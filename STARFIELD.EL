#OUTPUT "STARFIELD"' ¬¡ŒÀ4 ÕEMORY USAGE' ------------------' 4.0000 ƒÕ¡-Ã…”‘' 4.0020 VAR INTERFACE TO ASSEMBLY'        0020: PTR TO DEFAULTØRED&'        0022: PTR TO DEFAULTØGREEN&'        0024: PTR TO DEFAULTØBLUE&'        0026: PTR TO CURRØRED&'        0028: PTR TO CURRØGREEN&'        002A: PTR TO CURRØBLUE&'        002C: PTR TO DATAØADDR%'        002E: PTR TO CDATAØADDR%'        0030: PTR TO SCRADDR%'        0032: PTR TO CLRADDR%'        0034: PTR TO INC%'        0036: PTR TO STARX%'        0038: PTR TO STARVX%' 4.0800 ”√“≈≈Œ Õ≈Õœ“Ÿ' 4.2000 –≈‘”√…… «“¡–»…√” FOR ¬¡” LOGO' ¬¡ŒÀ5 ÕEMORY USAGE' ------------------' 5.0000 SCREEN BUFFER FOR DRAWØPETSCIIØFRAME' 5.1000 COLOR RAM BUFFER FOR DRAWØPETSCIIØFRAME' 5.2000 SCREEN BUFFER2 FOR LINE-DRAWING LAYER'--------.DECLARES'--------#DECLARE STARX%(20), STARY(20), STARVX%(20)#DECLARE K#DECLARE FNAME$, VAL&#DECLARE LDATA&(12288), DIDX%=0, PIDX%=0#DECLARE GROUPØFLAG&, VAL&, REVØFLAG& = 0#DECLARE OFFS, VER=2#DECLARE LASTFLAG, LASTØGROUPØIDX#DECLARE OLDX, OLDY, OLDOFFS, X, Y, A$, XX, YY, DEBUG, Z$#DECLARE CHR#DECLARE SRCØADDR, DESTØADDR, LENGTH, TRANSP#DECLARE LOC, PTR'-------.DEFINES'-------#DEFINE œ–Ø√œ–Ÿ = 0#DEFINE œ–ØÕ…ÿ  = 1#DEFINE œ–Ø”◊¡– = 2#DEFINE œ–Ø∆…ÃÃ = 3'----.MAIN'----  GOSUB INIT.LOOP  GOSUB DRAWØSTARFIELD  GOSUB PLAYØDATAØITER  ' LINE DATA  GOSUB PAGEØFLIP  GOSUB ITERØSTARFIELD  GOTO LOOP  END'----.INIT'----  BANK 0:BLOAD "ASMHELPER":BANK 128  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  PRINT CHR$(27);"5";  FOR K = 0 TO 20    STARX%(K) = INT(RND(1)*80)*256    STARY(K) = INT(RND(1)*50)    STARVX%(K) = (RND(1)*4 + .5)*256  NEXT K  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  EDMA 3, $FA0, 32, $52000  EDMA 3, $FA0, 0, $51000  FNAME$ = "ANA.LN"  VER = 1  GOSUB LOADØLINEØFILE  POKE $40000, $81 ' OPT = DEST ADDR Õ¬ SELECTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $00 ' √Õƒ LSB = √œ–Ÿ  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C, $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' √Õƒ MSB (IGNORE)  WPOKE $40010, $0000 ' MODULO (IGNORE)  ' INIT VAR INTERFACE TO ASSEMBLY  LOC = $40036  PTR = POINTER(STARX%(0))  GOSUB STOREØPTR  PTR = POINTER(STARVX%(0))  GOSUB STOREØPTR  RETURN'---------.STOREØPTR'---------  WPOKE LOC, PTR  LOC = LOC + 2  RETURN'--------------.LOADØLINEØFILE'-------------- ' (FNAME$)  IF FNAME$ = "" THEN RETURN  GOSUB LINEØFILEØINIT  DOPEN #2,(FNAME$),R,U8  DO    GET #2, VAL&    IF ST THEN EXIT    LDATA&(DIDX%) = VAL&    DIDX% = DIDX% + 1  LOOP  DCLOSE #2  GOSUB PLAYØDATAØINIT  RETURN'--------------.LINEØFILEØINIT'--------------  OLDX = -1 : OLDY = -1 : OLDOFFS = 0  DIDX% = 0  GROUPØFLAG& = 0 : REVØFLAG& = 0  OFFS = 0  RETURN'--------------.DRAWØSTARFIELD'--------------  FOR K = 0 TO 20    POKE $50000 + STARX%(K)/256 + STARY(K) * 80, 46  ' DOT  NEXT K  RETURN'--------------.ITERØSTARFIELD'--------------  BANK 0:SYS $7E0F:BANK 128  'FOR K = 0 TO 20  '  STARX%(K) = MOD( (STARX%(K)-STARVX%(K))/256 + 80, 80)  'NEXT K  RETURN'---------.PAGEØFLIP'---------  SRCØADDR = $52000  DESTØADDR = $50000  LENGTH = 4000  TRANSP = 32  GOSUB TRANSPARENTØDMA  EDMA 0, $FA0, $50000, $40800  EDMA 0, $FA0, $51000, $FF80000  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 1, $51000  RETURN'--------------.PLAYØDATAØINIT'--------------  PRINT "ì";  OFFS=0  PIDX% = 0  IF LASTFLAG = 1 THEN PIDX% = LASTØGROUPØIDX : LASTFLAG = 0  RETURN'--------------.PLAYØDATAØITER'--------------  IF PIDX% < DIDX% THEN BEGIN    VAL& = LDATA&(PIDX%) : PIDX% = PIDX% + 1    IF VER=3 AND VAL& = $FF THEN BEGIN      IF PIDX% > LASTØGROUPØIDX THEN LASTØGROUPØIDX = PIDX%      GOTO PDØENDLOOP    BEND    'IF VAL& = $FF THEN GROUPØFLAG& = 1 : GOTO PDØENDLOOP    'IF VAL& = $FE THEN GROUPØFLAG& = 0 : SLEEP .02 : GOTO PDØENDLOOP    X = VAL& AND $7F    IF VER=2 THEN BEGIN      X = VAL&      VAL& = LDATA&(PIDX%)      PIDX% = PIDX% + 1      X = X + (VAL& AND $7F) * 256    BEND    IF VAL& AND $80 THEN REVØFLAG& = 1: ELSE REVØFLAG& = 0    Y = LDATA&(PIDX%) : PIDX% = PIDX% + 1    A$ = CHR$(LDATA&(PIDX%)) : PIDX% = PIDX% + 1    IF VER=2 THEN BEGIN      DO WHILE X-OFFS > 78        GOSUB SCROLLØCANVASØRIGHT        PRINT "";CHR$(27);"QOFFS=";OFFS;      LOOP    BEND    XX = X-OFFS : YY = Y: CURSOR XX, YY : GOSUB DRAWØCHAR    IF DEBUG=1 THEN GET KEY Z$      'PRINT "";CHR$(27);"Q X,Y,PIDX,A$=";X;Y;PIDX%,ASC(A$)      'GET KEY A$    ' IF GROUPØFLAG& = 0 THEN SLEEP .02.PDØENDLOOP  BEND  ' X = X-OFFS  RETURN'-------------------.SCROLLØCANVASØRIGHT'-------------------  OFFS=OFFS+1  FOR YY = 0 TO 49    EDMA œ–Ø√œ–Ÿ, 79, $40801 + YY*80, $40800 + YY*80    POKE $40800 + 79 + YY*80, 32   NEXT YY                  RETURN'---------.DRAWØCHAR'---------  ' POKE $40800 + X + Y*80, ASC(A$)  ' POKE $FF80000 + X + Y*80, RCOLOR(1)    CHR = ASC(A$)  GOSUB PETSCIIØTOØSCREENCODE  IF REVØFLAG& = 1 THEN CHR = CHR + 128  POKE $52000 + X + Y*80, CHR  ' PRINT A$;  RETURN'---------------------.PETSCIIØTOØSCREENCODE'---------------------  ' ¬ASED ON THE TABLE HERE:  ' HTTPS://STA.C64.ORG/CBM64PETTOSCR.HTML  ' - SEEMS LIKE … NEEDED TO DO A REPAIR TO IT ON THE $A0-->$BF RANGE  IF CHR>=$00 AND CHR<=$1F THEN CHR=CHR OR $80:RETURN  IF CHR>=$20 AND CHR<=$3F THEN RETURN  IF CHR>=$40 AND CHR<=$5F THEN CHR=CHR AND $BF:RETURN  IF CHR>=$60 AND CHR<=$7F THEN CHR=CHR AND $DF:RETURN  IF CHR>=$80 AND CHR<=$9F THEN CHR=CHR OR $40:RETURN  IF CHR>=$A0 AND CHR<=$BF THEN CHR=(CHR AND $7F) OR $40:RETURN ' $BF:RETURN  IF CHR>=$C0 AND CHR<=$FE THEN CHR=CHR AND $7F:RETURN  RETURN'---------------.TRANSPARENTØDMA'---------------  WPOKE $40009, SRCØADDR  WPOKE $4000C, DESTØADDR  WPOKE $40007, LENGTH  POKE  $40004, TRANSP  POKE $D702, 4 ' DMA LIST IN BANK 4  POKE $D701, $00 ' DMA LIST MSB  POKE $D705, $00 ' DMA LIST LSB  RETURN