#OUTPUT "LINE"#DECLARE A$, LOC#DECLARE X=0, Y=0#DECLARE T0=0#DECLARE MODIFIED%=0#DECLARE OLDX, OLDY#DECLARE FNAME$#DECLARE LDATA&(8192), DIDX%=0#DECLARE GROUP¯FLAG&GOSUB INIT.MAINGOSUB CHECK¯INPUTGOSUB SHOW¯CURSORGOTO MAIN'----.INIT'----  ' SWITCH BACK TO UPPER-CASE  ' POKE $D018, PEEK($D018) AND $FD  OLDX = -1 : OLDY = -1  DIDX% = 0  GROUP¯FLAG& = 0  PRINT "“";  POKE $D020, 0  POKE $D021, 0  RETURN'-----------.CHECK¯INPUT'-----------  GET A$  IF A$="" AND X>0 THEN GOSUB RESTORE¯CHAR : X=X-1 : RETURN  IF A$="" AND X<79 THEN GOSUB RESTORE¯CHAR : X=X+1 : RETURN  IF A$="‘" AND Y>0 THEN GOSUB RESTORE¯CHAR : Y=Y-1 : RETURN            IF A$="" AND Y<49 THEN GOSUB RESTORE¯CHAR : Y=Y+1 : RETURN  IF A$="…" THEN GOSUB LOAD¯FILE : RETURN  IF A$="†" THEN GOSUB SAVE¯FILE : RETURN  IF A$=" " THEN GOSUB SET¯GROUP¯FLAG : RETURN  IF A$="‡" THEN GOSUB PLAY¯DATA : RETURN  IF A$<>"" THEN CURSOR X, Y : GOSUB RESTORE¯CHAR : PRINT A$; : GOSUB SAVE¯CHAR  RETURN'--------------.SET¯GROUP¯FLAG'--------------  IF GROUP¯FLAG& = 0 THEN BEGIN    GROUP¯FLAG& = 1    LDATA&(DIDX%) = $FF    POKE $D020, $02  BEND:ELSE BEGIN    GROUP¯FLAG& = 0    LDATA&(DIDX%) = $FE    POKE $D020, $00  BEND  RETURN'---------.LOAD¯FILE'---------  RETURN'---------.SAVE¯FILE'---------  INPUT "SAVE NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  DELETE (FNAME$)  DOPEN #2,(FNAME$),W,U8    DCLOSE #2  RETURN'---------.SAVE¯CHAR'---------  RETURN  '------------  .RESTORE¯CHAR'------------  IF MODIFIED% THEN BEGIN    LOC = $FF80000 + X + 80 * Y    POKE LOC, PEEK(LOC) XOR 32    MODIFIED% = 0    T0 = TI  BEND  RETURN'-----------.SHOW¯CURSOR'-----------  IF TI > T0 THEN T0 = TI + .5:ELSE RETURN  LOC = $FF80000 + X + 80 * Y  POKE LOC, PEEK(LOC) XOR 32  MODIFIED% = MODIFIED% XOR 1  RETURN