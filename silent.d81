 = тьтталк THEN GOSUB CLEAR╞TXT╞TALK      READ ACTION      ACTTIMER=0      IF ACTION = тьтгреы THEN READ ACTSTR$, ACTX, ACTY      IF ACTION = тьтталк THEN READ ACTSTR$, ACTDUR      IF ACTION = тьтцлеар THEN GOSUB CLEAR╞TEXT      IF ACTION = аним THEN READ ACTANIM:ANIMIDX=0:ANIMREPEATCOUNT=0      IF ACTION = паинтинг THEN READ ACTPAINTING:GOSUB DRAW╞PAINTING      IF ACTION = реацтион THEN READ ACTSTR$, ACTREACTION, ACTDUR:GOSUB INIT╞REACTION      IF ACTION = цлс THEN PRINT "⌠";      IF ACTION = дравфрм THEN READ FRAMEIDX:GOSUB DRAW╞PETSCII╞FRAME      IF ACTION = ендер THEN EXIT      TSTART = TI      READ TIME ' TIME FOR NEXT ACTION    BEND    IF ACTION = тьтгреы THEN GOSUB DRAW╞TXT╞GREY    IF ACTION = тьтталк THEN GOSUB DRAW╞TXT╞TALK    IF ACTION = реацтион THEN GOSUB DRAW╞REACTION    GOSUB POLL╞PLAY    GOSUB POLL╞ANIM  LOOP    RETURN#DEFINE марк1 = -1#DEFINE марк2 = -2#DEFINE марк3 = -3#DEFINE репеат = -10#DEFINE инфинителы = -1#DEFINE енд╞аним = -999#DEFINE алл╞анимс╞финисхед = -1000#DECLARE FRAME╞START.POLL╞ANIM'---------  IF ACTANIM = -1 THEN RETURN  IF FRAMEDUR > 0 AND (TI - FRAME╞START) < FRAMEDUR THEN RETURN  FRAMEDUR = 0  'CURSOR 0,1:PRINT "POLL╞ANIM";  'CURSOR 0,2:PRINT "ACTANIM=";ACTANIM;  'CURSOR 0,3:PRINT "ANIMIDX=";ANIMIDX;  AVAL = ANIMS(ACTANIM,ANIMIDX)  ANIMIDX = ANIMIDX + 1'PRINT "                     ANIMIDX=";ANIMIDX;  FOUND = 0  IF AVAL = марк1 THEN FOUND=1:MARK(1)=ANIMIDX  IF AVAL = марк2 THEN FOUND=1:MARK(2)=ANIMIDX  IF AV 0  1 A=126:B=124:C=123:D=108:E=254:F=252:G=251:H=236:I=127:J=255:K=98:L=226:M=97:N=225:O=32:P=160:Q=3.141592654269: 2 DIM AQ(10):DIM AR(10):DIM BO(10):DIM BP(10):DIM BQ(10):DIM BR(10):GOSUB 78 3 PRINT"⌠";:PRINT"PETLINE EXAMPLE MENU:":PRINT"--------------------":PRINT"1) LINES":PRINT"2) SQUARE":PRINT"3) MANY SQUARES":PRINT"4) DRAW CUBE" 4 PRINT"5) DRAW MANY CUBES":PRINT"6) QIX LINES":GETKEYB$:IFB$="1"THENGOSUB 27 5 IFB$="2"THENGOSUB 24 6 IFB$="3"THENGOSUB 23 7 IFB$="4"THENGOSUB 17 8 IFB$="5"THEN	GOSUB 16 9 IFB$="6"THENGOSUB 12 10 IFB$>="1"ANDB$<="5"THENGETKEYB$ 11 GOTO 3:END 12 BM=.:BN=. 13 BO(BM)=INT(RND(1)*160):BP(BM)=INT(RND(1)*100):BQ(BM)=INT(RND(1)*160):BR(BM)=INT(RND(1)*100):BW=INT(RND(1)*16)+64:SYS32268,1:BN=BN+1:R=BO(BM):S=BP(BM) 1
4 T=BQ(BM):U=BR(BM):GOSUB 28:BM=MOD(BM+1,10) 15 GOTO 13:RETURN 16 BD=.:FORBC=.TO1.9*Q/4STEPQ/16:GOSUB 17:NEXTBC:BC=.:FORBD=.TO1.9*Q/2STEPQ/16:GOSUB 17:NEXTBD:RETURN 17 AV=45:AZ=.:AY=ATN(1/SQR(2)):FORAX=Q/4TO1.9*QSTEPQ/2:BA=AV*COS(AY):BB=BA*SIN(AX):AR(AZ)=AV*SIN(AY):AQ(AZ)=BA*COS(AX):GOSUB 21 18 GOSUB 22:AQ(AZ)=AN+AQ(AZ)-BB*BF/4:AR(AZ)=AO+AR(AZ)+BB*BF:AZ=AZ+1:NEXTAX:AS=4:GOSUB 26:AZ=.:AY=-ATN(1/SQR(2)):FORAX=Q/4TO1.9*QSTEPQ/2 19 R=AQ(AZ):S=AR(AZ):BA=AV*COS(AY):BB=BA*SIN(AX):AR(AZ)=AV*SIN(AY):AQ(AZ)=BA*COS(AX):GOSUB 21:GOSUB 22:AQ(AZ)=AN+AQ(AZ)-BB*BF/4 20 AR(AZ)=AO+AR(AZ)+BB*BF:T=AQ(AZ):U=AR(AZ):GOSUB 28:AZ=AZ+1:NEXTAX:AS=4:GOSUB 26:RETURN 21 AD=AQ(AZ):AE=BB:BA=SQR(AD*AD+AE*AE):GOSUB 29:AI=AI+BC:AQ(AZ)=BA*COS(AI):BB=BA*SIN(AI):RETURN 22 AD=AQ(AZ):AE=AR(AZ):BA=SQR(AD*AD+AE*AE):GOSUB 29:AI=AI+BD:AQ(AZ)=BA*COS(AI):AR(AZ)=BA*SIN(AI):RETURN 23 FORAW=.TOQ/2STEPQ/8:GOSUB 24:NEXTAW:RETURN 24 AV=45:AT=AW-3*Q/4:AQ(.)=AN+AV*COS(AT):AR(.)=AO+AV*SIN(AT):AT=AW-Q/4:AQ(1)=AN+AV*COS(AT):AR(1)=AO+AV*SIN(AT):AT=AW+Q/4:AQ(2)=AN+AV*COS(AT) 25 AR(2)=AO+AV*SIN(AT):AT=AW+3*Q/4:AQ(3)=AN+AV*COS(AT):AR(3)=AO+AV*SIN(AT):AS=4:GOSUB 26:RETURN 26 FORAU=.TOAS-2:R=AQ(AU):S=AR(AU):T=AQ(AU+1):U=AR(AU+1):GOSUB 28:NEXTAU:R=AQ(AS-1):S=AR(AS-1):T=AQ(.):U=AR(.):GOSUB 28:RETURN 27 FORAJ=.TO2*QSTEPQ/8:R=80:S=50:T=INT(80+30*COS(AJ)):U=INT(50+30*SIN(AJ)):GOSUB 28:NEXTAJ:RETURN 28 SYS32259:R=MOD(INT(R)+256,256):S=MOD(INT(S)+256,256):T=MOD(INT(T)+256,256):U=MOD(INT(U)+256,256):SYS32265,R,S,T,U:RETURN 29 IFAD=.THENBEGIN 30 IFAE<.THENAI=-Q/2 31 IFAE>.THENAI=Q/2 32 BEND:ELSEBEGIN:AH=AE/AD:AI=ATN(AH) 33 IFAD<.THENBEGIN 34 IFAE<.THENAI=AI-Q:ELSEAI=AI+Q 35 BEND 36 BEND 37 RETURN 38 BANK.:SYS32262,MOD(Z+256,256),MOD(AA+256,256),5:RETURN 39 IFZ<.ORZ>159ORAA<.ORAA>99THENRETURN 40 V=INT(Z/2):W=INT(AA/2):X=MOD(INT(Z),2):Y=MOD(INT(AA),2):AB=PEEK(264192+V+W*80):GOSUB 45:IFX=.ANDY=.THENAC=ACOR1 41 IFX=1ANDY=.THENAC=ACOR2 42 IFX=.ANDY=1THENAC=ACOR4 43 IFX=1ANDY=1THENAC=ACOR8 44 GOSUB 61:POKE264192+V+W*80,AB:RETURN 45 AC=.:IFAB=ATHENAC=1:RETURN 46 IFAB=BTHENAC=2:RETURN 47 IFAB=CTHENAC=4:RETURN 48 IFAB=DTHENAC=8:RETURN 49 IFAB=ETHENAC=14:RETURN 50 IFAB=FTHENAC=13:RETURN 51 IFAB=GTHENAC=11:RETURN 52 IFAB=HTHENAC=7:RETURN 53 IFAB=ITHENAC=9:RETURN 54 IFAB=JTHENAC=6:RETURN 55 IFAB=KTHENAC=12:RETURN 56 IFAB=LTHENAC=3:RETURN 57 IFAB=MTHENAC=5:RETURN 58 IFAB=NTHENAC=10:RETURN 59 IFAB=PTHENAC=15:RETURN 60 RETURN 61 IFAC=.THENAB=O:RETURN 62 IFAC=1THENAB=A:RETURN 63 IFAC=2THENAB=B:RETURN 64 IFAC=3THENAB=L:RETURN 65 IFAC=4THENAB=C:RETURN 66 IFAC=5THENAB=M:RETURN 67 IFAC=6THENAB=J:RETURN 68 IFAC=7THENAB=H:RETURN 69 IFAC=8THENAB=D:RETURN 70 IFAC=9THENAB=I:RETURN 71 IFAC=10THENAB=N:RETURN 72 IFAC=11THENAB=G:RETURN 73 IFAC=12THENAB=K:RETURN 74 IFAC=13THENAB=F:RETURN 75 IFAC=14THENAB=E:RETURN 76 IFAC=15THENAB=P:RETURN 77 RETURN 78 BANK.:BLOAD"MEGAPLOT":SYS32259:AN=80:AO=50:PRINTCHR$(27);"5";CHR$(147);:BF=COS(Q/4):RETURN 79 REM пиь╞тл = :A: 80 REM пиь╞тр = :B: 81 REM пиь╞бл = :C: 82 REM пиь╞бр = :D: 83 REM пиь╞инж╞тл = :E: 84 REM пиь╞инж╞тр = :F: 85 REM пиь╞инж╞бл = :G: 86 REM пиь╞инж╞бр = :H: 87 REM пиь╞диаг╞тл╞бр = :I: 88 REM пиь╞диаг╞бл╞тр = :J: 89 REM пиь╞хлине╞бот = :K: 90 REM пиь╞хлине╞топ = :L: 91 REM пиь╞жлине╞лефт = :M: 92 REM пиь╞жлине╞5ригхт = :N: 93 REM пиь╞ноне = :O: 94 REM пиь╞алл = :P: 95 REM пи = :Q: 96 REM X1 = :R: 97 REM Y1 = :S: 98 REM X2 = :T: 99 REM Y2 = :U: 100 REM DX = :V: 101 REM DY = :W: 102 REM MX = :X: 103 REM MY = :Y: 104 REM CX = :Z: 105 REM CY = :AA: 10AL = марк3 THEN FOUND=1:MARK(3)=ANIMIDX  IF AVAL = репеат THEN BEGIN    FOUND=1    ' GET MARK NUMBER (IN AVAL)    GMARKNUM = ABS(ANIMS(ACTANIM,ANIMIDX))    ANIMIDX = ANIMIDX + 1    GCOUNT = ANIMS(ACTANIM,ANIMIDX)    ANIMIDX = ANIMIDX + 1    BAIL=0    IF ANIMREPEATCOUNT = 0 THEN BEGIN      IF GCOUNT <> -1 THEN ANIMREPEATCOUNT = GCOUNT      ANIMIDX = MARK(GMARKNUM)      BAIL=1    BEND          IF BAIL=0 AND ANIMREPEATCOUNT > 0 THEN BEGIN      ANIMREPEATCOUNT = ANIMREPEATCOUNT -1      IF ,ANIMREPEATCOUNT = 0 THEN BAIL=1      IF BAIL=0 THEN ANIMIDX=MARK(GMARKNUM)      BAIL=1    BEND    'IF BAIL=0 AND ANIMREPEATCOUNT = инфинителы THEN BEGIN    '  ANIMIDX=MARK(GMARKNUM)    '  BAIL=1    'BEND  BEND  IF AVAL = енд╞аним THEN BEGIN   FINE фрм╞оффсет╞ь          = 0#DEFINE фрм╞оффсет╞ы          = 1#DEFINE фрм╞оффсет╞в          = 2#DEFINE фрм╞оффсет╞х          = 3#DEFINE фрм╞оффсет╞хитбоьес   = 4#DEFINE фрм╞оффсет╞хб╞хеад    = 4#DEFINE фрм╞оффсет╞хб╞торсо   = 8#DEFINE фрм╞оффсет╞хб╞феет    = 12#DEFINE фрм╞оффсет╞хб╞аттацк  = 16#DEFINE фрм╞оффсет╞дата       = 20'----.MAIN'----  GOSUB INIT  GOSUB LOAD╞DATA  GOSUB STATE╞LOOP  GOSUB ANIMATE╞LOGO  END#DEFINE ст╞фаде╞то╞вхите = 0#DEFINE ст╞драв╞бацкдроп╞онлы = 1#DEFINE ст╞фаде╞то╞дефаулт = 2#DEFINE ст╞дроп╞ин╞б = 3#DEFINE ст╞пресентс = 4#DEFINE ст╞анатхема = 5'----------.STATE╞LOOP'----------  TSTART = TI  IF LOGO╞STATE = ст╞фаде╞то╞вхите THEN BEGIN    GOSUB FADE╞TO╞WHITE    LOGO╞STATE = ст╞драв╞бацкдроп╞онлы  BEND    IF LOGO╞STATE = ст╞драв╞бацкдроп╞онлы THEN BEGIN    BANK 128    POKE $D020, 1, 1    GOSUB INIT╞80X50    GOSUB DRAW╞BACKDROP    GOSUB PAGE╞FLIP    GOSUB STORE╞CURR╞COLOURS    GOSUB SET╞PALETTE╞FOR╞BACKDROP    FADEVAL=0    M=0    LOGO╞STATE = ст╞фаде╞то╞дефаулт  BEND    IF LOGO╞STATE = ст╞фаде╞то╞дефаулт THEN BEGIN    IF FADEVAL <= 128 THEN BEGIN      ' FADE╞COLOURS╞TO╞DEFAULTS      BANK 0:VSYNC 10:SYS $7E03, FADEVAL:BANK 128      FADEVAL = FADEVAL + 1    BEND    '  CYCLE╞ALT╞PALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M = 130 THEN LOGO╞STATE = ст╞дроп╞ин╞б  BEND  IF LOGO╞STATE = ст╞дроп╞ин╞б THEN BEGIN    GOSUB ANIMATE╞LOGO    ' CYCLE╞ALT╞PALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1   ! IF M > 250 THEN LOGO╞STATE = ст╞пресентс:FADEVAL = 0  BEND  IF LOGO╞STATE = ст╞пресентс THEN BEGIN    GOSUB ANIM╞DRAW╞SUBTEXT    ' CYCLE╞ALT╞PALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M > 360 THEN BEGIN      ' FADE TO BLACK      #BANK 0:SYS $7E0C, FADEVAL:BANK 128      FADEVAL = FADEVAL + 1    BEND    IF FADEVAL = 128 THEN BEGIN      POKE $D020, 0, 0      LOGO╞STATE = ст╞анатхема    BEND  BEND  IF LOGO╞STATE = ст╞анатхема THEN BEGIN    PRINT "ANATHEMA!";  BEND  DO$р=1#DEFINE тьтталк=2#DEFINE аним=3#DEFINE паинтинг=4#DEFINE реацтион=5#DEFINE цлс=6#DEFINE дравфрм=7#DEFINE ендер=8' ANIMATIONS#DEFINE анм╞пондер=0#DEFINE анм╞паинт=1#DEFINE анм╞лифт=2#DEFINE анм╞рип=3.INIT╞PETSCII╞FRAMES'---------------,  LOOP WHILE (TI-TSTART) < .03  GOTO STATE╞LOOP  RETURN'----------.INIT╞80X50'----------  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  ' SWITCH TO 80X50  ' SETBIT хотрег╞7, 7  ' POKE $D031, $E8 ' 1110 1000 = х640,фаст,аттр%----  MAX╞FRAMES = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  DO WHILE FRM╞IDX < MAX╞FRAMES    FRAME╞ADDR(FRM╞IDX) = DATA╞ADDR    DATA╞ADDR = DATA╞ADDR + 2    FRMW = PEEK(DATA╞ADDR)    DATA╞ADDR = DATA╞ADDR + 1    FRMH = PEEK(DATA╞ADDR)    DAT&A╞ADDR = DATA╞ADDR + 1    DATA╞ADDR = DATA╞ADDR + FRMW * FRMH * 2    ':PRINT CHR$(147);"FRM╞IDX=";FRM╞IDX    'FRAMEIDX=FRM╞IDX    'GOSUB DRAW╞PETSCII╞FRAME    'GETKEY TEST2$    FRM╞IDX = FRM╞IDX + 1  LOOP  RETURN#DECLARE ANIMIDX, ANIMREPEATCO'UNT'=============.PETSCII╞STORY'=============  GOSUB SWITCH╞TO╞80X25╞MODE  GOSUB RESTORE╞SCREEN╞POINTER  PALETTE RESTORE  BACKGROUND 0:BORDER 0  PRINT CHR$(147);  GOSUB INIT╞PETSCII╞FRAMES  GOSUB INIT╞ANIMS  #DECLARE TSTART, TIME, ACTION, A CTANIM=-1, ACTPAINTING  #DECLARE ACTSTR$, ACTX, ACTY, ACTDUR, ACTREACTION  #DECLARE ACTTIMER  TSTART = TI  READ TIME  ACTION = -1  DO WHILE ACTION <> ендер    ' TIME TO SWITCH TO NEXT ACTION?    IF (TI-TSTART) >= TIME THEN BEGIN      IF ACTION(INT(X1)+256,256)  Y1 = MOD(INT(Y1)+256,256)  X2 = MOD(INT(X2)+256,256)  Y2 = MOD(INT(Y2)+256,256)  SYS $7E09, X1, Y1, X2, Y2  RETURN  '-----.ATAN2'-----  IF DIFFX = 0 THEN BEGIN    IF DIFFY<0 THEN ANGLE = - пи/2    IF DIFFY>0 THEN ANGLE = пFFY<0 THEN ANGLE = - пи/2    IF DIFFY>0 THEN ANGLE = пи/2  BEND:ELSE BEGIN    TANVAL = DIFFY / DIFFX    ANGLE = ATN(TANVAL)  ' THIS IS RANGE -90DEG TO 90DEG    IF DIFFX<0 THEN BEGIN     IF DIFFY<0 THEN ANGLE = ANGLE - пи:ELSE ANGLE = ANGLE + пи   и/2  BEND:ELSE BEGIN    TANVAL = DIFFY / DIFFX    ANGLE = ATN(TANVAL)  ' THIS IS RANGE -90DEG TO 90DEG    IF DIFFX<0 THEN BEGIN     IF DIFFY<0 THEN ANGLE = ANGLE - пи:ELSE ANGLE = ANGLE + пи    BEND  BEND  RETURN'----------.DRAW╞PIXEL'----------  BANK 0:SYS $7E06, MOD(CX+256, 256), MOD(CY+256, 256), 5  RETURN  ' PIXEL CROPPED?  IF CX<0 OR CX>159 OR CY<0 OR CY>99 THEN RETURN  DX = INT(CX/2) : DY = INT(CY/2)  MX = MOD(INT(CX),2) : MY = MOD(INT(CY),2)    ' CURSOR 0,16:PRINT CHR$(27); BEND  BEND  RETURN'----------.DRAW╞PIXEL'----------  BANK 0:SYS $7E06, MOD(CX+256, 256), MOD(CY+256, 256), 5  RETURN  ' PIXEL CROPPED?  IF CX<0 OR CX>159 OR CY<0 OR CY>99 THEN RETURN  DX = INT(CX/2) : DY = INT(CY/2)  MX = MOD(INT(CX),2) :"QHX =";HX;", HY =";HY    ' CURSOR 0,17:PRINT CHR$(27);"QMX =";MX;", MY =";MY  CUR╞CHAR = PEEK($40800 + DX + DY * 80)  GOSUB READ╞ON╞PIXELS  IF MX = 0 AND MY = 0 THEN PIX = PIX OR 1  IF MX = 1 AND MY = 0 THEN PIX = PIX OR 2  IF MX = 0 AND MY = 1  MY = MOD(INT(CY),2)    ' CURSOR 0,16:PRINT CHR$(27);"QHX =";HX;", HY =";HY    ' CURSOR 0,17:PRINT CHR$(27);"QMX =";MX;", MY =";MY  CUR╞CHAR = PEEK($40800 + DX + DY * 80)  GOSUB READ╞ON╞PIXELS  IF MX = 0 AND MY = 0 THEN PIX = PIX OR 1  IF MX = 1	THEN PIX = PIX OR 4  IF MX = 1 AND MY = 1 THEN PIX = PIX OR 8  GOSUB SET╞ON╞PIXELS  POKE $40800 + DX + DY * 80, CUR╞CHAR  RETURN'--------------.READ╞ON╞PIXELS'--------------  PIX = 0 ' BITFIELDS: TL = 1, TR = 2, BL = 4, BR = 8  IF CUR╞CHAR =
 AND MY = 0 THEN PIX = PIX OR 2  IF MX = 0 AND MY = 1 THEN PIX = PIX OR 4  IF MX = 1 AND MY = 1 THEN PIX = PIX OR 8  GOSUB SET╞ON╞PIXELS  POKE $40800 + DX + DY * 80, CUR╞CHAR  RETURN'--------------.READ╞ON╞PIXELS'--------------  PIX = 0 ' BI пиь╞тл THEN PIX = 1:RETURN  IF CUR╞CHAR = пиь╞тр THEN PIX = 2:RETURN  IF CUR╞CHAR = пиь╞бл THEN PIX = 4:RETURN  IF CUR╞CHAR = пиь╞бр THEN PIX = 8:RETURN  IF CUR╞CHAR = пиь╞инж╞тл THEN PIX=14:RETURN  IF CUR╞CHAR = пиь╞инж╞тр THEN PIX=13:RETURN  IFTFIELDS: TL = 1, TR = 2, BL = 4, BR = 8  IF CUR╞CHAR = пиь╞тл THEN PIX = 1:RETURN  IF CUR╞CHAR = пиь╞тр THEN PIX = 2:RETURN  IF CUR╞CHAR = пиь╞бл THEN PIX = 4:RETURN  IF CUR╞CHAR = пиь╞бр THEN PIX = 8:RETURN  IF CUR╞CHAR = пиь╞инж╞тл THEN PIX=14:RE CUR╞CHAR = пиь╞инж╞бл THEN PIX=11:RETURN  IF CUR╞CHAR = пиь╞инж╞бр THEN PIX=7:RETURN  IF CUR╞CHAR = пиь╞диаг╞тл╞бр THEN PIX=9:RETURN  IF CUR╞CHAR = пиь╞диаг╞бл╞тр THEN PIX=6:RETURN  IF CUR╞CHAR = пиь╞хлине╞бот THEN PIX=12:RETURN  IF CUR╞CHAR = пиTURN  IF CUR╞CHAR = пиь╞инж╞тр THEN PIX=13:RETURN  IF CUR╞CHAR = пиь╞инж╞бл THEN PIX=11:RETURN  IF CUR╞CHAR = пиь╞инж╞бр THEN PIX=7:RETURN  IF CUR╞CHAR = пиь╞диаг╞тл╞бр THEN PIX=9:RETURN  IF CUR╞CHAR = пиь╞диаг╞бл╞тр THEN PIX=6:RETURN  IF CUR╞CHAь╞хлине╞топ THEN PIX=3:RETURN  IF CUR╞CHAR = пиь╞жлине╞лефт THEN PIX=5:RETURN  IF CUR╞CHAR = пиь╞жлине╞ригхт THEN PIX=10:RETURN  IF CUR╞CHAR = пиь╞алл THEN PIX=15:RETURN  RETURN'-------------.SET╞ON╞PIXELS'-------------  IF PIX = 0 THEN CUR╞CR = пиь╞хлине╞бот THEN PIX=12:RETURN  IF CUR╞CHAR = пиь╞хлине╞топ THEN PIX=3:RETURN  IF CUR╞CHAR = пиь╞жлине╞лефт THEN PIX=5:RETURN  IF CUR╞CHAR = пиь╞жлине╞ригхт THEN PIX=10:RETURN  IF CUR╞CHAR = пиь╞алл THEN PIX=15:RETURN  RETURN'------------HAR = пиь╞ноне:RETURN  IF PIX = 1 THEN CUR╞CHAR = пиь╞тл:RETURN  IF PIX = 2 THEN CUR╞CHAR = пиь╞тр:RETURN  IF PIX = 3 THEN CUR╞CHAR = пиь╞хлине╞топ:RETURN  IF PIX = 4 THEN CUR╞CHAR = пиь╞бл:RETURN  IF PIX = 5 THEN CUR╞CHAR = пиь╞жлине╞лефт:RETURN  -.SET╞ON╞PIXELS'-------------  IF PIX = 0 THEN CUR╞CHAR = пиь╞ноне:RETURN  IF PIX = 1 THEN CUR╞CHAR = пиь╞тл:RETURN  IF PIX = 2 THEN CUR╞CHAR = пиь╞тр:RETURN  IF PIX = 3 THEN CUR╞CHAR = пиь╞хлине╞топ:RETURN  IF PIX = 4 THEN CUR╞CHAR = пиь╞бл:RETURIF PIX = 6 THEN CUR╞CHAR = пиь╞диаг╞бл╞тр:RETURN  IF PIX = 7 THEN CUR╞CHAR = пиь╞инж╞бр:RETURN  IF PIX = 8 THEN CUR╞CHAR = пиь╞бр:RETURN  IF PIX = 9 THEN CUR╞CHAR = пиь╞диаг╞тл╞бр:RETURN  IF PIX = 10 THEN CUR╞CHAR = пиь╞жлине╞ригхт:RETURN  IF PIX = N  IF PIX = 5 THEN CUR╞CHAR = пиь╞жлине╞лефт:RETURN  IF PIX = 6 THEN CUR╞CHAR = пиь╞диаг╞бл╞тр:RETURN  IF PIX = 7 THEN CUR╞CHAR = пиь╞инж╞бр:RETURN  IF PIX = 8 THEN CUR╞CHAR = пиь╞бр:RETURN  IF PIX = 9 THEN CUR╞CHAR = пиь╞диаг╞тл╞бр:RETURN  IF PIX 11 THEN CUR╞CHAR = пиь╞инж╞бл:RETURN  IF PIX = 12 THEN CUR╞CHAR = пиь╞хлине╞бот:RETURN  IF PIX = 13 THEN CUR╞CHAR = пиь╞инж╞тр:RETURN  IF PIX = 14 THEN CUR╞CHAR = пиь╞инж╞тл:RETURN  IF PIX = 15 THEN CUR╞CHAR = пиь╞алл:RETURN  RETURN'----.INIT'-= 10 THEN CUR╞CHAR = пиь╞жлине╞ригхт:RETURN  IF PIX = 11 THEN CUR╞CHAR = пиь╞инж╞бл:RETURN  IF PIX = 12 THEN CUR╞CHAR = пиь╞хлине╞бот:RETURN  IF PIX = 13 THEN CUR╞CHAR = пиь╞инж╞тр:RETURN  IF PIX = 14 THEN CUR╞CHAR = пиь╞инж╞тл:RETURN  IF PIX = 15 T ▒---  BANK 0:BLOAD "MEGAPLOT"  SYS $7E03 ' INIT  CENTREX = 80 : CENTREY = 50  PRINT CHR$(27);"5";CHR$(147);  ZFACT = COS(пи/4)  RETURN                                                                                                                 хHEN CUR╞CHAR = пиь╞алл:RETURN  RETURN'----.INIT'----  BANK 0:BLOAD "MEGAPLOT"  SYS $7E03 ' INIT  CENTREX = 80 : CENTREY = 50  PRINT CHR$(27);"5";CHR$(147);  ZFACT = COS(пи/4)  RETURN                                                         #OUTPUT "XANADU-BASIC65"'============.DECLARATIONS'============  ' MUSIC RELATED VARS  ' ------------------  #DECLARE MUSIC╞CHUNK╞INDEX     ' OLD T  #DECLARE BAR╞INDEX             ' OLD TT  #DECLARE MAP╞BAR╞TO╞CHUNK(10)  ' OLD M()  #DECLARE V1$(4), V2$(4), V3$(4), V4$(4)  ' PALETTE  ' -------  #DECLARE DEFAULT╞RED(32)  #DECLARE DEFAULT╞GREEN(32)  #DECLARE DEFAULT╞BLUE(32)  #DECLARE CURR╞RED(32)  #DECLARE CURR╞GREEN(32)  #DECLARE CURR╞BLUE(32)  #DECLARE FADEVAL, TEMPVAL  ' и/о  ' ---  #DEFINE хотрег╞7 = $D05D  #DEFINE сцрнптрлсб = $D060  #DEFINE сцрнптрбнк = $D062  ' MISC  ' ----  #DECLARE K,M,N  #DECLARE RAINBOWSTR$  #DECLARE RAINBOW╞X, RAINBOW╞Y  #DECLARE PLEN=0  #DECLARE SUBTEXT$(2)  #DECLARE SUBTEXT╞IDX = 0  SUBTEXT$(0) = "PRESENTS..."  SUBTEXT$(1) = "A TRIBUTE TO THE LATE OLIVIA NEWTON JOHN..."  #DECLARE PAN╞IDX = 0  #DECLARE PAN╞SRC╞IDX  #DECLARE PAN╞DEST╞IDX  #DECLARE PAN╞Y, PAN╞LEN  ' PETSCII  ' -------  #DECLARE DATA╞ADDR = $4270C  #DECLARE MAX╞FRAMES  #DECLARE FRAME╞ADDR(64)  #DECLARE FRM╞IDX = 0  #DECLARE FRMW, FRMH#DECLARE ANIMS(4,100) ' ANIM╞IDX, ANIM╞DATA#DECLARE AVAL,MARK(3),GMARKNUM,GCOUNT,BAIL,FOUND,FRAMEIDX,FRAMEDUR=0#DECLARE FRMX, FRMY, FRMX1, FRMY1, CDATA╞ADDR#DEFINE фрм╞станд = 0#DEFINE фрм╞арм╞уп1 = 1#DEFINE фрм╞арм╞уп2 = 2#DEFINE фрм╞арм╞уп3 = 3#DEFINE фрм╞арм╞уп4 = 4#DEFINE фрм╞арм╞лефт1 = 5#DEFINE фрм╞арм╞лефт2 = 6#DEFINE фрм╞арм╞лефт3 = 7#DEFINE фрм╞арм╞лефт4 = 8#DEFINE фрм╞цлосе╞еыес = 9#DEFINE фрм╞опен╞моутх = 10#DEFINE фрм╞цлосе╞моутх = 11#DEFINE фрм╞арм╞ригхт1 = 12#DEFINE фрм╞арм╞ригхт2 = 13#DEFINE фрм╞арм╞ригхт3 = 14#DEFINE фрм╞арм╞ригхт4 = 15#DEFINE фрм╞ретурн╞паинтбрусх = 16#DEFINE фрм╞арм╞ригхт5 = 17#DEFINE фрм╞арм╞ригхт6 = 18#DEFINE фрм╞лифт╞папер1 = 19#DEFINE фрм╞лифт╞папер2 = 20#DEFINE фрм╞схоцк╞фаце = 21#DEFINE фрм╞цринге╞фаце = 22#DEFINE фрм╞цросс╞фаце = 23#DEFINE фрм╞хоррор╞фаце = 24#DEFINE фрм╞сад╞фаце = 25#DEFINE фрм╞норм╞фаце = 26#DEFINE фрм╞рип1 = 27#DEFINE фрм╞рип2 = 28#D EFINE фрм╞рип3 = 29#DEFINE фрм╞рип4 = 30#DEFINE фрм╞рип5 = 31#DEFINE фрм╞рип6 = 32#DEFINE фрм╞рип7 = 33#DEFINE фрм╞рип8 = 34#DEFINE фрм╞рип9 = 35#DEFINE фрм╞рип10 = 36#DEFINE фрм╞рип11 = 37#DEFINE фрм╞папер = 38#DEFINE фрм╞паинтинг1 = 39#DEFIN!E фрм╞паинтинг2 = 40#DEFINE фрм╞паинтинг3 = 41#DEFINE фрм╞мурал = 42'====.MAIN'====  GOSUB INIT  GOSUB BAS╞LOGO  GOSUB XANADU╞TITLE  GOSUB PETSCII╞STORY  GOSUB ENDER  ' BACKUP PALETTE TO $48000  EDMA 0, $300, $FFD3100, $48000   ' SET ALL "COLOURS TO BLACK  EDMA 3, $300, 0, $FFD3100   'тодо: DELETE  IF PEEK($D020)<>0 THEN BORDER 2:GOSUB INIT╞PETSCII╞FRAMES  FRAMEIDX=фрм╞мурал  GOSUB DRAW╞PETSCII╞FRAME  CLR  DLOAD "BIGSPRITE"  END' ACTION NAMES#DEFINE тьтгреы=0#DEFINE тьтцлеа$---------.DRAW╞LINE'---------  SYS $7E03  X1 = MOD(INT(X1)+256,256)  Y1 = MOD(INT(Y1)+256,256)  X2 = MOD(INT(X2)+256,256)  Y2 = MOD(INT(Y2)+256,256)  SYS $7E09, X1, Y1, X2, Y2, 5  RETURN    ' BORROWED FROM: WWW.BAELDUNG.COM/CS/BRESENHAMS-LINE-%B DRAW╞LINE  RETURN'--------------------------.DRAW╞LINES╞FROM╞CENTRE╞OUT'--------------------------  FOR ANG = 0 TO 2*пи STEP пи / 8    X1 = 80    Y1 = 50    X2 = INT(80 + 30 * COS(ANG))    Y2 = INT(50 + 30 * SIN(ANG))    ' CURSOR 0,20:PRI&ALGORITHM  X1 = INT(X1)  Y1 = INT(Y1)  X2 = INT(X2)  Y2 = INT(Y2)  DDX = ABS(X2-X1)  IF X1 < X2 THEN SX = 1 : ELSE SX = -1  DDY = -ABS(Y2-Y1)  IF Y1 < Y2 THEN SY = 1 : ELSE SY = -1  E = DDX + DDY  CX = X1 : CY = Y1  DO WHILE 1    GOSUB DRA NT CHR$(27);"QX1 =";X1;", Y1 =";Y1    ' CURSOR 0,21:PRINT CHR$(27);"QX2 =";X2;", Y2 =";Y2    ' GET KEY A$    ' IF A$="D" THEN DEBUG = 1: ELSE DEBUG = 0    GOSUB DRAW╞LINE  NEXT ANG  RETURN'---------.DRAW╞LINE'---------  SYS $7E03  X1 = MOD'W╞PIXEL    IF CX = (X2) AND CY = Y2 THEN EXIT  E2 = 2 * E  IF E2 >= DDY THEN BEGIN    IF CX = X2 THEN EXIT    E = E + DDY    CX = CX + SX  BEND  IF E2 <= DDX THEN BEGIN    IF CY = Y2 THEN EXIT    E = E + DDX    CY = CY + SY  BEND    IF DEBUG=1 THEN BEGIN      CURSOR 0,15:PRINT CHR$(27);"QCX =";CX;", CY =";CY      CURSOR 0,16:PRINT CHR$(27);"QDDX =";DDX;", DDY =";DDY;", E=";E;", E2=";E2      GET KEY A$    BEND  LOOP  RETURN'-----.ATAN2'-----  IF DIFFX = 0 THEN BEGIN    IF DI :  D╡0:E╡0:F╡0:I╡0:A%╡0:├ A&(12288):B%╡0:C%╡0:D&╡0:O╡2: B  █ 5 O  █ 6:█ 80 W  ┴ 3 ⌡  ЫЧ$:J╡╚1:K╡╚1:L╡.:B%╡.:B&╡.:D&╡.:≥"⌠";:≈53280,11:≈53281,.:N╡.:▌ ╣  ║A$:█ 29:▀A$Ё╠""╖█ 33 р  ▀A$╡"²"╞E╠.╖█ 77:E╡E╚1:▌ П  ▀A$╡""╞EЁ78╖█ 77:E╡E╙1:▌ !	 ▀A$╡"▒"╞F╠.╖█ 77:F╡F╚1:▌ +!
 ▀A$╡""╞FЁ49╖█ 77:F╡F╙1:▌ >! ▀A$╡"┘"╖█ 61:▌ Q! ▀A$╡"├"╖█ 64:▌ d! ▀A$╡"┬"╖█ 57:▌ u! ▀A$╡""╖█ 24 ┬! ▀A$╡"┤"╖█ 36:▌ ÷! ▀A$╡"▀"╖P╡1:█ 36:▌ ╡! ▀A$╡""╖D&╡1:▌ е! ▀A$╡"▓"╖D&╡.:▌ ч! ▀A$╡""╖┘B,C:A&(B)╡C " ▀A$╡""╖D╡н(D╙1,2):A$╡"":ЧA.,.:≥г(27);"QDEBUG=";D $" ▀A$Ё╠""╖Ч M" ЧAE,F:█ 77:█ 34:G╡E:H╡F:█ 28:█ 66:Ч S" ▌ f" O╡O╙1:▀O╡4╖O╡1 ⌠" ≥"";г(27);"QVERSION";O;:A$╡"":▀O╡3╖█ 27 ≥" ▌ в" ≥"⌠▓----------":≥:≥:≥"..........":≥:≥:≥:≥"----------":▌ Б" ≥A$;:▌ Ш" M╡б(54801)╞16:▀M╡.╖▌ # ▀A$╡"²"╖█ 82 # ▀A$╡""╖█ 84 )#  A$╡"":▌ V#! ≥"";г(27);"QFNAME=";C$;"  DIDX%=";B%;:▌ m#" ▀D&╡1╖≥"";:у≥"▓"; s## ▌ ┤#$ ≥"⌠";:▀O╡3╖█ 27 ╒#% N╡.:C%╡.:▀P╡1╖C%╡Q:P╡. Ь#& КЩC%ЁB%:ЧA.,49:≥г(27);"QPIDX=";C%;"[";A&(C%);A&(C%╙1);A&(C%╙2);:C&╡A&(C%):C%╡C%╙1 $' ▀O╡3╞C&╡255╖Ч $( █ 27:▀C%╠Q╖Q╡C% +$) ┴ 55:Ч 8$* E╡C&╞127 D$+ ▀O╡2╖Ч s$, E╡C&:C&╡A&(C%):C%╡C%╙1:E╡E╙(C&╞127)╛256:Ч ▄$- ▀C&╞128╖≥"";:у≥"▓"; ╤$. F╡A&(C%):C%╡C%╙1:A$╡г(A&(C%)):C%╡C%╙1 б$/ ▀O╡2╖Ч П$0 КЩE╚N╠78:█ 84:≥"";г(27);"QOFFS=";N;:Л:Ч %1 G╡E╚N:H╡F:ЧAG,H:█ 28:▀D╡1╖║ЫB$ $%2 ▀B$╡"X"╖█ 56 8%3 ▀B$╡"<"╖C%╡C%╚6 N%4 ▀B$╡"H"╖C%╡.:┴ 36 `%5 ▀B$╡"T"╖B%╡C% p%6 ▀B&╡.╖Ч.02 ~%7 Л:E╡E╚N:▌ н%8 B%╡B%╚3:C%╡C%╚3:│B╡C%╓B%:A&(B)╡A&(B╙3):A&(B╙1)╡A&(B╙4):A&(B╙2)╡A&(B╙5):┌B:▌ ш%9 ▀B&╡.╖Ч &: A&(B%)╡255:≈53280,(б(53280)╙1)╞15:█ 27 &; Ч:уЧ:Ч "&< B%╡B%╙1:▌ A&= ┘"LOAD NAME: ";C$:▀C$╡""╖▌ g&> █ 5:Ч#2,(C$),R,U8:К:║#2,C&:▀ST╖М ▀&? A&(B%)╡C&:B%╡B%╙1:Л:Ч#2:█ 36:▌ ╙&@ ┘"SAVE NAME: ";C$:▀C$╡""╖▌ Б&A В(C$):Ч#2,(C$),W,U8:│G╡.╓B%:≤2,г(A&(G));:┌G:Ч#2:▌ 'B ▀J╡E╞K╡F╞L╡N╞т("░÷·│∙√≈≤≥ ⌡▓",A$)╡.╖Ч 'C ▀O╡2╖Ч P'D A&(B%╚4)╡(E╙N)╞255:A&(B%╚3)╡(E╙N)╜256╙D&╛128 p'E Ч:уЧ:A&(B%╚3)╡E╙D&╛128:Ч ┐'F A&(B%╚1)╡ф(A$) ▐'G Ч:у:Ч ⌡'H ▀O╡2╖Ч ь'I A&(B%)╡(E╙N)╞255:B%╡B%╙1:A&(B%)╡(E╙N)╜256╙D&╛128:B%╡B%╙1 (J Ч:уЧ:A&(B%)╡(E╙N)	╙D&╛128:B%╡B%╙1:Ч ;(K A&(B%)╡F:B%╡B%╙1:A&(B%)╡ф(A$):B%╡B%╙1:J╡E:K╡F:L╡N:Ч A(L ▌ L(M ▀A%╖Ч {(N A╡267911168╙E╙80╛F:≈A,б(A)И32:A%╡.:I╡TI:Ч │(O ▌ √(P ▀TI╠I╖I╡TI╙.5:у▌ б(Q A╡267911168╙E╙80╛F:≈A,б(A)И32:A%╡A%И1:▌ т(R ▀N╠.╖N╡N╚1:у▌  )S │H╡.╓49:Ч!0╙32╙16,79,
264192╙H╛80╙78,264192╙H╛80╙79:≈264192╙H╛80,32:┌H:▌ i)T N╡N╙1:│H╡.╓49:Ч!0,79,264193╙H╛80,264192╙H╛80:≈264192╙79╙H╛80,32:┌H:▌ y)U ▐ LOC = :A: ┤)V ▐ K = :B: ∙)W ▐ V = :C: ╖)X ▐ DEBUG = :D: ╣)Y ▐ X = :E: ц)Z ▐ Y = :F: р)[ ▐ XX = :G: А)\ ▐ YY = :H: П)] ▐ T0 = :I: *^ ▐ OLDX = :J: *_ ▐ OLDY = :K: &*` ▐ OLDOFFS = :L: :*a ▐ ALT╞KEY = :M: K*b ▐ OFFS = :N: [*c ▐ VER = :O: p*d ▐ LASTFLAG = :P: ▀*e ▐ LAST╞GROUP╞IDX = :Q: ≤*f ▐  = :R: ╞*g ▐ MODIFIED% = :A%: б*h ▐ DIDX% = :B%: у*i ▐ PIDX% = :C%: Ц*j ▐  = :D%: С*k ▐  ёA$ = :A$: +l ▐ Z$ = :B$: +m ▐ FNAME$ = :C$: %+n ▐  = :D$: 9+o ▐ LDATA& = :A&: R+p ▐ GROUP╞FLAG& = :B&: d+q ▐ VAL& = :C&: {+r ▐ REV╞FLAG& = :D&: ┴+s ▐  = :E&:                                                                                               128:▌ t$ │F╡.╓49:S╡K:T╡L:│E╡.╓79:≈267911168╙E╙O,б(262144╙S╜65536╙╣(T╜65536)╛96):S╡S╙I:T╡T╙J:┌E:K╡K╙M:L╡L╙N:O╡O╙80:┌F:║ЫA$:▌ ┴$ ▐ хотрег╞7 = :A: ═$ ▐ сцрнптрлсб = :B: ╥$ ▐ сцрнптрбнк = :C: е$ ▐ T = :D: с$ ▐ X = :E: А$ ▐ Y = :F: Р$  ▐ COLR = :G: %! ▐ ANG = :H: %" ▐ XINC = :I: $%# ▐ YINC = :J: 3%$ ▐ TX = :K: B%% ▐ TY = :L: T%& ▐ TXINC = :M: f%' ▐ TYINC = :N: x%( ▐ Y1ADD = :O: ┼%) ▐ XFRAC = :P: °%* ▐ YFRAC = :Q: ╟%+ ▐ BOX╞ANG = :R: ©%, ▐ CX = :S: н%- ▐ CY = :T: ч%. ▐ HYP = :U: Я%/ ▐ PL╞RAD = :V: & ■0 ▐ PL╞ANG = :W: &1 ▐ PL╞DIR = :X: *&2 ▐ PL╞CLR = :Y: <&3 ▐ STATE = :Z: J&4 ▐  = :AA: X&5 ▐  = :A%: h&6 ▐ A$ = :A$: v&7 ▐  = :B$: └&8 ▐  = :A&:                                                                                                              A    GOSUB ROTATE╞INCB    PX(CBIDX) = CENTREX + PX(CBIDX) - PZ * ZFACT / 4    PY(CBIDX) = CENTREY + PY(CBIDX) + PZ * ZFACT    'PRINT "PX(";CBIDX;")=";PX(CBIDX);", PY(";CBIDX;")=";PY(CBIDX)    CBIDX = CBIDX + 1  NEXT CB╞ANGA   PLEN = 4  GOSUB DRAW╞POLY  ' DRAW LINES FROM POLY  CBIDX = 0  CB╞ANGB = -ATN(1/SQR(2))  FOR CB╞ANGA = пи / 4 TO 1.9 * пи STEP пи/2    X1 = PX(CBIDX)    Y1 = PY(CBIDX)    CBTMP = PDIST * COS(CB╞ANGB)    PZ = CBTMP * SIN(CB╞ANGA)    PY(CBIDX) = PDIST * SIN(CB╞ANGB)    PX(CBIDX) = CBTMP * COS(CB╞ANGA)    GOSUB ROTATE╞INCA    GOSUB ROTATE╞INCB    PX(CBIDX) = CENTREX + PX(CBIDX) - PZ * ZFACT / 4    PY(CBIDX) = CENTREY + PY(CBIDX) + PZ * ZFACT    X2 = PX(CBIDX)    Y2 = PY(CBIDX)    GOSUB DRAW╞LINE    CBIDBIDX) - PZ * ZFACT / 4    PY(CBIDX) = CENTREY + PY(CBIDX) + PZ * ZFACT    'PRINT "PX(";CBIDX;")=";PX(CBIDX);", PY(";CBIDX;")=";PY(CBIDX)    CBIDX = CBIDX + 1  NEXT CB╞ANGA   PLEN = 4  GOSUB DRAW╞POLY  ' DRAW LINES FROM POLY  CBIDX = 0  CB╞ANGX = CBIDX + 1  NEXT CB╞ANGA  PLEN = 4  GOSUB DRAW╞POLY  RETURN'-----------.ROTATE╞INCA'-----------  ' ROTATE ALONG Y-AXIS BY INCA  DIFFX = PX(CBIDX)  DIFFY = PZ  CBTMP = SQR(DIFFX*DIFFX + DIFFY*DIFFY)  GOSUB ATAN2  ' RETURNS ANGLE  ANGLEB = -ATN(1/SQR(2))  FOR CB╞ANGA = пи / 4 TO 1.9 * пи STEP пи/2    X1 = PX(CBIDX)    Y1 = PY(CBIDX)    CBTMP = PDIST * COS(CB╞ANGB)    PZ = CBTMP * SIN(CB╞ANGA)    PY(CBIDX) = PDIST * SIN(CB╞ANGB)    PX(CBIDX) = CBTMP * COS(CB╞ANGA)    GOSUB ROTA = ANGLE + CB╞INCA  PX(CBIDX) = CBTMP * COS(ANGLE)  PZ = CBTMP * SIN(ANGLE)   RETURN'-----------.ROTATE╞INCB'-----------  ' ROTATE ALONG Z-AXIS BY INCB  DIFFX = PX(CBIDX)  DIFFY = PY(CBIDX)  CBTMP = SQR(DIFFX*DIFFX + DIFFY*DIFFY)  GOSUB ATANTE╞INCA    GOSUB ROTATE╞INCB    PX(CBIDX) = CENTREX + PX(CBIDX) - PZ * ZFACT / 4    PY(CBIDX) = CENTREY + PY(CBIDX) + PZ * ZFACT    X2 = PX(CBIDX)    Y2 = PY(CBIDX)    GOSUB DRAW╞LINE    CBIDX = CBIDX + 1  NEXT CB╞ANGA  PLEN = 4  GOSUB DRAW╞2  ' RETURNS ANGLE  ANGLE = ANGLE + CB╞INCB  PX(CBIDX) = CBTMP * COS(ANGLE)  PY(CBIDX) = CBTMP * SIN(ANGLE)   RETURN'-----------------.DRAW╞MANY╞SQUARES'-----------------  FOR SQANG = 0 TO пи/2 STEP пи / 8    GOSUB DRAW╞SQUARE  NEXT SQANG  RPOLY  RETURN'-----------.ROTATE╞INCA'-----------  ' ROTATE ALONG Y-AXIS BY INCA  DIFFX = PX(CBIDX)  DIFFY = PZ  CBTMP = SQR(DIFFX*DIFFX + DIFFY*DIFFY)  GOSUB ATAN2  ' RETURNS ANGLE  ANGLE = ANGLE + CB╞INCA  PX(CBIDX) = CBTMP * COS(ANGLE)  ETURN'-----------.DRAW╞SQUARE'-----------  PDIST = 45  PANG = SQANG - 3 * пи / 4  PX(0) = CENTREX + PDIST * COS(PANG)  PY(0) = CENTREY + PDIST * SIN(PANG)  PANG = SQANG - пи / 4  PX(1) = CENTREX + PDIST * COS(PANG)  PY(1) = CENTREY + PDIST PZ = CBTMP * SIN(ANGLE)   RETURN'-----------.ROTATE╞INCB'-----------  ' ROTATE ALONG Z-AXIS BY INCB  DIFFX = PX(CBIDX)  DIFFY = PY(CBIDX)  CBTMP = SQR(DIFFX*DIFFX + DIFFY*DIFFY)  GOSUB ATAN2  ' RETURNS ANGLE  ANGLE = ANGLE + CB╞INCB  PX(CBID* SIN(PANG)  PANG = SQANG + пи / 4  PX(2) = CENTREX + PDIST * COS(PANG)  PY(2) = CENTREY + PDIST * SIN(PANG)  PANG = SQANG + 3 * пи / 4  PX(3) = CENTREX + PDIST * COS(PANG)  PY(3) = CENTREY + PDIST * SIN(PANG)  PLEN = 4  GOSUB DRAW╞POLY  RETX) = CBTMP * COS(ANGLE)  PY(CBIDX) = CBTMP * SIN(ANGLE)   RETURN'-----------------.DRAW╞MANY╞SQUARES'-----------------  FOR SQANG = 0 TO пи/2 STEP пи / 8    GOSUB DRAW╞SQUARE  NEXT SQANG  RETURN'-----------.DRAW╞SQUARE'-----------  PDISTURN'---------.DRAW╞POLY'---------  FOR PIDX = 0 TO PLEN-2    X1 = PX(PIDX) : Y1 = PY(PIDX)    X2 = PX(PIDX+1) : Y2 = PY(PIDX+1)    ' PRINT "X1=";X1;", Y1=";Y1;", X2=";X2;", Y2=";Y2    ' GET KEY A$    GOSUB DRAW╞LINE  NEXT PIDX  X1 = PX(PLEN  = 45  PANG = SQANG - 3 * пи / 4  PX(0) = CENTREX + PDIST * COS(PANG)  PY(0) = CENTREY + PDIST * SIN(PANG)  PANG = SQANG - пи / 4  PX(1) = CENTREX + PDIST * COS(PANG)  PY(1) = CENTREY + PDIST * SIN(PANG)  PANG = SQANG + пи / 4  PX(2) = CENTREX!-1) : Y1 = PY(PLEN-1)  X2 = PX(0) : Y2 = PY(0)  GOSUB DRAW╞LINE  RETURN'--------------------------.DRAW╞LINES╞FROM╞CENTRE╞OUT'--------------------------  FOR ANG = 0 TO 2*пи STEP пи / 8    X1 = 80    Y1 = 50    X2 = INT(80 + 30 * COS(ANG)) " + PDIST * COS(PANG)  PY(2) = CENTREY + PDIST * SIN(PANG)  PANG = SQANG + 3 * пи / 4  PX(3) = CENTREX + PDIST * COS(PANG)  PY(3) = CENTREY + PDIST * SIN(PANG)  PLEN = 4  GOSUB DRAW╞POLY  RETURN'---------.DRAW╞POLY'---------  FOR PIDX = 0 "   Y2 = INT(50 + 30 * SIN(ANG))    ' CURSOR 0,20:PRINT CHR$(27);"QX1 =";X1;", Y1 =";Y1    ' CURSOR 0,21:PRINT CHR$(27);"QX2 =";X2;", Y2 =";Y2    ' GET KEY A$    ' IF A$="D" THEN DEBUG = 1: ELSE DEBUG = 0    GOSUB DRAW╞LINE  NEXT ANG  RETURN'#TO PLEN-2    X1 = PX(PIDX) : Y1 = PY(PIDX)    X2 = PX(PIDX+1) : Y2 = PY(PIDX+1)    ' PRINT "X1=";X1;", Y1=";Y1;", X2=";X2;", Y2=";Y2    ' GET KEY A$    GOSUB DRAW╞LINE  NEXT PIDX  X1 = PX(PLEN-1) : Y1 = PY(PLEN-1)  X2 = PX(0) : Y2 = PY(0)  GOSU%  QLX2(QLIDX) = INT(RND(1)*160)  QLY2(QLIDX) = INT(RND(1)*100)  QLCLR = INT(RND(1)*16) + 64  SYS $7E0C, QLCLR  QLCNT = QLCNT + 1  X1 = QLX1(QLIDX)  Y1 = QLY1(QLIDX)  X2 = QLX2(QLIDX)  Y2 = QLY2(QLIDX)  'CURSOR 0,0:PRINT CHR$(27);"QX1,Y1,X  PDIST = 45  CBIDX = 0  CB╞ANGB = ATN(1/SQR(2))  FOR CB╞ANGA = пи / 4 TO 1.9 * пи STEP пи/2    CBTMP = PDIST * COS(CB╞ANGB)    PZ = CBTMP * SIN(CB╞ANGA)    PY(CBIDX) = PDIST * SIN(CB╞ANGB)    PX(CBIDX) = CBTMP * COS(CB╞ANGA)    GOSUB ROTATE╞INC&2,Y2=",X1,Y1,X2,Y2  GOSUB DRAW╞LINE  'GET KEY A$  QLIDX = MOD(QLIDX + 1, 10)  GOTO QLL╞LOOP    RETURN'---------------.DRAW╞MANY╞CUBES'---------------  CB╞INCB = 0  FOR CB╞INCA = 0 TO 1.9*пи/4 STEP пи/16    ' PRINT"⌠"    GOSUB DRAW╞CUBE'    ' SLEEP .02  NEXT CB╞INCA  CB╞INCA = 0  FOR CB╞INCB = 0 TO 1.9*пи/2 STEP пи/16    ' PRINT"⌠"    GOSUB DRAW╞CUBE    ' SLEEP .02  NEXT CB╞INCB  RETURN  '---------.DRAW╞CUBE'---------  PDIST = 45  CBIDX = 0  CB╞ANGB = ATN(1/SQR(2))  FOR CB╞ANGA = пи / 4 TO 1.9 * пи STEP пи/2    CBTMP = PDIST * COS(CB╞ANGB)    PZ = CBTMP * SIN(CB╞ANGA)    PY(CBIDX) = PDIST * SIN(CB╞ANGB)    PX(CBIDX) = CBTMP * COS(CB╞ANGA)    GOSUB ROTATE╞INCA    GOSUB ROTATE╞INCB    PX(CBIDX) = CENTREX + PX(C ТT "";CHR$(27);"Q X,Y,PIDX,A$=";X;Y;PIDX%,ASC(A$)    'GET KEY A$    SLEEP .02.PD╞ENDLOOP  LOOP  RETURN'---------.DRAW╞CHAR'---------  ' POKE $40800 + X + Y*80, ASC(A$)  ' POKE $FF80000 + X + Y*80, RCOLOR(1)  PRINT A$;  RETURN    VAL& =' ROTATE SCREEN CONTENTS#OUTPUT "ROTATE"' 4.0000 = 96X96 CLRBOX CANVAS (9216 BYTES)' 4.2400 = FREE.DEFINES'-------#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DECLARE хотрег╞7 = $D05D#DECLARE сцрнптрлсб = $D060#DECLARE сцрнптрбнк = $D062#DECLARE T, X, Y, COLR, ANG, XINC, YINC, TX, TY, TXINC, TYINC#DECLARE Y1ADD#DECLARE XFRAC, YFRAC#DECLARE BOX╞ANG, CX, CY, HYP#DEFINE пи = 3.1415926535#DECLARE PL╞RAD, PL╞ANG, PL╞DIR, PL╞CLR#DECLARE A$#DECLARE STATE.MAIN'----  GOSUB INIT  GOSUB DUMMY╞CONTENT.MN╞LOOP  GOSUB ROTATE╞LOGIC  GOSUB DRAW╞CONTENT  GOTO MN╞LOOP.INIT'----  ^^BLOAD "ASMROTATE",B0  ' PRINT CHR$(27);"5";CHR$(147);  ANG = 2*пи + .1  STATE = 0  PL╞RAD = 0  PL╞ANG = 0  PL╞DIR = 0  PL╞CLR = 0  ' SWITCH TO 80X50  BANK 128  SETBIT хотрег╞7, 7  POKE $D031, $E8 ' 1110 1000 = х640,фаст,аттр,ж400  ' MOVE сцрнптр TO BANK4 - $8000  WPOKE сцрнптрлсб, $8000  POKE сцрнптрбнк,$04  ' CLEAR 80X50 CHARS AND COLOUR RAM  EDMA 3, 4000, 160, $48000  EDMA 3, 4000, 6, $FF80000  ' FOR IDX=0 TO 3999:POKE $48000+IDX,160:POKE $FF80000+IDX,6:NEXT IDX  RETURN.DUMMY╞CONTENT'-------------  EDMA оп╞филл, 96*96, 0, $40000  'POKE $40000 + 48*96, 1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6  'FOR T = 0 TO 50  '  COLR = INT(RND(1)*16)  '  X = INT(RND(1)*96)  '  Y = INT(RND(1)*96)  '  POKE $40000 + X + Y * 96, COLR  'NEXT T  'FOR Y = 0 TO 96  '  FOR X = 0 TO 95  '    POKE $40000 + X + Y * 96, MOD(Y, 16)  '  NEXT X  'NEXT Y  RETURN.ROTATE╞LOGIC'------------  ANG = ANG - .1  IF ANG < 0 THEN ANG = ANG + (2 * пи)  HYP = SQR(25*25+40*40) * 65536  XINC = COS(ANG) * 65536  YINC = SIN(ANG) * 65536  TXINC = COS(ANG+пи/2) * 65536  TYINC = SIN(ANG+пи/2) * 65536  BOX╞	ANG = ATN(-25/-40)+ пи +ANG  IF BOX╞ANG < 0 THEN BOX╞ANG = BOX╞ANG + (2 * пи)  TX = HYP * COS(BOX╞ANG) + 48 * 65536  TY = HYP * SIN(BOX╞ANG) + 48 * 65536  CX = TX  CY = TY  XFRAC = 0  YFRAC = 0  Y1ADD = 0  RETURN.DRAW╞CONTENT'------------  
GOSUB PLOT╞ITERATION  GOSUB ASM╞ROTATION  ' GOSUB BASIC╞ROTATION  'CURSOR 0,0:PRINT CHR$(27);"Q TX=";TX;", TY=";TY;  'CURSOR 0,1:PRINT CHR$(27);"Q ANG=";ANG;", HYP=";HYP;  'CURSOR 0,2:PRINT CHR$(27);"Q XINC=";XINC;", YINC=";YINC;  'CURSOR 0,3:PRINT CHR$(27);"Q TXINC=";TXINC;", TYINC=";TYINC;  'GET KEY A$  RETURN.PLOT╞ITERATION'--------------  X = 48 + COS(PL╞ANG) * PL╞RAD  Y = 48 + SIN(PL╞ANG) * PL╞RAD  POKE $40000 + X + INT(Y) * 96, PL╞CLR + 64  PL╞ANG = PL╞ANG + .025  IF PL╞ANG > 2 * пи THEN PL╞ANG = PL╞ANG - 2 * пи  PL╞RAD = PL╞RAD + .05  IF PL╞RAD > 30 THEN BEGIN    PL╞RAD=0    PL╞CLR = PL╞CLR + 1    IF PL╞CLR = 16 THEN STATE = STATE + 1    PL╞ANG = .3926 * PL╞CLR  BEND  RETURN.ASM╞ROTATION'------------  ' ассемблы VERSION  IF XINC < 0 THEN XINC = XINC + 4294967296  IF YINC < 0 THEN YINC = YINC + 4294967296  IF TXINC < 0 THEN TXINC = TXINC + 4294967296  IF TYINC < 0 THEN TYINC = TYINC + 4294967296  WPOKE $1A00, MOD(TX,65536)  WPOKE $1A02, TX/65536  WPOKE $1A04, MOD(TY, 65536)  WPOKE $1A06, TY/65536  WPOKE $1A08, MOD(XINC,65536)  WPOKE $1A0A, XINC/65536  WPOKE $1A0C, MOD(YINC, 65536)  WPOKE $1A0E, YINC/65536  WPOKE $1A10, MOD(TXINC, 65536)  WPOKE $1A12, TXINC/65536  WPOKE $1A14, MOD(TYINC, 6 X = X-OFFS(FIDX%)  RETURN'---------.DRAW╞CHAR'---------  ' POKE $40800 + X + Y*80, ASC(A$)  ' POKE $FF80000 + X + Y*80, RCOLOR(1)    CHR = ASC(A$)  GOSUB PETSCII╞TO╞SCREENCODE  IF REV╞FLAG&(FIDX%) = 1 THEN CHR = CHR + 128  IF VER(FIDX%) = 1 THEN BEGIN    POKE $52000 + DXX + DYY*80, CHR    POKE $53000 + DXX + DYY*80, 1  BEND  IF VER(FIDX%) = 2 OR VER(FIDX%) = 3 THEN BEGIN    POKE $54000 + DXX + DYY*80, CHR    POKE $55000 + DXX + DYY*80, 2  BEND  RETURN'---------------------5536)  WPOKE $1A16, TYINC/65536  BANK 0:SYS $1800:BANK 128  RETURN.BASIC╞ROTATION'--------------  ' басиц VERSION  FOR Y = 0 TO 49    CX = TX    CY = TY    FOR X = 0 TO 79      POKE $FF80000 + X + Y1ADD, PEEK($40000 + CX/65536 + INT(CY/655.PETSCII╞TO╞SCREENCODE'---------------------  ' бASED ON THE TABLE HERE:  ' HTTPS://STA.C64.ORG/CBM64PETTOSCR.HTML  ' - SEEMS LIKE и NEEDED TO DO A REPAIR TO IT ON THE $A0-->$BF RANGE  IF CHR>=$00 AND CHR<=$1F THEN CHR=CHR OR $80:RETURN  IF CHR>=$2 0000 + X + Y*80, RCOLOR(1)  PRINT A$;  RETURN                                                                                                                                                                                                               0 AND CHR<=$3F THEN RETURN  IF CHR>=$40 AND CHR<=$5F THEN CHR=CHR AND $BF:RETURN  IF CHR>=$60 AND CHR<=$7F THEN CHR=CHR AND $DF:RETURN  IF CHR>=$80 AND CHR<=$9F THEN CHR=CHR OR $40:RETURN  IF CHR>=$A0 AND CHR<=$BF THEN CHR=(CHR AND $7F) OR $40:RETURN5 ' $BF:RETURN  IF CHR>=$C0 AND CHR<=$FE THEN CHR=CHR AND $7F:RETURN  RETURN'-----------------.SCREENCODE╞TO╞IDX'-----------------  IF CHR >= 65 AND CHR <= 90 THEN CHR = CHR - 65:RETURN  IF CHR = 46 THEN CHR = 26:RETURN ' FULL-STOP  IF CHR = 33  ╚36) * 96)      CX = CX + XINC      CY = CY + YINC    NEXT X    TX = TX + TXINC    TY = TY + TYINC    Y1ADD = Y1ADD + 80  NEXT Y  GET KEY A$  RETURN                                                                                              = 3.141592654269'----.VARS'----#DECLARE X1, Y1, X2, Y2#DECLARE DX, DY, MX, MY, CX, CY#DECLARE CUR╞CHAR, PIX#DECLARE DIFFX, DIFFY, DELTAX, DELTAY, TANVAL, ANGLE#DECLARE A$, ANG, LINE╞LENGTH, K, DEBUG#DECLARE CENTREX, CENTREY, CENTREZ#DECLARE PX(10), PY(10), PLEN, PANG, PIDX, PDIST#DECLARE SQANG#DECLARE CB╞ANGA, CB╞ANGB, CBIDX, CBTMP, PZ#DECLARE CB╞INCA, CB╞INCB, RET╞ANG, Z$, ZFACT#DECLARE DDX, DDY, SX, SY, E, E2#DECLARE QLIDX, QLCNT#DECLARE QLX1(10), QLY1(10), QLX2(10), QLY2(10)#DECLAC0 AND CHR<=$FE THEN CHR=CHR AND $7F:RETURN  RETURN'-----------------.SCREENCODE╞TO╞IDX'-----------------  IF CHR >= 65 AND CHR <= 90 THEN CHR = CHR - 65:RETURN  IF CHR = 46 THEN CHR = 26:RETURN ' FULL-STOP  IF CHR = 33 THEN CHR = 27:RETURN ' EXCLAMATION  IF CHR = 44 THEN CHR = 28:RETURN ' COMMA (SMILEY)  IF CHR = 47 THEN CHR = 29:RETURN ' FORWARD SLASH (LOVE HEART)  IF CHR = 35 THEN CHR = 30:RETURN ' # HASH (DHUFISH)  IF CHR >= 1 AND CHR <= 26 THEN CHR = CHR + 30  RETURN'----------.WRITE╞CHAR'----------  ' ITERATE OVER CHARS IN STRING    ' DRAW CURRENT CHAR AT GIVEN X,Y POS    ' INCREMENT X,Y LOCATION   PIDX% = CHAR╞IDX%(CHR)  DO WHILE PIDX% < DIDX% AND LDATA&(PIDX%) <> $FF    ' CURSOR 0,49:PRINT CHR$(27);"QPIDX=";PIDX%;"[";LDATA&(PIDX%);LDATA&(PIDX%+1);LDATA&(PIDX%+2);    VAL& = LDATA&(PIDX%) : PIDX% = PIDX% + 1    X = VAL& AND $7F    IF VAL& AND $80 THEN PRINT ""; : ELSE PRINT "▓";    Y = LDATA&(PIDX%) : PIDX% = PIDX% + 1    A$ = CHR$(LDATA&(PIDX%)) : PIDX% = PIDX% + 1    CURSOR XX+X, YY+Y : GOSUB DRAW╞CHAR    'PRINT "";CHR$(27);"Q X,Y,PIDX,A$=";X;Y;PIDX%,ASC(A$)    'GET KEY A$    SLEEP .02.PD╞ENDLOOP  LOOP  RETURN'---------.DRAW╞CHAR'---------  ' POKE $40800 + X + Y*80, ASC(A$)  ' POKE $FF80RE QLVX1, QLVY1, QLVX2, QLVY2#DECLARE QLCLRGOSUB INIT'----.MAIN'----  PRINT "⌠";  PRINT "PETLINE EXAMPLE MENU:"  PRINT "--------------------"  PRINT "1) LINES"  PRINT "2) SQUARE"  PRINT "3) MANY SQUARES"  PRINT "4) DRAW CUBE"  PRINT "5) D"RAW MANY CUBES"  PRINT "6) QIX LINES"  GET KEY Z$  IF Z$="1" THEN GOSUB DRAW╞LINES╞FROM╞CENTRE╞OUT  IF Z$="2" THEN GOSUB DRAW╞SQUARE  IF Z$="3" THEN GOSUB DRAW╞MANY╞SQUARES  IF Z$="4" THEN GOSUB DRAW╞CUBE  IF Z$="5" THEN GOSUB DRAW╞MANY╞CUBES  I X(10), PY(10), PLEN, PANG, PIDX, PDIST#DECLARE SQANG#DECLARE CB╞ANGA, CB╞ANGB, CBIDX, CBTMP, PZ#DECLARE CB╞INCA, CB╞INCB, RET╞ANG, Z$, ZFACT#DECLARE DDX, DDY, SX, SY, E, E2GOSUB INIT'----.MAIN'----  PRINT "⌠";  PRINT "PETLINE EXAMPLE MENU:" ! PRINT "--------------------"  PRINT "1) LINES"  PRINT "2) SQUARE"  PRINT "3) MANY SQUARES"  PRINT "4) DRAW CUBE"  PRINT "5) DRAW MANY CUBES"  GET KEY Z$  IF Z$="1" THEN GOSUB DRAW╞LINES╞FROM╞CENTRE╞OUT  IF Z$="2" THEN GOSUB DRAW╞SQUARE  IF Z$=#"3" THEN GOSUB DRAW╞MANY╞SQUARES  IF Z$="4" THEN GOSUB DRAW╞CUBE  IF Z$="5" THEN GOSUB DRAW╞MANY╞CUBES  IF Z$>="1" AND Z$<="5" THEN GET KEY Z$  GOTO MAIN  END'---------------.DRAW╞MANY╞CUBES'---------------  CB╞INCB = 0  FOR CB╞INCA = 0 TO 1#F Z$="6" THEN GOSUB DRAW╞QIX╞LINES  IF Z$>="1" AND Z$<="5" THEN GET KEY Z$  GOTO MAIN  END'--------------.DRAW╞QIX╞LINES'--------------  ' INIT  QLIDX = 0 : QLCNT = 0.QLL╞LOOP  QLX1(QLIDX) = INT(RND(1)*160)  QLY1(QLIDX) = INT(RND(1)*100)$.9*пи/2 STEP пи/16    ' PRINT"⌠"    GOSUB DRAW╞CUBE    ' SLEEP .02  NEXT CB╞INCA  CB╞INCA = 0  FOR CB╞INCB = 0 TO 1.9*пи/2 STEP пи/16    ' PRINT"⌠"    GOSUB DRAW╞CUBE    ' SLEEP .02  NEXT CB╞INCB  RETURN  '---------.DRAW╞CUBE'---------%   A╡53341:B╡53344:C╡53346: *  █ 5:█ 7 7  █ 8:█ 12 ?  ┴ 3 ╧  Ч "ASMROTATE",B0:H╡2╛3.1415926535╙.1:Z╡.:V╡.:W╡.:X╡.:Y╡.:Ч128:Ч-ЧNA,7:≈53297,232:ЧB,32768:≈C,4:Ч!3,4000,160,294912 т  Ч!3,4000,6,267911168:▌ М  Ч!3,96╛96,.,262144:▌ ! H╡H╚.1:▀HЁ.╖&H╡H╙(2╛3.1415926535) ⌡!	 U╡╨(25╛25╙40╛40)╛65536:I╡╬(H)╛65536:J╡©(H)╛65536:M╡╬(H╙3.1415926535╜2)╛65536:N╡©(H╙3.1415926535╜2)╛65536:R╡а(╚25╜╚40)╙3.1415926535╙H ╧!
 ▀RЁ.╖R╡R╙(2╛3.1415926535) В! K╡U╛╬(R)╙48╛65536:L╡U╛©(R)╙48╛65536:S╡K:T╡L:P╡.:Q╡.:O╡.:▌ " '█ 13:█ 13:█ 19:▌ m" E╡48╙╬(W)╛V:F╡48╙©(W)╛V:≈262144╙E╙╣(F)╛96,Y╙64:W╡W╙.025:▀W╠2╛3.1415926535╖W╡W╚2╛3.1415926535 y" V╡V╙.05 ├" ▀V╠30╖Ч ═" V╡.:Y╡Y╙1:▀Y╡16╖Z╡Z╙1 ╠" W╡.3926╛Y:Ч ╥" ▌ о" ▀IЁ.╖I╡I╙4294967296 Г" ▀JЁ.╖J╡J╙4294967296 Ъ" ▀MЁ.╖M╡M╙4294967296 # ▀NЁ.╖N╡N╙4294967296 ■# Ч6656,н(K,65536):Ч6658,K╜65536:Ч6660,н(L,65536):Ч6662,L╜65536:Ч6664,н(I,65536):Ч6666,I╜65536:Ч6668,н(J,65536) Щ# Ч6670,J╜65536:Ч6672,н(M,65536):Ч6674,M╜65536:Ч6676,н(N,65536):Ч6678,N╜65536:Ч.:·6144:Ч N  A╡53335:B╡53333:C╡53334:D╡53344:E╡53346:F╡53358:G╡53356:H╡53358:I╡53341: a  █ 3:║ЫA$:█ 4:─ Ё  ≈53281,9:≈H,5╙128:ЧG,.:│J╡.╓4:ЧJ,1:ЧJ,64╛J╙24,50:┌J:≈A,255:≈B,255:≈C,200:▌ и  │J╡.╓4:ЧJ,.:┌J:▌ ч  ▐ спрь64ен = :A: С  ▐ спрхгтен = :B: ! ▐ спрх©┬╒┤╒╒┘╒╛╬©©╒│║│║│║│║│║┌╒╒└╒╒╩╪┤╒┬╒╛▄©	║	║	╪┼╒▀╒┼©Ъ╒╒╒╒│║║│║┌	╒┐©└©└╩╛┐║┐╬	╬©Ъ│╛│╛╛╩║┌║║╬╛│║│║│║┌	╒	╬╛╬║©┌╒╒Ъ║┌╒╛║©┌	╒║╪Ъ©┌╒│©║╪╒╬┐©║└║║╩└©║└ ┐╩┐╬└╪╬Ъ┌╒┌╒╬©┌╒╛│©©╒┐ Ъ╛╛©└©©╒┌©║║©┌║┌║	╬╛│║╛┌╩┐	┐╒┐╒Ъ©┌╒╛│║╪╒╒╒╬└©└©©┐║┐╬┐	©
║╬╒╒╪
╛Ъ╩┌©╪│║╒║║╬╛┌║┌║┌║┌	 ┌╬╬┐©└╒╩└║└©└	╬	╬ Егт = :C: ! ▐ сцрнптрлсб = :D: 4!	 ▐ сцрнптрбнк = :E: I!
 ▐ спрптр16 = :F: _! ▐ спрптрадр = :G: u! ▐ спрптрбнк = :H: ┼! ▐ хотрег╞7 = :I: ≤! ▐ K = :J: ╔! ▐  = :K: Ё! ▐  = :A%: ц! ▐ A$ = :A$: я! ▐  = :B$: ъ! ▐  = :A&:   = :J: 15 REM  = :K: 16 R	╬	╪╛└╬╩Ъ╛│╒│╬╩║╬╛│║	╪┌	©╩┌║╪╩│║┌©Ъ╬╬©╛╩└╩└║║	║
╬
╛┐║┐©╒╪│║
╛
╩╬╛╩╬╪║╛Ъ╬╪╛©┐╩┐║║║┌║┌©	╬	╪╛┌╛╬┐╪└╒║║└╒┐╪┌╩╩©┘	╪	╬╛Ъ│╒│©©┌║║║│║│║║	©┌	©┌║Ъ│╛╛╛╩┌╬┌©┌║┌║║║╬╬╛│	╒│	╒│╬┌ ┐©└╩└║└║║	╬	╪	╪╛╬┘©├╬├╬║├║║├	╪┤	©╒Ъ│╒│©║┌║┌©║│	║╛┐©╒╬╛└║║└	╪	╬╩Ъ╪║┌©│║║©┌	╒┐©╛╬║┐╪┌╬╪Ъ╬│║╛╩┌╩┌║║	║
║│╩│╩│
║	╛┐©└╩└║└╬	╪	╪╩┌╛Ъ╬╒│©║│╪┌©┐©┐╪┐╛┌╬┌	©
╬
╛│║╪╬╛╬
╩┌║┐╒Ъ╬╪╩┌╩┌║║	╬│	║╛┐©└╩Ъ╩╩┐╒║╒╛║║╪╩	╬	╒	╪╛Ъ┌╛╩╬╛┌║║╬╛│©│©║	╪	╬║ ²│╛┌╪┐©Ъ╬│╛╩│╩│║║	©	╒	╬║╛┐║┐║║║╩╛╪└╛Ъ│║©┌║║║│	©	╬┌╪┐©└©║╛└║┘╪Ъ╬╛╩┌║║│║│	╒│	╒┌©╬╛╬└ ┐╩┐	 ╒╬╛╬║╛╪├╛╬Ъ╬┌╬┌╒╩║║	╪└	╒└╒╒┐╬╛	╬	©Ъ╪╛╩┌╛┌╛║║┌	╒┐©└©║╛└║└╛└╛╬╬┐╬┐	║┐
║┐
║┐©╒©
╒ K│╩┌╪╪Ъ╬╬╛╪┐╒└╒╬╒╒└╛┐©┌©│	╒│	╒│╬┌╬╒╒└	╒	╒	╩                                                                                                                                                                                     #OUTPUT "WRITER"'--------.DECLARES'--------#DECLARE S$, PIDX%, DIDX%, LDATA&(12000), PTR, VAL&#DECLARE CHAR╞IDX%(60)#DECLARE CHAR╞WIDTH%(60)#DECLARE CHAR╞CNT, MAX╞WIDTH, TXT╞K#DECLARE X, Y, A$, DEBUG=0, Z$#DECLARE XX, YY, CHR'----.MAIN'---#OUTPUT "WRITER"'--------.DECLARES'--------#DECLARE S$, PIDX%, DIDX%, LDATA&(12000), PTR, VAL&#DECLARE CHAR╞IDX%(60)#DECLARE CHAR╞WIDTH%(60)#DECLARE CHAR╞CNT, MAX╞WIDTH, K#DECLARE X, Y, A$, DEBUG=0, Z$#DECLARE XX, YY, CHR'----.MAIN'----  -  GOSUB INIT  XX=0:YY=0  S$ = ",/#"  GOSUB WRITE╞TEXT  XX=0:YY=15    S$ = "дRUM бOOGIE!"  GOSUB WRITE╞TEXT  END'----.INIT'----  PRINT "⌠";  XX = 0 : YY = 0  PTR = $42000  ' LOAD 'ABC.LN' FONT  GOSUB LOAD╞FONT  CHAR╞CNT = 0  CHARGOSUB INIT  XX=0:YY=0  S$ = ",/#"  GOSUB WRITE╞TEXT  XX=0:YY=15    S$ = "тHIS IS бас!"  GOSUB WRITE╞TEXT  END'----.INIT'----  PRINT "⌠";  XX = 0 : YY = 0  PTR = $42000  ' LOAD 'ABC.LN' FONT  GOSUB LOAD╞FONT  CHAR╞CNT = 0  CHAR╞IDX╞IDX%(0) = 0  CHAR╞WIDTH%(0) = 0  MAX╞WIDTH = 0  TXT╞K = 0  DO WHILE TXT╞K < DIDX%    ' GET X VALUE    VAL& = LDATA&(TXT╞K)    TXT╞K=TXT╞K+1    IF VAL& = $FF THEN BEGIN      ' KEEP AN ARRAY OF WIDTHS OF EACH LETTER      CHAR╞WIDTH%(CHAR╞CNT)=%(0) = 0  CHAR╞WIDTH%(0) = 0  MAX╞WIDTH = 0  K = 0  DO WHILE K < DIDX%    ' GET X VALUE    VAL& = LDATA&(K)    K=K+1    IF VAL& = $FF THEN BEGIN      ' KEEP AN ARRAY OF WIDTHS OF EACH LETTER      CHAR╞WIDTH%(CHAR╞CNT)=MAX╞WIDTH      ' PRINTMAX╞WIDTH      ' PRINT "CHAR╞WIDTH(";CHAR╞CNT;") = ";MAX╞WIDTH      ' GET KEY Z$      MAX╞WIDTH = 0      CHAR╞CNT=CHAR╞CNT+1      ' KEEP AN ARRAY OF INDICES TO EACH DRAWN LETTER      CHAR╞IDX%(CHAR╞CNT) = TXT╞K      'PRINT "CHAR╞IDX%(";CHAR╞CNT "CHAR╞WIDTH(";CHAR╞CNT;") = ";MAX╞WIDTH      ' GET KEY Z$      MAX╞WIDTH = 0      CHAR╞CNT=CHAR╞CNT+1      ' KEEP AN ARRAY OF INDICES TO EACH DRAWN LETTER      CHAR╞IDX%(CHAR╞CNT) = K      'PRINT "CHAR╞IDX%(";CHAR╞CNT;")=";K      'GET KEY A$  ;")=";K      'GET KEY A$    BEND    IF VAL& = $FF THEN GOTO CONT╞LOOP    VAL& = VAL& AND $7F    IF VAL& > MAX╞WIDTH THEN MAX╞WIDTH = VAL&        TXT╞K=TXT╞K+1  ' SKIP Y VALUE    TXT╞K=TXT╞K+1  ' SKIP CHAR .CONT╞LOOP  LOOP  RETURN'------  BEND    IF VAL& = $FF THEN GOTO CONT╞LOOP    VAL& = VAL& AND $7F    IF VAL& > MAX╞WIDTH THEN MAX╞WIDTH = VAL&        K=K+1  ' SKIP Y VALUE    K=K+1  ' SKIP CHAR .CONT╞LOOP  LOOP  RETURN'---------.LOAD╞FONT'---------  DOPEN #2,("ABC.LN"),R,U8  DO    GET #2, VAL&    IF ST THEN EXIT    LDATA&(DIDX%) = VAL&    DIDX% = DIDX% + 1  LOOP  DCLOSE #2  RETURN'----------.WRITE╞TEXT'----------  FOR K = 1 TO LEN(S$)    CHR = ASC(MID$(S$,K,1))    ' PRINT "";CHR$(27);"QCHR=";CHR;---.LOAD╞FONT'---------  DOPEN #2,("ABC.LN"),R,U8  DO    GET #2, VAL&    IF ST THEN EXIT    LDATA&(DIDX%) = VAL&    DIDX% = DIDX% + 1  LOOP  DCLOSE #2  RETURN'----------.WRITE╞TEXT'----------  FOR TXT╞K = 1 TO LEN(S$)    CHR = ASC(MID$(S$, TXT╞K, 1))    ' PRINT "";CHR$(27);"QCHR=";CHR;    GOSUB PETSCII╞TO╞SCREENCODE    GOSUB SCREENCODE╞TO╞IDX    ' PRINT "FIXED CHR=";CHR;    IF CHR=32 THEN BEGIN      XX=XX+7    BEND:ELSE:BEGIN      GOSUB WRITE╞CHAR      XX = XX + CHAR╞WIDTH%(CHR) + 1    BEND  NEXT TXT╞K  RETURN'---------------------.PETSCII╞TO╞SCREENCODE'---------------------  ' бASED ON THE TABLE HERE:  ' HTTPS://STA.C64.ORG/CBM64PETTOSCR.HTML  IF CHR>=$00 AND CHR<=$1F THEN CHR=CHR OR $80:RETURN  IF CHR>=$20 AND CHR<=$3F THEN RETURN  IF CHR>=$40 AND CHR<=$5F THEN CHR=CHR AND $BF:RETURN  IF CHR>=$60 AND CHR<=$7F THEN CHR=CHR AND $DF:RETURN  IF CHR>=$80 AND CHR<=$9F THEN CHR=CHR OR $40:RETURN  IF CHR>=$A0 AND CHR<=$BF THEN CHR=CHR AND $BF:RETURN  IF CHR>=$     GOSUB PETSCII╞TO╞SCREENCODE    GOSUB SCREENCODE╞TO╞IDX    ' PRINT "FIXED CHR=";CHR;    IF CHR=32 THEN BEGIN      XX=XX+7    BEND:ELSE:BEGIN      GOSUB WRITE╞CHAR      XX = XX + CHAR╞WIDTH%(CHR) + 1    BEND  NEXT K  RETURN'-------------║©╩╩	╪	╩Ъ╬┌©╩║║╬╬╛╛┌║┌©║	╬	©╒┌╪	©	╒	╒├	©╩╛Ъ╒╬╛│╪│╪│	╪│	╪	╬┌╛┌╛┌║╛╛╬║┐║┐║┐║╩┌║┐╩┐ ║©└║	║└	║┘©║╛╬┤©║╩┤©║┤╬┤╬┤╩┤║┤║┤║	©		╬┴║	╩╪Ъ╪│║║╬╪╪╩╬╛┌║┌║┌©║	©┐	╬╩┌╪┌║┐╛╩©╪╩║©┘║	╪	╒	╒	╬║║╩╪├║├)├)├╒├║├║├║├║╒╒╩┬║╬╪╛Ъ╬╬┘ ╒╛╛╬╛║║│║│║│║╪╩	╪	©└	©└	©╒╬├©├║├║├║├║├║├╩Ъ╬╬╪╪│©©┌╩┌║┌║┌║║┌║	╪┌╩┐©©╩┘║║╬╛╬╒╒┌╩╛Ъ©©╩┐╒┌©│║║║║│║│║©╒╒╬┘║╛╛╬║║╩╪╩╒┐╩╪└╒┘╬┘╛┘╛	©	╒	╬╩╛Ъ╬╪╛©┌╩┌╩┌║┌║┌║┌║┌║	╬	╬©╛┌╩╬╛╒╩┘║┘║┘║╬╒╒╛╬┌╬┐╩©└║└║╪╪╩	©├	©╩Ъ╩┐╒║╩┐╒┌╒╛║║╪╩╪©║║┐	©	©	╪║╒╬Ъ╛╩╬╪╪│╪│©┌╒╩╒╒╒╒╒╬╒╛┘╬║║║║└║║	║└	╪Ъ┌╩┌╩╬│║╛╛┌╒╩┐║┐║┐©║║║	╪	╒	╬╛├╒├╬╬╬├║├║║╩╪├║©┘║Ъ│╒│©│©╩║┌║┌║┌║┌║║┌	║┐╛║└║└║┘©╛╛╬║╩┘╒╛╬Ъ│ │©╩║║║│║│║║│║│║┌	╒┐©║└║└║║║╩╛└║└ ╪┘©║├║╛╬║┤║©╛┤╩╬Ъ┐║╬╬╪┌╬┐╬©║©║║┘║	║	©┘╬├╒╒╬╬╒├╛├╛┘©└ ┐©┌║║│ 	╪	╩Ъ╬╪╪│©│©║┌╛┌╛║©╒╒┘©║├║╩├ ┘║┘╛╬║║└║║	╪Ъ╛┌╒┌ ║╪╒╩╪├╒╬©├©┘║╬╛║┐©┌©┌©│	╒╛┌╬┐	╒└	╒	╒	╒	╬Ъ┐	©╒┌	║┐	╬	╒	╬╛╒Ъ└ └║└║└║║┐	©	╪╛╒	║
╪Ъ┘╒└╒╒┌©│║║║│║©	©	╒	╒	╒┤	©┬©	║┴║┴║	║©╒├╒©╪╬╛╬╛©╒╒╬╬╩Ъ	║║┌║║║╩╪║│║│║┌©┐╒©└║╬║╛├╒├╒┤ё┤╩╩╩┤║┤║┤©├©╛╬╛║┐	╛Ъ╒╒	╒
╒╒╒	║┴║	║		╬	╛
╪
╪	
╬		©
	╬
	╬┼║║║┼║▄╪╩╪╩
╪
╩	!--------.PETSCII╞TO╞SCREENCODE'---------------------  ' бASED ON THE TABLE HERE:  ' HTTPS://STA.C64.ORG/CBM64PETTOSCR.HTML  IF CHR>=$00 AND CHR<=$1F THEN CHR=CHR OR $80:RETURN  IF CHR>=$20 AND CHR<=$3F THEN RETURN  IF CHR>=$40 AND CHR<=$5F THEN CH"R=CHR AND $BF:RETURN  IF CHR>=$60 AND CHR<=$7F THEN CHR=CHR AND $DF:RETURN  IF CHR>=$80 AND CHR<=$9F THEN CHR=CHR OR $40:RETURN  IF CHR>=$A0 AND CHR<=$BF THEN CHR=CHR AND $BF:RETURN  IF CHR>=$C0 AND CHR<=$FE THEN CHR=CHR AND $7F:RETURN  RETURN'--#---------------.SCREENCODE╞TO╞IDX'-----------------  IF CHR >= 65 AND CHR <= 90 THEN CHR = CHR - 65:RETURN  IF CHR = 46 THEN CHR = 26:RETURN ' FULL-STOP  IF CHR = 33 THEN CHR = 27:RETURN ' EXCLAMATION  IF CHR = 44 THEN CHR = 28:RETURN ' COMMA (SMIL&EY)  IF CHR = 47 THEN CHR = 29:RETURN ' FORWARD SLASH (LOVE HEART)  IF CHR = 35 THEN CHR = 30:RETURN ' # HASH (DHUFISH)  IF CHR >= 1 AND CHR <= 26 THEN CHR = CHR + 30  RETURN'----------.WRITE╞CHAR'----------  ' ITERATE OVER CHARS IN STRING    ' ЮRN'-------------------.SCROLL╞CANVAS╞RIGHT'-------------------  OFFS=OFFS+1  FOR YY = 0 TO 49    EDMA оп╞цопы, 79, $40801 + YY*80, $40800 + YY*80    POKE $40800 + 79 + YY*80, 32   NEXT YY                  RETURN MODIFIED% XOR 1  RETURN'-- АURN'-------------------.SCROLL╞CANVAS╞RIGHT'-------------------  OFFS=OFFS+1  FOR YY = 0 TO 49    EDMA оп╞цопы, 79, $40801 + YY*80, $40800 + YY*80    POKE $40800 + 79 + YY*80, 32   NEXT YY                  RETURN MODIFIED% XOR 1  RETURN'-' DRAW CURRENT CHAR AT GIVEN X,Y POS    ' INCREMENT X,Y LOCATION   PIDX% = CHAR╞IDX%(CHR)  DO WHILE PIDX% < DIDX% AND LDATA&(PIDX%) <> $FF    ' CURSOR 0,49:PRINT CHR$(27);"QPIDX=";PIDX%;"[";LDATA&(PIDX%);LDATA&(PIDX%+1);LDATA&(PIDX%+2);    VAL& =  LDATA&(PIDX%) : PIDX% = PIDX% + 1    X = VAL& AND $7F    IF VAL& AND $80 THEN PRINT ""; : ELSE PRINT "▓";    Y = LDATA&(PIDX%) : PIDX% = PIDX% + 1    A$ = CHR$(LDATA&(PIDX%)) : PIDX% = PIDX% + 1    CURSOR XX+X, YY+Y : GOSUB DRAW╞CHAR    'PRIN, $E0 ' х640, фаст, аттр  RETURN.RESTORE╞SCREEN╞POINTER'----------------------  ' TO BANK 0 - $0800  BANK 128  WPOKE сцрнптрлсб, $0800  POKE сцрнптрбнк, 0  RETURN.SET╞SCREEN╞POINTER'------------------  ' MOVE TO BANK4 - $8000  BANK 128  SETBIT хотрег╞7, 7  WPOKE сцрнптрлсб, $8000  POKE сцрнптрбнк, $04  RETURN.PAN╞TITLE'---------  FOR PAN╞IDX = 0 TO 196    IF PAN╞IDX > 79 THEN BEGIN      PAN╞SRC╞IDX = PAN╞IDX - 79      PAN╞DEST╞IDX = 0      IF PAN╞IDX > 117 THEN BEGIN        PAN╞LEN = 80 - (PAN╞IDX - 117)        IF PAN╞LEN < 1 THEN PAN╞LEN = 0      BEND:ELSE BEGIN        PAN╞LEN = 80      BEND    BEND:ELSE BEGIN      PAN╞SRC╞IDX = 0      PAN╞DEST╞IDX = 79 - PAN╞IDX      PAN╞LEN=PAN╞IDX + 1    BEND    FOR PAN╞Y = 0 TO 49      EDMA 0,PAN╞LEN,$41000+PAN╞Y*118+PAN╞SRC╞IDX,$FF80000+PAN╞Y*80+PAN╞DEST╞IDX    NEXT PAN╞Y    SLEEP .02    GOSUB POLL╞PLAY  NEXT PAN╞IDX  RETURN.LOAD╞PALETTE'------------  #DECLARE LOC=$40FA0  FOR K = 0 TO 31    POKE $D100+K,PEEK(LOC):LOC=LOC+1    POKE $D200+K,PEEK(LOC):LOC=LOC+1    POKE $D300+K,PEEK(LOC):LOC=LOC+1  NEXT K  RETURN'========.BAS╞LOGO'========  GOSUB POLL╞PLAY  GOSUB FADE╞TO╞WHITE  GOSUB DRAW╞LOGO  GOSUB FADE╞TO╞DEFAULTS  GOSUB CYCLE╞ALT╞PALETTE╞LOOP  GOSUB FADE╞TO╞BLACK  RETURN.CYCLE╞ALT╞PALETTE╞LOOP'----------------------  FOR M = 0 TO 32*4    GOSUB CYCLE╞ALT╞PALETTE    GOSUB POLL╞PLAY    GOSUB ANIM╞DRAW╞SUBTEXT    SLEEP .04  NEXT M  RETURN.ANIM╞DRAW╞SUBTEXT'-----------------  IF M = 40 THEN BEGIN    SUBTEXT╞IDX = 1    PLEN = 0    EDMA 3,80,32,$800+80*24  BEND  IF PLEN < LEN(SUBTEXT$(SUBTEXT╞IDX)) THEN BEGIN    PLEN = PLEN + 1    RAINBOWSTR$=LEFT$(SUBTEXT$(SUBTEXT╞IDX),PLEN)    IF SUBTEXT╞IDX = 0 THEN RAINBOW╞X = 36:ELSE RAINBOW╞X = 21    RAINBOW╞Y = 24    GOSUB PRINT╞RAINBOW╞STR  BEND  RETURN.PRINT╞RAINBOW╞STR  #DECLARE RAIN╞IDX  CURSOR RAINBOW╞X, RAINBOW╞Y  FOR RAIN╞IDX=1 TO LEN(RAINBOWSTR$)    FOREGROUND MOD(RAIN╞IDX-1,16)+16    PRINT MID$(RAINBOWSTR$,RAIN╞IDX,	1);  NEXT RAIN╞IDX  RETURN.CYCLE╞ALT╞PALETTE'-----------------  #DECLARE TEMPR, TEMPG, TEMPB  TEMPR = PEEK($D100+16)  TEMPG = PEEK($D200+16)  TEMPB = PEEK($D300+16)  FOR K = 16 TO 30    POKE $D100+K, PEEK($D100+K+1)    POKE $D200+K, PEEK($D20
0+K+1)    POKE $D300+K, PEEK($D300+K+1)  NEXT K  POKE $D100+31, TEMPR  POKE $D200+31, TEMPG  POKE $D300+31, TEMPB  RETURN.DRAW╞LOGO'---------  BACKGROUND 1  BORDER 1  EDMA 0, 2000, $40000, $800  EDMA 0, 2000, $407D0, $FF80000  RETURN.FADE╞TO╞WHITE'-------------  FOR FADEVAL=0 TO 16    GOSUB FADE╞COLOURS╞TO╞WHITE    SLEEP .05  NEXT FADEVAL  RETURN.FADE╞TO╞BLACK'-------------  GOSUB STORE╞CURR╞COLOURS  FOR FADEVAL=0 TO 16    GOSUB FADE╞COLOURS╞TO╞BLACK    SLEEP .05  NEXT FADEVAL  RETURN.FADE╞TO╞DEFAULTS'----------------  GOSUB STORE╞CURR╞COLOURS  FOR FADEVAL=0 TO 16    GOSUB FADE╞COLOURS╞TO╞DEFAULTS    SLEEP .05  NEXT FADEVAL  RETURN'====.INIT'====  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  ^^BLOAD "INTRO.DAT",P($40000),R  ' $4,0000 +------------------+ интро.дат  '         ! бас LOGO CHARS   !  ' $4,07д0 +..................+  '         ! бас LOGO COLORS  !  ' $4,0фа0 +..................+  '         ! 32 X ргб палетте !  ' $4,1000 +..................+  '         ! титле COLORS     !  ' $4,270ц +..................+  '         ! петсции FRAMES   !  ' $4,54фц +------------------+  GOSUB INIT╞MUSIC  GOSUB STORE╞DEFAULT╞COLOURS  RETURN.STORE╞DEFAULT╞COLOURS'---------------------  FOR K = 0 TO 31    DEFAULT╞RED(K)=PEEK($D100+K)    DEFAULT╞GREEN(K)=PEEK($D200+K)    DEFAULT╞BLUE(K)=PEEK($D300+K)  NEXT K  RETURN.STORE╞CURR╞COLOURS'------------------  FOR K = 0 TO 31    CURR╞RED(K)=PEEK($D100+K)    CURR╞GREEN(K)=PEEK($D200+K)    CURR╞BLUE(K)=PEEK($D300+K)  NEXT K  RETURN.FADE╞COLOURS╞TO╞WHITE'---------------------  'инпут: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = 0 TO 31    POKE $D100+K, DEFAULT╞RED(K) + (15 - DEFAULT╞RED(K)) * TEMPVAL    POKE $D200+K, DEFAULT╞GREEN(K) + (15 - DEFAULT╞GREEN(K)) * TEMPVAL    POKE $D300+K, DEFAULT╞BLUE(K) + (15 - DEFAULT╞BLUE(K)) * TEMPVAL  NEXT K  RETURN.FADE╞COLOURS╞TO╞DEFAULTS'------------------------  'инпут: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = 0 TO 31    POKE $D100+K, CURR╞RED(K) + (DEFAULT╞RED(K)-CURR╞RED(K)) * TEMPVAL    POKE $D200+K, CURR╞GREEN(K) + (DEFAULT╞GREEN(K)-CURR╞GREEN(K)) * TEMPVAL    POKE $D300+K, CURR╞BLUE(K) + (DEFAULT╞BLUE(K)-CURR╞BLUE(K)) * TEMPVAL  NEXT K  RETURN.FADE╞COLOURS╞TO╞BLACK'---------------------  TEMPVAL = (16-FADEVAL) / 16  FOR K = 0 TO 31    POKE $D100+K, CURR╞RED(K) * TEMPVAL    POKE $D200+K, CURR╞GREEN(K) * TEMPVAL    POKE $D300+K, CURR╞BLUE(K) * TEMPVAL  NEXT K  RETURN'==========.INIT╞MUSIC'==========  PLAY  BAR╞INDEX=0  MAP╞BAR╞TO╞CHUNK(0)=0  MAP╞BAR╞TO╞CHUNK(1)=1  MAP╞BAR╞TO╞CHUNK(2)=1  MAP╞BAR╞TO╞CHUNK(3)=2  MAP╞BAR╞TO╞CHUNK(4)=3  FILTER 1,100,1  FILTER 2,100,1  ENVELOPE 2,3,3,3,10,0  ENVELOPE 4,9,4,9,8  ENVELOPE 7,0,9,9,0,2,1100  ENVELOPE 8,0,12,3,5,2,1100  ENVELOPE 9,0,10,3,5,2,1100  ' *** VOICE1 - GUITAR1 ***  ' ------------------------  V1$(0)="T2O6M2 QDIR QC.R QDIR QC.R QDIR QC.R QDIR QC.R"  V1$(1)="T2O6M2 QDIR QC.R QDIR QC.R P9A IR QAIR P0IDP9O5A O5IAO6DA Q.G IDO5A IBO6DG Q.A IGD O5BO6EG Q.A IGE O5IBO6DG Q.A IGD  O5BO6EGQA IG#FE "  V1$(2)="T2O6M2 QDIR QC.R QDIR QC.R  IDDFQ.DIFD O5Q.#AHO6CIR O5#AQ#AO6HCIR IDDFHDIR  DDFQ.DIFD O5Q.#AHO6CIR O5#AQ#AO6HCIR O5Q.A O6HE IR  V1$(3)="T2O6M2 IGG#GHGIR O5Q.G O6HD IR AA#AHA IR A O6D #F QE I#F QD  Q.#F.EDO6.G.#FE O5G I#A O6 QE O5I#A O6QE QDIR QC.R QDIR QC.R  V1$(3)=V1$(3)+"O6Q.G.#FE O5G I#A O6QE O5I#A O6QE QDIR QC.R QDIR QC.R QDIR QC.R QDIR QC.R"  ' *** VOICE2 - GUITAR2 ***  ' ------------------------  V2$(0)="T2O5M4 QAIR Q#G.R QAIR Q#G.R QAIR Q#G.R QAIR Q#G.R"  V2$(1)="T2O5M4 QAIR Q#G.R QAIR Q#G.R  O5 Q.#C .D O6I#FD O5D#FAO6Q.D IO5A#F  EGBO6Q.E O5IBG EAO6#CQ.E I#CO5A EGBO6Q.E O5IBG EAO6#CQE ID#CD"  V2$(2)="T2O5M4 QAIR Q#G.R QAIR Q#G.R  IAAO6CO5Q.AIGA Q.FHG IR IFQF HG IR IAAO6CO5HA IR  AAO6CO5Q.AIGA Q.FHG IRFQF HG IR Q.E .A O6E "  V2$(3)="T2O5M4 IGG#G HG IR Q.D HG IR DDGHD IR DDAQGIAQD Q.A.G#F .#A .A G  O5QEIGQ#AIG#AO6C QAIR Q#G.R QAIR Q#G.R Q.#A .A G O5QEIGQ#AIG#AO6C"  V2$(3)=V2$(3)+"QAIR Q#G.R QAIR Q#G.R QAIR Q#G.R QAIR Q#G.R"  ' *** VOICE3 - BASS ***  ' ---------------------  V3$(0)="X1T7O2M1 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A   O2ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  V3$(1)="X1T7O2M1 ID QR P1 ICD QR ICD SF#F QD QR IR O1A T8 O2Q.#CQD IDE#F Q.#F O1A IA O2Q#C O1Q.E E IEBG Q.A A IA O2QC Q.E E IE O1 QB Q.A A O2IE QA"  V3$(2)="X1T7O2M1 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  V3$(2)=V3$(2)+"T9O2IDDDDDDDD O1#A#A#A#A#A#A#A#A #A#A#A#A#A#A#A#A O2DDFQDIDDDDDDDDDDD O1#A#A#A#A#A#A#A#A #A#A#A T8O2QCICCC O1Q.AAIAAA"  V3$(3)="O2Q.DDIDDD O1Q.GGI#AA#A Q.#A#AI#AQ#A Q.AAIAQA O2Q.DDIO1GO2QD Q.EEIEQE O1Q.AAIAQA T7O2 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  V3$(3)=V3$(3)+"O2Q.EEIEQE O1Q.AAIAQA T7O2 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A  T7O2 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  ' *** VOICE4 - MELODY ***  ' -----------------------  V4$(0)=""  V4$(1)="T4O5P0 QR M2ID M4QD P5 M1O4#G H.A IAQA   O5Q.E H#F IR #F#FA QG IG#F W M5 .G P9M2O4IA O5I.B.A SG#F AGABAB QG O4IAB O5H#F SG#F Q.E.D"  V4$(2)="O5T4P7WDHRQ.RICP5O5IDDFQ.GIFDQ.FSEDHCIFFAQGIFDSCP2H.DP5I.RICDDFQ.GIFD Q.F SED HC IFFAQGIFD IGP1H.A P7IRA"  V4$(3)="T4 IO6DD#DQDICO5#AH.#AQ.R IAA#AQAIAGP1WAP7IR"  V4$(3)=V4$(3)+"HRI#FGAQ.GI#FG#FHERIR DHDRR IR#FGAQ.GI#FG#FHERIR DHD"  RETURN'---------.POLL╞PLAY'---------  IF RPLAY(1) THEN RETURN  MUSIC╞CHUNK╞INDEX=MAP╞BAR╞TO╞CHUNK(BAR╞INDEX)    PLAY V1$(MUSIC╞CHUNK╞INDEX),V3$(MUSIC╞CHUNK╞INDEX),V4$(MUSIC╞CHUNK╞INDEX)  SLEEP .05  PLAY ,,,V2$(MUSIC╞CHUNK╞INDEX),V3$(MUSIC╞CHUNK╞INDE _X),V4$(MUSIC╞CHUNK╞INDEX)  BAR╞INDEX=BAR╞INDEX+1  IF BAR╞INDEX=5 THEN BAR╞INDEX=1  RETURN                                                                                                                                                                !LARE спрптрбнк = $D06E  #DECLARE хотрег╞7 = $D05D#DECLARE K, A$'----.MAIN'----  GOSUB INIT  GET KEY A$  GOSUB DE╞INIT  END'----.INIT'----  POKE $D021,9  ' ENFORCE SPRITES INTO банк5 AND спрптр16 BIT TURNED ON  POKE спрптрбнк, 5+12"8  WPOKE спрптрадр, 0  ' TURN ON ALL SPRITES  FOR K = 0 TO 4    SPRITE K, 1    MOVSPR K, 64*K+24, 50  NEXT K  POKE спрь64ен, 255  POKE спрхгтен, 255  POKE спрхгт, 200  RETURN'-------.DE╞INIT'-------  FOR K = 0 TO 4    SPRITE K, 0  NEX T K    RETURN                                                                                                                                                                                                                                               $----------------.SCROLL╞CANVAS╞LEFT'------------------  IF OFFS>0 THEN OFFS=OFFS-1:ELSE RETURN  FOR YY = 0 TO 49    EDMA оп╞цопы+дст╞дец+срц╞дец, _           79, $40800 + YY*80 + 78, $40800 + YY*80 + 79    POKE $40800 + YY*80, 32   NEXT YY  RETU%-----------------.SCROLL╞CANVAS╞LEFT'------------------  IF OFFS>0 THEN OFFS=OFFS-1:ELSE RETURN  FOR YY = 0 TO 49    EDMA оп╞цопы+дст╞дец+срц╞дец, _           79, $40800 + YY*80 + 78, $40800 + YY*80 + 79    POKE $40800 + YY*80, 32   NEXT YY  RET&LARE спрптрбнк = $D06E  #DECLARE хотрег╞7 = $D05D#DECLARE K, A$'----.MAIN'----  GOSUB INIT  GET KEY A$  GOSUB DE╞INIT  END'----.INIT'----  POKE $D021,9  ' ENFORCE SPRITES INTO банк5 AND спрптр16 BIT TURNED ON  POKE спрптрбнк, 5+12'8  WPOKE спрптрадр, 0  ' TURN ON ALL SPRITES  FOR K = 0 TO 4    SPRITE K, 1    MOVSPR K, 64*K+22, 50  NEXT K  POKE спрь64ен, 255  POKE спрхгтен, 255  POKE спрхгт, 200  RETURN'-------.DE╞INIT'-------  FOR K = 0 TO 4    SPRITE K, 0  NEX T K    RETURN                                                                                                                                                                                                                                               UNT'=============.PETSCII╞STORY'=============  GOSUB SWITCH╞TO╞80X25╞MODE  GOSUB RESTORE╞SCREEN╞POINTER  PALETTE RESTORE  BACKGROUND 0:BORDER 0  PRINT CHR$(147);  GOSUB INIT╞PETSCII╞FRAMES  GOSUB INIT╞ANIMS  #DECLARE TSTART, TIME, ACTION, ACTANIM=-1, ACTPAINTING  #DECLARE ACTSTR$, ACTX, ACTY, ACTDUR, ACTREACTION  #DECLARE ACTTIMER  TSTART = TI  READ TIME  ACTION = -1  DO WHILE ACTION <> ендер    ' TIME TO SWITCH TO NEXT ACTION?    IF (TI-TSTART) >= TIME THEN BEGIN      IF ACTION = тьтталк THEN GOSUB CLEAR╞TXT╞TALK      READ ACTION      ACTTIMER=0      IF ACTION = тьтгреы THEN READ ACTSTR$, ACTX, ACTY      IF ACTION = тьтталк THEN READ ACTSTR$, ACTDUR      IF ACTION = тьтцлеар THEN GOSUB CLEAR╞TEXT      IF ACTION = аним THEN READ ACTANIM:ANIMIDX=0:ANIMREPEATCOUNT=0      IF ACTION = паинтинг THEN READ ACTPAINTING:GOSUB DRAW╞PAINTING      IF ACTION = реацтион THEN READ ACTSTR$, ACTREACTION, ACTDUR:GOSUB INIT╞REACTION      IF ACTION = цлс THEN PRINT "⌠";      IF ACTION = дравфрм THEN READ FRAMEIDX:GOSUB DRAW╞PETSCII╞FRAME      IF ACTION = ендер THEN EXIT      TSTART = TI      READ TIME ' TIME FOR NEXT ACTION    BEND    IF ACTION = тьтгреы THEN GOSUB DRAW╞TXT╞GREY    IF ACTION = тьтталк THEN GOSUB DRAW╞TXT╞TALK    IF ACTION = реацтион THEN GOSUB DRAW╞REACTION    GOSUB POLL╞PLAY    GOSUB POLL╞ANIM  LOOP    RETURN#DEFINE марк1 = -1#DEFINE марк2 = -2#DEFINE марк3 = -3#DEFINE репеат = -10#DEFINE инфинителы = -1#DEFINE енд╞аним = -999#DEFINE алл╞анимс╞финисхед = -1000#DECLARE FRAME╞START.POLL╞ANIM'---------  IF ACTANIM = -1 THEN RETURN  IF FRAMEDUR > 0 AND (TI - FRAME╞START) < FRAMEDUR THEN RETURN  FRAMEDUR = 0  'CURSOR 0,1:PRINT "POLL╞ANIM";  'CURSOR 0,2:PRINT "ACTANIM=";ACTANIM;  'CURSOR 0,3:PRINT "ANIMIDX=";ANIMIDX;  AVAL = ANIMS(ACTANIM,ANIMIDX)  ANIMIDX = ANIMIDX + 1'PRINT "                     ANIMIDX=";ANIMIDX;  FOUND = 0  IF AVAL = марк1 THEN FOUND=1:MARK(1)=ANIMIDX  IF AVAL = марк2 THEN FOUND=1:MARK(2)=ANIMIDX  IF AV	AL = марк3 THEN FOUND=1:MARK(3)=ANIMIDX  IF AVAL = репеат THEN BEGIN    FOUND=1    ' GET MARK NUMBER (IN AVAL)    GMARKNUM = ABS(ANIMS(ACTANIM,ANIMIDX))    ANIMIDX = ANIMIDX + 1    GCOUNT = ANIMS(ACTANIM,ANIMIDX)    ANIMIDX = ANIMIDX + 1    BAIL
=0    IF ANIMREPEATCOUNT = 0 THEN BEGIN      IF GCOUNT <> -1 THEN ANIMREPEATCOUNT = GCOUNT      ANIMIDX = MARK(GMARKNUM)      BAIL=1    BEND          IF BAIL=0 AND ANIMREPEATCOUNT > 0 THEN BEGIN      ANIMREPEATCOUNT = ANIMREPEATCOUNT -1      IF ANIMREPEATCOUNT = 0 THEN BAIL=1      IF BAIL=0 THEN ANIMIDX=MARK(GMARKNUM)      BAIL=1    BEND    'IF BAIL=0 AND ANIMREPEATCOUNT = инфинителы THEN BEGIN    '  ANIMIDX=MARK(GMARKNUM)    '  BAIL=1    'BEND  BEND  IF AVAL = енд╞аним THEN BEGIN    FOUND = 1    ACTANIM = -1  BEND  'CURSOR 0,8:PRINT "FOUND = ";FOUND;  IF FOUND = 0 THEN BEGIN ' WE'RE DRAWING A PETSCII FRAME NOW?    FRAMEIDX = AVAL    'CURSOR 0,5:PRINT "DRAW FRAMEIDX=";FRAMEIDX;    'INPUT AVAL    GOSUB DRAW╞PETSCII╞FRAME    FRAMEDUR = ANIMS(ACTANIM,ANIMIDX)    ANIMIDX = ANIMIDX + 1    FRAME╞START = TI  BEND  RETURN.CLEAR╞TEXT'-----------  EDMA 3,80,32,$800  RETURN.DRAW╞TXT╞GREY'-------------  IF ACTTIMER = -1 THEN RETURN  SLEEP .05  CURSOR ACTX + ACTTIMER, ACTY  PRINT "≤";MID$(ACTSTR$,1+ACTTIMER,1);  ACTTIMER = ACTTIMER + 1  IF ACTTIMER >= LEN(ACTSTR$) THEN ACTTIMER = -1  RETURN.DRAW╞TXT╞TALK'-------------  IF ACTTIMER = -1 THEN RETURN  SLEEP .05  ACTX=(80-LEN(ACTSTR$))/2+7  ACTY=1  CURSOR ACTX + ACTTIMER, ACTY  PRINT "";MID$(ACTSTR$,1+ACTTIMER,1);  ACTTIMER = ACTTIMER + 1  IF ACTTIMER >= LEN(ACTSTR$) THEN ACTTIMER = -1  IF MOD(ACTTIMER,2) = 0 THEN FRAMEIDX=фрм╞опен╞моутх:ELSE FRAMEIDX=фрм╞цлосе╞моутх  GOSUB DRAW╞PETSCII╞FRAME  RETURN.CLEAR╞TXT╞TALK'--------------  CURSOR 0,1:PRINT CHR$(27);"Q";  RETURN.DRAW╞PETSCII╞FRAME'------------------  DATA╞ADDR = FRAME╞ADDR(FRAMEIDX)  FRMX = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMY = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMW = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMH = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  #DECLARE YY, SCRADDR,CLRADDR  SCRADDR = $800 + FRMX + FRMY * 80  CLRADDR = $1F800 + FRMX + FRMY * 80  CDATA╞ADDR = DATA╞ADDR + FRMW * FRMH  FOR YY=FRMY TO FRMY1    EDMA 0, FRMW, DATA╞ADDR, SCRADDR    EDMA 0, FRMW, CDATA╞ADDR, CLRADDR    DATA╞ADDR = DATA╞ADDR + FRMW    CDATA╞ADDR = CDATA╞ADDR + FRMW    SCRADDR = SCRADDR + 80    CLRADDR = CLRADDR + 80    NEXT YY  RETURN.INIT╞REACTION'-------------  PRINT "⌠";  FRAMEIDX = фрм╞станд:GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞лифт╞папер1:GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞лифт╞папер2:GOSUB DRAW╞PETSCII╞FRAME  RETURN.DRAW╞REACTION'-------------  ACTTIMER = ACTTIMER + 1  SLEEP .1  IF MOD(ACTTIMER,2) = 0 THEN FRAMEIDX=фрм╞схоцк╞фаце:ELSE FRAMEIDX=фрм╞хоррор╞фаце  GOSUB DRAW╞PETSCII╞FRAME  IF ACTTIMER > 10 THEN ACTION = тьтталк:ACTTIMER = 0  RETURN.DRAW╞PAINTING'-------------  PRINT "⌠";  FRAMEIDX = фрм╞папер  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞паинтинг1 + ACTPAINTING - 1  GOSUB DRAW╞PETSCII╞FRAME  RETURN#DECLARE RVAL, AIDX, VIDX#DECLARE TEST$.INIT╞ANIMS'----------  AIDX = 0  VIDX = 0  DO    READ RVAL    ' PRINT RVAL;", ";    IF RVAL = алл╞анимс╞финисхед THEN EXIT    ANIMS(AIDX,VIDX) = RVAL    VIDX = VIDX + 1    IF RVAL = енд╞аним THEN AIDX=AIDX+1:VIDX=0  LOOP  RETURN.ANIMS'-----  ' анм╞пондер  DATA фрм╞станд,   .3, _       фрм╞арм╞уп1, .3, _       фрм╞арм╞уп2, .3, _       фрм╞арм╞уп3, .3    ' RAISE ARM TO CHIN  DATA марк1  DATA фрм╞арм╞уп4, .5, _       фрм╞арм╞уп3, .5, _       фрм╞арм╞уп4, .5, _       фрм╞арм╞уп3, .5    ' SCRATCH CHIN  DATA фрм╞цлосе╞еыес, 0 , _       фрм╞арм╞уп4,     .5, _       фрм╞арм╞уп3,     .5, _       фрм╞арм╞уп4,     .5, _       фрм╞арм╞уп3,     .5    ' CLOSE EYES & SCRATCH CHIN  DATA фрм╞цлосе╞моутх, .2    ' NORMAL FACE  DATA репеат, марк1, инфинителы  DATA енд╞аним  ' анм╞паинт  DATA фрм╞опен╞моутх, 0 , _       фрм╞арм╞лефт1, 1     ' GAPING MOUTH AND FINGER POINT UP  DATA фрм╞цлосе╞моутх,.2, _       фрм╞арм╞лефт2,  .2, _       фрм╞арм╞лефт3,  .2, _       фрм╞арм╞лефт4,  .2, _       фрм╞арм╞ригхт1, .2, _       фрм╞арм╞ригхт2, .2 ' GET BRUSH  DATA марк1  DATA фрм╞цлосе╞моутх, .1  DATA марк2  DATA фрм╞арм╞ригхт3, .1, _       фрм╞арм╞ригхт4, .1  DATA репеат, марк2,   5  DATA фрм╞цлосе╞еыес,  .5  DATA марк3  DATA фрм╞арм╞ригхт3, .1, _       фрм╞арм╞ригхт4, .1  DATA репеат, марк3,   5  DATA репеат, марк1, инфинителы  DATA енд╞аним  ' анм╞лифт  DATA фрм╞арм╞ригхт2, .25, _       фрм╞арм╞ригхт1, .25, _       фрм╞ретурн╞паинтбрусх, .5, _       фрм╞арм╞ригхт5, .25, _       фрм╞арм╞ригхт6, .25, _       фрм╞лифт╞папер1, .25, _       фрм╞лифт╞папер2, .25  DATA марк1  DATA фрм╞цринге╞фаце, .1, _       фрм╞цросс╞фаце, .1, _       репеат, марк1, 5  DATA енд╞аним  ' анм╞рип  DATA фрм╞норм╞фаце, .2, _       фрм╞рип1, .1, _       фрм╞рип2, .1, _       фрм╞рип3, .1, _       фрм╞рип4, .1, _       фрм╞рип5, .1, _       фрм╞рип6, .1, _       фрм╞рип7, .1, _       фрм╞рип8, .1, _       фрм╞рип9, .1, _       фрм╞рип10, .1, _       фрм╞рип11, .1  DATA енд╞аним  DATA алл╞анимс╞финисхед.STORY╞DATA'----------                  '      TIMEDELTA  ACTION       TEXT                            X   Y  DUR(SEC)  ' сONNY: ATTEMPT #1  DATA 0,        аним,        анм╞пондер  DATA 2,        тьтгреы,     "HERE'S SONNY...",              4,  0  DATA 1.5,      тьтгреы,     "A STRUGGLING ARTIST...",       22, 0  DATA 1.7,      тьтгреы,     "SEARCHING FOR INSPIRATION...", 47, 0  DATA 2,        тьтцлеар  DATA .5,       тьтталк,     "HMM... WHAT TO DRAW TODAY...",        3  DATA 2,        аним,        ан м╞паинт  DATA 1.5,      тьтталк,     "I KNOW!",                             2  DATA 1,        тьтцлеар  DATA 3,        аним,        анм╞лифт  DATA 4,        паинтинг,    1  DATA 2,        реацтион,    "BLECH!",                       1,     2  DATA !2,        аним,        анм╞рип  DATA 1.5,      цлс  DATA .,        тьтгреы,     "TRY AGAIN SONNY...",           34, 12  DATA 2,      цлс  ' сONNY: ATTEMPT #2  DATA .,        аним,        анм╞пондер  DATA 2,        аним,        анм╞паинт  DATA 1.5",      тьтталк,     "AHA!",                             2  DATA 1,        тьтцлеар  DATA 3,        аним,        анм╞лифт  DATA 4,        паинтинг,    2  DATA 2,        реацтион,    "YUCK!",                       1,     2  DATA 2,        аним,       # анм╞рип  DATA 1.5,      цлс  DATA .,        тьтгреы,     "DON'T GIVE UP SONNY!",           32, 12  DATA 2,        цлс  ' сONNY: ATTEMPT #3  DATA .,        аним,        анм╞пондер  DATA 2,        аним,        анм╞паинт  DATA 1.5,      тьтталк,   $  "I GOT IT!",                             2  DATA 1,        тьтцлеар  DATA 3,        аним,        анм╞лифт  DATA 4,        паинтинг,    3  DATA 2,        реацтион,    "EWW!",                       1,     2  DATA 2,        аним,        анм╞рип  DAT%A 1.5,      дравфрм,     фрм╞сад╞фаце  DATA .,        тьтгреы,     "AWW... POOR SONNY...",           32, 0  DATA 2,        тьтцлеар  DATA .1,       тьтталк,     "GUYS LIKE ME SHOULDN'T DREAM ANYWAY...", 3.5  DATA 3.5,      дравфрм,     фрм╞сад╞фаце & DATA 1,        цлс  DATA .5,       тьтгреы,     "...AND WITH THAT, SONNY'S DREAMS BLEW AWAY WITH THE WIND...", 10, 12  DATA 3.5,      цлс  DATA 1,       ендер'=====.ENDER'=====  GOSUB SWITCH╞TO╞80X25╞MODE  GOSUB RESTORE╞SCREEN╞POINTER  PALET'TE RESTORE  RETURN'============.XANADU╞TITLE'============  PRINT CHR$(147);  BACKGROUND 0  BORDER 0  ' FILL SCREEN WITH BLACK INVERTED SPACES  EDMA 3,4000,0,$FF80000  EDMA 3,4000,160,$48000      GOSUB LOAD╞PALETTE  GOSUB SWITCH╞TO╞80X50╞MO DE  GOSUB SET╞SCREEN╞POINTER  GOSUB PAN╞TITLE  RETURN.SWITCH╞TO╞80X50╞MODE'--------------------  BANK 128  SETBIT хотрег╞7, 7  POKE $D031, $E8 ' х640, фаст, аттр, ж400  RETURN.SWITCH╞TO╞80X25╞MODE'--------------------  BANK 128  POKE $D031CQC T2P0IEP5G#F Q.R P0T7I#D P7S#DD#DE#FE#FGHG"  V2$(7)="T7P0M1O3QDO2#F QAA IO3ECEQDIDDD O3QDO2#F QAA IO3ECEQDIDDD EE#F#F Q.EIEEEEE"  V3$(7)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  V4$(7)="T0M4O4P0IDP8SCDICSO3BO4C QO3BIO4CQC O5T2P0IGP5BA QRR T0M4O4P0IDP8SCDICSO3BO4C QO3BIO4CQC O5T2P0IGP5BA Q.R O4P0T0I#DP9S#DD#DE#FE#FGHGR"  V5$(7)="T7P0M1O3QAD EE IGEG Q#F I#F#F#F QAD EE IGEG Q#F I#F#F#F GGAA Q.B IBBBBB"  V6$(7)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  ' *** I'M ALIVE! CHORUS2 ***  ' -------------------------  V1$(8)="T7M5O5P0QAA P3HB QBBO6H.#C O51QBQ.BIR QP0BB P3H.O6#CP1O5QBQ.BIR"  V2$(8)="T7P0M1O3QDDHG QEE SARARARARARARARAR ERERERERERERERER ARARARARARARARAR ERERERER"  V3$(8)="T3O2 IBRBR BRRR BRBR O1S GRGRGRGRGRGRGRGRGRGRGRGRGRGRGRGR GRGRGRGRGRGRGRGRGRGRGRGR"  V4$(8)="T7M5O6P0QDD HD QEE RO5EP9O6EID#CO5HB P0O6QEE RO5EP9O6EID#CO5HB"  V5$(8)="T7P0M1O3QAAO4HD O3QBB O4SERERERERERERERER O3BRBRBRBRBRBRBRBR O4ERERERERERERERER O3BRBRBRBR"  V6$(8)="T3O2 IBRBR BRRR BRBR O1S GRGRGRGRGRGRGRGRGRGRGRGRGRGRGRGR GRGRGRGRGRGRGRGRGRGRGRGR"  ' *** IM ALIVE! VERSE PITCH SHIFT ***  ' -----------------------------------  V1$(9)="T7M5O5QP0AA ARIRP7 #F#G QAIAQA#G#F H#F S#FE#F#G#F#G HEIR"  V2$(9)="T7P0M1O2QGO3D O2QAAIAQAIO3D O2Q#F#FI#FQ#FIB QDDIDQDI#F QEE"  V3$(9)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR"  V4$(9)="T7M5O6QP0GP9S#FD#FG QERIR T0O6P0#FP8#G QAIAQA#G#F H#F S#FE#F#G#F#G HEIR"  V5$(9)="T7P0M1O3QDA EEIEQEIA O3Q#C#CI#CQ#CI#F O2 QAAIAQAIO3#C O2QBB"  V6$(9)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR"  ' *** SEEMS LIKE FOREVER ***  V1$(10)="T7M5O5QP0IEP5SDEIDS#CO5D Q#CIO5DQD T2P0I#FP5A#G QRR T7M5O5P0IEP5SDEIDS#CD Q#CIO5DQD T2P0I#FP5A#G Q.R P0T7IF P7SFEF#F#G#F#GAHAR"  V2$(10)="T7P0M1O3QEO2#G QBB IO3#FD#FQEIEEE O3QEO2#G QBB IO3#FD#FQEIEEE #F#F#G#G Q.#FI#F#F#F#F#F"  V3$(10)="T3O2 IBRBR O1GR O2	GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  V4$(10)="T0M4O4P0IEP8SDEIDS#CD Q#CIO4DQD O5T2P0IAP5O6#CO5B QRR T0M4O4P0IEP8SDEIDS#CD Q#CIO4DQD O5T2P0IAP5O6#CO5B Q.R O4P0T0IFP9SFEF#F#G#F#GAHAR"  V5$(10)="T7P0M1O
3QBE #F#F IA#FA Q#G I#G#G#G QBE #F#F IA#FA Q#G I#G#G#G AABB QO4.#C I#C#C#C#C#C"  V6$(10)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  ' *** IM ALIVE CHORUS3 ***  V1$(11)="T7M5O5P0QBB P3HO6#C O5IBO6#CDH#CIR O5QBB P3HO6#C O5IBO6#CDH#CIR O5QBB HO6#C O5IBO6#CDH#CIR SP9O5BABO6#CO5BO6#CO5AB"  V2$(11)="T7P0M1O3QEE SAEAEAEAE #GE#GE#GE#GE #FE#FE#FE#FE EBEBEBEB SAEAEAEAE#GE#GE#GE#GE#FE#FE#FE#FE EBEBEBEB SAEAEAEAE#GE#GE#GE#GE#FE#FE#FE#FE EBEBEBEB"  V3$(11)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR"  V4$(11)="T7M5O5P0Q#G#G P3HA I#GABHAIR Q#G#GHA I#GABHAIR Q#G#GHA I#GABHAIR P9S#G#F#GA#F#GE#F"  V5$(11)="QT6O4EE O5IP0AE#CO4A O5BE#CO4A O6#CO5E#CO4A O6EO5B#GE O5IP0AE#CO4A O5BE#CO4A O6#CO5E#CO4A O6EO5B#GE"  V5$(11)=V5$(11)+"O5SP0AE#CEAE#CE BE#CEBE#CE O6#CO5E#CEO6#CO5E#CE O6EO5B#GBO6EO5B#GB"  V6$(11)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR"  ' *** FINAL INTERLUDE INTRO ***  V1$(12)="T8M5O5P0 H.#FIRS#F#F Q.GSGGIGSRIGSRIG":V1$(12)=V1$(12)+V1$(12)+V1$(12):V1$(12)=V1$(12)+"H.#FIRS#F#F Q.GSGGIFSRIFSRIF"  V2$(12)="T8O3H.DIRSDD Q.DSDDO2IASRIASRIA O3H.DIRSDD Q.DSDDIDSRIDSRID H.DIRSDD Q.DSDDO2IASRIASRIA H.DIRSDD Q.DSDD O2I#GSRI#GSRI#G"  V3$(12)="T3O2 QBRRIRSBB Q.BSBBIDSRIDSRID QBRRIRSBB Q.BSBBIDSRIDSRID O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR IDSRIDSRID"  V4$(12)="M0P0T7O1H.DIRSDD Q.DSDDIDSRIDSRID":V4$(12)=V4$(12)+V4$(12)+V4$(12):V4$(12)=V4$(12)+"H.DIRSDD Q.DSDD I#GSRI#GSRI#G"  V5$(12)="T8O3H.AIRSAA Q.ASAAIDSRIDSRID H.AIRSAA Q.ASAAIASRIASRIA H.AIRSAA Q.ASAAIDSRIDSRID H.AIRSAA Q.ASAA I#CSRI#CSRI#C"  V6$(12)="T3O2 QBRRIRSBB Q.BSBBIDSRIDSRID QBRRIRSBB Q.BSBBIDSRIDSRID O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR IDSRIDSRID"  ' *** FINAL INTERLUDE 1 ***  V1$(13)="O5T8W.E QO6IDP5SRI#CSR O5IB H.A IRB WB WE O6H#C O5A WG R"  V2$(13)="T6O2 IAAAAAAAA AAAAAAAA EEEEEEEE EEEE T8QGB T6IAAAAAAAA AAAAAAAA EEEEEEEE EEEE T8QGB"  V3$(13)="T3O2I O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR BRBR":V3$(13)=V3$(13)+V3$(13)  V4$(13)="O4T8W.E QO5IDP5SRI#CSR O4IB H.A IRB WB WE O5H#C O4A WG R"  V5$(13)="T6O3 IEEEEEEEE EEEEEEEE O2BBBBBBBB BBBBO3 T8QD#F T6IO3EEEEEEEE EEEEEEEE O2BBBBBBBB BBBBO3 T8QD#F"  V6$(13)="T3O2I O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR BRBR":V6$(13)=V6$(13)+V6$(13)  ' *** FINAL INTERLUDE 2 ***  V1$(14)="O6T8W.#C Q#CIO5BO6#C HD IREF HEIR"  V2$(14)="T7M0O2 SARARARARARARARAR ARARARARARARARAR #AR#AR#AR#AR#AR#AR#AR#AR T8Q.EIEQEE"  V3$(14)="T3I O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR BRR BBRBR"  V4$(14)="O5T8W.#C Q#CIO4BO5#C HD IREF HEIR"  V5$(14)="T7M0P0O3 SERERERERERERERER ERERERERERERERER FRFRFRFRFRFRFRFR T8O2 Q.BIBQBB"  V6$(14)="T3I O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR O1GR O2GR O1GG O2GR BRR BBRBR"  ' *** FINAL IM ALIVE CHORUS ***  V1$(15)="T7M5O5P0 QBB P3O6H.#C O5QBQ.BIR QP0BB P3H.O6#CP1O5QBQ.BIR QP0BB P3H.O6#CP1O5QBQ.BIR QP0BB T1O6HC"  V2$(15)="SO2AO3AO2AO3AO2AO3AO2AO3A O2AO3AO2AO3AO2AO3AO2AO3A O2Q.E IEQEE":V2$(15)="T7P0M1O2QEE"+V2$(15)+V2$(15)+V2$(15)+"P1T1HF"  V3$(15)="T3I O2BRBR O1GR O2GR O1GG O2GR BRRB BRBR O1GR O2GR O1GG O2GR BRRB BRBR O1GR O2GR O1GG O2GR BRRB BRBR O1HG"  V4$(15)="P0T7O5Q#G#G P2H.A Q#GQ.#GIR Q#G#G H.A Q#GQ.#GIR Q#G#G H.A Q#GQ.#GIR Q#G#G T1 P1SFHO2F"  V5$(15)="QT6O4EE O5IP0AE#CO4A O5IP0AE#CO4A O5B#GEO4B O5B#GEO4B O5IP0AE#CO4A O5IP0AE#CO4A O5B#GEO4B O5B#GEO4B"  V5$(15)=V5$(15)+"O5SP0AE#CEAE#CE AE#CEAE#CE B#GE#GB#GE#G B#GE#GB#GE#G O5T1SEP1O2HE"  V6$(15)="T3I O2BRBR O1GR O2GR O1GG O2GR BRRB BRBR O1GR O2GR O1GG O2GR BRRB BRBR O1GR O2GR O1GG O2GR BRRB BRBR O1HG"#ENDIF  RETURN'---------.POLL╞PLAY'---------  IF RPLAY(1) THEN RETURN  IF BAR╞INDEX>22 THEN RETURN  MUSIC╞CHUNK╞INDEX=MAP╞BAR╞TO╞CHUNK(BAR╞INDEX)    PLAY V1$(MUSIC╞CHUNK╞INDEX),V2$(MUSIC╞CHUNK╞INDEX),V3$(MUSIC╞CHUNK╞INDEX)  SLEEP .02  PLAY ,,,V g4$(MUSIC╞CHUNK╞INDEX),V5$(MUSIC╞CHUNK╞INDEX),V6$(MUSIC╞CHUNK╞INDEX)  BAR╞INDEX=BAR╞INDEX+1  RETURN                                                                                                                                                        #OUTPUT "XANADU-BASIC65"'============.DECLARATIONS'============  ' MUSIC RELATED VARS  ' ------------------  #DECLARE MUSIC╞CHUNK╞INDEX     ' OLD T  #DECLARE BAR╞INDEX             ' OLD TT  #DECLARE MAP╞BAR╞TO╞CHUNK(10)  ' OLD M()  #DECLARE V1$(4), V2$(4), V3$(4), V4$(4)  ' PALETTE  ' -------  #DECLARE DEFAULT╞RED(32)  #DECLARE DEFAULT╞GREEN(32)  #DECLARE DEFAULT╞BLUE(32)  #DECLARE CURR╞RED(32)  #DECLARE CURR╞GREEN(32)  #DECLARE CURR╞BLUE(32)  #DECLARE FADEVAL, TEMPVAL  ' и/о  ' ---  #DEFINE хотрег╞7 = $D05D  #DEFINE сцрнптрлсб = $D060  #DEFINE сцрнптрбнк = $D062  ' MISC  ' ----  #DECLARE K,M,N  #DECLARE RAINBOWSTR$  #DECLARE RAINBOW╞X, RAINBOW╞Y  #DECLARE PLEN=0  #DECLARE SUBTEXT$(2)  #DECLARE SUBTEXT╞IDX = 0  SUBTEXT$(0) = "PRESENTS..."  SUBTEXT$(1) = "A TRIBUTE TO THE LATE OLIVIA NEWTON JOHN..."  #DECLARE PAN╞IDX = 0  #DECLARE PAN╞SRC╞IDX  #DECLARE PAN╞DEST╞IDX  #DECLARE PAN╞Y, PAN╞LEN  ' PETSCII  ' -------  #DECLARE DATA╞ADDR = $4270C  #DECLARE MAX╞FRAMES  #DECLARE FRAME╞ADDR(64)  #DECLARE FRM╞IDX = 0  #DECLARE FRMW, FRMH#DECLARE ANIMS(4,100) ' ANIM╞IDX, ANIM╞DATA#DECLARE AVAL,MARK(3),GMARKNUM,GCOUNT,BAIL,FOUND,FRAMEIDX,FRAMEDUR=0#DECLARE FRMX, FRMY, FRMX1, FRMY1, CDATA╞ADDR#DEFINE фрм╞станд  = 0#DEFINE фрм╞арм╞уп1 = 1#DEFINE фрм╞арм╞уп2 = 2#DEFINE фрм╞арм╞уп3 = 3#DEFINE фрм╞арм╞уп4 = 4#DEFINE фрм╞арм╞лефт1 = 5#DEFINE фрм╞арм╞лефт2 = 6#DEFINE фрм╞арм╞лефт3 = 7#DEFINE фрм╞арм╞лефт4 = 8#DEFINE фрм╞цлосе╞еыес = 9#DEFINE фрм╞опен╞моутх != 10#DEFINE фрм╞цлосе╞моутх = 11#DEFINE фрм╞арм╞ригхт1 = 12#DEFINE фрм╞арм╞ригхт2 = 13#DEFINE фрм╞арм╞ригхт3 = 14#DEFINE фрм╞арм╞ригхт4 = 15#DEFINE фрм╞ретурн╞паинтбрусх = 16#DEFINE фрм╞арм╞ригхт5 = 17#DEFINE фрм╞арм╞ригхт6 = 18#DEFINE фрм╞лифт╞"папер1 = 19#DEFINE фрм╞лифт╞папер2 = 20#DEFINE фрм╞схоцк╞фаце = 21#DEFINE фрм╞цринге╞фаце = 22#DEFINE фрм╞цросс╞фаце = 23#DEFINE фрм╞хоррор╞фаце = 24#DEFINE фрм╞сад╞фаце = 25#DEFINE фрм╞норм╞фаце = 26#DEFINE фрм╞рип1 = 27#DEFINE фрм╞рип2 = 28#D#EFINE фрм╞рип3 = 29#DEFINE фрм╞рип4 = 30#DEFINE фрм╞рип5 = 31#DEFINE фрм╞рип6 = 32#DEFINE фрм╞рип7 = 33#DEFINE фрм╞рип8 = 34#DEFINE фрм╞рип9 = 35#DEFINE фрм╞рип10 = 36#DEFINE фрм╞рип11 = 37#DEFINE фрм╞папер = 38#DEFINE фрм╞паинтинг1 = 39#DEFIN$E фрм╞паинтинг2 = 40#DEFINE фрм╞паинтинг3 = 41#DEFINE фрм╞мурал = 42'====.MAIN'====  GOSUB INIT  GOSUB BAS╞LOGO  GOSUB XANADU╞TITLE  GOSUB PETSCII╞STORY  GOSUB ENDER  ' BACKUP PALETTE TO $48000  EDMA 0, $300, $FFD3100, $48000   ' SET ALL %COLOURS TO BLACK  EDMA 3, $300, 0, $FFD3100   'тодо: DELETE  IF PEEK($D020)<>0 THEN BORDER 2:GOSUB INIT╞PETSCII╞FRAMES  FRAMEIDX=фрм╞мурал  GOSUB DRAW╞PETSCII╞FRAME  CLR  DLOAD "BIGSPRITE"  END' ACTION NAMES#DEFINE тьтгреы=0#DEFINE тьтцлеа&р=1#DEFINE тьтталк=2#DEFINE аним=3#DEFINE паинтинг=4#DEFINE реацтион=5#DEFINE цлс=6#DEFINE дравфрм=7#DEFINE ендер=8' ANIMATIONS#DEFINE анм╞пондер=0#DEFINE анм╞паинт=1#DEFINE анм╞лифт=2#DEFINE анм╞рип=3.INIT╞PETSCII╞FRAMES'---------------'----  MAX╞FRAMES = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  DO WHILE FRM╞IDX < MAX╞FRAMES    FRAME╞ADDR(FRM╞IDX) = DATA╞ADDR    DATA╞ADDR = DATA╞ADDR + 2    FRMW = PEEK(DATA╞ADDR)    DATA╞ADDR = DATA╞ADDR + 1    FRMH = PEEK(DATA╞ADDR)    DAT A╞ADDR = DATA╞ADDR + 1    DATA╞ADDR = DATA╞ADDR + FRMW * FRMH * 2    ':PRINT CHR$(147);"FRM╞IDX=";FRM╞IDX    'FRAMEIDX=FRM╞IDX    'GOSUB DRAW╞PETSCII╞FRAME    'GETKEY TEST2$    FRM╞IDX = FRM╞IDX + 1  LOOP  RETURN#DECLARE ANIMIDX, ANIMREPEATCO	TER=0:GOSUB STORE╞CURR╞COLOURS:MUSE╞STATE=0  RETURN.HIGHLIGHT╞CURR╞MUSE'-------------------    FADEVAL = DEFCOLVAL    K = MUSE╞CLR(CURR╞MUSE)    STARTCOL = K:ENDCOL = K    GOSUB FADE╞COLOURS╞TO╞WHITE    DEFCOLVAL = DEFCOLVAL + DEFCOLDIR    IF D	EFCOLVAL = 16 THEN DEFCOLDIR=-2    IF DEFCOLVAL = 0 THEN DEFCOLDIR=2:COUNTER=COUNTER+1    IF COUNTER = 3 AND DEFCOLVAL = 14 AND DEFCOLDIR=-2 THEN BEGIN      STATE=STATE+1      COUNTER=0      PALETTE RESTORE      FADEVAL=0      GOSUB SAVE╞SCREEN  	    GOSUB STORE╞CURR╞COLOURS    BEND    RETURN.FADE╞COLOURS╞TO╞WHITE'---------------------  'инпут: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = STARTCOL TO ENDCOL    POKE $D100+K, DEFAULT╞RED(K) + (15 - DEFAULT╞RED(K)) * TEMPVAL    POKE $D	200+K, DEFAULT╞GREEN(K) + (15 - DEFAULT╞GREEN(K)) * TEMPVAL    POKE $D300+K, DEFAULT╞BLUE(K) + (15 - DEFAULT╞BLUE(K)) * TEMPVAL  NEXT K  RETURN  .CYCLE╞COLOURS'-------------  TEMPR = PEEK($D100+STARTCOL)  TEMPG = PEEK($D200+STARTCOL)  TEMPB = P	EEK($D300+STARTCOL)  FOR K = STARTCOL TO ENDCOL    POKE $D100+K, PEEK($D100+K+1)    POKE $D200+K, PEEK($D200+K+1)    POKE $D300+K, PEEK($D300+K+1)  NEXT K  POKE $D100+ENDCOL, TEMPR  POKE $D200+ENDCOL, TEMPG  POKE $D300+ENDCOL, TEMPB  RETURN	.P1╞ENDER'--------  RETURN'==========================.P7╞BIG╞OLIVIA╞WITH╞SPRITES'==========================  GOSUB P7╞INIT  GOSUB P7╞LOOP  GOSUB P7╞ENDER  RETURN'----.P7╞INIT'----  POKE 53275,0  ' SWITCH TO 80X50  BANK 128  SETBIT хот	рег╞7, 7  POKE $D031, $E8 ' 1110 1000 = х640,фаст,аттр,ж400  ' MOVE сцрнптр TO BANK4 - $8000  WPOKE сцрнптрлсб, $8000  POKE сцрнптрбнк,$04  ' LET ALL SPRITES BE 64 BITS WIDE  POKE спрь64ен, 255  ' LET ALL SPRITES BE 64 BITS HIGH  POKE спрхгтен	, 255  POKE спрхгт, 64  ' $4,0000 +------------------+  '         ! спрптр (8 WORDS) !  ' $4,0040 +------------------+ <-- SPRPTR $1001  '         ! мусе.дат         !  '         ! ========         !  '         ! мусе#1 - FRAME 0 !  ' $4,0240 +.		.................+ <-- SPRPTR $1001 + 8  '         ! мусе#1 FRAMES1-5 !  ' $4,0е40 +..................+ <-- SPRPTR $1001 + 8*6  '         ! мусе#2 FRAMES0-5 !  ' $4,1а40 +..................+ <-- SPRPTR $1001 + 8*12  '         ! мусес#3 TO #8    !  	
' $4,6040 +..................+  '         ! 32 X ргб палетте !  ' $4,6ца0 +..................+  '         ! OLI - FRAME 0    !  ' $4,7ц40 +------------------+  '         ! папер.дат        !  '         ! =========        !  '         ! папер - FRA	ME 0  !  ' $4,7ц80 +..................+  '         ! папер - FRAME 1  !  ' $4,7цц0 +..................+  '         ! папер FRM 2-12   !  ' $4,7ф80 +------------------+  ' $4,8000 +------------------+  '         ! сцреен мем 80X50 !  ' $4,8фа0 +-	-----------------+  ' $5,0000 +------------------+  '         ! оли.дат          !  ' $5,фа00 +------------------+  ' ENFORCE SPRITES INTO банк4 AND спрптр16 BIT TURNED ON  POKE спрптрбнк, 4+128             WPOKE спрптрадр, 0  ' BLACK OUT PALET	TE  EDMA 3, $300, 0, $FFD3100  ' CLEAR 80X50 CHARS AND COLOUR RAM  EDMA 3, 4000, 160, $48000  EDMA 3, 4000, 6, $FF80000  ' FOR IDX=0 TO 3999:POKE $48000+IDX,160:POKE $FF80000+IDX,6:NEXT IDX  ' SWITCH PALETTE  #DECLARE RED,GREEN,BLUE  LOC=$46040	  FOR IDX=0 TO 31    RED=PEEK(LOC):LOC=LOC+1    GREEN=PEEK(LOC):LOC=LOC+1    BLUE=PEEK(LOC):LOC=LOC+1    ' PRINT "R=";RED;", G=";GREEN;", B=";BLUE    POKE $D100+IDX,RED    POKE $D200+IDX,GREEN    POKE $D300+IDX,BLUE  NEXT IDX  FOR K = 0 TO 7 	   MOVSPR K, 0#0  NEXT K          ' DISPLAY SPRITE  #DECLARE SPRCLR,OFFX  SPRCLR = 30  OFFX=25  SPRITE 0,1,SPRCLR  MOVSPR 0,0+OFFX,50  SPRITE 1,1,SPRCLR  MOVSPR 1,85+OFFX,50  SPRITE 2,1,SPRCLR  MOVSPR 2,171+OFFX,50  SPRITE 3,1,SPRCLR  MOVSP	R 3,256+OFFX,50  SPRITE 4,1,SPRCLR  MOVSPR 4,0+OFFX+8,180  SPRITE 5,1,SPRCLR  MOVSPR 5,85+OFFX+8,180  SPRITE 6,1,SPRCLR  MOVSPR 6,171+OFFX,180  SPRITE 7,1,SPRCLR  MOVSPR 7,256+OFFX,180  ' POINT SPRITE0 TO $4040  BANK 4  FOR K=0 TO 14 STEP 2	    WPOKE K, $1001+8*(3*K)  NEXT K  ' SET BACKGROUND, BORDER  BACKGROUND 6  BORDER 14  IDX = 0  ^^OI=0:OD=0  COUNTER = 0  RETURN/----.P7╞LOOP'----  ' SELECT SPRITE FRAME  BANK 4  FOR K=0 TO 7    WPOKE K*2, $1001+8*(IDX+6*K)  NEXT K 	 GOSUB DRAWOLIVIA  GOSUB POLL╞PLAY  SLEEP .3  IDX=IDX+1  IF IDX=6 THEN IDX=0  COUNTER = COUNTER + 1  IF COUNTER < 30 THEN GOTO P7╞LOOP  RETURN'-----.P7╞ENDER'-----  FOR IDX = 0 TO 7    SPRITE IDX,0  NEXT IDX  ' SWITCH TO 80X25  BANK 1	28  POKE $D031, $E0 ' 1110 0000 = х640,фаст,аттр  ' RESTORE сцнптр TO BANK 0 - $0800  WPOKE сцрнптрлсб, $0800  POKE сцрнптрбнк, 0  PALETTE RESTORE  PLAY  PRINT "⌠";  BOOT'----------.DRAWOLIVIA'----------  #DECLARE X,Y,Z,BVAL,OLIDX  ^^IF 	OI=0 THEN LO=$460A0  ^^IF OI>0 THEN LO=$50000+4000*(OI-1)  LOC=$46CA0 ' FIRST OLIVIA FRAME  ^^EDMA 0,4000,LO,$FF80000  ^^IF OD = 0 THEN OI = OI + 1:IF OI > 8 THEN OD = 1:OI=8  ^^IF OD = 1 THEN OI = OI - 1:IF OI < 1 THEN OD = 0  RETURN'========	==.INIT╞MUSIC'==========  PLAY  TEMPO 17  BAR╞INDEX=0  MAP╞BAR╞TO╞CHUNK(0)=0  MAP╞BAR╞TO╞CHUNK(1)=0  MAP╞BAR╞TO╞CHUNK(2)=1  MAP╞BAR╞TO╞CHUNK(3)=2  MAP╞BAR╞TO╞CHUNK(4)=2  MAP╞BAR╞TO╞CHUNK(5)=3  MAP╞BAR╞TO╞CHUNK(6)=4  MAP╞BAR╞TO╞CHUNK(7)=2  M	AP╞BAR╞TO╞CHUNK(8)=2  MAP╞BAR╞TO╞CHUNK(9)=3  MAP╞BAR╞TO╞CHUNK(10)=4  MAP╞BAR╞TO╞CHUNK(11)=5  MAP╞BAR╞TO╞CHUNK(12)=6  MAP╞BAR╞TO╞CHUNK(13)=7  MAP╞BAR╞TO╞CHUNK(14)=8  MAP╞BAR╞TO╞CHUNK(15)=9  MAP╞BAR╞TO╞CHUNK(16)=9  MAP╞BAR╞TO╞CHUNK(17)=10  MAP╞BA	R╞TO╞CHUNK(18)=11  MAP╞BAR╞TO╞CHUNK(19)=12  MAP╞BAR╞TO╞CHUNK(20)=13  MAP╞BAR╞TO╞CHUNK(21)=14  MAP╞BAR╞TO╞CHUNK(22)=15  ENVELOPE 8,0,12,3,7  ENVELOPE 1,0,9,9,12,2,2048  ' *** INTRO WAILING ***  ' ---------------------  V1$(0)="O5T4M9WFFFHF"  V	2$(0)="O3T5M0SP0CP1O5RCRCRCRCRCRCRCR P0O5CRP1O3CRCRCRCRCRCRCR P0O4GR P1O2GRGRGRGRGRGRGR P0O4ER P1O2ERERER"  V3$(0)="M1P0T6O1IFE#DEFD#DEFE#DEFE#DEFE#DEFE#DEFE#DE"  V4$(0)="O5T4M9W#F#F#FH#F"  V5$(0)="O3T5M0SP0#CP1O5R#CR#CR#CR#CR#CR#CR#CR P0O5#CRP1O3#CR#	CR#CR#CR#CR#CR#CR P0O4#GR P1O2#GR#GR#GR#GR#GR#GR#GR P0O4#ER P1O2#ER#ER#ER"  V6$(0)="M1T9O6SEGEG#D#F#D#FDFDF#CE#CE FAFAE#GE#G#DG#DGD#FD#F GBGB#F#A#F#AFAFAE#GE#G FA#F#AFA#F#A"  ' *** FIRST RIFF ***  ' ------------------  V1$(1)="T7P0M1O2QFO3C O2IGGGGG	GGGGGGG O2QFO3C O2IGGGGGGGGGGGG"  V2$(1)="T9 P0O6 QFE SGR P2O2GRGRGRGRGRGRGRGRGRGRGR":V2$(1)=V2$(1)+V2$(1)  V3$(1)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR"  V4$(1)="T7P0M1QO3CG IDDDDDDDDDDDD QO3CG IDDDDDDDDDDDD"  	V5$(1)="T9 P0O5QAG SBR P1O1BRBRBRBRBRBRBRBRBRBRBR":V5$(1)=V5$(1)+V5$(1)  V6$(1)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR"  ' REM *** I'M ALIVE! ***  ' ---------------------  V1$(2)="T7M5O5QP0GG GRIRP7 E#F QGIGQG#F	E HE SEDE#FE#F HDIR"  V2$(2)="T7P0M1O2QFO3C O2QGGIGQGIO3C O2QEEIEQEIA QCCICQCIE QDD"  V3$(2)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR"  V4$(2)="T7M5O6QP0FP9SEDEF QDRIR T0O6P0EP8#F QGIGQG#FE HE SEDE#FE#F HDIR"  V5$(	2)="T7P0M1O3QCG DDIDQDIG O2QBBIBQBO3IE O2 QGGIGQGIB QAA"  V6$(2)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR"#IFDEF фуллсонг  ' *** SEEMS LIKE FOREVER ***  V1$(3)="T7M5O5QP0IDP5SCDICSO4BO5C QO4BIO5CQC T2P0IEP5G#F QRR	 T7M5O5P0IDP5SCDICSO4BO5C QO4BIO5CQC T2P0IEP5G#F Q.R P0T7I#D P7S#DD#DE#FE#FGHGR"  V2$(3)="T7P0M1O3QDO2#F QAA IO3ECEQDIDDD O3QDO2#F QAA IO3ECEQDIDDD EE#F#F Q.EIEEEEE"  V3$(3)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O	1GR O2GR O1GG O2GR O1GG O2GR"  V4$(3)="T0M4O4P0IDP8SCDICSO3BO4C QO3BIO4CQC O5T2P0IGP5BA QRR T0M4O4P0IDP8SCDICSO3BO4C QO3BIO4CQC O5T2P0IGP5BA Q.R O4P0T0I#DP9S#DD#DE#FE#FGHGR"  V5$(3)="T7P0M1O3QAD EE IGEG Q#F I#F#F#F QAD EE IGEG Q#F I#F#F#F GGAA Q.B IBBB	 BB"  V6$(3)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  ' *** IM ALIVE (CHORUS1) ***  ' --------------------------  V1$(4)="T7M5O5P0QAA P3H.BP1QAQ.AIR QP0AA P3H.BP1QAQ.AIR"  V2$(4)="T	!7P0M1O3QDDIGGGGGGGG DDDDDDDD GGGGGGGG DDDD"  V3$(4)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  V4$(4)="T7M5O6P0QDDWDQDR DDWDQDR"  V5$(4)="T7P0M1O3QAA O4IDDDDDDDD O3IAAAAAAAA O4DDDDDDDD 	"O3IAAAA"  V6$(4)="T3O2 IBRBR O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR O1GR O2GR O1GG O2GR O1GG O2GR"  ' *** I'M ALIVECLOSE(CHORUS2 ENDING) ***  ' --------------------------------------  V1$(5)="T7M5O5P0QAA HBIAB O6CO5HBIRSAP9	#GABABGA W.G"  V2$(5)="T7P0M1O3QDD GG#F#FEEDDW.C"  V3$(5)="T3O2 IBRBR O1GR GR O2 GR O1 GR GR GR O2 GR O1 GR T0O2P0S#CR O5P1 #CR#CR#CR#CR#CR#CR#CR#CR#CR#CR#CR"  V4$(5)="T7M5O5P0Q#F#F HGI#FGAHGIRS#FP9E#FG#FGE#F W.C"  V5$(5)="T7P0M1O3QAA O4DDCCO3BBAAW.G"	$  V6$(5)="T3O2 IBRBR O1GR GR O2 GR O1 GR GR GR O2 GR O1 GR T0O2P0SCR O5P1 CRCRCRCRCRCRCRCRCRCRCR"  ' *** INSTRUMENTAL ***  ' --------------------  V1$(6)="T7M5P5O5 QRR R Q.G IED O4QB IO5DEG P0SDO4BO5DEDO4BIP9G O4IEGGEQGIE QBO5IDDO4BO5QDE P9O5R Q.GIE	%DQESGEGEIGBO6DO5SP0BAIG"  V1$(6)=V1$(6)+"O5QP9IBP0SGBO6IDO5SBO6D SP0G#FDO5B O6#FDO5BG P9IBO6CDO5IB"  V2$(6)="T7P0M1O2QFO3C O2QGGIGQGIO3C O2QEEIEQEIA O1QAAIAQAIO2E QDD  FO3C O2QGGIGQGIO3C O2QEEIEQEIA O1QAAIAQAIO2E QDD"  V3$(6)="P0T3O2 IBRBR O1GR O2GR O	&1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR":V3$(6)=V3$(6)+V3$(6)  V4$(6)="QRRT2P0SO6B#F#AFAE#G#DGD#F#CFCEO5BO6#DO5#AO6DO5AO6#CO5#GO6CO5GB#F#AFAE#GDO3SCRP2T7O6CRCRCRCRCRCRCRCRCRCRCRCRCRGRGR"  V4$(6)=V4$(6)+"T6O6P0SDP6O5CO3P9CO2CO5P0SBP6O5CO3P	'9CO2CO5P0SGP6O5CO3P9O1CCO5P0SGP6O5CO3P9O1CC"  V4$(6)=V4$(6)+"O4P0GRP1O2CRCRCRCRCRCRCRT0O5P0SEGEGF#GF#G#FA#FAGBGBT7O6SGP3O2WC"  V5$(6)="T7P0M1O3QCG DDIDQDIG O2QBBIBQBO3IE QEEIEQEIG Q#F#F  CG DDIDQDIG O2QBBIBQBO3IE QEEIEQEIG Q#F#F"  V6$(6)="P0T3O2 IBRBR  O1GR O2GR O1GG O2GR O1GR O2GR BRBR O1GR O2GR O1GG O2GR O1GR O2GR":V6$(6)=V6$(6)+V6$(6)  ' *** SUDDENLY CAME THE DAWN ***  ' ------------------------------  V1$(7)="T7M5O5QP0IDP5SCDICSO4BO5C QO4BIO5CQC T2P0IEP5G#F QRR T7M5O5P0IDP5SCDICSO4BO5C QO4BIO5
BLOAD "OLI.DAT",P($50000),R  ' DISABLE ANY 64-BIT WIDE SPRITES  POKE спрь64ен, 0  ' ALL SPRITES NORMAL HEIGHT  POKE спрхгтен, 0  ' ENFORCE SPRITES INTO банк4 AND спрптр16 BIT TURNED ON  POKE спрптрбнк, 4+128  WPOKE спрптрадр, 0  ' PREPARE ALL
 SPRITE  FOR K = 0 TO 7    SPRITE╞FRAME╞IDX(K) = INT(RND(1)*13)    SPRITE╞X(K) = 30+40*K    SPRITE╞Y(K) = INT(RND(1)*5)*5    SPRITE K, 1, 15    MOVSPR K, 0#0    MOVSPR K, SPRITE╞X(K), SPRITE╞Y(K)    WPOKE ($40000+K*2), $11F1 + SPRITE╞FRAME╞IDX(K)
  NEXT K  FADEVAL = 0  RETURN.STORE╞CURR╞COLOURS'------------------  FOR K = 0 TO 31    CURR╞RED(K)=PEEK($D100+K)    CURR╞GREEN(K)=PEEK($D200+K)    CURR╞BLUE(K)=PEEK($D300+K)  NEXT K  RETURN.P1╞LOOP'-------  ' DROP PAPER SPRITES DOWN  I
F STATE < 4 AND MUSE╞STATE=0 THEN BEGIN    FOR K = 0 TO 7      IF INT(RND(1)*3) = 0 THEN BEGIN        SPRITE╞FRAME╞IDX(K) = MOD(SPRITE╞FRAME╞IDX(K)+1,13)      BEND      IF SPRITE╞Y(K) < 247 THEN BEGIN        SPRITE╞Y(K) = SPRITE╞Y(K) + INT(RND(1)*3
)        SPRITE╞X(K) = SPRITE╞X(K) + INT(RND(1)*5)-2        MOVSPR K, SPRITE╞X(K), SPRITE╞Y(K)        WPOKE ($40000+K*2), $11F1 + SPRITE╞FRAME╞IDX(K)      BEND    NEXT K  BEND  GOSUB POLL╞PLAY  SLEEP .025  ' FADE IN TO GREY  ' ---------------
  IF STATE = 0 THEN BEGIN    IF MOD(COUNTER,5)=0 THEN BEGIN      GOSUB FADE╞COLOURS╞TO╞GREY      FADEVAL = FADEVAL + 1      IF FADEVAL > 16 THEN STATE = STATE + 1:FADEVAL = 0:GOSUB STORE╞CURR╞COLOURS:COUNTER=0    BEND    COUNTER = COUNTER + 1  BE
ND  ' EBB-FADE TO COLOURS FOR DEFAULT PALETTE  ' ---------------------------------------  IF STATE = 1 THEN BEGIN    FADEVAL = DEFCOLVAL    STARTCOL = 0:ENDCOL = 15    IF COUNTER > 3 THEN ENDCOL = 31    GOSUB FADE╞COLOURS╞TO╞DEFAULTS    DEFCOLVA
L = DEFCOLVAL + DEFCOLDIR    IF DEFCOLVAL = 16 THEN DEFCOLDIR=-1    IF DEFCOLVAL = 0 THEN DEFCOLDIR=1:COUNTER=COUNTER+1    IF COUNTER = 6 AND DEFCOLVAL = 15 AND DEFCOLDIR=-1 THEN STATE=STATE+1:COUNTER=0  BEND  ' COLOUR-CYCLE MUSES  ' -------------
	-----  IF STATE = 2 THEN BEGIN    DIST = DIST + VEL    IF DIST >= 1 THEN BEGIN      DIST = DIST - 1      COUNTER = COUNTER + 1      STARTCOL = 16:ENDCOL = 31      GOSUB CYCLE╞COLOURS      IF COUNTER > 16*2 THEN VEL=VEL*.93      IF COUNTER = 16*3

-1 THEN STATE = 3:PALETTE RESTORE:COUNTER=0:DEFCOLVAL=0:DEFCOLDIR=2    BEND  BEND  IF STATE = 3 THEN GOSUB HIGHLIGHT╞CURR╞MUSE  IF STATE = 4 THEN GOSUB FADE╞OUT  IF STATE = 5 THEN GOSUB FADE╞OUT  ' BAIL OUT TO OLIVIA?  IF STATE = 5 AND CURR╞MU
SE = 8 AND MUSE╞STATE=0 THEN RETURN  IF STATE = 6 THEN GOSUB FOCUS╞MUSE  ' GET A$:IF A$="" THEN GOTO P1╞LOOP  GOTO P1╞LOOP.FOCUS╞MUSE'----------  IF MUSE╞STATE = 0 THEN BEGIN    GOSUB INIT╞MUSE╞SPRITES    MUSE╞STATE=1    COUNTER = 0    PRIN
T "⌠";    RETURN  BEND  IF MUSE╞STATE = 1 THEN BEGIN    FADEVAL=COUNTER    GOSUB FADE╞COLOURS╞TO╞DEFAULTS    IF COUNTER=16 THEN COUNTER=0:MUSE╞STATE=2  BEND  IF MUSE╞STATE = 2 THEN GOSUB SHOW╞THANKS  IF MUSE╞STATE = 3 THEN BEGIN    FADEVAL=CO
UNTER    'PRINT "";CHR$(27);"Q";FADEVAL;:GETKEY S$    STARTCOL=0:ENDCOL=31:GOSUB FADE╞COLOURS╞TO╞BLACK    IF COUNTER = 16 THEN COUNTER=0:MUSE╞STATE = 4  BEND  IF MUSE╞STATE = 4 THEN BEGIN    'PRINT "";CHR$(27);"Q MUSE╞STATE=4";FADEVAL;:GETKEY S$
    FOR K = 0 TO 7:SPRITE K,0:SPR╞ACTIVE(K)=0:NEXT K    BANK 128    GOSUB RESTORE╞SCREEN    CURR╞MUSE = CURR╞MUSE + 1    MUSE╞STATE = 5    GOSUB STORE╞CURR╞COLOURS    COUNTER = 0  BEND  IF MUSE╞STATE = 5 THEN BEGIN    FADEVAL=COUNTER    START
COL=0:ENDCOL=31:GOSUB FADE╞COLOURS╞TO╞DEFAULTS    IF COUNTER=16 THEN BEGIN      MUSE╞STATE = 6      COUNTER = 0      STATE = 2:DIST = 0:VEL = 1    BEND  BEND  IF MUSE╞STATE > 0 AND MUSE╞STATE < 4 AND STATE=6 THEN BEGIN    GOSUB ANIM╞MUSE╞SPRITES
  BEND    COUNTER = COUNTER + 1  RETURN.DRAW╞CLR╞TEXT'-------------  CURSOR SX+COUNTER,SY:COLOR MOD(COUNTER,16)+16:PRINT MID$(S$,1+COUNTER,1);  IF COUNTER = LEN(S$) THEN COUNTER = -1  RETURN.SHOW╞THANKS'-----------  POKE 53275, 255  IF TH
ANK╞STATE = 0 AND COUNTER > 5 THEN THANK╞STATE = 1:COUNTER=0  IF THANK╞STATE = 1 THEN BEGIN    S$=THANK1$(0):SX=1:SY=0:GOSUB DRAW╞CLR╞TEXT    IF COUNTER <> -1 THEN COUNTER=COUNTER+1:GOSUB DRAW╞CLR╞TEXT    IF COUNTER = -1 THEN THANK╞STATE = 2:THANK╞ID
X=1  BEND  ' PAUSE  IF THANK╞STATE = 2 AND COUNTER > 5 THEN BEGIN    THANK╞STATE = 3:COUNTER = 0  BEND  ' DRAW NEXT NAME  IF THANK╞STATE = 3 THEN BEGIN    IF THANK╞IDX < 16 THEN BEGIN      S$=THANK1$(THANK╞IDX)      IF MOD(THANK╞IDX,2) = 1 THEN
 SX=10-LEN(S$)/2:ELSE SX=70-LEN(S$)/2      SY = INT((THANK╞IDX-1) / 2)*3 + 3      GOSUB DRAW╞CLR╞TEXT      IF COUNTER <> -1 THEN COUNTER=COUNTER+1:GOSUB DRAW╞CLR╞TEXT    BEND    IF COUNTER = -1 OR THANK╞IDX=16 THEN BEGIN      THANK╞IDX = THANK╞IDX 
+ 1      IF THANK╞IDX > 16 THEN BEGIN        THANK╞STATE = 4        MUSE╞STATE=3        COUNTER=0        PALETTE RESTORE        GOSUB STORE╞CURR╞COLOURS      BEND:ELSE THANK╞STATE = 2    BEND  BEND  ' 2ND PAGE OF THANKS  IF CURR╞MUSE >= 1 AND
 CURR╞MUSE <=4 THEN GOSUB THANKS╞2  ' 3RD PAGE OF THANKS  IF CURR╞MUSE >=5 AND CURR╞MUSE <=6 THEN GOSUB THANKS╞3  ' 4TH PAGE OF THANKS  IF CURR╞MUSE = 7 THEN GOSUB THANKS╞4  IF THANK╞STATE<>4 AND THANK╞STATE<>8 THEN BEGIN    STARTCOL=16:ENDCOL=3
1:GOSUB CYCLE╞COLOURS  BEND  RETURN.THANKS╞2'--------  IF THANK╞STATE = 4 AND COUNTER > 10 THEN THANK╞STATE = 5:COUNTER=0  IF THANK╞STATE = 5 THEN BEGIN    S$=THANK2$(0):SX=40-LEN(S$)/2:SY=0:GOSUB DRAW╞CLR╞TEXT    IF COUNTER > -1 THEN COUNTER=C
OUNTER+1:GOSUB DRAW╞CLR╞TEXT    IF COUNTER = -1 THEN THANK╞STATE = 6:THANK╞START╞IDX=1+(CURR╞MUSE-1)*4:THANK╞IDX=THANK╞START╞IDX  BEND  ' PAUSE  IF THANK╞STATE = 6 AND COUNTER > 5 THEN BEGIN    THANK╞STATE = 7:COUNTER = 0  BEND#DEFINE маь╞схоутс╞
пер╞паге = 4  ' DRAW NEXT SHOUT OUT  IF THANK╞STATE = 7 THEN BEGIN    IF THANK╞IDX-THANK╞START╞IDX < маь╞схоутс╞пер╞паге THEN BEGIN      S$=THANK2$(THANK╞IDX)      SX=40-LEN(S$)/2      SY=(THANK╞IDX - THANK╞START╞IDX) * 3 + 3      IF SY > 6 THEN S
Y = SY + 11      GOSUB DRAW╞CLR╞TEXT      IF COUNTER > -1 THEN COUNTER=COUNTER+1:GOSUB DRAW╞CLR╞TEXT    BEND    IF COUNTER = -1 OR THANK╞IDX-THANK╞START╞IDX=маь╞схоутс╞пер╞паге THEN BEGIN      THANK╞IDX = THANK╞IDX + 1      IF THANK╞IDX - THANK╞STA
RT╞IDX >= маь╞схоутс╞пер╞паге+1 THEN BEGIN        THANK╞STATE = 4        IF CURR╞MUSE = 4 THEN THANK╞STATE = 8        MUSE╞STATE=3        COUNTER=0        PALETTE RESTORE        GOSUB STORE╞CURR╞COLOURS      BEND:ELSE THANK╞STATE = 6    BEND  BE
ND  RETURN.THANKS╞3'--------  IF THANK╞STATE = 8 AND COUNTER > 10 THEN THANK╞STATE = 9:COUNTER=0  IF THANK╞STATE = 9 THEN BEGIN    S$=THANK3$(0):SX=40-LEN(S$)/2:SY=0:GOSUB DRAW╞CLR╞TEXT    IF COUNTER > -1 THEN COUNTER=COUNTER+1:GOSUB DRAW╞CLR╞TE
XT    IF COUNTER = -1 THEN THANK╞STATE = 10:THANK╞START╞IDX=1+(CURR╞MUSE-5)*30:THANK╞IDX=THANK╞START╞IDX  BEND  ' PAUSE  IF THANK╞STATE = 10 AND COUNTER > 5 THEN BEGIN    THANK╞STATE = 11:COUNTER = 0    IF THANK╞IDX-THANK╞START╞IDX >= 30 THEN BEGIN
      THANK╞STATE = 12      IF CURR╞MUSE = 5 THEN THANK╞STATE = 8      MUSE╞STATE = 3      COUNTER = 0      PALETTE RESTORE      GOSUB STORE╞CURR╞COLOURS      RETURN    BEND  BEND  ' DRAW NEXT NAME  IF THANK╞STATE = 11 THEN BEGIN    IF THANK
╞IDX-THANK╞START╞IDX < 30 THEN BEGIN      S$=THANK3$(THANK╞IDX)      FOR K = 1 TO LEN(S$)        IF MOD(THANK╞IDX,2) = 1 THEN SX=10-LEN(S$)/2:ELSE SX=70-LEN(S$)/2        SY = INT((THANK╞IDX-THANK╞START╞IDX) / 2) + 5        GOSUB DRAW╞CLR╞TEXT      
  COUNTER = COUNTER + 1      NEXT K    BEND    THANK╞IDX = THANK╞IDX + 1    THANK╞STATE = 10:COUNTER = 0  BEND  RETURN.THANKS╞4'--------  IF THANK╞STATE = 12 AND COUNTER > 10 THEN THANK╞STATE = 13:COUNTER=0  IF THANK╞STATE = 13 THEN BEGIN   
  S$=THANK4$(0):SX=40-LEN(S$)/2:SY=0:GOSUB DRAW╞CLR╞TEXT    IF COUNTER > -1 THEN COUNTER=COUNTER+1:GOSUB DRAW╞CLR╞TEXT    IF COUNTER = -1 THEN THANK╞STATE = 14:THANK╞IDX=1  BEND  ' PAUSE  IF THANK╞STATE = 14 AND COUNTER > 5 THEN BEGIN    THANK╞STATE
! = 15:COUNTER = 0  BEND  ' DRAW NEXT SHOUT OUT  IF THANK╞STATE = 15 THEN BEGIN    IF THANK╞IDX-1 < маь╞схоутс╞пер╞паге THEN BEGIN      S$=THANK4$(THANK╞IDX)      SX=40-LEN(S$)/2      SY=(THANK╞IDX - 1) * 3 + 3      IF SY > 6 THEN SY = SY + 11  
"    GOSUB DRAW╞CLR╞TEXT      IF COUNTER > -1 THEN COUNTER=COUNTER+1:GOSUB DRAW╞CLR╞TEXT    BEND    IF COUNTER = -1 OR THANK╞IDX-1=маь╞схоутс╞пер╞паге THEN BEGIN      THANK╞IDX = THANK╞IDX + 1      IF THANK╞IDX - 1 >= маь╞схоутс╞пер╞паге+1 THEN BEGIN
#        THANK╞STATE = 16        MUSE╞STATE=3        COUNTER=0        PALETTE RESTORE        GOSUB STORE╞CURR╞COLOURS      BEND:ELSE THANK╞STATE = 14    BEND  BEND  RETURN.ANIM╞MUSE╞SPRITES'-----------------  NEXT╞CNT = NEXT╞CNT + 1  IF NEX
$T╞CNT = 5 THEN BEGIN    NEXT╞CNT = 0    BANK 4      WPOKE NEXT╞SPR*2,$1001+8*(NEXT╞FRM + 6 * CURR╞MUSE)      WPOKE 0,WPEEK(NEXT╞SPR*2)    BANK 128    MOVSPR NEXT╞SPR, 150, 120    MOVSPR 0, 150, 120    MOVSPR NEXT╞SPR, SPR╞ANGLE#1    SPR╞ANGLE=MO
%D(SPR╞ANGLE+10,360)    SPRITE NEXT╞SPR, 1, GREYS(0)    SPRITE 0, 1, 1    SPR╞ACTIVE(NEXT╞SPR) = 1    NEXT╞SPR = MOD(NEXT╞SPR+5, 7)+1    NEXT╞FRM = MOD(NEXT╞FRM+1, 6)  BEND  FOR K = 1 TO 7    IF SPR╞ACTIVE(K)>0 THEN BEGIN      SPR╞ACTIVE(K)=SPR╞
&ACTIVE(K)+1      FADEVAL=SPR╞ACTIVE(K)/10      IF FADEVAL < 3 THEN BEGIN        SPRITE K, 1, GREYS(FADEVAL)      BEND:ELSE SPRITE K, 0:SPR╞ACTIVE(K)=0    BEND  NEXT K  RETURN.INIT╞MUSE╞SPRITES'-----------------  ' TURN OF ALL SPRITES  FOR K =
' 0 TO 7    SPRITE K, 0    MOVSPR K, 160, 80  NEXT K  POKE спрь64ен, 255  POKE спрхгтен, 255  POKE спрхгт, 64  POKE спрптрбнк, 4+128  WPOKE спрптрадр, 0  RETURN.SAVE╞SCREEN  ^^EDMA 0, $7D0, $800, $48000  ^^EDMA 0, $7D0, $1F800, $49000  RETU	 RN.RESTORE╞SCREEN  ^^EDMA 0, $7D0, $48000, $800  ^^EDMA 0, $7D0, $49000, $1F800  RETURN.FADE╞OUT'--------  FADEVAL = COUNTER  GOSUB FADE╞COLOURS╞TO╞BLACK  COUNTER = COUNTER + 1  IF COUNTER > 16 THEN STATE = STATE + 1:STARTCOL=0:ENDCOL=31:COUN#OUTPUT "BIGSPRITE"#DEFINE фуллсонг=1'============.DECLARATIONS'============  ' MUSIC RELATED VARS  ' ------------------  #DECLARE MUSIC╞CHUNK╞INDEX     ' OLD T  #DECLARE BAR╞INDEX             ' OLD TT  #DECLARE MAP╞BAR╞TO╞CHUNK(25)  ' OLD M()  #DECLARE V1$(15), V2$(15), V3$(15), V4$(15), V5$(15), V6$(15)  ' PALETTE  ' -------  #DECLARE DEFAULT╞RED(32)  #DECLARE DEFAULT╞GREEN(32)  #DECLARE DEFAULT╞BLUE(32)  #DECLARE CURR╞RED(32)  #DECLARE CURR╞GREEN(32)  #DECLARE CURR╞BLUE(32)  #DECLARE FADEVAL, TEMPVAL  #DECLARE GREY  #DECLARE TEMPR, TEMPG, TEMPB  #DECLARE VEL=1,DIST=0  ' MISC  '-----  #DECLARE A$ = ""  #DECLARE IDX = 0  #DECLARE VALUE = 0  #DECLARE LOC  #DECLARE K  #DECLARE SPRITE╞FRAME╞IDX(8)  #DECLARE SPRITE╞X(8)  #DECLARE SPRITE╞Y(8)  #DECLARE STATE = 0  #DECLARE COUNTER = 0  #DECLARE DEFCOLVAL = 0, DEFCOLDIR=1, ALTCOLVAL = 0, ALTCOLDIR=1  #DECLARE STARTCOL, ENDCOL  #DECLARE CURR╞MUSE = 0#DECLARE THANK╞STATE = 0#DECLARE THANK╞IDX = 0#DECLARE S$,SX,SY#DECLARE THANK1$(15)THANK1$(0)="A BIG THANK YOU TO THE CORE MEGA65 TEAM FOR ALL THEIR EFFORTS OVER THE YEARS!"THANK1$(1)="HIGHLANDER"THANK1$(2)="DEFT"THANK1$(3)="SERIOUSLY"THANK1$(4)="ADTBM"THANK1$(5)="FALK/BLUEWAYWS"THANK1$(6)="ANTTI-BRAIN"THANK1$(7)="DOUBLEFLASH"THANK1$(8)="BIT SHIFTER"THANK1$(9)="LGB"THANK1$(10)="SY2002"THANK1$(11)="TAYGER"THANK1$(12)="LYDON"THANK1$(13)="M3WP"THANK1$(14)="FERALCHILD"THANK1$(15)="INDIOCOLIFA"#DECLARE THANK2$(16)THANK2$(0)="EXTRA SHOUT OUTS TO:"THANK2$(1)="TRENZ ELECTRONICS AND THE MOULDS TEAM!"THANK2$(2)="DEATHY FOR ALL YOUR PASSION AND DEDICATION TO THE MEGA65!"THANK2$(3)="BIT SHIFTER FOR ALL THE GREAT BASIC 65 ENHANCEMENTS!"THANK2$(4)="LYDON FOR ALL YOUR EFFORTS PREPARING BATCH#2!"THANK2$ та' ---' 4.2бц0 фрее.DECLARES'--------  #DECLARE спрь64ен = $D057  #DECLARE спрхгтен = $D055  #DECLARE спрхгт   = $D056  #DECLARE сцрнптрлсб = $D060  #DECLARE сцрнптрбнк = $D062  #DECLARE спрптр16 = $D06E  #DECLARE спрптрадр = $D06C  #DEC	(5)="SY2002, MJOERGEN AND LYDON FOR ALL THE ADDITIONAL CORES!"THANK2$(6)="DDDAAANNN FOR ALL YOUR DOCUMENTATION, TOOLING AND COMMUNITY-BUILDING!"THANK2$(7)="TAYGER FOR MEGA65CONNECT AND THE 'FILES.MEGA65.ORG' FILEHOST!"THANK2$(8)="IMPAKT FOR THE DETERM
INED AND THOROUGH MANUAL PROOF-READING!"THANK2$(9)="THECHIEF FOR YOUR EFFORTS SUPPORTING THE NEXYS BOARD!"THANK2$(10)="HOJO FOR THE AWESOME NEW FRONT COVERS YOU MADE FOR ALL OUR MANUALS!"THANK2$(11)="AMOK FOR ALL YOUR DOCUMENTATION EFFORTS!"THANK2$(12)="UBIK FOR THE AWESOME ELEVEN IDE!"THANK2$(13)="MAURICE FOR TESTING EVERY SINGLE BASIC 65 EXAMPLE IN THE MANUAL!"THANK2$(14)="RETROCOMBS, PERIFRACTIC AND RB-JEFFREY FOR YOUR AWESOME YOUTUBE VIDS!"THANK2$(15)="MINDRAIL FOR THE MACGUYVER-JTAG VIDEO!"THANK2$(16)="DEFT AND ADTBM FOR ALL YOUR 'HELLO MEGA65 COMMUNITY' VIDEOS!"#DECLARE THANK3$(60)THANK3$(0)="THANKS TO ALL THE 1ST GEN DEVELOPERS THAT MADE DEMOS, UTILITIES AND GAMES!"THANK3$(1)="ADTBM"THANK3$(2)="AIRJURI"THANK3$(3)="AKMAFIN"THANK3$(4)="AMOK"THANK3$(5)="DDDAAANNN"THANK3$(6)="DEATHY"THANK3$(7)="DEFT"THANK3$(8)="DEXTROUS"THANK3$(9)="DILLOF"THANK3$(10)="DIRK"THANK3$(11)="DOCSTER"THANK3$(12)="EGONOLSEN71"THANK3$(13)="ELCH"THANK3$(14)="ENDURION"THANK3$(15)="FERALCHILD"THANK3$ = (X+OFFS) AND 255        DIDX% = DIDX% + 1      LDATA&(DIDX%) = (X+OFFS) / 256 + REV╞FLAG& * $80        DIDX% = DIDX% + 1    BEND:ELSE BEGIN      LDATA&(DIDX%) = (X+OFFS) + REV╞FLAG& * $80        DIDX% = DIDX% + 1          BEND    LDATA&(DIDX%)= (X+OFFS) AND 255        DIDX% = DIDX% + 1      LDATA&(DIDX%) = (X+OFFS) / 256 + REV╞FLAG& * $80        DIDX% = DIDX% + 1    BEND:ELSE BEGIN      LDATA&(DIDX%) = (X+OFFS) + REV╞FLAG& * $80        DIDX% = DIDX% + 1          BEND    LDATA&(DIDX%) ├╛╩├╒┘╒╒┐©║║║║║┌	©	©│©║╩├╛║├║║║║║	║
╪
╬┤	╩╛┤©├╛┘╒╪╩┐╪╒╪Ъ│║╩┌║╪╩╬╛┌║┌║┌║┌║	╬	╒	©╛┌©╒└╒©║┘╬└╒╒┌╬┐╒©╩╪╩║┘	©	╒	©Ъ©║╩└╒┐╒╛║│║║║│║║	╪┐	╒	╬= Y      DIDX% = DIDX% + 1    LDATA&(DIDX%) = ASC(A$)      DIDX% = DIDX% + 1        OLDX=X : OLDY=Y : OLDOFFS=OFFS  BEND  RETURN  '------------  .RESTORE╞CHAR'------------  IF MODIFIED% THEN BEGIN    LOC = $FF80000 + X + 80 * Y    POKE LO└║©┐║Ъ║╛╩┌║┌║║║║│║│║┌	╒╒╬╛╬║┘║┘║║╩└╒┐©┌╩Ъ╒╒╩┘ └╒┐©┌©©╒┌ ┌║┌║┌║║║║│	╒│	╒©│©│©┌╪┐╒╒╒└	╒┘	╒║║╪┌╩┌╬┌╬╒©└©└©Ъ┘╪┘╪╬╒└╒╒┌©┌©│║║║┌║┌║┌	©┌	©	©╛┌╛┐╒╒(16)="FREDRIKR"THANK3$(17)="GEEHAF"THANK3$(18)="GEIRS"THANK3$(19)="GRIM-FANDANGO"THANK3$(20)="GRUBI"THANK3$(21)="HEATH-MAN"THANK3$(22)="HERNANDP"THANK3$(23)="HSTAMPFL"THANK3$(24)="JAMES"THANK3$(25)="JESPERGRAVGAARD"THANK3$(26)="JOHAN"THANK3$(27)="JOHNWAYNER"THANK3$(28)="KIDRA"THANK3$(29)="KITHKANAN"THANK3$(30)="KRYAN1"THANK3$(31)="LAK132"THANK3$(32)="LIQUIDDREAM"THANK3$(33)="LYDON"THANK3$(34)="M3WP"THANK3$(35)="MAJIKEYRIC"THANK3$(36)="MAURICE"THANK3$(37)="MAXICE"THANK3$(38)="MC64" = Y      DIDX% = DIDX% + 1    LDATA&(DIDX%) = ASC(A$)      DIDX% = DIDX% + 1        OLDX=X : OLDY=Y : OLDOFFS=OFFS  BEND  RETURN  '------------  .RESTORE╞CHAR'------------  IF MODIFIED% THEN BEGIN    LOC = $FF80000 + X + 80 * Y    POKE L$OC, PEEK(LOC) XOR 32    MODIFIED% = 0    T0 = TI  BEND  RETURN'-----------.SHOW╞CURSOR'-----------  IF TI > T0 THEN T0 = TI + .5:ELSE RETURN  LOC = $FF80000 + X + 80 * Y  POKE LOC, PEEK(LOC) XOR 32  MODIFIED% = MODIFIED% XOR 1  RETURN'-#C, PEEK(LOC) XOR 32    MODIFIED% = 0    T0 = TI  BEND  RETURN'-----------.SHOW╞CURSOR'-----------  IF TI > T0 THEN T0 = TI + .5:ELSE RETURN  LOC = $FF80000 + X + 80 * Y  POKE LOC, PEEK(LOC) XOR 32  MODIFIED% = MODIFIED% XOR 1  RETURN'--╒©Ъ╛╪╬╬├║╩┘╒└╒╒┌©│║║║│║│║┌	╒┌	╒	╬╛╬╛╬╩╛└║║	╪	╬├║├║╩╩╩┘╛└╩╛╪╪Ъ║©│©┌╒╩║║╬╛┌║┌║┌║┌	©	©│╛╩╩┘║╒╒║├║├║├©║║├║├║	║┘	╪╩├╬┘╒└╒┐╪╒╪Ъ┤ ┤ ╬╒╒╒┐╒╛╛╬╛╪╒╬©╛╩┘╬┘©║└║└║└║└║└	║	╛┤	©╩╩╒╒└	╩	╪╩©│©│	©│	©	©	©	║│	╩Ъ╪║╛┌╒┐╒╒╒╬╬╬╪┌╩┐ ║┐║┐©┐©║║┐║┐║	╬	╒	©│©Ъ╬╬│║┌╒╩║║┌║┌©║║║│	 ║║╩├╛├╛┘©└╒╒┌╛┌╩©┐THANK3$(39)="MIGHTYAXLE"THANK3$(40)="MR.TOAST"THANK3$(41)="MTEUFEL"THANK3$(42)="N1K0M0"THANK3$(43)="NEOMAN"THANK3$(44)="OZIPHANTOM"THANK3$(45)="RETROCOMBS"THANK3$(46)="SHALLAN50K"THANK3$(47)="SNOOPY"THANK3$(48)="STEPZ"THANK3$(49)="STIGODUMP"THANK3$(50)="SY2002"THANK3$(51)="TAYGER"THANK3$(52)="THECHIEF"THANK3$(53)="UBIK"THANK3$(54)="URBANL"THANK3$(55)="WAULOK"THANK3$(56)="WOMBAT"THANK3$(57)="ZEHA"THANK3$(58)="ZZSILA"THANK3$(59)=""THANK3$(60)=""#DECLARE THANK4$(10)THANK4$(0)="...AND SOME FINAL THANK YOUS TO:"THANK4$(1)="OLIVIA NEWTOWN JOHN, ELO AND JOHN FARRAR, FOR THE WONDERFUL MUSICAL MEMORIES!"THANK4$(2)="SYNTAX PARTY ORGANISERS FOR HOSTING THIS LOVELY EVENT!"THANK4$(3)="MY WIFE, TRAM, AND BUBBY MOANA FOR THEIR LOVE AND SACRIFICE!"THANK4$(4)="...AND THANK YOU MUM TOO, FOR ALWAYS BEING THERE FOR ME!"#DECLARE MUSE╞STATE = 0#DECLARE NEXT╞SPR = 1#DECLARE NEXT╞FRM = 0#DECLARE NEXT╞CNT = 0#DECLARE SPR╞ACTIVE(8)#DECLARE SPR╞ANGLE = 0#DECLARE GREYS(3)GREYS(0)=15:GREYS(1)=12:GREYS(2)=11#DECLARE MUSE╞CLR(9)MUSE╞CLR(0)=20MUSE╞CLR(1)=18MUSE╞CLR(2)=29MUSE╞CLR(3)=26MUSE╞CLR(4)=22MUSE╞CLR(5)=28MUSE╞CLR(6)=16MUSE╞CLR(7)=31MUSE╞CLR(8)=25#DECLARE THANK╞START╞IDX  #DECLARE спрь64ен = $D057  #DECLARE спрхгтен = $D055  #DECLARE спрхгт   = $D056  #DECLARE сцрнптрлсб = $D060  #DECLARE сцрнптрбнк = $D062  #DECLARE спрптр16 = $D06E  #DECLARE спрптрадр = $D06C  #DECLARE спрптрбнк = $D06E  #DECLARE хотрег╞7 = $D05D'----.MAIN'----  POKE $D63C,$F ' SELECT 8580  SID  GOSUB INIT╞DEFAULT╞COLOURS  GOSUB INIT╞MUSIC  GOSUB P1╞DROP╞PAPERS  GOSUB P7╞BIG╞OLIVIA╞WITH╞SPRITES.INIT╞DEFAULT╞COLOURS'--------------------#DECLARE DEBUG╞FLAG = 0  IF PEEK($D020)<>0 AND PEEK($D020)<>2 THEN BEGIN    BORDER 0    POKE $D!018, PEEK($D018) AND $FD    EDMA 0, $300, $FFD3100, $48000    EDMA 3, $300, 0, $FFD3100    ^^BLOAD "MURAL.BIN",P($800),R    ^^BLOAD "MURAL.CLR",P($1F800),R    DEBUG╞FLAG = 1  BEND  FOR K = 0 TO 31    DEFAULT╞RED(K) = PEEK($48000+K)    DEFAULT╞G"REEN(K) = PEEK($48100+K)    DEFAULT╞BLUE(K) = PEEK($48200+K)  NEXT K  IF DEBUG╞FLAG=1 THEN BEGIN    ^^BLOAD "MURAL.BIN",P($48000),R    ^^BLOAD "MURAL.CLR",P($49000),R  BEND  RETURN.FADE╞COLOURS╞TO╞GREY'--------------------'инпут: FADEVAL = 0# TO 16  TEMPVAL = (16-FADEVAL) / 16  FOR K = 0 TO 31    GREY = (DEFAULT╞RED(K) + DEFAULT╞GREEN(K) + DEFAULT╞BLUE(K)) / 3    POKE $D100+K, INT(GREY + (CURR╞RED(K) - GREY) * TEMPVAL)    POKE $D200+K, INT(GREY + (CURR╞GREEN(K) - GREY) * TEMPVAL)    PO%KE $D300+K, INT(GREY + (CURR╞BLUE(K) - GREY) * TEMPVAL)  NEXT K  RETURN.FADE╞COLOURS╞TO╞DEFAULTS'------------------------  'инпут: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = STARTCOL TO ENDCOL    POKE $D100+K, CURR╞RED(K) + (DEFAULT╞RED(K)%та' ---' 4.2бц0 фрее.DECLARES'--------  #DECLARE спрь64ен = $D057  #DECLARE спрхгтен = $D055  #DECLARE спрхгт   = $D056  #DECLARE сцрнптрлсб = $D060  #DECLARE сцрнптрбнк = $D062  #DECLARE спрптр16 = $D06E  #DECLARE спрптрадр = $D06C  #DEC&-CURR╞RED(K)) * TEMPVAL    POKE $D200+K, CURR╞GREEN(K) + (DEFAULT╞GREEN(K)-CURR╞GREEN(K)) * TEMPVAL    POKE $D300+K, CURR╞BLUE(K) + (DEFAULT╞BLUE(K)-CURR╞BLUE(K)) * TEMPVAL  NEXT K  RETURN.FADE╞COLOURS╞TO╞BLACK'---------------------  'инпут: FADE'VAL=0 TO 16  TEMPVAL = (16-FADEVAL) / 16  FOR K = STARTCOL TO ENDCOL    POKE $D100+K, CURR╞RED(K) * TEMPVAL    POKE $D200+K, CURR╞GREEN(K) * TEMPVAL    POKE $D300+K, CURR╞BLUE(K) * TEMPVAL  NEXT K  RETURN'==============.P1╞DROP╞PAPERS'========
 ======  GOSUB P1╞INIT  GOSUB P1╞LOOP  GOSUB P1╞ENDER  RETURN.P1╞INIT'-------  ' LOAD 13 STANDARD SPRITES FOR PAPER  ^^BLOAD "PAPER.DAT",P($47C40),R  ' LOAD 64X64 SPRITE DATA  ^^BLOAD "MUSE.DAT",P($40040),R  ' LOAD OLI FRAMES TO BANK 5  ^^ TIMISED VAR NAME) щY8'    ≤1, д(SI)╙" REM " ╙ VT$(TY,ID) ╙ " = :"╙VN$╙PF$(TY)╙":" МY='    SI╡SI╙1 ЬYB'  ┌ ID ZL'┌ TY ZV'▌                                                                                                                                    IF M >= 70 AND M < 800 THEN BEGIN    FIDX%=0    GOSUB PLAY╞DATA╞ITER  ' LINE DATA  BEND  GOSUB PAGE╞FLIP  IF M > 850 AND M < 950 THEN FIDX%=0:GOSUB SCROLL╞CANVAS╞RIGHT  IF M > 300 THEN BEGIN    FIDX%=1    GOSUB PLAY╞DATA╞ITER    IF M > 2630 THEN GOSUB SCROLL╞CANVAS╞RIGHT  BEND  IF MN╞STATE = 0 THEN BEGIN    S$ = "иN DREAMLAND..."    TXT╞K = 1    MN╞STATE = 1  BEND  IF MN╞STATE = 1 THEN BEGIN    FIDX% = 2    GOSUB ITER╞WRITE╞TEXT  BEND  GOSUB ITER╞STARFIELD  ' CURSOR 0,0:PRINT M  DO WHILE (TI-TSTART < .03)  LOOP  GOTO MAIN╞LOOP  END'----.INIT'----  M = 0  BANK 0:BLOAD "ASMHELPER":BANK 128  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  PRINT CHR$(27);"5";  PRINT "⌠";  POKE $D020,0,0  FOR K = 0 TO 20    STARX%(K) = INT(RND(1)*80)*256    STARY(K) = INT(RND(1)*50)    STARVX%(K) = (RND(1)*4 + .5)*256  NEXT K  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  EDMA 3, $FA0, 32, $52000  EDMA 3, $FA0, 0, $53000  EDMA 3, $FA0, 32, $54000  EDMA 3, $FA0, 0, $55000  FNAME$ = "ANA.LN"  FIDX% = 0  VER(FIDX%) = 1  GOSUB LOAD╞LINE╞FILE  FNAME$ = "SILENT.L"  FIDX% = 1  VER(FIDX%) = 2  GOSUB LOAD╞LINE╞FILE  POKE $40000, $81 ' OPT = DEST ADDR мб SELECTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $00 ' цмд LSB = цопы  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C, $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' цмд MSB (IGNORE)  WPOKE $40010, $0000 ' MODULO (IGNORE	)  GOSUB INIT╞WRITER  ' INIT VAR INTERFACE TO ASSEMBLY  LOC = $40036  PTR = POINTER(STARX%(0))  GOSUB STORE╞PTR  PTR = POINTER(STARVX%(0))  GOSUB STORE╞PTR  RETURN'-----------.INIT╞WRITER'-----------  TXT╞K = 0  WXX = 0 : WYY = 0  FN
AME$ = "ABC.LN"  FIDX% = 2  VER(FIDX%) = 3  GOSUB LOAD╞LINE╞FILE  CHAR╞CNT = 0  CHAR╞IDX%(0) = 0  CHAR╞WIDTH%(0) = 0  MAX╞WIDTH = 0  K = 0  DO WHILE K < DIDX%(FIDX%)    ' GET X VALUE    VAL& = LDATA&(FIDX%, K)    K=K+1    IF VAL& = $FF THEN BEGIN      ' KEEP AN ARRAY OF WIDTHS OF EACH LETTER      CHAR╞WIDTH%(CHAR╞CNT)=MAX╞WIDTH      ' PRINT "CHAR╞WIDTH(";CHAR╞CNT;") = ";MAX╞WIDTH      ' GET KEY Z$      MAX╞WIDTH = 0      CHAR╞CNT=CHAR╞CNT+1      ' KEEP AN ARRAY OF INDICES TO EACH DRAWN LETTER      CHAR╞IDX%(CHAR╞CNT) = K      'PRINT "CHAR╞IDX%(";CHAR╞CNT;")=";K      'GET KEY A$    BEND    IF VAL& = $FF THEN GOTO CONT╞LOOP    VAL& = VAL& AND $7F    IF VAL& > MAX╞WIDTH THEN MAX╞WIDTH = VAL&        K=K+1  ' SKIP Y VALUE    K=K+1  ' SKIP CHAR .CONT╞LOOP  LOOP  RETURN'---------------.ITER╞WRITE╞TEXT'---------------  IF WC╞FLAG = 0 AND TXT╞K > 0 AND TXT╞K <= LEN(S$) THEN BEGIN    CHR = ASC(MID$(S$, TXT╞K, 1))    ' PRINT "";CHR$(27);"QCHR=";CHR;    GOSUB PETSCII╞TO╞SCREENCODE    GOSUB SCREENCODE╞TO╞IDX    ' PRINT "FIXED CHR=";CHR;    ' GET KEY Z$    IF CHR=32 THEN BEGIN      WXX=WXX+7      TXT╞K = TXT╞K + 1    BEND:ELSE:BEGIN      WC╞FLAG = 1      WC╞CHR = CHR      PIDX%(FIDX%) = CHAR╞IDX%(CHR)    BEND  BEND  IF WC╞FLAG = 1 THEN BEGIN    CHR = WC╞CHR    GOSUB ITER╞WRITE╞CHAR    IF RET = 1 THEN BEGIN      WXX = WXX + CHAR╞WIDTH%(WC╞CHR) + 1      TXT╞K = TXT╞K + 1      WC╞FLAG = 0    BEND  BEND  RETURN'----------.ITER╞WRITE╞CHAR'---------------  ' ITERATE OVER CHARS IN STRING    ' DRAW CURRENT CHAR AT GIVEN X,Y POS    ' INCREMENT X,Y LOCATION  RET = 1  IF PIDX%(FIDX%) < DIDX%(FIDX%) AND LDATA&(FIDX%, PIDX%(FIDX%)) <> $FF THEN BEGIN    ' CURSOR 0,49    ' PRINT CHR$(27);"QPIDX=";PIDX%(FIDX%);"[";LDATA&(FIDX%, PIDX%);    ' PRINT LDATA&(FIDX%, PIDX%+1);LDATA&(FIDX%, PIDX%+2);    VAL& = LDATA&(FIDX%, PIDX%(FIDX%))    PIDX%(FIDX%) = PIDX%(FIDX%) + 1    X = VAL& AND $7F    IF VAL& AND $80 THEN REV╞FLAG&(FIDX%) = 1 : ELSE REV╞FLAG&(FIDX%) = 0    Y = LDATA&(FIDX%, PIDX%(FIDX%))    PIDX%(FIDX%) = PIDX%(FIDX%) + 1    A$ = CHR$(LDATA&(FIDX%, PIDX%(FIDX%)))    PIDX%(FIDX%) = PIDX%(FIDX%) + 1    DXX = WXX+X : DYY = WYY+Y : GOSUB DRAW╞CHAR    ' PRINT "";CHR$(27);"Q X,Y,PIDX,A$=";X;Y;PIDX%(FIDX%),ASC(A$)    ' GET KEY A$    RET = 0.PD╞ENDLOOP  BEND  RETURN'---------.STORE╞PTR'---------  WPOKE LOC, PTR  LOC = LOC + 2  RETURN'--------------.LOAD╞LINE╞FILE'-------------- ' (FNAME$)  IF FNAME$ = "" THEN RETURN  GOSUB LINE╞FILE╞INIT  DOPEN #2,(FNAME$),R,U8  DO    GET #2, VAL&    IF ST THEN EXIT    LDATA&(FIDX%, DIDX%(FIDX%)) = VAL&    DIDX%(FIDX%) = DIDX%(FIDX%) + 1  LOOP  DCLOSE #2  GOSUB PLAY╞DATA╞INIT  RETURN'--------------.LINE╞FILE╞INIT'--------------  OLDX = -1 : OLDY = -1 : OLDOFFS(FIDX%) = 0  DIDX%(FIDX%) = 0  GROUP╞FLAG& = 0 : REV╞FLAG&(FIDX%) = 0  OFFS(FIDX%) = 0  RETURN'--------------.DRAW╞STARFIELD'--------------  FOR K = 0 TO 20    POKE $50000 + STARX%(K)/256 + STARY(K) * 80, 46  ' DOT  NEXT K  RETURN'--------------.ITER╞STARFIELD'--------------  BANK 0:SYS $7E0F:BANK 128  'FOR K = 0 TO 20  '  STARX(K) = MOD( (STARX(K)-STARVX(K)) + 80, 80)  'NEXT K  'CURSOR 0,0  'FOR K = 0 TO 20  '  PRINT INT(STARX%(K)/256), STARY(K)  'NEXT K  'GET KEY A$  RETURN'---------.PAGE╞FLIP'---------  VSYNC 10  BANK 0 : SYS $7E15 : BANK 128  RETURN'--------------.PLAY╞DATA╞INIT'--------------  PRINT "⌠";  OFFS(FIDX%)=0  PIDX%(FIDX%) = 0  IF LASTFLAG = 1 THEN PIDX%(FIDX%) = LAST╞GROUP╞IDX : LASTFLAG = 0  RETURN'--------------.PLAY╞DATA╞ITER'--------------  IF PIDX%(FIDX%) < DIDX%(FIDX%) THEN BEGIN    VAL& = LDATA&(FIDX%, PIDX%(FIDX%))    PIDX%(FIDX%) = PIDX%(FIDX%) + 1    IF VER(FIDX%)=3 AND VAL& = $FF THEN BEGIN      IF PIDX%(FIDX%) > LAST╞GROUP╞IDX THEN LAST╞GROUP╞IDX = PIDX%(FIDX%)      GOTO PD╞ENDLOOP    BEND    X = VAL& AND $7F    IF VER(FIDX%)=2 THEN BEGIN      X = VAL&      VAL& = LDATA&(FIDX%, PIDX%(FIDX%))      PIDX%(FIDX%) = PIDX%(FIDX%) + 1      X = X + (VAL& AND $7F) * 256    BEND    IF VAL& AND $80 THEN REV╞FLAG&(FIDX%) = 1: ELSE REV╞FLAG&(FIDX%) = 0    Y = LDATA&(FIDX%, PIDX%(FIDX%))    PIDX%(FIDX%) = PIDX%(FIDX%) + 1    A$ = CHR$(LDATA&(FIDX%, PVAL&    DIDX% = DIDX% + 1  LOOP  DCLOSE #2  GOSUB PLAY╞DATA  RETURN'---------.SAVE╞FILE'---------  INPUT "SAVE NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  DELETE (FNAME$)  DOPEN #2,(FNAME$),W,U8  FOR XX = 0 TO DIDX%    PRINT #2, CHR$(LD VAL&    DIDX% = DIDX% + 1  LOOP  DCLOSE #2  GOSUB PLAY╞DATA  RETURN'---------.SAVE╞FILE'---------  INPUT "SAVE NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  DELETE (FNAME$)  DOPEN #2,(FNAME$),W,U8  FOR XX = 0 TO DIDX%    PRINT #2, CHR$(LIDX%(FIDX%)))    PIDX%(FIDX%) = PIDX%(FIDX%) + 1    IF VER(FIDX%)=2 THEN BEGIN      IF X-OFFS(FIDX%) > 78 THEN BEGIN        GOSUB SCROLL╞CANVAS╞RIGHT        PIDX%(FIDX%) = PIDX%(FIDX%) - 4        RETURN        ' PRINT "";CHR$(27);"QOFFS=";OFFS(FIDX%);      BEND    BEND    DXX = X-OFFS(FIDX%) : DYY = Y: GOSUB DRAW╞CHAR    DEBUG = 0    IF DEBUG=1 THEN BEGIN      PRINT "";CHR$(27);"Q X,Y,PIDX,A$,OFFS=";X;Y;PIDX%(FIDX%),ASC(A$),OFFS(FIDX%)      GET KEY A$    BEND.PD╞ENDLOOP  BEND  ATA&(XX));  NEXT XX    DCLOSE #2  RETURN'---------.SAVE╞CHAR'---------  IF OLDX=X AND OLDY=Y AND OLDOFFS=OFFS AND INSTR("░÷·│∙√≈≤≥ ⌡▓", A$)=0 THEN BEGIN    ' REPLACE PREVIOUS CHAR    IF VER = 2 THEN BEGIN      LDATA&(DIDX%-4) = (X+OFFS)!DATA&(XX));  NEXT XX    DCLOSE #2  RETURN'---------.SAVE╞CHAR'---------  IF OLDX=X AND OLDY=Y AND OLDOFFS=OFFS AND INSTR("░÷·│∙√≈≤≥ ⌡▓", A$)=0 THEN BEGIN    ' REPLACE PREVIOUS CHAR    IF VER = 2 THEN BEGIN      LDATA&(DIDX%-4) = (X+OFFS AND 255      LDATA&(DIDX%-3) = (X+OFFS) / 256 + REV╞FLAG& * $80    BEND:ELSE BEGIN      LDATA&(DIDX%-3) = X + REV╞FLAG& * $80    BEND    LDATA&(DIDX%-1) = ASC(A$)  BEND:ELSE:BEGIN    ' WRITE NEW CHAR    IF VER = 2 THEN BEGIN      LDATA&(DIDX%) ) AND 255      LDATA&(DIDX%-3) = (X+OFFS) / 256 + REV╞FLAG& * $80    BEND:ELSE BEGIN      LDATA&(DIDX%-3) = X + REV╞FLAG& * $80    BEND    LDATA&(DIDX%-1) = ASC(A$)  BEND:ELSE:BEGIN    ' WRITE NEW CHAR    IF VER = 2 THEN BEGIN      LDATA&(DIDX%)#' аN EXPERIMENT TO DROP 5 (OR 6) SPRITES (EACH 64X200) OVER THE 320X200 SCREEN' TO ACT LIKE AN OVERLAY THAT и CAN DRAW LINES ON TOP OF' еACH SPRITE WILL CONSUME 1.6KB ($640 IN HEX)' вILL NEED A ROUTINE THAT TAKES VECTOR COORDS FOR LINES (MAYBE FROM $VART)' AND DRAWS THEM ONTO THIS MULTI-SPRITE OVERLAY#OUTPUT "SPRITELINE"' банк4 мEMORY USAGE' ------------------' 4.0000 сприте 0 дата' 4.0640 сприте 1 дата' 4.12ц0 сприте 2 дата' 4.1900 сприте 3 дата' 4.1ф40 сприте 4 дата' 4.2580 сприте 5 даWC╞CHR'-------.DEFINES'-------#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE дст╞дец = 32#DEFINE срц╞дец = 16'----.MAIN'----  GOSUB INIT.MAIN╞LOOP  TSTART = TI  M = M + 1  GOSUB DRAW╞STARFIELD &PRINTSS$:LOOP:S$=SS$:TR$=WH$:STOP эVП%    ▀ и(S$,1)╡"," ╖ S$╡х(S$,ц(S$)╚1) 3WЯ%    S$╡SK$(SZ)╙"("╙д(SR)╙")="╙S$:█ 3007:█ 9800:S$╡"":SZ╡SZ╙1:▐ SAFE ADD TO LI$(LN) <WР%  Ч ^WС%  ▀ SM╡1 ╞ S$╡"[" ╖ SM╡2:SZ╡0 {WТ%  ▀ SM╡1 ╞ S$╡"]" ╖ SM╡0 ╚WУ%  █ 9400:▐ READ 'NEXT TOKEN FROM CL$ INTO S$ ╠WЬ%Л рW&S$╡"":CL$╡"":NL$╡""::ZZ$╡"Z" ьW>&▌ XH&▐ --- SAFE ADD L$+S$ TO CURRENT OR═NEXT LI$(LN) 2XR&▀ ц(L$)╙ц(S$)╙ц(д(LN))╠╡159 ╖NL╡1 eXW&▀ ZZ$Ё╠"" ╖ S$╡"":ZZ$╡"":▌:▐ FORCE S$ TO EMPTY tX\&▀ NL╡1 ╖Ч ▀Xf&  LI$(LN)╡L$:L$╡S$ ²X p&  LN%(LN)╡SL: ╡Xz&  LN╡LN╙1 : NL╡0 нX└&Ч : уЧ ▐ -- ADD TO L$ ЧX▌&  ▀ L$Ё╠"" ╞ CN╡0 ╞ и(L$,1)Ё╠":" ╖L$╡L$╙":" Y≤&  L$╡L$╙S$ Y╒&Ч +Y╓&▀ VB ╖ ≥ "<<"LN;S$ 1Y╖&▌ EY'▐ --- DUMP VARS VY'│ TY ╡ 0 ╓ 3 nY$'  │ ID ╡ 0 ╓ EC(TY) ²Y.'    █ 5000: ▐ GET VN$ (OPARS IN KEYBOARD BUFFER 4╛≈ 688,13,13:▐ RETURN 4╤─ 4Г: .4Х▐ DECLARE VAR(S) IN S$ n4РS$╡й(CL$,10╚DF):D$╡",;":IB╡1:█2100:IB╡0: ▐ SPLIT PARAMETERS ┴4Т▐ (IB=IGNORE BRACKETS) ╢4ВNL$╡"" : ▐ NEW LINE IF DIMENSIONING... В4Э▀ ACЁ0 ╖ PE$╡"?DECLARE PARAMETER MISSING IN LINE "╙д(SL):┴1800 5Щ│ I╡0 ╓ AC 25Ч  P$╡AL$(I):█ 1030:▐ PARSE DECLARED VAR :5Ъ┌ I b5 ▀ NL$Ё╠"" ╖DL╡0:CL$╡"^^"╙NL$:у DL╡1 h5▌ ┘5▐ --- PARSE DECLARED VAR ⌡5: DI$╡"" : VL$╡"" х5: B1╡т(P$,"("):B2╡т(P$,")"):EQ╡т(P$,"=") М5: ▀ EQЁ╠0 ╖Ч : ▐ --- ASSIGNMENT ,6:   VL$╡й(P$,EQ╙1):P$╡х(P$,EQ╚1):TR$╡WH$:S$╡P$:█2050:P$╡S$ N6:   S$╡VL$:█2000:█2050:VL$╡S$ 6:   ▀ х(VL$,1)╡"$"╖HX$╡й(VL$,2):█4900:VL$╡C$ ╟6:   ▀ х(VL$,1)╡"%"╖BI$╡й(VL$,2):█4800:VL$╡C$ ╧6: Ч Е6: ▀ B1Ё╠0 ╞ B2Ё╠0 ╖Ч : ▐ --- DIMENSION 7:   DI$╡й(P$,B1╙1,B2╚B1╚1) : PP$╡х(P$,B1╚1) ^7:   S$╡DI$:DZ╡1:█ 3000:DZ╡0:DI$╡S$:P$╡PP$: ▐ CHECK FOR DEFINE TOKENS k7":   DL╡0 t7$: Ч ▄7&: TY╡0 : ▐ VAR TYPE ╢7(: T$╡и(P$,1): ▐ TYPE (IF ANY) IN T$ н7*: ▀ VB ╖≥ "ADDING "; П7,: ▀ т("%&$",T$)╡0 ╖T$╡"":TY╡0 8-: ▀ DF╡1 ╖TY╡4 8.: ▀ T$╡"%" ╖TY╡1 -80: ▀ T$╡"$" ╖TY╡2 B81: ▀ T$╡"&" ╖TY╡3 \82: VT$(TY,EC(TY)) ╡ P$ p84: ▀ DI$Ё╠"" ╖Ч ═86:   ID╡EC(TY):█5000: ▐ FETCH VARNAME IN VN$ т8<:   ▀ DF╡0 ╖ NL$╡NL$╙"DIM "╙VN$╙T$╙"("╙DI$╙"):" щ8=: Ч Я8@: ▀ VL$Ё╠"" ╖Ч 	9A:   ID╡EC(TY):█5000 59B:   ▀ DF╡0 ╖ NL$╡NL$╙VN$╙T$╙"="╙VL$╙":" >9D: Ч ]9E: ▀ DF╡1 ╖ DF$(EC(TY))╡VL$ {9K: ▀ VB ╖≥ P$;"▓: ";EC(TY) ▒9L: EC(TY)╡EC(TY)╙1 ≈9`▌ ╣9╟S$╡й(CL$,8):D$╡",;":█2100 М9╨▀ ACЁ╠0 ╖≥ "?INVALID PARAMETERS IN LINE ";LN%(SL):─ *:дS$╡AL$(0):TR$╡Q$:█2000:█2050: ▐ TRIM QUOTES LEFT & RIGHT X:н▀ VB ╖≥ "SETTING OUTPUT FILE TO "╙S$╙"▓" c:ьOF$╡S$ └:БDL╡1 : ▐ DISABLE PASSTHROUGH ┼:Л▌ ░:м: ╘:р▐ ADD TO LABEL TABLE ╞:в: в:э▀ VB ╖≥ "LABEL ";CL$;" AT LINE ";LN Ю:АDL╡1 У:БLB$(LC)╡й(CL$,2) ;ФLL(LC)╡LN╙1 *;ПLC╡LC╙1 : ▐ INCREASE LABEL COUNT 0;З▌ R;▐ RETURN TO EDITOR WITH ERROR v;Ч 4 : ▐ SET ERROR MAILBOX FLAG ╗;│ R╡1 ╓ ц(PE$):≈ $4FF30╙R╚1,ф(й(PE$,R,1)):┌ R ╩;≈ $4FF30╙R╚1,0 И;≈ я("FF0	9"),н(SL,256):≈ я("FF0A"),SL╜256 <≈ я("FF07"),б(я("FF07"))╟2 : ▐ SET AUTOJUMP FLAG %<&Ч /<0┴7210 5<о: j<п▐ -- STRIP TR$ FROM BEGINNING OF STRING IN S$ -- ┐<зК Щ т(TR$,(х(S$,1))) ■<Д  S$╡й(S$,2)  <НЛ ═<Ь▌ ╕<Щ: ь<▐ -- STRIP CHARCTERS IN TR$
 FROM END OF S$ -- О<К Щ т(TR$,и(S$,1)) =  S$╡х(S$,ц(S$)╚1) = Л =*▌ =/: 4=4▐ -- PARSE ARGUMENTS -- \=5▐     IN: S$ = STRING, D$=DELIMITER ▓=6▐    OUT: AL$(X)=ARGUMENT LIST, AC=ARGUMENT COUNT г=7▐         AL$(0)=FIRST ARG, AL$(1)=SECOND ARG... м=8▐ с==: Я=>AC╡0:AL$╡S$:AL╡ц(S$):IG╡0 >@▀ AL╡0 ╖AC╡╚1:▌ : ▐ NO STRING />C│AI╡0╓31:AL$(AI)╡"":┌AI ?>H│ AI╡1 ╓ AL R>MB$╡й(AL$,AI,1) l>N▀ B$╡"(" ╞ IB╡1 ╖IG╡1 ├>O▀ B$╡")" ╞ IB╡1 ╖IG╡0 ё>R▀ т(D$,B$)Ё╠0 ╞ IG╡0 ╖Ч у>T    S$╡AL$(AC):TR$╡" ":█2000:█2050:AL$(AC)╡S$ Е>\    AC╡AC╙1 Т>f  Ч : уЧ ?p    AL$(AC)╡AL$(AC)╙B$ ?z  Ч !?└┌ AI O?├S$╡AL$(AC):TR$╡" ":█2000:█2050:AL$(AC)╡S$ i?┴S$╡AL$ : ▐ RESTORE S$ o?▌▌ u?Ё: ╗?╦▐ -- REPLACE VARS & LABELS IN SOURCE STRING -- й?╧▐    IN:   S$ = SOURCE STRING Ч?╨▐    OUT:  S$ = DEST STRING WITH REPLACED ITEMS @╬: +@©▀ х(S$,2)╡"^^" ╖S$╡и(S$,ц(S$)╚2):▌ I@бQ╡0:A$╡"":C$╡"":SS╡0:TG╡0 n@дCX$╡"?<>=+-#*/^,.:;() " : D$╡CX$ ▐@л│ II╡1 ╓ ц(S$):B$╡й(S$,II,1) ╝@я▀ B$╡":" ╞ Q╡0 ╖ SS╡0:RI╡0 п@ж▀ SS ╞ B$╡"(" ╖ RI╡0 : D$╡CX$ Э@ш▀ SS ╞ B$╡")" ╖ RI╡╚1 : D$╡CX$ ╙ "DPUB" AЮ  ▀ B$╡Q$ ╖Ч : Q╡╤(Q╚1) KAБ  ▀ Q╡1 ╖█4000:A$╡A$╙C$:C$╡"":уA$╡A$╙B$:B$╡"" RAДЧ lAЙ▀ Q╡1 ╖A$╡A$╙B$:┴3200 ┌AТ▀ т(D$,B$)Ё╠0 ╖Ч ╘AЧ█4000:A$╡A$╙C$:C$╡"":▀B$╡" "╖B$╡"" ╤AA$╡A$╙B$ иAЧ : уC$╡C$╙B$ оA─┌ ыA┌█4000 ФA┼S$╡A$╙C$ ЛA■▌ РA<─ 
B═▀ C$╡"" ╟ C$╡"_" ╖▌ ?B║▀ е(C$)Ё╠0 ╖TG╡0: ▌     : ▐ NEVER CHANGE NUMBERS ~B╒▀ C$╡"0" ╖C$╡".":▌        : ▐ STUPID MS BASIC OPTIMIZATION ╟B╔▀ TG ╞ DZ╡0 ╖█4500:TG╡0:▌   : ▐ REPLACE LABEL фB╕▀ C$╡"GOTO" ╖NL╡1 УB╖▀ C$╡"GOTO" ╟ C$╡"GOSUB" ╟ C$╡"TRAP" ╖TG╡1 C╗DR╡0 : ▐ DID REPLACE FLAG :C╘▀ х(C$,1)╡"$" ╖HX$╡й(C$,2):█4900:▌ aC╙▀ х(C$,1)╡"%" ╖BI$╡й(C$,2):█4800:▌ sC╚P$╡" "╙C$╙" " ╔C╛│ T╡0 ╓ 6:▀ т(RW$(T),P$)Ё╠0 ╖ LC$╡C$:█ 4100:▌ ╚C╜┌ ©C╝T$╡и(C$,1):TY╡0 рC╞▀ T$╡"%" ╖TY╡1 ЕC╟▀ T$╡"$" ╖TY╡2 ЬC╠▀ T$╡"&" ╖TY╡3 D╢│ ID╡0 ╓ EC(TY) ED╧▀ C$╡VT$(TY,ID) ╖█5000:C$╡VN$╙PF$(TY):ID╡EC(TY):DR╡1 ND╬┌ ID \DФ▀ DR╡1 ╖▌ ┴DГ│ ID╡0 ╓ EC(4):▐ CHECK DEFINES TABLE TOO ╜DХ  ▀ C$╡VT$(4,ID) ╖ C$╡DF$(ID):▌ ╤DИ┌ ID юDЙCI╡╚1 ГDК│ ID╡0 ╓ SS╚1:▐ CHECK STRUCT NAMES ,EЛ  ▀ C$╡SN$(ID) ╖ █ 9600:CI╡ID:ID╡SS╚1:▐ CREATE NEW STRUCT OBJECT 5EМ┌ ID ]EН▀ CIЁ╠╚1 ╖ ▌:у ▀ ф(C$)╡222 ╖ ▌:▐ PI ²EО▀ т(DC$, LC$)Ё╠0 ╞ (C$╡"R" ╟ C$╡"P" ╟ C$╡"U8" ╟ C$╡"W") ╖ ▌ ЦEПPE$╡"?UNRESOLVED IDENTIFIER: '"╙C$╙"' IN LINE "╙д(SL):Ч 1:┴ 1800 ИEЗ▌ ОEШ: УEЭ: (F▐ CHECK IF COMMAND TRIGGERS SHITTY SYNTAX MODE sF▐ TODO: COMPARE UBIK'S LOGIC HERE VERSUS MY OWN 4079 LC$="DOPEN" LOGIC yF▌ ·F■C$╡MK$╙C$╙MK$ : ▌ : ▐ MARK LABEL ╖F≥DR╡0 ╧F·│ ID╡0 ╓ LC╚1 ЦF╗▀ C$╡LB$(ID) ╖C$╡д(LL(ID)):ID╡LC:DR╡1 ЛF╡┌ ID ЬF╪▀ DR ╖▌ >GфPE$╡"?UNRESOLVED LABEL: '"╙C$╙"' IN LINE"╙д(LN%(SI╚1)):Ч 1:┴1800 DGв▌ ]Gю▐ --- CONVERT BINARY qGйBR╡0 : ▐ RESULT ├Gт│ B╡0 ╓ ц(BI$)╚1 ═GчBC$╡й(BI$,ц(BI$)╚B,1) тGХ▀ BC$Ё╠"1" ╞ BC$Ё╠"0" ╖Ч4:≈я("FF08"),132:┴4082 НGР▀ BC$╡"1" ╖BR╡BR╙B(B) ЖGЭ┌ B HC$╡й(д(BR),2) H▌ H#░ *H$▐ --- CONVERT HEX 4H)в4940 BH.VL╡я(HX$) TH8C$╡й(д(VL),2) ZH=в `HB▌ ▐HLв:Ч 4:≈ я("FF08"),131 : ▐ SET ILLEGAL HEX ╢HV┴4082: ▐ JUMP INTO ERROR HANDLER ╨H~: эH┐▐ GENERATE VARNAME FROM INDEX БH├:  I┬▀ IDЁ26 ╖VN$╡г(65╙ID) : ▌ I▓N2╡н(ID,26):N1╡╣(ID╜26)╚1 9I°VN$╡г(65╙N1)╙г(65╙N2) xI²▀ VN$╡"DO" ╖ VN$╡"D1":▐ AVOID ANY BASIC TERMS AS VAR NAMES ▓I·▀ VN$╡"GO" ╖ VN$╡"G1" ╛I÷▀ VN$╡"TO" ╖ VN$╡"T1" фI═▀ VN$╡"DS" ╖ VN$╡"D2" ЮI║▀ VN$╡"DT" ╖ VN$╡"D3" ЗI╒▀ VN$╡"EL" ╖ VN$╡"E1" Jё▀ VN$╡"ER" ╖ VN$╡"E2" .J╓▀ VN$╡"FN" ╖ VN$╡"F1" HJ╔▀ VN$╡"IF" ╖ VN$╡"I1" NJ╕▌ TJ░ ZJT: `JU: fJV: yJX▐ GET FILENAME Jb: ∙JlЧ 4:BA╡я("FF00") ©Jv▀ б(BA╙0)╡ф("S") ╞ б(BA╙1)╡ф("K") ╖Ч ьJ─  VB╡б(я("FF07"))╞16 K┼  F$╡"":A╡BA╙16:КЩб(A)Ё╠0:F$╡F$╙г(б(A)):A╡A╙1:Л: 'K■  ▀ б(я("FF07"))╞1 ╖▌ EK·  ≥ "FILENAME? "╙F$:≥"▒"; LK╗Ч `K╡┘ "FILENAME";A$ ┐K╪▀ A$╡"" ╖≥ "NO FILENAME SET":─ ║Kф≈ BA,ф("S"):≈ BA╙1,ф("K") хKп│R╡1╓16:≈ BA╙8╙R╚1,ф(й(A$,R,1)):┌R рKзF$╡A$ ьKД▌ ПKН▐ --- SAVE FILENAME LЬAD╡я("FF30"):Ч 4 L│R╡0╓16:≈AD╙R,0:┌R HL▀ OF$Ё╠"" ╖TF$╡OF$ : уTF$╡"ELEVEN.OUT" qL│R╡1╓ц(TF$):≈AD╙R╚1,ф(й(TF$,R,1)):┌R wL ▌ ┼L*▐ CHAIN EDITOR ЁL4║ A$:▀ A$Ё╠"" ╖ ┘ ZZ:▀ ZZ╡1 ╖ ADFSDF M9≥"⌠EDMA 0,$D400,$8000000,$2001:NEW RESTORE":≥"RUN";:▐ LOAD '11.EDIT' FROM CACHE M>Ч 128 LMH≈ 208,2     : ▐ NO OF CHARS IN KEYBOARD BUFFER gMR≈ 688,13,13 : ▐ RETURN mM\─ ∙M▄#▐ --- COPY ATTIC RAM TO LINE BUFFER ╛M√#CB╡$8030000 : C╡CB иM═#NL╡б(C)╙256╛б(C╙1):C╡C╙2 рM╙#CL╡0 АM╢#К Щ CLЁ╠NL N╬#  L╡б(C):LI$(CL)╡х(BL$,L):P╡н
(LI$(CL)) 4Nц#  B╡$10000╙б(P╙1)╙256╛б(P╙2):C╡C╙1 VNм#  ▀ LЁ╠0 ╖ Ч! 0,L,C,B : C╡C╙L dNэ#  CL╡CL╙1 jNФ#Л pNП#▌ ▐NЗ#▐ --- DEFINE IN S$ EXISTS?  N$SH ╡ 1 ╘N$│K╡0╓EC(4) дN$▀ VT$(4,K) ╡ S$ ╖ SH╡0 кN"$┌K яN,$▌ РNT$▐ --- READ IN STRUCT DETAILS !OY$CL$╡й(CL$,9):█ 9400:▐ GET NEXT TOKEN IN S$ VO[$▀ S$╡"" ╖ ≥ "ERROR: NO STRUCT NAME FOUND":Ч 1:▌ gO^$SN$(SS) ╡ S$ yOh$SV$(SS) ╡ CL$ ┘Om$SS╡SS╙1 ▀Or$▌ ╤O╦$▐ --- READ NEXT TOKEN FROM CL$ INTO S$ жOб$S$╡CL$:█ 2000:█ 2050:CL$╡S$ ГOц$SF$╡" ":SF╡0 Pд$▀ х(S$,1)╡Q$ ╖ SF$╡Q$╙", ":SF╡2 Pг$A╡т(CL$,SF$) `Pл$▀ AЁ╠0 ╖ S$╡й(CL$,1,т(CL$,SF$)╙SF╚1):CL$╡й(CL$,т(CL$,SF$)╙SF╙1) zPж$▀ A╡0 ╖ S$╡CL$:CL$╡"" ─PЮ$▌ ≥P%▐ --- READ NEXT LINE ╒P&%Ч 0 мP0%L╡б(CA):CL$╡х(BL$,L):P╡н
(CL$):CA╡CA╙1 ЛP:%B╡$10000╙б(P╙1)╙256╛б(P╙2) QD%▀ LЁ╠0 ╖ Ч! 0,L,CA,B : CA╡CA╙L QN%RL╡RL╙1 ;QX%TR$╡WH$:S$╡CL$:█2000:CL$╡S$ SQb%Q ╡ 0 : ▐ QUOTES ON vQl%CT ╡ 0 : ▐ CUT CHARS FROM TAIL Qv%Ч 1 ┘Q{%▌ ЁQ─%▐ --- CHECK FOR CREATION OF STRUCT OBJECT ФQ┼%CO$╡S$:CL$╡S$:ZZ╡╚1:▐ PRESERVE ORIGINAL STRING R■%█ 9400:▐ READ NEXT TOKEN FROM CL$ INTO S$ $R·%│ ZI╡0 ╓ SS ER╗%  ▀ S$╡SN$(ZI) ╖ ZZ╡ZI:ZI╡SS NR╡%┌ ZI mR╪%▀ ZZ╡╚1 ╖ CL$╡CO$:S$╡CO$:▌ ≤R╬%█ 9400:SK$╡S$:▐ GET STRUCT OBJECT NAME ╙ Rю%BL╡т(SK$,"(") ЮRф%▐ *** FOUND IT, SO MAKE DIM'S FOR EACH MEMBER VAR Sп%S$╡SV$(ZZ):█ 2100:▐ PARSE ARGS INTO AL$(), AC  Sу%ZZ╡1:SZ╡0 0Sз%│ ZI╡0 ╓ AC ISш%  ▀ AL$(ZI)Ё╠"" ╖ Ч jSэ%    ≥ "AL$(";ZI;")=";AL$(ZI) ╚Sщ%    ▀ BL╡0 ╖ S$╡SK$╙"╞"╙AL$(ZI):≥ "STRUCT!: ";S$:P$╡S$:█ 1030 Tч%    ▀ BLЁ╠0 ╖ S$╡х(SK$,BL╚1)╙"╞"╙AL$(ZI)╙й(SK$,BL):≥ "STRUCT: ";S$:P$╡S$:█ 1030:SK$(SZ)╡P$:SZ╡SZ╙1 HTъ%    ▐ IF NL$<>"" THEN DL=0:CL$="^^"+NL$:ELSE DL=1 QTЮ%  Ч ZTД%┌ ZI ≈TЕ%S$╡NL$:█ 9800:NL$╡"":▐ SAFE ADD L$+S$ TO CURRENT LI$(LN$) ╥TФ%█ 9400:▀ S$Ё╠"=" ╖ CL$╡"":▌ ТTГ%█ 9400:SZ╡0:SR╡0:SM╡0:▐ READ NEXT TOKEN FROM CL$ INTO S$ UХ%К Щ S$Ё╠"" =UИ%    ▀ S$╡"_" ╖ SL╡SL╙1:█ 9500:┴ 9717:▐ READ NEXT LINE sUЙ%  ▀ SM╡0 ╞ S$Ё╠"[" ╖ ≥ "ERROR: EXPECTED [":Ч 1:░ ≈UК%  ▀ SM╡0 ╞ S$╡"[" ╖ SM╡1:┴ 9#)#DECLARE K#DECLARE FNAME$, VAL&#DECLARE LDATA&(2, 12288), DIDX%(2)=0, PIDX%(2)=0, FIDX%=0#DECLARE GROUP╞FLAG&, VAL&, REV╞FLAG&(2) = 0#DECLARE OFFS(2), VER(2)#DECLARE LASTFLAG, LAST╞GROUP╞IDX#DECLARE OLDX, OLDY, OLDOFFS(2), X, Y, A$, XX, YY, DXX,$ DYY, DEBUG, Z$#DECLARE WXX, WYY#DECLARE CHR, TMP#DECLARE SRC╞ADDR, DEST╞ADDR, LENGTH, TRANSP#DECLARE LOC, PTR, M, TSTART, ADDR#DECLARE CHAR╞CNT, CHAR╞IDX%(60), CHAR╞WIDTH%(60), MAX╞WIDTH#DECLARE TXT╞K, S$, RET#DECLARE MN╞STATE = 0, WC╞FLAG, %717 эUЛ%  ▀ SM╡1 ╞ S$Ё╠"[" ╞ S$Ё╠"]" ╖ ≥ "ERROR: EXPECTED [ OR ]":Ч 1:░ НUМ%  ▀ SM╡2 ╖ Ч 0VН%    ▀ х(S$,1)╡"]" ╖ SR╡SR╙1:SZ╡0:SM╡1:S$╡"":┴ 9714:▐ NEXT ROW ЁVО%▐ IF LEFT$(S$,1)=Q$ THEN SS$=S$:TR$="":DO WHILE RIGHT$(SS$,2)<>(Q$+","):GOSUB9400:SS$=SS$+S$:&"PASS 2 "; 1LP╡0   : ▐ CURRENT LINE POINTER 31OL$╡"" : ▐ CURRENT OPTIMIZED LINE E1 │ SI╡0 ╓ LN╚1 s1*S$╡LI$(SI)  : ▀ VB ╖≥ SI;"·=> "S$:у≥ "."; ┼1,  К Щ т(S$,MK$)Ё╠0 ╡1.     S1╡т(S$,MK$):S2╡т(S$,MK$,S1╙2) я1/     C$╡й(S$,S1╙2,S2╚S1╚2) Ю14     █'4505 2>     S$╡х(S$,S1╚1)╙C$╙й(S$,S2╙2) 2\  Л (2a▀ VB ╖≥ "<= ";д(SI)╙S$ >2k  ≤1,д(SI)╙" "╙S$ G2l┌ SI c2p█ 10000:▐ --- DUMP VARS ┐2q│ R╡0 ╓ 10:≤1,д(32000╙R):┌R 3vF$╡"Dц:Dс"╙Q$╙"11TOKENIZED"╙Q$╙":IFDS<>0THEN?"╙Q$╙"DISC ERROR: "╙Q$╙";DS$:ELSE?"╙Q $╙""╙Q$╙":Dл"╙Q$╙"11.POST" 3z≤1,F$  3└═ 1 )3┴≥"" S3▌ET╡TI╚BT:≥ "ELAPSED TIME:";ET;"TICKS" ╡3≤≥"⌠EDMA 0,$1FFF,$8022000,$2001:NEW RESTORE":≥"RUN";:▐ LOAD '11.TOKENIZE' FROM CACHE ╫3²Ч 128 Н3╒≈ 208,2   : ▐ NO OF CHUP ONE  K = SEQCNT - 2  DO WHILE K >= SEQPTR    SEQ╞CHUNK(K+1) = SEQ╞CHUNK(K)    SEQ╞EXTRA(K+1) = SEQ╞EXTRA(K)    K = K - 1  LOOP  SEQ╞CHUNK(SEQPTR) = 0  SEQ╞EXTRA(SEQPTR) = 0  RETURN.ADD╞CHUNK╞TO╞SEQ'----------------  SEQPTR = SEQCNT  SE LQCNT = SEQCNT + 1  SEQ╞CHUNK(SEQPTR) = 0  SEQ╞EXTRA(SEQPTR) = 0  RETURN                                                                                                                                                                                    1    IF VER=2 THEN BEGIN      DO WHILE X-OFFS > 78        GOSUB SCROLL╞CANVAS╞RIGHT        PRINT "";CHR$(27);"QOFFS=";OFFS;      LOOP    BEND    XX = X-OFFS : YY = Y: CURSOR XX, YY : GOSUB DRAW╞CHAR    IF DEBUG=1 THEN GET KEY Z$    IF Z$="X" THEN GOSUB DELETE╞CHAR    IF Z$="<" THEN PIDX%=PIDX%-6    IF Z$="H" THEN PIDX%=0:GOTO PLAY╞DATA    IF Z$="T" THEN DIDX%=PIDX%      'PRINT "";CHR$(27);"Q X,Y,PIDX,A$=";X;Y;PIDX%,ASC(A$)      'GET KEY A$    IF GROUP╞FLAG& = 0 THEN SLEEP .02.PD╞ENDLOOP  LOOP  X = X-OFFS  RETURN'-----------.DELETE╞CHAR'-----------  DIDX% = DIDX% - 3  PIDX% = PIDX% - 3  FOR K = PIDX% TO DIDX%    LDATA&(K) = LDATA&(K+3)    LDATA&(K+1) = LDATA&(K+4)    LDATA&(K+2) = LDATA&(K+5)  NEXT K  RETURN'--------------.SET╞GROUP╞FLAG'--------------  IF GROUP╞FLAG& = 0 THEN BEGIN    ' GROUP╞FLAG& = 1    LDATA&(DIDX%) = $FF    POKE $D020, (PEEK($D020)+1) AND 15    GOSUB DRAW╞FONT╞GUIDE╞LINES  BEND:ELSE BEGIN  '  GROUP╞FLAG& = 0  '  LDATA&(DIDX%) = $FE  '  POKE $D020, $00  BEND  DIDX% = DIDX% + 1  RETURN'---------.LOAD╞FILE'---------  INPUT "LOAD NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  GOSUB INIT  DOPEN #2,(FNAME$),R,U8  DO    GET #2, VAL&    IF ST THEN EXIT    LDATA&(DIDX%) =   ° 6  PN$╡"11.PARSE":MK$╡"@Ъ":Q$╡г(34):H╡34:Y╡39 >  Ы ▒ e  ≥ "ележен PREPROCESSOR V0.5.0▓":≥ ╗  Ы7,"SCRATCH"╙Q$╙PN$╙Q$╙":DSAVE"╙г(34)╙PN$╙Q$╙":DVERIFY"╙Q$╙PN$ ! T$╡"                                                                             	  ":BL$╡T$╙T$╙T$:T$╡"" ╢!
 RW$(0)╡" PRINT INPUT IF THEN ELSE DO LOOP WHILE UNTIL GOSUB GOTO OPEN CLOSE DOPEN DCLOSE FOR NEXT GETKEY HEX$ DIM PEEK POKE WAIT DEC CHR$ ASC SGN SQR STR$" 1" RW$(0)╡RW$(0)╙" GRAPHIC CLR SCREEN DEF BEGIN BEND LEN MID$ RIGHT$ L
EFT$ INSTR FOR NEXT STEP TRAP BORDER AND FOREGROUND " х" RW$(1)╡" BACKGROUND SET ABS SIN COS TAN LOG FRE CURSOR PIXEL WINDOW RWINDOW LINE BOX CIRCLE ELLIPSE PALETTE RESTORE DATA ERR$ ER EL CURSOR ON OFF" ?## RW$(1)╡RW$(1)╙" VAL SCRATCH RETURN RND STOP BANK TI DO OR ST IF EL ER ON TO PEN GET END INT NOT DS RUN USING DOT " ж#F RW$(2)╡" APPEND ATN AUTO BACKUP BLOAD BOOT BSAVE BUMP BVERIFY CATALOG CHANGE CHAR CMD COLLISION COLOR CONCAT CONT COPY WPOKE WPEEK SETBIT CLRBIT " q$G RW$(3)╡" DCLEAR DEFFN DELETE FN DIR DISK DLOAD DMA DMODE DPAT DSAVE DVERIFY EDMA ENVELOPE ERASE EXIT EXP FAST FILTER FIND GO64 HEADER HELP HIGHLIGHT " Ю$H RW$(4)╡" JOY LIST LOAD LOCATE LPEN MOD MONITOR MOUSE MOVSPR NEW PAINT PLAY POINTER POLYGON POS POT PUDEF " q%I RW$(5)╡" RCOLOR RDOT READ RECORD REM RENAME RESUME RGR RMOUSE RPLAY RREG RSPCOLOR RSPPOS RSPRITE SAVE SCNCLR SLEEP SLOW SOUND SPC SPRCOLOR " П%K RW$(6)╡" SPRITE SPRSAV SYS TAB TEMPO TROFF TRON TYPE USR VERIFY VOL XOR KEY VSYNC RCURSOR T@& C@& RGRAPHIC FREAD POINTER " @&U DC$╡" BLOAD BSAVE DLOAD TO SAVE DIR COLLECT DOPEN DCLOSE BACKUP FREAD GET " Z&Z █7020: ▐ GET FILENAME k&d Ч128:≈ 0,65  &n PF$(0)╡"":PF$(1)╡"%":PF$(2)╡"$":PF$(3)╡"&" ч&o ├ B(16) : ▐ BIT SHIFTER'S FAST BINARY CONVERSION. THANKS A LOT! 'p B(0)╡1:│ I╡1 ╓ 16:B(I)╡B(I╚1)╙B(I╚1):┌ I U's ├ LN%(1000)             : ▐ SRC FILE LINE NR <-> INTERNAL IDX MAPPING ┼'x ├ LI$(1000)             : ▐ POST PROCESSED LINES а'y ├ EC(4)                 : ▐ ELEMENT COUNT PER TYPE Ы'z ├ VT$(4,200)            : ▐ VARIABLE TABLE PER TYPE -({ ├ DF$(200)              : ▐ DEFINE VALUES TABLE a(} ├ LB$(200),LL(200):LC╡0 : ▐ LABEL TABLE & COUNT ▐(~ ├ AL$(32)               : ▐ ARGUMENT LIST д( ├ SN$(30),SK$(30)       : ▐ STRUCT NAMES, FIELDS )─ ├ SV$(30)               : ▐ STRUCT VADX% > LAST╞GROUP╞IDX THEN LAST╞GROUP╞IDX = PIDX%      GOTO PD╞ENDLOOP    BEND    'IF VAL& = $FF THEN GROUP╞FLAG& = 1 : GOTO PD╞ENDLOOP    'IF VAL& = $FE THEN GROUP╞FLAG& = 0 : SLEEP .02 : GOTO PD╞ENDLOOP    X = VAL& AND $7F    IF VER=2 THEN BEGIN      X = VAL&      VAL& = LDATA&(PIDX%)      PIDX% = PIDX% + 1      X = X + (VAL& AND $7F) * 256    BEND    IF VAL& AND $80 THEN PRINT ""; : ELSE PRINT "▓";    Y = LDATA&(PIDX%) : PIDX% = PIDX% + 1    A$ = CHR$(LDATA&(PIDX%)) : PIDX% = PIDX% + 1    IF VER=2 THEN BEGIN      DO WHILE X-OFFS > 78        GOSUB SCROLL╞CANVAS╞RIGHT        PRINT "";CHR$(27);"QOFFS=";OFFS;      LOOP    BEND    XX = X-OFFS : YY = Y: CURSOR XX, YY : GOSUB DRAW╞CHAR    IF DEBUG=1 THEN GET KEY Z$    IF Z$="X" THEN GOSUB DELETE╞CHAR    IF Z$="<" THEN PIDX%=PIDX%-6    IF Z$="H" THEN PIDX%=0:GOTO PLAY╞DATA    IF Z$="T" THEN DIDX%=PIDX%      'PRINT "";CHR$(27);"Q X,Y,PIDX,A$=";X;Y;PIDX%,ASC(A$)      'GET KEY A$    IF GROUP╞FLAG& = 0 THEN SLEEP .02.PD╞ENDLOOP  LOOP  X = X-OFFS  RETURN'-----------.DELETE╞CHAR'-----------  DIDX% = DIDX% - 3  PIDX% = PIDX% - 3  FOR K = PIDX% TO DIDX%    LDATA&(K) = LDATA&(K+3)    LDATA&(K+1) = LDATA&(K+4)    LDATA&(K+2) = LDATA&(K+5)  NEXT K  RETURN'--------------.SET╞GROUP╞FLAG'--------------  IF GROUP╞FLAG& = 0 THEN BEGIN    ' GROUP╞FLAG& = 1    LDATA&(DIDX%) = $FF    POKE $D020, (PEEK($D020)+1) AND 15    GOSUB DRAW╞FONT╞GUIDE╞LINES  BEND:ELSE BEGIN  '  GROUP╞FLAG& = 0  '  LDATA&(DIDX%) = $FE  '  POKE $D020, $00  BEND  DIDX% = DIDX% + 1  RETURN'---------.LOAD╞FILE'---------  INPUT "LOAD NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  GOSUB INIT  DOPEN #2,(FNAME$),R,U8  DO    GET #2, VAL&    IF ST THEN EXIT    LDATA&(DIDX%) = RS (EACH ENTRY HAS STRING OF VARS) W)│ SS╡0                      : ▐ INDEX TO NEXT FREE STRUCT DEFINITION ])┌ : ╘)┐ ▐ ------------------------- PASS 1 ------------------------------------ ╞)┤ : ╨)┼ NL ╡ 0 Ц)▄ WH$╡г(32)╙г(160)╙"	" : ▐ WHITESPACE *√ ▐ CLEANUP TEMPORARY FILES '*╧ SL╡0 : ▐ SOURCE CODE LINE COUNTER =*╬ ≥ "PASS 1 ";:RL╡0 d*ц ° TI: ▐ KEEP START TIME FOR TIMING ≈*ф CB╡$8030000:CA╡CB:TL╡б(CA)╙256╛б(CA╙1):CA╡CA╙2 х*х К Щ RLЁ╠TL : ▐ UNTIL TARGET LINES IS REACHED О*о   █ 9500:▐ READ NEXT LINE INTO CL$ +╕  CT╡т(CL$,"'"): ▀ CT╡0 ╖┴580 .+╖  ▀ т(CL$,г(34))╡0 ╖┴540 9+╗  CT╡0 d+╘  Ч0:L╡б(P)╚1:A╡б(P╙1)╙256╛б(P╙2):Ч1 ÷+╦  │R╡.╓L:C╡б(A╙R):▀C╡H╖Q╡╤(Q╚1):у▀C╡Y╞Q╡0╖CT╡R╙1:R╡999 ╖+  ┌ ц+  ▀ CT ╖CL$╡х(CL$,CT╚1) Е+0  ▐ STRIP WHITESPACE FROM END Ъ+D  S$╡CL$:█2050:CL$╡S$ ,I  ▀ CL$Ё╠"" ╖Ч 5,J    DL╡0 : ▐ DELETE LINE FLAG S,N    ▀ VB ╖≥ ">>"LN;SL;CL$ ,X    ▀ х(CL$,1)╡"." ╖NL╡1:█1500: ▐ LABEL  ,Y    ▀ х(CL$,1)╡"#" ╖Ч ╘,Z      CC╡1 Ю,[      ▀ т(CL$,"IFDEF")╡2 ╖ S$╡й(CL$,8):█ 9210:DL╡1 	-\ "     ▀ т(CL$,"ENDIF")╡2 ╖ SH╡0:DL╡1 8-]      ▀ т(CL$,"DEFINE")╡2 ╖DF╡1:█1000:DF╡0 c-^      ▀ т(CL$,"DECLARE")╡2 ╖DF╡0:█1000 ┬-_      ▀ т(CL$,"OUTPUT")╡2 ╖█1200 Ё-`      ▀ т(CL$,"STRUCT")╡2 ╖ █9300:DL╡1 ╬-┼    Ч у-█    ▀ SH╡1 ╖ ┴ 750 	.▌    ▀ х(CL z A B C" D, EA FN 
GO 
HS IW ZX Z[ F\ A_ Z_ ` Za Za Za Za Zb Zb  Zb !c !Zd !Ye !Af !B_ A` Ba C                                                                                                                                       Б ╛ ╩─║ ║─╬ ╬─╛─  ╬─  ╪─╪─╩ ╪ ╛─ ─╒ ╒─╪ ╬─ ─╒─╬ ╬─╒ ╒─╒ ╒ ╪─╪─  ╩─╒─╪─╩─╪ ╪─ ─  ╩
 ╒
─╒	─ 	 ╛─╬─╛ ╛─ ─╬─╛─╬─╛─╬─  ║─	  1:▌ !	 ▀A$╡"▒"╞C╠.╖█ 47:C╡C╚#OUTPUT "STARFIELD"' банк4 мEMORY USAGE' ------------------' 4.0000 дма-лист' 4.0020 VAR INTERFACE TO ASSEMBLY'        0020: PTR TO DEFAULT╞RED&'        0022: PTR TO DEFAULT╞GREEN&'        0024: PTR TO DEFAULT╞BLUE&'        0026: PTR TO CURR╞RED &'        0028: PTR TO CURR╞GREEN&'        002A: PTR TO CURR╞BLUE&'        002C: PTR TO DATA╞ADDR%'        002E: PTR TO CDATA╞ADDR%'        0030: PTR TO SCRADDR%'        0032: PTR TO CLRADDR%'        0034: PTR TO INC%'        0036: PTR TO STARX%!'        0038: PTR TO STARVX%' 4.0800 сцреен меморы' 4.2000 петсции грапхицс FOR бас LOGO' банк5 мEMORY USAGE' ------------------' 5.0000 SCREEN BUFFER FOR DRAW╞PETSCII╞FRAME' 5.1000 COLOR RAM BUFFER FOR DRAW╞PETSCII╞FRAME' 5.2000 SCREEN BUFFER2 "FOR 'ANATHEMA' LAYER' 5.4000 COLOR RAM BUFFER2 FOR 'ANATHEMA' LAYER' 5.3000 SCREEN BUFFER3 FOR 'THE SILENT ENIGMA' LAYER' 5.4000 COLOR RAM BUFFER3 FOR 'THE SILENT ENIGMA' LAYER'--------.DECLARES'--------#DECLARE STARX%(20), STARY(20), STARVX%(20#$,4)╡"DATA" ╟ и(CL$,5)╡"BEGIN" ╖ NL╡1 .▐    ▀ DL╡0 ╖Ч 5.░      ▀ VB╡0 ╖≥ "."; F.■      S$╡CL$ t.·      █3007:▐ REPLACE VARS & LABELS IN S$ ╙.÷      █9600:▐ CHECK FOR CREATION OF STRUCT OBJECT Ф.═      ▀ и(L$,1)╡"_" ╖ L$╡х(L$,ц(L$)╚1):NL╡0:CN╡1:у $CN╡0 #/ё      █ 9800:▐ SAFE ADD L$+S$ TO CURRENT OR NEXT LI$(LN) f/э      ▀ и(S$,4)╡"BEND" ╟ и(S$,6)╡"RETURN" ╟ х(S$,2)╡"IF" ╖NL╡1 ─/ъ    Ч : ▐ ENDIF DL=0  /Д  Ч : ▐ ENDIF C$<>"" з/Н  SL╡SL╙1 : ▐ INCREASE SOURCE CODE LINE (FOR ERROR MSGS...) Ь/С % ▀ VB ╖ ≥ "SL=";SL:║Ы Z$ Ч/ЬЛ 0Щ▀ L$Ё╠"" ╖LI$(LN)╡L$:LN╡LN╙1 '0═ 1 H0█7150: ▐ SET OUTPUT FILENAME g0Р "11TEMP":Р "11TOKENIZED" Ё0▐ ------------------------- PASS 2 ------------------------------------ ╧0: р0÷ 1,1,5,"11TEMP,S,W" И0≥ г(13)&  V = SEQ╞CHUNK(SEQPTR)    V1$ = STR$(V)    IF LEFT$(V1$,1) = " " THEN V1$=MID$(V1$,2)    PRINT "CHUNK#: ";кеы╞есцапе;"^";V1$;кеы╞есцапе;"_";    INPUT "", V    SEQ╞CHUNK(SEQPTR) = V  BEND  IF SSCOL = 1 THEN BEGIN    V = SEQ╞EXTRA(SEQPTR)    'V1$ = STR$(V)    IF LEFT$(V1$,1) = " " THEN V1$=MID$(V1$,2)    PRINT "EXTRA#: ";кеы╞есцапе;"^";V1$;кеы╞есцапе;"_";    INPUT "", V    SEQ╞EXTRA(SEQPTR) = V  BEND  RETURN.EDIT╞CHUNK╞CMD'--------------  V = -SEQ╞CHUNK(SEQPTR)  PRINT кеы╞цлр;   FOR ROW = 1 TO цмд╞маь - 1    PRINT ROW;":"; SEQ╞CMDNAME$(ROW)  NEXT ROW  PRINT  INPUT "CMD: ", V  IF V > 0 THEN SEQ╞CHUNK(SEQPTR) = -V  RETURN.INSERT╞CHUNK╞TO╞SEQ'-------------------  SEQCNT = SEQCNT + 1  ' MOVE ALL HIGHER CHUNK SEQUENCES URR╞DIR = дир╞уп      IF FILT╞DIR(FSEL) = дир╞довн THEN CURR╞FREQ = FILT╞FREQ(FSEL)    BEND    RETURN  BEND  RETURN.APPLY╞SELECTED╞FILTER'---------------------  IF FSEL = -1 THEN RETURN  CURR╞FREQ = FILT╞FREQ(FSEL)  CURR╞DIR = дир╞ноне  IF   FILT╞DIR(FSEL) = дир╞уп _    OR FILT╞DIR(FSEL) = дир╞осц THEN BEGIN    CURR╞FREQ = FILT╞MIN(FSEL)    CURR╞DIR = дир╞уп  BEND  IF FILT╞DIR(FSEL) = дир╞довн THEN BEGIN    CURR╞DIR = дир╞довн  BEND  FILTER 1, FILT╞FREQ(FSEL), FILT╞LP(FSEL), _          FILT╞BP(FSEL), FILT╞HP(FSEL), FILT╞RES(FSEL)  FILTER 2, FILT╞FREQ(FSEL), FILT╞LP(FSEL), _          FILT╞BP(FSEL), FILT╞HP(FSEL), FILT╞RES(FSEL)  RETURN.CHANGE╞ENV╞NAME'---------------  V$=""  INPUT "NEW NAME: ",V$  IF V$<>"" THEN ENVS╞NAME$(SROW) = V$  RETURN.EDIT╞ENV╞FIELD'--------------  IF SCOL = 0 THEN GOSUB CHANGE╞ENV╞NAME : RETURN  IF SCOL = 6 THEN BEGIN    V$=""    INPUT "NEW VALUE: ",V$    V = VAL(V$)    IF V > 4095 THEN V = 4095    IF V < 0 THEN V = 0    ENVS╞PW(SROW) = V    RETURN  BEND  IF A$="+" THEN DELTA=1 : GOSUB INCR╞VAL  IF A$="-" THEN DELTA=1 : GOSUB DECR╞VAL  RETURN.EDIT╞FILTER╞FIELD'-----------------  IF FSCOL = 2 THEN V=FILT╞LP(FSROW):V=MOD(V+1,2):FILT╞LP(FSROW)=V:RETURN  IF FSCOL = 3 THEN V=FILT╞BP(FSROW):V=MOD(V+1,2):FILT╞BP(FSROW)=V:RETURN  IF FSCOL = 4 THEN V=FILT╞HP(FSROW):V=MOD(V+1,2):FILT╞HP(FSROW)=V:RETURN  IF FSCOL = 6 THEN V=FILT╞DIR(FSROW):V=MOD(V+1,4):FILT╞DIR(FSROW)=V:RETURN  V$=""  INPUT "NEW VALUE: ",V$  IF V$<>"" THEN BEGIN    IF FSCOL = 0 THEN FILT╞NAME$(FSROW) = V$    IF FSCOL = 1 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILT╞FREQ(FSROW) = V    BEND    IF FSCOL = 5 THEN BEGIN      V = VAL(V$)      IF V > 15 THEN V = 15      IF V < 0 THEN V = 0      FILT╞RES(FSROW) = V    BEND    IF FSCOL = 6 THEN BEGIN      V = VAL(V$)      IF V > 3 THEN V = 3      IF V < 0 THEN V = 0      FILT╞DIR(FSROW) = V    BEND    IF FSCOL = 7 THEN BEGIN      V = VAL(V$)   	   IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILT╞MIN(FSROW) = V    BEND    IF FSCOL = 8 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILT╞SWEEP(FSROW) = V    BEND  BEND.CHECK╞PIANO╞KE
YS'----------------  ' APPLY FILTER  PSTR$ = "X0"  IF FSEL <> -1 THEN PSTR$ = "X1"  ' DECIDE NOTE LENGTH  PSTR$ = PSTR$ + DUR$(SDUR, дцхар)  ' DECIDE OCTAVE  PSTR$ = PSTR$ + "O" + STR$(OCT)  ' WHICH NOTE TO PLAY  FOR K = 0 TO 11    IF A$ = KEYS╞IN$(K) THEN PSTR$ = PSTR$ + KEYS╞OUT$(K)  NEXT K  IF LEN(PSTR$)>0 THEN BEGIN    PLAY "T"+STR$(SROW)+PSTR$  BEND  RETURN.INCR╞VAL'--------  GOSUB GET╞VAL  MAXV = 15  IF SCOL = 5 THEN MAXV = 4  IF SCOL = 6 THEN MAXV = 4095  V = V + DELTA  IF V > MAXV THEN V = MAXV  GOSUB APPLY╞VAL  RETURN.DECR╞VAL'--------  GOSUB GET╞VAL  V = V - DELTA  IF V < 0 THEN V = 0  GOSUB APPLY╞VAL  RETURN.INCR╞FVAL'---------  IF FSCOL = 1 THEN BEGIN    V = FILT╞FREQ(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILT╞FREQ(FSROW) = V  BEND  IF FSCOL = 2 THEN FILT╞LP(FSROW) = 1  IF FSCOL = 3 THEN FILT╞BP(FSROW) = 1  IF FSCOL = 4 THEN FILT╞HP(FSROW) = 1  IF FSCOL = 5 THEN BEGIN    V = FILT╞RES(FSROW) + DELTA    IF V > 15 THEN V = 15    FILT╞RES(FSROW) = V  BEND  IF FSCOL=6 AND FILT╞DIR(FSROW) < 3 THEN FILT╞DIR(FSROW) = FILT╞DIR(FSROW) + 1  IF FSCOL=7 AND FILT╞MIN(FSROW) < 2047 THEN BEGIN    V = FILT╞MIN(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILT╞MIN(FSROW) = V  BEND      IF FSCOL=8 AND FILT╞SWEEP(FSROW) < 2047 THEN BEGIN    V = FILT╞SWEEP(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILT╞SWEEP(FSROW) = V  BEND  GOSUB APPLY╞SELECTED╞FILTER  RETURN.DECR╞FVAL'---------  IF FSCOL = 1 THEN BEGIN    V = FILT╞FREQ(FSROW) - DELTA    IF V < 0 THEN V = 0    FILT╞FREQ(FSROW) = V  BEND  IF FSCOL = 2 THEN FILT╞LP(FSROW) = 0  IF FSCOL = 3 THEN FILT╞BP(FSROW) = 0  IF FSCOL = 4 THEN FILT╞HP(FSROW) = 0  IF FSCOL = 5 THEN BEGIN    V = FILT╞RES(FSROW) - DELTA    IF V < 0 THEN V = 0    FILT╞RES(FSROW) = V  BEND  IF FSCOL=6 AND FILT╞DIR(FSROW) > 0 THEN FILT╞DIR(FSROW) = FILT╞DIR(FSROW) - 1  IF FSCOL=7 AND FILT╞MIN(FSROW) > 0 THEN BEGIN    V = FILT╞MIN(FSROW) - DELTA    IF V < 0 THEN V = 0    FILT╞MIN(FSROW) = V  BEND  IF FSCOL=8 AND FILT╞SWEEP(FSROW) > 0 THEN BEGIN    V = FILT╞SWEEP(FSROW) - DELTA    IF V < 0 THEN V = 0    FILT╞SWEEP(FSROW) = V  BEND  GOSUB APPLY╞SELECTED╞FILTER  RETURN.APPLY╞VAL'---------  IF SCOL=0 THEN ENVS╞NAME$(SROW) = V$  IF SCOL=1 THEN ENVS╞ATTACK(SROW) = V  IF SCOL=2 THEN ENVS╞DECAY(SROW) = V  IF SCOL=3 THEN ENVS╞SUSTAIN(SROW) = V  IF SCOL=4 THEN ENVS╞RELEASE(SROW) = V  IF SCOL=5 THEN ENVS╞WAVEFORM(SROW) = V  IF SCOL=6 THEN ENVS╞PW(SROW) = V  ROW = SROW  GOSUB SET╞ENV  RETURN.SET╞ENV'-------  ENVELOPE ROW, ENVS╞ATTACK(ROW), ENVS╞DECAY(ROW), ENVS╞SUSTAIN(ROW), ENVS╞RELEASE(ROW), ENVS╞WAVEFORM(ROW), ENVS╞PW(ROW)  RETURN.RUNSTOP╞TRAPPER'---------------  IF ER=30 THEN RESUME  ' IGNORE RUN/STOP  TRAP  PRINT ERR$(ER);" ERROR"  PRINT " IN LINE";EL  KEY ON  END.CHUNK╞SEQUENCER'---------------  DO WHILE 1    GOSUB DRAW╞SEQUENCE    GOSUB GET╞USER╞INPUT╞FOR╞SEQUENCE    IF A$ = кеы╞мега╞я THEN EXIT  LOOP  RETURN.DRAW╞SEQUENCE'-------------  PRINT "⌠SEQUENCE EDITOR"  PRINT "---------------"  PRINT "а)DD и)NSERT д)ELETE, еDIT=ртн, пLAYаLL=схфт+ртн, пLAY=спц - SEQCNT = ";SEQCNT  PRINT "ц: EDIT цмд, есц: STOP MUSIC, мега+я: EXIT"  PRINT " цMD            еXTRA"           PRINT " ---            -----"  IF INT((SEQCNT-1)/43) > 1 AND (INT(SEQ╞OFFS/43)+1) < INT((SEQCNT-1)/43) THEN BEGIN    'IF INT((SEQCNT-1) / 43) * 43 > SEQ╞OFFS THEN BEGIN      CURSOR 75, 5:PRINT "--->"    'BEND  BEND  IF SEQ╞OFFS > 0 THEN BEGIN    CURSOR 70, 5:PRINT "<---"  BEND  K = SEQ╞OFFS  DO WHILE K < SEQCNT    IF K > (SEQ╞OFFS + 43 * 2 - 1) THEN K=SEQCNT:GOTO NXT    IF (K-SEQ╞OFFS) >= 43 THEN CURSOR 40,6+(K-SEQ╞OFFS-43)    IF PLYPTR = K THEN PRINT ">";:ELSE PRINT " ";    S=0:GOSUB HIGHLIGHT╞SELECTED╞SEQ╞COLUMN    ' CHUNK IS A SPECIAL цмд╞*?    IF SEQ╞CHUNK(K) < 0 AND ABS(SEQ╞CHUNK(K)) < цмд╞маь THEN BEGIN      V$ = SEQ╞CMDNAME$(ABS(SEQ╞CHUNK(K)))      S = 10-LEN(V$)      PRINT V$;      DO WHILE S >= 0        PRINT " ";        S = S - 1      LOOP    BEND:ELSE BEGIN      PRINT SEQ╞CHUNK(K);кеы╞таб;    BEND    S=1:GOSUB HIGHLIGHT╞SELECTED╞SEQ╞COLUMN    HANDLED = 0    IF SEQ╞CHUNK(K) = цмд╞филтер THEN BEGIN      HANDLED = 1      IF SEQ╞EXTRA(K) = -1 THEN PRINT кеы╞таб;"<NONE>":ELSE BEGIN        PRINT кеы╞таб;FILT╞NAME$(SEQ╞EXTRA(K))      BEND    BEND    IF HANDLED=0 AND SEQ╞CHUNK(K) = цмд╞темпо THEN BEGIN      HANDLED = 1      PRINT кеы╞таб;SEQ╞EXTRA(K)    BEND    ' елсе    IF HANDLED = 0 THEN BEGIN       PRINT кеы╞таб;SEQ╞EXTRA(K)    BEND    PRINT кеы╞реж╞офф;.NXT    K = K + 1  LOOP    RETURN.HIGHLIGHT╞SELECTED╞SEQ╞COLUMN'-----------------------------  IF SEQPTR = K AND SSCOL=S THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  RETURN.GET╞USER╞INPUT╞FOR╞SEQUENCE'---------------------------  GOSUB READ╞KEY╞LOOP  IF A$="A" THEN GOSUB ADD╞CHUNK╞TO╞SEQ  IF A$="I" THEN GOSUB INSERT╞CHUNK╞TO╞SEQ  ' IF A$="E" THEN GOSUB EDIT╞CHUNK╞SEQ  IF A$="D" THEN GOSUB DELETE╞CHUNK╞SEQ  IF A$=кеы╞уп AND SEQPTR > 0 THEN SEQPTR = SEQPTR - 1  IF A$=кеы╞довн AND SEQPTR < SEQCNT-1 THEN SEQPTR = SEQPTR + 1   IF A$=кеы╞лефт THEN BEGIN    IF SSCOL = 1 THEN BEGIN      SSCOL = 0    BEND:ELSE BEGIN      IF (SEQPTR-43)>=0 THEN BEGIN        SSCOL = 1        SEQPTR = SEQPTR - 43      BEND    BEND  BEND  IF A$=кеы╞ригхт THEN BEGIN    IF SSCOL = 0 THEN BEGIN      SSCOL = 1    BEND:ELSE BEGIN      IF (SEQPTR+43) < SEQCNT THEN BEGIN        SSCOL = 0        SEQPTR = SEQPTR + 43      BEND    BEND   BEND  IF A$=кеы╞схифт╞ретурн THEN BEGIN    PLYPTR = 0    PLYFLAG = 1    CHUNK╞RPT = 0    PLAY    GOSUB SET╞ALL╞ENV    TEMPO TMPO%  BEND  IF A$=кеы╞спаце THEN BEGIN    PLYPTR = SEQPTR    PLYFLAG = 1    CHUNK╞RPT = 0    PLAY    GOSUB SET╞A!LL╞ENV    TEMPO TMPO%  BEND  IF A$=кеы╞ретурн THEN GOSUB EDIT╞CHUNK╞CELL  IF A$="C" THEN GOSUB EDIT╞CHUNK╞CMD  IF A$=кеы╞есцапе THEN GOSUB STOP╞ALL╞MUSIC  IF A$=кеы╞хоме THEN SEQPTR = 0  IF A$=кеы╞цлр THEN SEQPTR = SEQCNT-1  ' FINALLY, ADJUST SE"Q╞OFFS IF NEEDBE  IF (INT(SEQPTR / 43) * 43) < SEQ╞OFFS THEN SEQ╞OFFS = SEQ╞OFFS - 43  IF (INT(SEQPTR / 43) * 43) > (SEQ╞OFFS+43) THEN SEQ╞OFFS = SEQ╞OFFS + 43  RETURN.STOP╞ALL╞MUSIC'--------------  PLYPTR = -1  PLYFLAG = 0  PLAY  GOSUB SET╞AL#L╞ENV  TEMPO TMPO%  GOSUB APPLY╞SELECTED╞FILTER  RETURN.DELETE╞CHUNK╞SEQ'----------------  IF SEQCNT = 0 THEN RETURN  K = SEQPTR  DO WHILE K < SEQCNT - 1    SEQ╞CHUNK(K) = SEQ╞CHUNK(K + 1)    SEQ╞EXTRA(K) = SEQ╞EXTRA(K + 1)    K = K + 1  LO$OP  SEQCNT = SEQCNT - 1  IF SEQPTR = SEQCNT AND SEQPTR>0 THEN SEQPTR = SEQPTR - 1  RETURN.EDIT╞CHUNK╞SEQ'--------------  IF SEQCNT = 0 THEN RETURN  PRINT кеы╞хоме;кеы╞таб;кеы╞таб;кеы╞есцапе;"Q";  V=0:INPUT "CHUNK#: ", V  SEQ╞CHUNK(SEQPTR) = %V  PRINT кеы╞хоме;кеы╞таб;кеы╞таб;кеы╞есцапе;"Q";  V=-1:INPUT "EXTRA#: ", V  SEQ╞EXTRA(SEQPTR) = V  RETURN.EDIT╞CHUNK╞CELL'---------------  IF SEQCNT = 0 THEN RETURN  PRINT кеы╞хоме;кеы╞таб;кеы╞таб;кеы╞есцапе;"Q";  IF SSCOL = 0 THEN BEGIN  &'       (сетбит WILL INTERNALLY NEED A READ PRIOR TO THE WRITE)  ' буг? и COULDN'T DO поке $д415 (IT BECAME 868691 = $д4153 ?!)  WPOKE 54293, (CURR╞FREQ AND 7) + ((CURR╞FREQ >> 3) * 256)  WPOKE 54357, (CURR╞FREQ AND 7) + ((CURR╞FREQ >> 3) * 256)  'IF CURR╞DIR = дир╞уп THEN BEGIN    CURR╞FREQ = CURR╞FREQ + FILT╞SWEEP(FSEL)    IF CURR╞FREQ > FILT╞FREQ(FSEL) THEN BEGIN      CURR╞FREQ = FILT╞FREQ(FSEL)      IF FILT╞DIR(FSEL) = дир╞осц THEN CURR╞DIR = дир╞довн      IF FILT╞DIR(FSEL) = дир╞уп THEN  CURR╞FREQ = FILT╞MIN(FSEL)    BEND    RETURN  BEND  IF CURR╞DIR = дир╞довн THEN BEGIN    CURR╞FREQ = CURR╞FREQ - FILT╞SWEEP(FSEL)    IF CURR╞FREQ < FILT╞MIN(FSEL) THEN BEGIN      CURR╞FREQ = FILT╞MIN(FSEL)      IF FILT╞DIR(FSEL) = дир╞осц THEN C    TEMPO TMPO% : PLAY V1$  BEND  IF KEY$="," THEN DELTA = -1 : GOSUB TRANSPOSE╞OCTAVE  IF KEY$="." THEN DELTA = 1  : GOSUB TRANSPOSE╞OCTAVE  IF KEY$="I" THEN GOSUB INSERT╞CHUNK  KEY$ = ""  RETURN.COPY╞ALL╞VOICES╞TO╞CLIPBOARD'----------------------------  FOR Y = 0 TO 5    CP$(Y) = V$(Y, CHUNK╞IDX)  NEXT Y  RETURN.PASTE╞ALL╞VOICES╞FROM╞CLIPBOARD'-------------------------------  FOR Y = 0 TO 5    V$(Y, CHUNK╞IDX) = CP$(Y)  NEXT Y  RETURN.INSERT╞CHUNK'------------  FOR K = CHUNK╞MAX-1 TO CHUNK╞IDX + 1 STEP -1    FOR Y = 0 TO 5      V$(Y, K) = V$(Y, K-1)    NEXT Y  NEXT K  FOR Y = 0 TO 5    V$(Y, CHUNK╞IDX) = ""  NEXT Y  ' REPAIR ITEMS IN THE SEQUENCE THAT ARE AFFECTED  FOR K = 0 TO 100    IF SEQ╞CHUNK(K) >= CHUNK╞IDX THEN SEQ╞CHUNK(K) = SEQ╞CHUNK(K) + 1  NEXT K  RETURN.TRANSPOSE╞OCTAVE'----------------  V1$ = V$(CURSOR╞Y, CHUNK╞IDX)  LIMIT = 0  IF DELTA = 1 THEN LIMIT = 6  RET% = 0  GOSUB CAN╞TRANSPOSE╞OCTAVE  IF RET% = 0 THEN PRINT кеы╞бееп; : RETURN  K = 0  DO WHILE K < LEN(V1$)    V2$ = MID$(V1$,K+1,1)    IF V2$ = "O" AND (K + 1) < LEN(V1$) THEN BEGIN      V2$ = STR$(VAL(MID$(V1$,K+2,1)) + DELTA)      V2$ = MID$(V2$,2)      V1$ = LEFT$(V1$,K+1) + V2$ + MID$(V1$, K+3)    BEND    K = K + 1  LOOP  V$(CURSOR╞Y, CHUNK╞IDX) = V1$  RETURN.CAN╞TRANSPOSE╞OCTAVE'--------------------  RET% = 1  K = 0  DO WHILE K < LEN(V1$)    V2$ = MID$(V1$,K+1,1)    IF V2$ = "O" AND (K+1) < LEN(V1$) THEN BEGIN      V2$ = MID$(V1$,K+2,1)      IF VAL(V2$) = LIMIT THEN RET% = 0 : RETURN    BEND    K = K + 1  LOOP  RETURN.PLAY╞CHUNK╞IDX'--------------  V1$ = V$(0,CHUNK╞IDX)  V2$ = V$(1,CHUNK╞IDX)  V3$ = V$(2,CHUNK╞IDX)  V4$ = V$(3,CHUNK╞IDX)  V5$ = V$(4,CHUNK╞IDX)  V6$ = V$(5,CHUNK╞IDX)  IF ECHO╞DELAY = 1 THEN BEGIN    PLAY V1$    SLEEP (ECHO╞SZ)    PLAY ,V2$    SLEEP (ECHO╞SZ)    PLAY ,,V3$    SLEEP (ECHO╞SZ)    PLAY ,,,V4$    SLEEP (ECHO╞SZ)    PLAY ,,,,V5$    SLEEP (ECHO╞SZ)    PLAY ,,,,,V6$    SLEEP (ECHO╞SZ)    RE	TURN  BEND  IF ECHO╞M = 0 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$, V2$, V3$, V4$, V5$, V6$    RETURN  BEND  IF ECHO╞M = 1 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$, V6$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$  BEND  IF E
CHO╞M = 1 AND ECHO╞B = 1 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$,    , V3$  BEND  IF ECHO╞M = 2 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$,    , V3$,    ,    , V6$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$    SLEEP (ECHO╞SZ)    PLAY    , V1$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    ,    , V1$  BEND  IF ECHO╞M = 2 AND ECHO╞B = 1 THEN BEGIN    PLAY V1$,    , V3$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$    SLEEP (ECHO╞SZ)    PLAY    , V1$,    ,    ,    , V3$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    ,    , V1$  BEND  RETURN.ENVELOPE╞EDITOR'---------------  DO WHILE 1    GOSUB DRAW╞TABLE    GOSUB GET╞USER╞INPUT╞FOR╞TABLE    ' ALT+Q TO EXIT    IF A$ = кеы╞мега╞я THEN EXIT  LOOP  RETURN.DRAW╞TABLE'----------  PRINT "⌠ENV EDITOR";кеы╞таб;DUR$(SDUR, днаме);кеы╞таб;"OCTAVE";OCT  PRINT "----------"  PRINT "-/+: DECR/INCR, </>: OCTAVE, ртн: EDIT, таб: FOCUS ENV/FILTER, мега+я: EXIT"  PRINT  PRINT "   наме";кеы╞таб;кеы╞таб;"аттацк";кеы╞таб;"децаы";кеы╞таб;"сустаин";кеы╞таб;"релеасе";кеы╞таб;  PRINT "важефрм";кеы╞таб;"пулсевидтх"  FOR ROW = 0 TO 9    IF SROW = ROW THEN PRINT ">";:ELSE PRINT " ";    PRINT ROW;": ";    COL = 0 : V$ = ENVS╞NAME$(ROW)    GOSUB SHOW╞CELL    COL = 1 : V = ENVS╞ATTACK(ROW)    GOSUB SHOW╞CELL    COL = 2 : V = ENVS╞DECAY(ROW)    GOSUB SHOW╞CELL    COL = 3 : V = ENVS╞SUSTAIN(ROW)    GOSUB SHOW╞CELL    COL = 4 : V = ENVS╞RELEASE(ROW)    GOSUB SHOW╞CELL    COL = 5 : V = ENVS╞WAVEFORM(ROW)    GOSUB SHOW╞CELL    COL = 6 : V = ENVS╞PW(ROW)    GOSUB SHOW╞CELL    PRINT  NEXT ROW  PRINT  PRINT "FILTER EDITOR"  PRINT "-------------";  PRINT кеы╞таб;"FREQ";кеы╞таб;"LP";кеы╞таб;"BP";кеы╞таб;"HP";кеы╞таб;"RES";  PRINT кеы╞таб;"DIR";кеы╞таб;"MIN";кеы╞таб;"SWEEP"  FOR FPRESET = 0 TO 10    GOSUB SHOW╞FILTER  NEXT FPRESET  RETURN.SHOW╞FILTER'-----------  IF FSEL = FPRESET THEN PRINT ">";:ELSE PRINT " ";  K = 0 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞NAME$(FPRESET);"  ";кеы╞таб;  K = 1 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞FREQ(FPRESET);кеы╞таб;  K = 2 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞STATE╞NAME$(FILT╞LP(FPRESET));кеы╞таб;  K = 3 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞STATE╞NAME$(FILT╞BP(FPRESET));кеы╞таб;  K = 4 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞STATE╞NAME$(FILT╞HP(FPRESET));кеы╞таб;  K = 5 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞RES(FPRESET);кеы╞таб;  K = 6 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT DIR╞NAME$(FILT╞DIR(FPRESET));кеы╞таб;  K = 7 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞MIN(FPRESET);кеы╞таб;  K = 8 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞SWEEP(FPRESET);  PRINT кеы╞реж╞офф  RETURN.CHECK╞SHOW╞FILTER╞HIGHLIGHT'---------------------------  IF FSROW = FPRESET AND FFOCUS = 1 AND FSCOL = K THEN _    PRINT кеы╞реж╞он; : ELSE PRINT кеы╞реж╞офф;  RETURN.GET╞VAL'-------  IF SCOL = 0 THEN V$ = ENVS╞NAME$(SROW)  IF SCOL = 1 THEN V = ENVS╞ATTACK(SROW)  IF SCOL = 2 THEN V = ENVS╞DECAY(SROW)  IF SCOL = 3 THEN V = ENVS╞SUSTAIN(SROW)  IF SCOL = 4 THEN V = ENVS╞RELEASE(SROW)  IF SCOL = 5 THEN V = ENVS╞WAVEFORM(SROW)  IF SCOL = 6 THEN V = ENVS╞PW(SROW)  RETURN.SHOW╞CELL'---------  IF SROW=ROW AND SCOL = COL AND FFOCUS=0 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  IF COL = 0 THEN BEGIN    PRINT V$;кеы╞таб;"▓";    RETURN  BEND  IF COL = 5 THEN BEGIN    PRINT WNAME$(V);кеы╞таб;кеы╞реж╞офф;    RETURN  BEND  ' ELSE  PRINT V;кеы╞таб;кеы╞реж╞офф;  RETURN.GET╞USER╞INPUT╞FOR╞TABLE'------------------------  ' GET KEY A$  GOSUB READ╞KEY╞LOOP  IF A$ = кеы╞лефт AND SCOL > 0 THEN SCOL = SCOL - 1  IF A$ = кеы╞ригхт AND SCOL < 6 THEN SCOL = SCOL + 1  IF A$ = кеы╞уп AND SROW > 0 THEN SROW = SROW - 1  IF A$ = кеы╞довн AND SROW < 9 THEN SROW = SROW + 1  IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCR╞VAL  IF A$ = "-" THEN DELTA=1 : GOSUB DECR╞VAL  IF A$ = кеы╞схифт╞плус THEN DELTA=100 : GOSUB INCR╞VAL  IF A$ = кеы╞схифт╞минус THEN DELTA=100 : GOSUB DECR╞VAL  IF A$ = кеы╞ретурн THEN A$ = "+" : GOSUB EDIT╞ENV╞FIELD  IF A$ = кеы╞схифт╞ретурн THEN A$ = "-" : GOSUB EDIT╞ENV╞FIELD  IF A$ = кеы╞таб THEN FFOCUS = 1 : GOSUB GET╞USER╞INPUT╞FOR╞FILTERS  GOSUB CHECK╞DURATION╞CHANGE  GOSUB CHECK╞PIANO╞KEYS  RETURN.GET╞USER╞INPUT╞FOR╞FILTERS'--------------------------  DO WHILE 1    GOSUB DRAW╞TABLE    ' GET KEY A$    GOSUB READ╞KEY╞LOOP    IF A$ = кеы╞лефт AND FSCOL > 0 THEN FSCOL = FSCOL - 1    IF A$ = кеы╞ригхт AND FSCOL < 8 THEN FSCOL = FSCOL + 1    IF A$ = кеы╞уп AND FSROW > 0 THEN FSROW = FSROW - 1    IF A$ = кеы╞довн AND FSROW < 10 THEN FSROW = FSROW + 1    IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCR╞FVAL    IF A$ = "-" THEN DELTA=1 : GOSUB DECR╞FVAL    IF A$ = кеы╞схифт╞плус THEN DELTA = 100 : GOSUB INCR╞FVAL    IF A$ = кеы╞схифт╞минус THEN DELTA = 100 : GOSUB DECR╞FVAL    IF A$ = " " THEN BEGIN      IF FSEL = FSROW THEN FSEL = -1:ELSE FSEL = FSROW      GOSUB APPLY╞SELECTED╞FILTER    BEND    IF A$ = кеы╞ретурн THEN GOSUB EDIT╞FILTER╞FIELD:GOSUB APPLY╞SELECTED╞FILTER    IF A$ = кеы╞таб OR A$ = кеы╞мега╞я THEN EXIT    GOSUB CHECK╞DURATION╞CHANGE    GOSUB CHECK╞PIANO╞KEYS  LOOP  FFOCUS = 0  RETURN.READ╞KEY╞LOOP'-------------  A$ = ""  DO WHILE A$=""    GET A$    IF FSEL <> -1 THEN BEGIN      GOSUB UPDATE╞SELECTED╞FILTER    BEND    IF PLYFLAG = 1 THEN BEGIN      IF RPLAY(1) = 0 THEN GOSUB PARSE╞CURRENT╞SEQPTR    BEND  LOOP  RETURN.PARSE╞CURRENT╞SEQPTR'----------------- ---  K = SEQ╞CHUNK(PLYPTR)    IF K >= 0 THEN BEGIN    CHUNK╞IDX = K    IF CHUNK╞RPT <= 0 THEN CHUNK╞RPT = SEQ╞EXTRA(PLYPTR)    GOSUB PLAY╞CHUNK╞IDX    SLEEP .1    GOSUB DRAW╞SEQUENCE  BEND  IF K = цмд╞темпо THEN BEGIN    K = SEQ╞EXTRA(PLYPTR)!    TEMPO (K)    TMPO% = K  BEND  IF K = цмд╞филтер THEN BEGIN    K = SEQ╞EXTRA(PLYPTR)    FSROW = K    FSEL = K    GOSUB APPLY╞SELECTED╞FILTER  BEND  IF K = цмд╞ецхо╞м1 THEN ECHO╞M = 1 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞м2 THEN ECHO╞M = 2 : ECH"O╞DELAY = 0  IF K = цмд╞ецхо╞б  THEN ECHO╞B = 1 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞офф THEN ECHO╞M = 0 : ECHO╞B = 0  IF K = цмд╞ецхо╞сз THEN ECHO╞SZ = SEQ╞EXTRA(PLYPTR)  IF K = цмд╞делаы THEN ECHO╞DELAY = 1 : ECHO╞M = 0 : ECHO╞B = 0  IF K = цмд╞жол #THEN V = SEQ╞EXTRA(PLYPTR) : VOL V, V  IF CHUNK╞RPT > 0 THEN CHUNK╞RPT = CHUNK╞RPT - 1  IF CHUNK╞RPT <= 0 THEN PLYPTR = PLYPTR + 1  IF K = цмд╞лооп THEN PLYPTR = 0  IF PLYPTR >= SEQCNT THEN PLYFLAG = 0 : PLYPTR = -1  RETURN.CHECK╞DURATION╞CHAN$GE'---------------------  FOR K = д╞вхоле TO д╞сиьтеентх    IF A$ = DUR$(K, дкеы) THEN SDUR = K  NEXT K  ' CHECK OCTAVE TOO  IF A$ = ">" AND OCT < 6 THEN OCT = OCT + 1  IF A$ = "<" AND OCT > 0 THEN OCT = OCT - 1  RETURN.UPDATE╞SELECTED╞FILTE%R'----------------------  IF FSEL = -1 THEN RETURN  IF CURR╞DIR = дир╞ноне THEN RETURN  PRINT "";кеы╞таб;кеы╞таб;кеы╞таб;кеы╞таб;кеы╞таб;CHR$(27);"QCURR╞FREQ=";CURR╞FREQ;    ' ноте: цAN'T USE сетбит FOR сид REGISTERS AS THE REGS ARE WRITE-ONLY  &KEY$ = кеы╞схифт╞ретурн THEN BEGIN    TEMPO TMPO%    GOSUB PLAY╞CHUNK╞IDX  BEND  IF KEY$ = кеы╞инст THEN BEGIN    V1$ = V$(CURSOR╞Y, CHUNK╞IDX)    V1$ = LEFT$(V1$,CURSOR╞X) + MID$(V1$,CURSOR╞X+2)    V$(CURSOR╞Y, CHUNK╞IDX) = V1$  BEND  GOSUB C'HECK╞VALID╞KEY  RETURN.CHECK╞ALT╞KEY╞INPUTS'--------------------  ALT╞KEY = PEEK($D611) AND 16  IF ALT╞KEY = 0 THEN RETURN  IF KEY$="X" THEN CLIP$=V$(CURSOR╞Y, CHUNK╞IDX) : V$(CURSOR╞Y, CHUNK╞IDX) = ""  IF KEY$="C" THEN CLIP$=V$(CURSOR╞Y, CHUNK ╞IDX)  IF KEY$="V" THEN V$(CURSOR╞Y, CHUNK╞IDX) = CLIP$  IF KEY$="ц" THEN GOSUB COPY╞ALL╞VOICES╞TO╞CLIPBOARD  IF KEY$="ж" THEN GOSUB PASTE╞ALL╞VOICES╞FROM╞CLIPBOARD  IF KEY$=кеы╞ретурн THEN BEGIN    V1$ = MID$(V$(CURSOR╞Y, CHUNK╞IDX), CURSOR╞X + 1)FREQ, CURR╞DIR#DECLARE HANDLED#DECLARE PLYPTR = -1, PLYFLAG.DURATION'--------#DEFINE днаме = 0#DEFINE дцхар = 1#DEFINE дкеы  = 2#DEFINE д╞вхоле = 0#DEFINE д╞халф = 1#DEFINE д╞яуартер = 2#DEFINE д╞еигхтх = 3#DEFINE д╞сиьтеентх = 4#DECLARE SDUR = 2#DECLARE DUR$(5,2)DUR$(д╞вхоле, днаме) = "WHOLE"DUR$(д╞вхоле, дцхар) = "W"DUR$(д╞вхоле, дкеы)  = "1"DUR$(д╞халф, днаме) = "HALF"DUR$(д╞халф, дцхар) = "H"DUR$(д╞халф, дкеы)  = "2"DUR$(д╞яуартер, днаме) = "QUARTER"DUR$(д╞яуартер, дцхар) = "Q"DUR$(д╞яуартер, дкеы)  = "3"DUR$(д╞еигхтх, днаме) = "EIGHTH"DUR$(д╞еигхтх, дцхар) = "I"DUR$(д╞еигхтх, дкеы)  = "4"DUR$(д╞сиьтеентх, днаме) = "SIXTEENTH"DUR$(д╞сиьтеентх, дцхар) = "S"DUR$(д╞сиьтеентх, дкеы)  = "5"#DECLARE CLIP$, ALT╞KEY, LIMIT, RET%, Y, CP$(6).KEYS'----#DEFINE кеы╞уп = "▒"#DEFINE кеы╞довн = ""#DEFINE кеы╞лефт = "²"#DEFINE кеы╞ригхт = ""#DEFINE кеы╞спаце = " "#DEFINE кеы╞дел = ""#DEFINE кеы╞цтрл╞в = ""#DEFINE кеы╞цтрл╞у = ""#DEFINE кеы╞мега╞я = "╚"#DEFINE кеы╞ф1 = "┘"#DEFINE кеы╞ф3 = "├"#DEFINE кеы╞ф4 = "┼"#DEFINE кеы╞ф7 = "┬"#DEFINE кеы╞ф8 = "▄"#DEFINE кеы╞ф9 = CHR$(16)#DEFINE кеы╞ретурн = CHR$(13)#DEFINE кеы╞есцапе = CHR$(27)#DEFINE кеы╞схифт╞ретурн = CHR$(141)#DEFINE кеы╞схифт╞плус = "ш"#DEFINE кеы╞схифт╞минус = "щ"#DEFINE кеы╞реж╞он = ""#DEFINE кеы╞реж╞офф = "▓"#DEFINE кеы╞таб = CHR$(9)#DEFINE кеы╞хоме = ""#DEFINE кеы╞цлр  = "⌠"#DEFINE кеы╞ловерцасе = CHR$(14)#DEFINE кеы╞упперцасе = CHR$(142)#DEFINE кеы╞бееп = CHR$(7)#DEFINE кеы╞инст = "■"#DEFINE кеы╞дел  = "".INIT'----PRINT "⌠";кеы╞ловерцасе;кеы╞есцапе;"5";PLAY : PLAY ""BACKGROUND 0 : BORDER 0COLOR 5.MAIN'----  KEY OFF  GOSUB DRAW╞EDITOR╞SCREEN  GOSUB USER╞INPUT  GOTO MAIN.DRAW╞EDITOR╞SCREEN'------------------  CURSOR 0,0:PRINT "⌠PLAYMAKER V0.5 - BY GURCE ISIKYILDIZ"  PRINT "---------"  PRINT "<: PREV CHUNK, >: NEXT CHUNK, -/+ TEMPO, ф7=ENV EDITOR, ф9/цтрл-п=SEQ EDITOR"  PRINT "ртн: PLAY CURR VOICE, схфт+ртн: PLAY ALL VOICE, ф1=LOAD, ф3=SAVE, мега+я=QUI	T"  PRINT "алт-ь/ц/ж: ROW CUT/COPY/PASTE, есц-есц: STOP MUSIC, алт-ртн: PLAY FROM CURSOR"  PRINT  GOSUB DRAW╞CURRENT╞CHUNK  RETURN.DRAW╞CURRENT╞CHUNK'------------------  PRINT "TEMPO: "; TMPO%  PRINT "CHUNK╞IDX: "; CHUNK╞IDX       FOR VIDX=0 
TO 5    IF CURSOR╞Y <> VIDX THEN BEGIN      CURSOR 0,9+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX+1;": ";V$(VIDX,CHUNK╞IDX);    BEND:ELSE BEGIN      CURSOR 0,9+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX+1;": ";      FOR IDX=1 TO LEN(V$(VIDX,CHUNK╞IDX))        IF CURSOR╞X = IDX-1 THEN BEGIN          PRINT "";MID$(V$(VIDX,CHUNK╞IDX),IDX,1);"▓";        BEND:ELSE BEGIN          PRINT MID$(V$(VIDX,CHUNK╞IDX),IDX,1);        BEND      NEXT IDX      IF LEN(V$(VIDX,CHUNK╞IDX)) = 0 OR CURSOR╞X=LEN(V$(VIDX,CHUNK╞IDX)) THEN PRINT " ▓";    BEND  NEXT VIDX  RETURN.CHECK╞VALID╞KEY'---------------  FOR IDX=1 TO LEN(VALID$)    VAL$=MID$(VALID$,IDX,1)    IF KEY$= VAL$ THEN BEGIN      IF CURSOR╞X < LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN BEGIN        V$(CURSOR╞Y,CHUNK╞IDX) = LEFT$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X) _          + VAL$ + MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1)        CURSOR╞X=CURSOR╞X+1        RETURN      BEND      V$(CURSOR╞Y,CHUNK╞IDX)=V$(CURSOR╞Y,CHUNK╞IDX)+VAL$      CURSOR╞X=CURSOR╞X+1      RETURN    BEND  NEXT IDX  RETURN.FORWARD╞WORD'------------  IF CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN RETURN  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) <> " "    CURSOR╞X=CURSOR╞X+1    IF CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN RETURN  LOOP  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) = " "    CURSOR╞X=CURSOR╞X+1    IF CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN RETURN  LOOP  RETURN.PREVIOUS╞WORD'-------------  IF CURSOR╞X = 0 THEN RETURN  IF CURSOR╞X = 1 THEN CURSOR╞X = 0: RETURN  CURSOR╞X = CURSOR╞X - 1  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) = " "    CURSOR╞X=CURSOR╞X-1    IF CURSOR╞X = 0 THEN RETURN  LOOP  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) <> " "    CURSOR╞X=CURSOR╞X-1    IF CURSOR╞X = 0 THEN RETURN  LOOP  CURSOR╞X=CURSOR╞X+1  RETURN.SET╞ALL╞ENV'-----------  FOR ROW = 0 TO 9    GOSUB SET╞ENV  NEXT ROW  RETURN.LOAD'----  INPUT "LOAD NAME: ";KEY$  IF KEY$="" THEN RETURN  DOPEN #2,(KEY$),R,U8  ' LOAD MELODY CHUNKS  ' ------------------  INPUT #2, CHUNK╞CNT  FOR CHUNK╞IDX = 0 TO CHUNK╞CNT - 1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNK╞IDX)    NEXT VIDX  NEXT CHUNK╞IDX  INPUT #2,TMPO%' #IFDEF еьтра    ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    INPUT #2, ENVS╞NAME$(ROW)    INPUT #2, ENVS╞ATTACK(ROW)    INPUT #2, ENVS╞DECAY(ROW)    INPUT #2, ENVS╞SUSTAIN(ROW)    INPUT #2, ENVS╞RELEASE(ROW)    INPUT #2, ENVS╞WAVEFORM(ROW)    INPUT #2, ENVS╞PW(ROW)    GOSUB SET╞ENV  NEXT ROW  PRINT  ' LOAD FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    INPUT #2, FILT╞NAME$(ROW)    INPUT #2, FILT╞FREQ(ROW)    INPUT #2, FILT╞LP(ROW)    INPUT #2, FILT╞BP(ROW)    INPUT #2, FILT╞HP(ROW)    INPUT #2, FILT╞RES(ROW)    INPUT #2, FILT╞DIR(ROW)    INPUT #2, FILT╞MIN(ROW)    INPUT #2, FILT╞SWEEP(ROW)  NEXT ROW  ' LOAD SEQUENCE  ' -------------  SEQCNT = 0  INPUT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    INPUT #2, SEQ╞CHUNK(ROW)    INPUT #2, SEQ╞EXTRA(ROW)    ROW = ROW + 1  LOOP' #ENDIF  DCLOSE #2  CHUNK╞IDX = 0  RETURN.GET╞CHUNK╞CNT'-------------  CHUNK╞CNT = 0  FOR K = 0 TO CHUNK╞MAX    IF V$(0,K)<>"" OR V$(1,K)<>"" OR V$(2,K)<>"" OR V$(3,K)<>"" OR V$(4,K)<>"" OR V$(5,K)<>"" THEN BEGIN      CHUNK╞CNT = K + 1    BEND  NEXT K  RETURN.SAVE'----  INPUT "SAVE NAME: ";KEY$  IF KEY$="" THEN RETURN    DELETE (KEY$)  DOPEN #2,(KEY$),W,U8  TMP = CHUNK╞IDX  ' SAVE MELODY CHUNKS  ' ------------------  GOSUB GET╞CHUNK╞CNT  PRINT #2, CHUNK╞CNT  FOR CHUNK╞IDX = 0 TO CHUNK╞CNT - 1    FOR VIDX=0 TO 5      PRINT #2,V$(VIDX, CHUNK╞IDX)    NEXT VIDX  NEXT CHUNK╞IDX  PRINT #2,TMPO%  ' SAVE ENVELOPES  ' --------------  FOR ROW = 0 TO 9    PRINT #2, ENVS╞NAME$(ROW)    PRINT #2, ENVS╞ATTACK(ROW)    PRINT #2, ENVS╞DECAY(ROW)    PRINT #2, ENVS╞SUSTAIN(ROW)    PRINT #2, ENVS╞RELEASE(ROW)    PRINT #2, ENVS╞WAVEFORM(ROW)    PRINT #2, ENVS╞PW(ROW)  NEXT ROW  ' SAVE FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    PRINT #2, FILT╞NAME$(ROW)    PRINT #2, FILT╞FREQ(ROW)    PRINT #2, FILT╞LP(ROW)    PRINT #2, FILT╞BP(ROW)    PRINT #2, FILT╞HP(ROW)    PRINT #2, FILT╞RES(ROW)    PRINT #2, FILT╞DIR(ROW)    PRINT #2, FILT╞MIN(ROW)    PRINT #2, FILT╞SWEEP(ROW)  NEXT ROW  ' SAVE SEQUENCE  ' -------------  PRINT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    PRINT #2, SEQ╞CHUNK(ROW)    PRINT #2, SEQ╞EXTRA(ROW)    ROW = ROW + 1  LOOP  DCLOSE #2  CHUNK╞IDX = TMP  RETURN.SAVE╞AS╞TEXT'------------  INPUT "SAVE (AS TEXT) NAME: ";KEY$  IF KEY$="" THEN RETURN  DELETE (KEY$)      DOPEN #2,(KEY$),W,U8  FOR CHUNK╞IDX = 0 TO CHUNK╞MAX    FOR VIDX=0 TO 5      PRINT #2, "V";CHR$(49+VIDX);"$(";STR$(CHUNK╞IDX);")=";      PRINT #2, CHR$(34);V$(VIDX, CHUNK╞IDX);CHR$(34)    NEXT VIDX      PRINT #2, ""  NEXT CHUNK╞IDX  DCLOSE #2  CHUNK╞IDX = 0  RETURN.USER╞INPUT'----------  ' GETKEY KEY$  GOSUB READ╞KEY╞LOOP  KEY$ = A$  GOSUB CHECK╞ALT╞KEY╞INPUTS  ' DOWN ARROW?  IF KEY$ = кеы╞довн AND CURSOR╞Y<5 THEN BEGIN    CURSOR╞Y = CURSOR╞Y + 1    IF CURSOR╞X > LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN CURSOR╞X = _      LEN(V$(CURSOR╞Y,CHUNK╞IDX))  BEND  ' UP ARROW?  IF KEY$ = кеы╞уп AND CURSOR╞Y>0 THEN BEGIN    CURSOR╞Y = CURSOR╞Y - 1    IF CURSOR╞X > LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN _      CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX))  BEND  ' RIGHT ARROW?  IF KEY$ = кеы╞ригхт AND CURSOR╞X < LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN BEGIN    CURSOR╞X=CURSOR╞X+1  BEND  ' LEFT ARROW?  IF KEY$ =  кеы╞лефт AND CURSOR╞X > 0 THEN CURSOR╞X=CURSOR╞X-1  ' BACKSPACE (INST/DEL)?  IF KEY$ = кеы╞дел AND CURSOR╞X > 0 THEN BEGIN    V$(CURSOR╞Y,CHUNK╞IDX)=LEFT$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X-1) _      + MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1)    CURSO!R╞X=CURSOR╞X-1  BEND  IF ESC╞FLAG% THEN BEGIN    ESC╞FLAG%=0    IF KEY$ = "J" THEN BEGIN:CURSOR╞X=0:BEND    IF KEY$ = "K" THEN BEGIN:CURSOR╞X=LEN(V$(CURSOR╞Y,CHUNK╞IDX)):BEND    IF KEY$=кеы╞есцапе THEN GOSUB STOP╞ALL╞MUSIC    KEY$=""  BEND  IF" KEY$ = кеы╞есцапе THEN ESC╞FLAG%=ABS(ESC╞FLAG%-1)  ' CTRL-W = FORWARD ONE WORD  IF KEY$ = кеы╞цтрл╞в THEN GOSUB FORWARD╞WORD  ' CTRL-U = BACK ONE WORD  IF KEY$ = кеы╞цтрл╞у THEN GOSUB PREVIOUS╞WORD  ' < / > = PREVIOUS/NEXT CHUNK  IF KEY$ = "<" #AND CHUNK╞IDX>0 THEN BEGIN    CHUNK╞IDX=CHUNK╞IDX-1    CURSOR╞X=0  BEND  IF KEY$ = ">" AND CHUNK╞IDX<CHUNK╞MAX THEN BEGIN    CHUNK╞IDX=CHUNK╞IDX+1    CURSOR╞X=0  BEND  ' +/- = TEMPO CHANGE  IF KEY$="-" THEN TMPO%=TMPO%-1  IF KEY$="+" THEN TMPO$%=TMPO%+1  ' MEGA-Q = EXIT  IF KEY$ = кеы╞мега╞я THEN BEGIN    PRINT "ARE YOU SURE? (Y/N)"    GET KEY A$    IF A$="Y" THEN KEY ON:END  BEND  IF KEY$ = кеы╞ф1 THEN GOSUB LOAD  IF KEY$ = кеы╞ф3 THEN GOSUB SAVE  IF KEY$ = кеы╞ф7 THEN GOSUB ENVELO%PE╞EDITOR  IF KEY$ = кеы╞ф9 THEN GOSUB CHUNK╞SEQUENCER  ' ф4 = SAVE AS TEXT  IF KEY$ = кеы╞ф4 THEN GOSUB SAVE╞AS╞TEXT  ' RETURN=PLAY ROW  IF KEY$ = кеы╞ретурн THEN TEMPO TMPO% : PLAY V$(CURSOR╞Y,CHUNK╞IDX)  ' SHIFT+RETURN=PLAY ALL CHANNELS  IF &$(8) = "ецхо╞сз"SEQ╞CMDNAME$(9) = "жол"SEQ╞CMDNAME$(10) = "делаы"#DECLARE SEQCNT, SEQPTR#DECLARE ROW, COL, SROW, SCOL, A$, V, MAXV, V$#STRUCT кеы╞тыпе IN$, OUT$кеы╞тыпе KEYS(11) = [ _  [ "A", "C", ], _  [ "W", "#C", ], _  [ "S", "D", ], _  '[ "E", "#D", ], _  [ "D", "E", ], _  [ "F", "F", ], _  [ "T", "#F", ], _  [ "G", "G", ], _  [ "Y", "#G", ], _  [ "H", "A", ], _  [ "U", "#A", ], _  [ "J", "B", ] _]#DECLARE PSTR$, K, DELTA#DECLARE WNAME$(4)WNAME$(0) = "три"WNAME$(1) = "сав "WNAME$(2) = "пулсе"WNAME$(3) = "ноисе"WNAME$(4) = "ринг"#DECLARE FILT╞STATE╞NAME$(2)FILT╞STATE╞NAME$(0) = "офф"FILT╞STATE╞NAME$(1) = "он"#DECLARE FPRESET = 1#DECLARE FSCOL = 0, FSROW = 0, FFOCUS = 0, FSEL = -1#DECLARE OCT = 5#DECLARE CURR╞#OUTPUT PLAYMAKER' кEYS:' ----'    уP ARROW = мOVE TO PREVIOUS VOICE'  дOWN ARROW = мOVE TO NEXT VOICE'  лEFT ARROW = мOVE LEFT WITHIN CURRRENT VOICE STRING' рIGHT ARROW = мOVE RIGHT WITHIN CURRENT VOICE STRING'    инст/дел = дELETE CHAR IN CURRENT VOICE STRING'       есц,й = мOVE TO START OF CURRENT VOICE STRING'       есц,к = мOVE TO END OF CURRENT VOICE STRING'      цтрл+в = мOVE FORWARD ONE WORD IN CURRENT VOICE STRING'      цтрл+у = мOVE BACK ONE WORD IN CURRENT VOICE STRING'          #OUTPUT "BASLOGO"' банк4 мEMORY USAGE' ------------------' 4.0000 дма-лист' 4.0020 VAR INTERFACE TO ASSEMBLY'        0020: PTR TO DEFAULT╞RED&'        0022: PTR TO DEFAULT╞GREEN&'        0024: PTR TO DEFAULT╞BLUE&'        0026: PTR TO CURR╞RED&'        0028: PTR TO CURR╞GREEN&'        002A: PTR TO CURR╞BLUE&'        002C: PTR TO DATA╞ADDR%'        002E: PTR TO CDATA╞ADDR%'        0030: PTR TO SCRADDR%'        0032: PTR TO CLRADDR%'        0034: PTR TO INC%' 4.0800 сцреен меморы' 4.2000 петсции грапхицс' банк5 мEMORY USAGE' ------------------' 5.0000 SCREEN BUFFER' 5.1000 COLOR RAM BUFFER.DEFINES#DECLARE K, PTR, TMP, MAX╞FRAMES, FRM╞IDX, FRMW, FRMH, SZ#DECLARE FRAME╞ADDR%(25), SRC╞ADDR, DEST╞ADDR, LENGTH, TRANSP#DECLARE FRAME  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞с  FX=-999 : FY=FRMY(2)  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  RETURN'------------------.DRAW╞PETSCII╞FRAME'------------------  POKE $4000B, $04  ' ASSURE SOURCE BANK 4 (FOR ORIGINAL FRAME DATA)  IF MIRROR = 1 THEN SETBIT $40006, 5:ELSE CLRBIT $40006, 5  DATA╞ADDR% = FRAME╞ADDR%(FRAMEIDX)  BANK 4  FRMX = PEEK(DATA╞ADDR% + фрм╞оффсет╞ь)  FRMY = PEEK(DATA╞ADDR% + фрм╞оффсет╞ы)  FRMW = PEEK(DATA╞ADDR% + фрм╞оффсет╞в)  FRMH = PEEK(DATA╞ADDR% + фрм╞оффсет╞х)  BANK 128  IF FX<>-999 THEN FRMX = FX ' OVERRIDE POSITION  IF FY<>-999 THEN FRMY = FY  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  SCRADDR% = $0000 + FRMX + (FRMY+FRMH-1) * 80  CLRADDR% = $1000 + FRMX + (FRMY+FRMH-1) * 80  	IF MIRROR = 1 THEN CLRADDR% = CLRADDR% + FRMW - 1  DATA╞ADDR% = DATA╞ADDR% + фрм╞оффсет╞дата  CDATA╞ADDR% = DATA╞ADDR% + FRMW * FRMH  INC% = INC(FRAMEIDX) * 256  ' ASM: DRAW╞PETSCII╞FRAME  BANK 0:SYS $7E09, MOD(FRMY+256,256), MOD(FRMY1+256,256), F
RMW  RETURN'---------------.TRANSPARENT╞DMA'---------------  WPOKE $40009, SRC╞ADDR  WPOKE $4000C, DEST╞ADDR  WPOKE $40007, LENGTH  POKE  $40004, TRANSP  POKE $D702, 4 ' DMA LIST IN BANK 4  POKE $D701, $00 ' DMA LIST MSB  POKE $D705, $00 ' DMA LIST LSB  RETURN'---------.PAGE╞FLIP'---------  EDMA 0, $FA0, $50000, $40800  EDMA 0, $FA0, $51000, $FF80000  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  RETURN.FADE╞TO╞WHITE'-------------  FOR FADEVAL=0 TO 128    ' FADE╞COLOURS╞TO╞WHITE    BANK 0:VSYNC 10:SYS $7E00, FADEVAL:BANK 128  NEXT FADEVAL  RETURN.STORE╞DEFAULT╞COLOURS'---------------------  FOR K = 0 TO 31    DEFAULT╞RED&(K)=PEEK($D100+K)    DEFAULT╞GREEN&(K)=PEEK($D200+K)    DEFAULT╞BLUE&(K)=PEEK($D300+K)  NEXT K  RETURN.STORE╞CURR╞COLOURS'------------------  FOR K = 0 TO 31    CURR╞RED&(K)=PEEK($D100+K)    CURR╞GREEN&(K)=PEEK($D200+K)    CURR╞BLUE&(K)=PEEK($D300+K)  NEXT K  RETURN.CYCLE╞ALT╞PALETTE╞LOOP'----------------------  FOR M = 0 TO 32*4    ' GOSUB CYCLE╞ALT╞PALETTE    ' GOSUB POLL╞PLAY    ' GOSUB ANIM╞DRAW╞SUBTEXT  NEXT M  RETURN'------------------------.SET╞PALETTE╞FOR╞BACKDROP'------------------------#DEFINE цол1╞р = $DA ' 218#DEFIN.CHK╞REV'-------  IF REV╞FLAG& = 1 THEN PRINT "";:ELSE PRINT "▓";  RETURN'---------.PLAY╞DATA'---------  PRINT "⌠";  IF VER = 3 THEN GOSUB DRAW╞FONT╞GUIDE╞LINES  OFFS=0  PIDX% = 0  IF LASTFLAG = 1 THEN PIDX% = LAST╞GROUP╞IDX : LASTFLAG = 0  DO WHILE PIDX% < DIDX%    CURSOR 0,49:PRINT CHR$(27);"QPIDX=";PIDX%;"[";LDATA&(PIDX%);LDATA&(PIDX%+1);LDATA&(PIDX%+2);    VAL& = LDATA&(PIDX%) : PIDX% = PIDX% + 1    IF VER=3 AND VAL& = $FF THEN BEGIN      GOSUB DRAW╞FONT╞GUIDE╞LINES      IF PI < = сHOW PREVIOUS SONG CHUNK'           > = сHOW NEXT SONG CHUNK'           - = дECREASE TEMPO'           + = иNCREASE TEMPO'      мега+я = яUIT PROGRAM / еXIT еNV еDITOR'          ф1 = лOAD'          ф3 = сAVE'          ф7 = еNVELOPE EDITOR'          ф8 = фILTER EDITOR'   ф9/цтрл-п = цHUNK SEQUENCERTRAP RUNSTOP╞TRAPPER.DECLARATIONS'------------#DECLARE CHUNK╞IDX = 0#DECLARE CHUNK╞CNT = 0#DEFINE CHUNK╞MAX = 50#DECLARE VIDX, IDX#DECLARE CURSOR╞X = 0#DECLARE CURSOR╞Y = 0#DECLARE V$(5,CHUNK╞MAX)#DECLARE KEY$#DECLARE VALID$="CDEFGAB0123456789 #$.HIQRSWOTUXMPL"#DECLARE VAL$#DECLARE TMPO% = 12#DECLARE ESC╞FLAG% = 0#STRUCT енжтыпе NAME$, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PWенжтыпе ENVS(9) = [ _  [ "пIANO",       0,  9,  0,  0,  2, 1536 ], _  [ "аCCORDION",  12,  0, 12,  0,  1,    0 ], _  [ "цALLIOPE",    0,  0, 15,  0,  0,    0 ], _  [ "дRUM",        0,  5,  5,  0,  3,    0 ], _  [ "фLUTE",       9,  4,  4,  0,  0,    0 ], _  [ "гUITAR",      0,  9,  2,  1,  1,    0 ], _  [ "хARPSICRD",   0,  9,  0,  0,  2,  512 ], _  [ "оRGAN",       0,  9,  9,  0,  2, 2048 ], _  [ "тRUMPET",     8,  9,  4,  1,  2,  512 ], _  [ "ьYLOPHONE",   0,  9,  0,  0,  0,    0 ]  _]#DEFINE дир╞ноне = 0#DEFINE дир╞уп   = 1#DEFINE дир╞довн = 2#DEFINE дир╞осц  = 3#DECLARE DIR╞NAME$(3)DIR╞NAME$(0) = "ноне"DIR╞NAME$(1) = "уп"DIR╞NAME$(2) = "довн"DIR╞NAME$(3) = "осц"#DEFINE ф╞офф = 0#DEFINE ф╞он  = 1#STRUCT филттыпе NAME$, FREQ, LP, BP, HP, RES, DIR, MIN, SWEEPфилттыпе FILT(10) = [ _  [ "LOWP╞UP",    1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞уп,   100, 10 ], _  [ "LOWP╞DOWN",  1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞довн, 100, 10 ], _  [ "LOWP╞OSC",   1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞осц,  100, 10 ], __  [ "BANDP╞UP",   E цол1╞г = $89 ' 137#DEFINE цол1╞б = $00 ' 0#DEFINE цол2╞р = $1B ' 27#DEFINE цол2╞г = $42 ' 66#DEFINE цол2╞б = $0B ' 11  FOR K = 12 TO 21    FLIP╞VAR = цол1╞р + (цол2╞р-цол1╞р) * (K-12)/9    GOSUB FLIP╞NIBBLE    DEFAULT╞RED&(K) = FLIP╞VAR    DEFAULT╞RED&(43-K) = FLIP╞VAR    FLIP╞VAR = цол1╞г + (цол2╞г-цол1╞г) * (K-12)/9    GOSUB FLIP╞NIBBLE    DEFAULT╞GREEN&(K) = FLIP╞VAR    DEFAULT╞GREEN&(43-K) = FLIP╞VAR    FLIP╞VAR = цол1╞б + (цол2╞б-цол1╞б) * (K-12)/9    GOSUB FLIP╞NIBBLE    DEFAULT╞BLUE&(K) = FLIP╞VAR    DEFAULT╞BLUE&(43-K) = FLIP╞VAR  NEXT K  RETURN'-----------.FLIP╞NIBBLE'-----------  LOWER╞NIBBLE = FLIP╞VAR AND $0F  UPPER╞NIBBLE = (FLIP╞VAR >> 4) AND $0F  FLIP╞VAR = (LOWER╞NIBBLE << 4) + UPPER╞NIBBLE  RETURN.ANIM╞DRAW╞SUBTEXT'-----------------  IF M = 330 THEN BEGIN    SUBTEXT╞IDX = 1    PLEN = 0    EDMA 3,80,32,$40800+80*46  BEND  IF PLEN < LEN(SUBTEXT$(SUBTEXT╞IDX)) THEN BEGIN    PLEN = PLEN + .25    RAINBOWSTR$=LEFT$(SUBTEXT$(SUBTEXT╞IDX),PLEN)  "----------"  RETURN'---------.DRAW╞CHAR'---------  ' POKE $40800 + X + Y*80, ASC(A$)  ' POKE $FF80000 + X + Y*80, RCOLOR(1)  PRINT A$;  RETURN'--------------------.CHECK╞ALT╞KEY╞INPUTS'--------------------  ALT╞KEY = PEEK($D611) AND 16  IF ALT╞KEY = 0 THEN RETURN  IF A$=кеы╞лефт THEN GOSUB SCROLL╞CANVAS╞LEFT  IF A$=кеы╞ригхт THEN GOSUB SCROLL╞CANVAS╞RIGHT  A$=""  RETURN'---------.DRAW╞INFO'---------  PRINT "";CHR$(27);"QFNAME=";FNAME$;"  DIDX%=";DIDX%;  RETURN'-------4   IF SUBTEXT╞IDX = 0 THEN RAINBOW╞X = 35:ELSE RAINBOW╞X = 33    RAINBOW╞Y = 46    GOSUB PRINT╞RAINBOW╞STR  BEND  RETURN.PRINT╞RAINBOW╞STR'-----------------  CURSOR RAINBOW╞X, RAINBOW╞Y  FOR RAIN╞IDX=1 TO LEN(RAINBOWSTR$)    FOREGROUND MOD(RAIN%IDX, FX, FY, MIRROR, DATA╞ADDR%, FRMX, FRMY#DECLARE FRMX1, FRMY1, SCRADDR%, CLRADDR%, CDATA╞ADDR%, YY#DECLARE INC(3), INC╞DIR(3), A$, X, Y#DECLARE TEMPR, TEMPG, TEMPB, M#DECLARE LOGO╞STATE#DECLARE FLIP╞VAR, UPPER╞NIBBLE, LOWER╞NIBBLE#DECLARE CLR1,  1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞уп,   100, 10 ], _  [ "BANDP╞DOWN", 1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞довн, 100, 10 ], _  [ "BANDP╞OSC",  1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞осц,  100, 10 ], __  [ "HIGHP╞UP",   1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞у!п,   100, 10 ], _  [ "HIGHP╞DOWN", 1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞довн, 100, 10 ], _  [ "HIGHP╞OSC",  1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞осц,  100, 10 ], __  [ "SPARE╞1",    0,    ф╞офф, ф╞офф, ф╞офф, 0,  дир╞ноне, 0,   0  ], _  [ "SPARE╞2",    "0,    ф╞офф, ф╞офф, ф╞офф, 0,  дир╞ноне, 0,   0  ], __]#DECLARE SEQ╞CHUNK(200), SEQ╞EXTRA(200)#DECLARE ECHO╞M, ECHO╞B, ECHO╞SZ = .05, CHUNK╞RPT, ECHO╞DELAY#DECLARE V1$, V2$, V3$, V4$, V5$, V6$#DECLARE TMP#DECLARE SSCOL, S, SEQ╞OFFS#DEFINE оп╞ц#опы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE сцрнптрлсб = $D060#DEFINE сцрнптрмсб = $D061#DEFINE сцрнптрбнк = $D062.CMDS#DEFINE цмд╞темпо = -1#DEFINE цмд╞филтер = -2#DEFINE цмд╞лооп = -3#DEFINE цмд╞ецхо╞м1 = -4   '$ ECHO MELODY: VOICE 1 ON VOICE 4#DEFINE цмд╞ецхо╞м2 = -5   ' ECHO MELODY: VOICE 1 ON VOICE 2 + 4 + 5#DEFINE цмд╞ецхо╞б  = -6   ' ECHO BASS:   VOICE 3 ON VOICE 6#DEFINE цмд╞ецхо╞офф = -7#DEFINE цмд╞ецхо╞сз = -8#DEFINE цмд╞жол = -9#DEFINE цмд╞делаы =% -10#DEFINE цмд╞маь = 11#DECLARE SEQ╞CMDNAME$(10)SEQ╞CMDNAME$(1) = "темпо"SEQ╞CMDNAME$(2) = "филтер"SEQ╞CMDNAME$(3) = "лооп"SEQ╞CMDNAME$(4) = "ецхо╞м1"SEQ╞CMDNAME$(5) = "ецхо╞м2"SEQ╞CMDNAME$(6) = "ецхо╞б"SEQ╞CMDNAME$(7) = "ецхо╞офф"SEQ╞CMDNAME&CLR2, TSTART#DECLARE BAS╞STATE = 0#DECLARE FRMY(3), ORIG╞FRMY(3), FINISH╞CNT, BCNT#DECLARE LOC, INC%  #DECLARE RAIN╞IDX, PLEN, RAINBOWSTR$, RAINBOW╞X, RAINBOW╞Y  #DECLARE SUBTEXT$(2)  #DECLARE SUBTEXT╞IDX = 0  SUBTEXT$(0) = "PRESENTS..."  SUBTEX'T$(1) = "A SONG BY..."#DEFINE фрм╞б = 0#DEFINE фрм╞а = 1#DEFINE фрм╞с = 2#DEFINE фрм╞бацкдроп = 3#DECLARE хотрег╞7 = $D05D#DEFINE сцрнптрлсб = $D060#DEFINE сцрнптрбнк = $D062  ' PALETTE  ' -------  #DECLARE DEFAULT╞RED&(32)  #DECLARE DEFAULT╞GREEN&(32)  #DECLARE DEFAULT╞BLUE&(32)  #DECLARE CURR╞RED&(32)  #DECLARE CURR╞GREEN&(32)  #DECLARE CURR╞BLUE&(32)  #DECLARE FADEVAL, TEMPVAL.OFFSETS#DEFINE оффсет╞дата╞сизе  = 0#DEFINE оффсет╞нум╞фрамес = 2#DEFINE оффсет╞фраме0     = 3#DEMOD(PTR,65536)    FRMX = PEEK(PTR + фрм╞оффсет╞ь)    FRMY = PEEK(PTR + фрм╞оффсет╞ы)    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    FRMX1=FRMX+FRMW-1    FRMY1=FRMY+FRMH-1    DATA╞ADDR% = MOD(PTR, 65536)    DATA╞ADDR% = DATA╞ADDR% + фрм╞оффсет╞дата    CDATA╞ADDR% = DATA╞ADDR% + FRMW * FRMH    BANK 4    FOR Y = 0 TO FRMY1-FRMY      FOR X = 0 TO FRMX1-FRMX        IF PEEK(DATA╞ADDR% + X + Y * FRMW) = 102 THEN BEGIN          POKE (CDATA╞ADDR% + X + Y * FRMW), $FF        BEND      NEXT X    NEXT Y    BANK 128        'PRINT "PTR=";HEX$(PTR);", IDX=";FRM╞IDX;", W=";FRMW;", H=";FRMH    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2    'PRINT "FRM╞IDX=";FRM╞IDX    FRM╞IDX = FRM╞IDX + 1  LOOP  PTR = TMP  RETURN'---------------------------.╞INCREMENT╞PTR╞TO╞NEXT╞FREE'---------------------------  PTR = TMP  SZ = WPEEK(PTR + оффсет╞дата╞сизе)  'PRINT  'PRINT "INC SZ = ";SZ  'PRINT "PTR = ";HEX$(PTR + оффсет╞дата╞сизе)  PTR = PTR + SZ  'GET KEY A$  RETURN'--------.DRAW╞BAS'--------  FRAMEIDX = фрм╞бацкдроп  FX=-999 : FY = -999  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞б  FX=-999 : FY=FRMY(0)  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞а  FX=-999 : FY=FRMY(1) 0 TO 128        ' FADE╞COLOURS╞TO╞DEFAULTS        BANK 0:VSYNC 10:SYS $7E03, FADEVAL:BANK 128        FADEVAL = FADEVAL + 1      NEXT FADEVAL      LOGO╞STATE = ст╞анатхема    BEND  BEND  IF LOGO╞STATE = ст╞анатхема THEN BEGIN    PRINT "ANATHEMA!";  BEND  DO  LOOP WHILE (TI-TSTART) < .03  GOTO STATE╞LOOP  RETURN'----------.INIT╞80X50'----------  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  ' SWITCH TO 80X50  ' SETBIT хотрег╞7, 7  ' POKE $D031, $E8 ' 1110 1000 = х640,фаст,аттр,ж400  PRINT CHR$(27);"5";  ' WPOKE сцрнптрлсб, $0800  ' POKE сцрнптрбнк, $04  RETURN'-------------.DRAW╞BACKDROP'-------------    FRAMEIDX = фрм╞бацкдроп    FX=-999 : FY = -999    MIRROR = 0    GOSUB DRAW╞PETSCII╞FRAME 	   RETURN'------------.ANIMATE╞LOGO'------------  IF BAS╞STATE = 0 THEN BEGIN    ORIG╞FRMY(0) = 6    ORIG╞FRMY(1) = 23    ORIG╞FRMY(2) = 6    FRMY(0) = -44    FRMY(1) = -69    FRMY(2) = -107    BAS╞STATE = 1    INC╞DIR(0) = 1    INC(0) =
 1    INC╞DIR(1) = 1    INC(1) = 1    INC╞DIR(2) = 1    INC(2) = 1    INC╞DIR(3) = 1    INC(3) = 1  BEND  IF BAS╞STATE = 1 THEN BEGIN    FINISH╞CNT = 0    FOR K = 0 TO 2      IF FRMY(K) < ORIG╞FRMY(K) THEN BEGIN        FRMY(K) = FRMY(K) + 2        IF FRMY(K) > ORIG╞FRMY(K) THEN FRMY(K) = ORIG╞FRMY(K)      BEND      IF FRMY(K) = ORIG╞FRMY(K) THEN FINISH╞CNT = FINISH╞CNT OR 2^K    NEXT K  BEND  GOSUB DRAW╞BAS  GOSUB PAGE╞FLIP  FOR FRAMEIDX = 0 TO 2    IF FINISH╞CNT AND 2^FRAMEIDX AND BCNT(FRAMEIDX)<3 THEN BEGIN      INC(FRAMEIDX) = INC(FRAMEIDX) + .2 * INC╞DIR(FRAMEIDX)      IF INC(FRAMEIDX) < .6 THEN BEGIN        INC╞DIR(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF INC(FRAMEIDX) > 2.9 THEN BEGь╞инж╞бр = 236#DECLARE пиь╞диаг╞тл╞бр = 127#DECLARE пиь╞диаг╞бл╞тр = 255#DECLARE пиь╞хлине╞бот = 98#DECLARE пиь╞хлине╞топ = 226#DECLARE пиь╞жлине╞лефт = 97#DECLARE пиь╞жлине╞ригхт = 225#DECLARE пиь╞ноне = 32#DECLARE пиь╞алл = 160#DECLARE пиIN        INC╞DIR(FRAMEIDX) = -1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF BCNT(FRAMEIDX) = 2 AND INC(FRAMEIDX) > 1 THEN BEGIN        INC(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND    BEND    BEND  NEXT FRAM!EIDX    RETURN'----.INIT'----  BANK 0:BLOAD "ASMHELPER":BANK 128  LOGO╞STATE = 0  GOSUB STORE╞DEFAULT╞COLOURS  INC╞DIR(3) = -1  INC(3) = 1  ' CLEAR DMA LIST AREA  FOR K = 0 TO 20    POKE $40000+K, 0  NEXT K  POKE $40000, $81 ' OPT = x*X AC╡AC╙1:I╡б(AC):≈AD╙3,I:AC╡AC╙1:AG╡20╚4:Ч!3,AG,.,AD╙4:AG╡H╛I╛2:Ч!0,AG,AC,AD╙20:AC╡AC╙AG:AD╡AD╙20╙AG:AE╡AE╙20╙AG:┌AF:AD╡327680:ЧAD╙0,AE ~*Y ▌ ²*Z ┘"SAVE NAME: ";C$:▀C$╡""╖▌ у*[ D╡327680╙н(327680╙0):В(C$):Ч(C$),P(327680)╓P(D):▌ -+\ AE╡н(327680╙0):D╡327680╙3:│AF╡.╓E╚1:H╡б(D╙2):I╡б(D╙3):AE╡AE╚H╛I:D╡D╙20╙H╛I╛2:┌AF:▌ X+] ┘"SAVE NAME (OPTIMISED): ";C$:▀C$╡""╖▌ ÷+^ В(C$):Ч#2,(C$╙",P"),W,U8:≤2,г(1);:≤2,г(2);:█ 92:≤2,г(н(AE,256)); ,_ ≤2,г(╣(AE╜256));:≤2,г(E);:D╡327680╙3:│F╡.╓E╚1:B╡б(D╙0):C╡б(D╙1):H╡б(D╙2):I╡б(D╙3):≤2,г(B);г(C);г(H);г(I); W,` │AF╡.╓15:≤2,г(б(D╙4╙AF));:┌AF:S╡D╙20:T╡D╙20╙H╛I:│AF╡.╓H╛I╚1:Y╡б(T╙AF) k,a ▀б(S╙AF)╡102╖Ч x,b Y╡255:Ч ═,c ≤2,г(Y);:┌AF:D╡D╙20╙H╛I╛2:┌F:Ч#2:▌ -d ≈264192╙N╙O╛80,J:≈267911168╙N╙O╛80,K:≈264192╙P╙Q╛80,L:≈267911168╙P╙Q╛80,M:E╡б(327680╙2):█ 143:D╡327680╙G:AS╡1 -e █ 102:▌ F-f ≈D╙0,N:≈D╙1,O:≈D╙2,B╚N╙1:≈D╙3,C╚O╙1 Q-g ▀AS╖Ч m-h AG╡20╚4:Ч!3,AG,.,D╙4:Ч в-i D╡D╙20:│V╡O╓C:│U╡N╓B:≈D,б(264192╙U╙V╛80):D╡D╙1:┌U:┌V:│V╡O╓C:│U╡N╓B:≈D,б(267911168╙U╙V╛80):D╡D╙1:┌U:┌V Б-j ▀AS╖Ч .k Ч327680╙0,D╚327680:≈327680╙2,E╙1:Ч Z.l ЧA.,49:≥A$;"FRAME COUNT=";б(327680╙2);:≥", NEXT-FREE=$";р(D);:ЧA.,.:AS╡.:▌ {.m ≥"";A$;:┘"FRAME#";R:█ 124:▌ ╒.n █ 117:AA╡D:E╡E╚1:≈327680╙2,E:█ 115 ╝.o ▀R╡E╖Ч ╦.p R╡R╚1 л.q Ч:уЧ:█ 116:Ч ь.r █ 124:▌ ,/s █ 122:AB╡D:H╡б(AB╙2):I╡б(AB╙3):AE╡н(327680╙0):AE╡AE╚(20╙H╛I╛2):Ч327680╙0,AE:▌ u/t █ 122:AB╡D:H╡б(AB╙2):I╡б(AB╙3):Z╡AB╙20╙H╛I╛2:AG╡AA╚Z╙1:Ч!0,AG,Z,AB:▌ √/u E╡б(327680╙2):D╡327680╙3:F╡. ё/v ▀F╠╡E╖Ч е/w ЧA.,.:≥A$;"INVALID BLOCK#!":▌ л/x Ч Щ/y │F╡.╓E╚1:H╡б(D╙2):I╡б(D╙3):D╡D╙20╙H╛I╛2:┌F:▌ (0z E╡б(327680╙2):D╡327680╙3:│F╡.╓E:▀F╡R╖▌ T0{ H╡б(D╙2):I╡б(D╙3):D╡D╙20╙H╛I╛2:┌F:D╡.:▌ u0| E╡б(327680╙2):D╡327680╙3:F╡. ┌0} ▀F╠╡E╖Ч ╓0~ ЧA.,.:≥A$;"INVALID BLOCK#!":▌ ╚0 Ч й0─ █ 122:▀D╡.╖≥"NOT FOUND!":▌ @1│ B╡б(D╙0):C╡б(D╙1):H╡б(D╙2):I╡б(D╙3):P╡B╙H╚1:Q╡C╙I╚1:≥"";A$;:≥"X=";B;", Y=";C;", W=";H;", H=";I;:≥", PTR=$";р(D); б1┌ ≥"";г(27);"J";A$;"FRAME=";R;:≥", NXT=$";р(D╙20╙H╛I╛2);:S╡D╙20:T╡D╙20╙H╛I:W╡264192╙B╙C╛80:X╡267911168╙B╙C╛80:│V╡C╓Q:Ч!0,H,S,W О1┐ Ч!0,H,T,X:S╡S╙H:T╡T╙H:W╡W╙80:X╡X╙80:┌V:▌ Э1└ ▀AR╡0╖Ч %2┘ ≈264192╙B╙C╛80,J:≈267911168╙B╙C╛80,K X2├ Ч:уЧ:≈264192╙B╙C╛80,L:≈267911168╙B╙C╛80,M:Ч ^2┤ ▌ ┼2┬ ≈264192╙B╙C╛80,43:≈267911168╙B╙C╛80,1:▌ н2┴ ЧA.,49:≥A$;"FRAME COUNT=";б(327680╙2);", NEXT-FREE=$";:≥р(D);:▌ ш2┼ ▀AR╡0╖Ч 3▀ J╡б(264192╙B╙C╛80):K╡б(267911168╙B╙C╛80):N╡B:O╡C O3▄ Ч:уЧ:L╡б(264192╙B╙C╛80):M╡б(267911168╙B╙C╛80):P╡B:Q╡C:Ч U3█ ▌ p3▌ A╡.:AR╡0:B╡.:C╡.:R╡.:▌ ∙3▐ E╡б(327680╙2):F╡.:D╡327680╙3:КЩ1 ║3░ ▀F╡E╖Ч ╡3▒ G╡D╚327680:▌ ╧3▓ Ч Ф3⌠ H╡б(D╙2):I╡б(D╙3):D╡D╙20╙H╛I╛2:F╡F╙1:Л:▌ 
4■ ▀б(393214)Ё╠71╟б(393215)Ё╠73╖Ч i4∙ Ч393214,18759:≥"⌠";A$;:≥"MAGIC SIGNATURE APPLIED. RESET FRAME COUNT TO ZERO? (Y/N)";:║ЫB$ x4√ ▀B$╡"Y"╖Ч ≤4≈ Ч327680╙0,.:≈327680╙2,.:Ч ╗4≤ ≥"⌠";A$;:Ч ╝4≥ ▌ б4  ▀б(393212)╡1╖Ч 5⌡ ≈393212,.:R╡б(393213):█ 122:N╡б(D╙0):O╡б(D╙1):B╡N╙б(D╙2)╚1:C╡O╙б(D╙3)╚1:AS╡.:█ 102 &5° █ 124:Ч ,5² ▌ ┴5· ≈53280,б(53280)╙1:█ 81:D╡н
(A&(.)):AG╡AK╚AI╙1:│C╡AJ╓AL:Ч!0,AG,264192╙AI╙C╛80,D:D╡D╙AG:┌C Я5÷ D╡н
(B&(.)):│C╡AJ╓AL:Ч!0,AG,267911168╙AI╙C╛80,D:D╡D╙AG:┌C:AP╡AK╚AI╙1:AQ╡AL╚AJ╙1:≈53280,б(53280)╚1:▌ j6═ AI╡B:AJ╡C:AK╡B╙AP╚1:AL╡C╙AQ╚1:D╡н
(A&(.)):AG╡AK╚AI╙1:│C╡AJ╓AL:Ч!0,AG,D,264192╙AI╙C╛80:D╡D╙AG:┌C:D╡н
(B&(.)):│C╡AJ╓AL ╬6║ Ч!0,AG,D,267911168╙AI╙C╛80:D╡D╙AG:┌C:█ 102:█ 122:N╡б(D╙0):O╡б(D╙1):B╡N╙б(D╙2)╚1 э6╒ C╡O╙б(D╙3)╚1:AS╡.:█ 102:▌ Ж6ё ▐ CURRENT╞FRAME = :A: 7╓ ▐ X = :B: 7╔ ▐ Y = :C: "7╕ ▐ PTR = :D: :7╖ ▐ FRAME╞COUNT = :E: M7╗ ▐ FRMIDX = :F: d7╘ ▐ BYTES╞USED = :G: u7╙ ▐ FRMW = :H: ├7╚ ▐ FRMH = :I: ²7╛ ▐ START╞CHAR = :J: ╣7╜ ▐ START╞COLOR = :K: й7╝ ▐ END╞CHAR = :L: Ю7╞ ▐ END╞COLOR = :M: С7╟ ▐ STARTX = :N: 8╠ ▐ STARTY = :O: 8╡ ▐ ENDX = :P: (8Ё ▐ ENDY = :Q: ?8╢ ▐ CURR╞FRAME = :R: X8╣ ▐ SRC╞CHAR╞PTR = :S: p8╤ ▐ SRC╞CLR╞PTR = :T: │8╥ ▐ XIDX = :U: ▓8╦ ▐ YIDX = :V: ╛8╧ ▐ DEST╞CHAR╞PTR = :W: е8╨ ▐ DEST╞CLR╞PTR = :X: ж8╩ ▐ CVAL = :Y: Л8╪ ▐ START╞PTR = :Z: 9╫ ▐ END╞PTR = :AA: 9╬ ▐ CURR╞PTR = :AB: ,9© ▐ SRC╞PTR = :AC: B9ю ▐ DEST╞PTR = :AD: R9а ▐ SZ = :AE: a9б ▐ K = :AF: q9ц ▐ LN = :AG: ─9д ▐ B = :AH: ░9е ▐ X1 = :AI: ═9ф ▐ Y1 = :AJ: ╟9г ▐ X2 = :AK: ю9х ▐ Y2 = :AL: т9и ▐ HB╞SE L = :AM: И9й ▐ HB╞MODE = :AN: З9к ▐ IDX = :AO: :л ▐ CLIPW = :AP:  :м ▐ CLIPH = :AQ: 9:н ▐ STORE╞STATE = :AR: U:о ▐ NEW╞FRAME╞FLAG = :AS: j:п ▐ BX╞OFFS = :AT: x:я ▐  = :AU: ├:р ▐  = :A%: ё:с ▐ CLR╞LINE╞RIGHT$ = :A$: Ё:т ▐ A$ = :B$: г:у ▐ FNAME$ = :C$: у: Vж ▐  = :D$: Р:в ▐ CLIPBOARD╞CHAR& = :A&: ;ь ▐ CLIPBOARD╞CLR& = :B&: ;ы ▐  = :C&:                                                                                                                                                                            " DEST ADDR мб SELECTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $0#0 ' цмд LSB = цопы  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C, $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' цмд MSB (IGNORE)  WPOKE $40010, $0000 '$ MODULO (IGNORE)  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  ' INIT VAR INTERFACE TO ASSEMBLY  LOC = $40020  PTR = POINTER(DEFAULT╞RED&(0))  GOSUB STORE╞PTR  PTR = POINTER(DEFAULT╞GREEN&(0))  GOSUB STORE%╞PTR  PTR = POINTER(DEFAULT╞BLUE&(0))  GOSUB STORE╞PTR  PTR = POINTER(CURR╞RED&(0))  GOSUB STORE╞PTR  PTR = POINTER(CURR╞GREEN&(0))  GOSUB STORE╞PTR  PTR = POINTER(CURR╞BLUE&(0))  GOSUB STORE╞PTR  PTR = POINTER(DATA╞ADDR%)  GOSUB STORE╞PTR&  PTR = POINTER(CDATA╞ADDR%)  GOSUB STORE╞PTR  PTR = POINTER(SCRADDR%)  GOSUB STORE╞PTR  PTR = POINTER(CLRADDR%)  GOSUB STORE╞PTR  PTR = POINTER(INC%)  GOSUB STORE╞PTR  RETURN'---------.STORE╞PTR'---------  WPOKE LOC, PTR  LOC = LOC +' 2  RETURN'---------.LOAD╞DATA'---------  PTR = $42000    BLOAD "BAS.BIN",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  RETURN'-------------------.INIT╞PETSCII╞FRAMES'-------------------  TMP = PTR  MAX╞FRAMES =  PEEK(PTR + оффсет╞нум╞фрамес)  'PRINT  'PRINT "PTR=";HEX$(PTR + оффсет╞нум╞фрамес)  PTR = PTR + оффсет╞фраме0  'PRINT  'PRINT "- MX╞FRM=";MAX╞FRAMES;": "  FRM╞IDX = 0  DO WHILE FRM╞IDX < MAX╞FRAMES    'PRINT FRM╞IDX;    FRAME╞ADDR%(FRM╞IDX) = IN    GOSUB FADE╞TO╞WHITE    LOGO╞STATE = ст╞драв╞бацкдроп╞онлы  BEND    IF LOGO╞STATE = ст╞драв╞бацкдроп╞онлы THEN BEGIN    BANK 128    POKE $D020, 1, 1    GOSUB INIT╞80X50    GOSUB DRAW╞BACKDROP    GOSUB PAGE╞FLIP    GOSUB STORE╞CURR╞COLOURS    GOSUB SET╞PALETTE╞FOR╞BACKDROP    FADEVAL=0    M=0    LOGO╞STATE = ст╞фаде╞то╞дефаулт  BEND    IF LOGO╞STATE = ст╞фаде╞то╞дефаулт THEN BEGIN    IF FADEVAL <= 128 THEN BEGIN      ' FADE╞COLOURS╞TO╞DEFAULTS      BANK 0:VSYNC 10:SYS $7E03, FADEVAL:BANK 128      FADEVAL = FADEVAL + 1    BEND    ' CYCLE╞ALT╞PALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M = 130 THEN LOGO╞STATE = ст╞дроп╞ин╞б  BEND  IF LOGO╞STATE = ст╞дроп╞ин╞б THEN BEGIN    GOSUB ANIMATE╞LOGO    ' CYCLE╞ALT╞PALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M > 250 THEN LOGO╞STATE = ст╞пресентс:FADEVAL = 0  BEND  IF LOGO╞STATE = ст╞пресентс THEN BEGIN    GOSUB ANIM╞DRAW╞SUBTEXT    ' CYCLE╞ALT╞PALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M > 360 THEN BEGIN      ' FADE TO BLACK      BANK 0:SYS $7E0C, FADEVAL:BANK 128      FADEVAL = FADEVAL + 1    BEND    IF FADEVAL = 128 THEN BEGIN      POKE $D020, 0, 0      PRINT "⌠";      GOSUB STORE╞CURR╞COLOURS      FOR FADEVAL = ;  A$╡г(27)╙"Q":├ AH(50,3):AM╡0:├ A&(80╛50):├ B&(80╛50): i  ├ AT(3):AT(.)╡4:AT(1)╡8:AT(2)╡12:AT(3)╡16 °  ЫЧ$:≈53280,11,14:█ 142:█ 148:█ 154:█ 143:█ 137 ╩  КЩ1:█ 138:█ 136:█ 18:█ 5:Л к  ЧA.,49:≥A$; ь  ▀AR╡0╖Ч Ь  ≥г(27)╙"QX=";B;", Y=";C;:Ч ! ▀AR╡1╖Ч A!	 ≥г(27)╙"QX=";N;", Y=";O;:≥", W=";B╚N╙1;", H=";C╚O╙1;:Ч L!
 ≥A$;:▌ v! КЩ1:█ 138:█ 136:║ЫB$:▀B$Ё╠г(13)╖█ 132 ▄! ▀B$╡"²"╞B╠.╖B╡B╚1 ё! ▀B$╡""╞BЁ79╖B╡B╙1 ╧! ▀B$╡"▒"╞C╠.╖C╡C╚1 п! ▀B$╡""╞CЁ49╖C╡C╙1 Ю! ▀B$╡г(13)╖М Х! Л:▌  " ║ЫB$:▀B$Ё╠" "╖█ 132 " ▀B$╡"²"╞B╠.╖B╡B╚1 -" ▀B$╡""╞BЁ79╖B╡B╙1 C" ▀B$╡"▒"╞C╠.╖C╡C╚1 Z" ▀B$╡""╞CЁ49╖C╡C╙1 l" ▀B$╡"D"╖█ 110 ~" ▀B$╡"Y"╖█ 158 ░" ▀B$╡"P"╖█ 160 ÷" ▀B$╡"C"╖Ч ╤" ≥"⌠";:R╡.:█ 124:Ч и" ▀B$╡"-"╞R╠.╖Ч э" R╡R╚1:█ 124:Ч Ы" ▀B$╡"="╞RЁб(327682)╚1╖Ч 	# R╡R╙1:█ 124:Ч #  ▀B$╡" "╖Ч '#! AR╡AR╙1 4#" ▀AR╡2╖Ч C## █ 100:─:Ч J#$ Ч \#% ▀B$╡"L"╖█ 109 k#& ▀B$╡"X"╖Ч }#' ЧA.,.:Ы▒:─:Ч ▄#( ▀B$╡"E"╖Ч Ё#) ЧA.,40:≈393212,1:≈393213,R:Ы▒:─:Ч д#* ▀B$╡"┘"╖█ 85 у#+ ▀B$╡"├"╖█ 90 Ф#, ▀B$╡"┤"╖█ 93 В#- ▀B$╡"┬"╖█ 47 
Щ#. ▌ $/ AN╡0:КЩ1:█ 61:█ 55:█ 72 8$0 ▀B$╡"X"╟B$╡г(27)╟B$╡"┬"╖Ч P$1 ≥г(147);:█ 124:М:Ч X$2 Л:▌ u$3 ▀б(264192╙B╙C╛80)Ё╠32╖Ч ┐$4 AF╡AF╙128 ╔$5 Ч:уЧ:≈267911168╙B╙C╛80,1:Ч ╫$6 ≈264192╙B╙C╛80,AF:▌ %7 █ 124:█ 122:│AO╡.╓3:AI╡б(D╙AT(AO)):AJ╡б(D╙AT(AO)╙1):AK╡б(D╙AT(AO)╙2):AL╡б(D╙AT(AO)╙3) 6%8 ▀╗(AI╡.╞AJ╡.╞AK╡.╞AL╡.)╖Ч ▓%9 B╡AI:C╡AJ:AF╡112:█ 51:B╡AK:C╡AJ:AF╡110:█ 51:B╡AI:C╡AL:AF╡109:█ 51:B╡AK:C╡AL:AF╡125:█ 51 Ц%: │B╡AI╙1╓AK╚1:C╡AJ:AF╡64:█ 51:C╡AL:AF╡64:█ 51:┌B:│C╡AJ╙1╓AL╚1:B╡AI:AF╡93:█ 51 Щ%; B╡AK:AF╡93:█ 51:┌C:Ч &< ┌AO:▌ )&= █ 122:AB╡D:▀AM╡.╖≥"";:у≥"▓"; f&> ЧA40,40:≥г(27);"Q  HEAD: ";:AF╡4:█ 84:▀AM╡1╖≥"";:у≥"▓"; ё&? ЧA40,41:≥г(27);"Q TORSO: ";:AF╡8:█ 84:▀AM╡2╖≥"";:у≥"▓"; А&@ ЧA40,42:≥г(27);"Q  FEET: ";:AF╡12:█ 84:▀AM╡3╖≥"";:у≥"▓"; 'A ЧA40,43:≥г(27);"QATTACK: ";:AF╡16:█ 84:≥"▓";:█ 71:▌ ('B ▀AM╡.╖AF╡4 7'C ▀AM╡1╖AF╡8 G'D ▀AM╡2╖AF╡12 W'E ▀AM╡3╖AF╡16 ]'F ▌ m'G █ 66:█ 83:▌ ▀'H ║ЫB$:▀B$╡"▒"╞AM╠.╖AM╡AM╚1 ╓'I ▀B$╡""╞AMЁ3╖AM╡AM╙1 ╥'J ▀B$╡"-"╞R╠.╖Ч й'K R╡R╚1:█ 124:Ч Г'L ▀B$╡"="╞RЁб(327682)╚1╖Ч З'M R╡R╙1:█ 124:Ч (N ▀B$╡г(13)╖Ч J(O █ 81:█ 66:≈AB╙AF,AI:≈AB╙AF╙1,AJ:≈AB╙AF╙2,AK:≈AB╙AF╙3,AL:Ч P(P ▌ ╪(Q B╡AI:C╡AJ:AR╡0:█ 11:AI╡B:AJ╡C:AR╡1:█ 11:AK╡B:AL╡C:≈264192╙N╙O╛80,J:≈267911168╙N╙O╛80,K:≈264192╙P╙Q╛80,L ж(R ≈267911168╙P╙Q╛80,M:▌ )S AI╡б(AB╙AF):AJ╡б(AB╙AF╙1):AK╡б(AB╙AF╙2):AL╡б(AB╙AF╙3):▌ 7)T █ 83:≥AI;",";AJ;",";AK;",";AL;:▌ V)U ┘"LOAD NAME: ";C$:▀C$╡""╖▌ m)V Ч(C$),P(327680):▌ Л)W AC╡270336:AD╡327680:E╡б(AC):≈AD╙2,E:AC╡AC╙1:AD╡AD╙3:AE╡3:│AF╡.╓E╚1:≈AD╙0,б(AC):AC╡AC╙1:≈AD╙1,б(AC):AC╡AC╙1:H╡б(AC):≈AD╙2,H   ЪЪЪЪЪЪЪЪ              ЪЪЪЪЪЪЪЪЪ           ЪЪЪЪЪЪЪЪЪ              ЪЪЪЪЪЪЪЪЪЪ             ЪЪЪЪЪЪЪЪЪЪЪ     ЪЪЪЪЪЪЪЪЪЪЪЪ      ЪЪЪЪЪЪЪЪЪЪЪЪ      ЪЪЪЪЪЪЪЪЪЪЪЪ        ЪЪЪЪЪЪЪЪЪЪЪЪ            ЪЪЪЪЪЪЪЪЪЪЪЪ           ЪЪЪЪЪЪЪЪЪЪЪЪ         ЪЪЪЪЪЪЪЪЪЪ           ЪЪЪЪЪЪЪЪЪЪ                 ЪЪЪЪЪЪЪЪ           ЪЪЪЪЪЪЪ           ЪЪЪЪЪЪ             ЪЪЪЪЪ           ЪЪЪЪ              ЪЪЪЪ             ЪЪ          ЪЪ                           Ъ                ЪЪ        ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ            ЪЪЪЪЪЪЪЪ                ЪЪЪЪЪЪЪЪ        ЪЪЪЪЪЪЪ   ЪЪЪЪЪЪЪЪ  ЪЪЪЪЪЪЪЪ   ЪЪЪЪЪЪЪ    ЪЪЪЪЪЪЪЪ            ЪЪЪЪЪЪЪ        ЪЪЪЪЪЪЪ            ЪЪЪЪЪЪ             ЪЪЪЪЪ           ЪЪЪЪЪ            ЪЪЪЪ               ЪЪЪ              ЪЪЪ              ЪЪЪ                   Ъ                    Ъ                                            )&                ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ     ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ             ЪЪЪЪЪЪЪЪЪЪЪ         ЪЪЪЪЪЪЪЪЪ          ЪЪЪЪЪЪ          ЪЪЪ         ЪЪ                 ЪЪЪ         ЪЪЪ                        ЪЪЪ      ЪЪЪ          ЪЪЪЪ               ЪЪЪЪЪ            ЪЪЪЪЪ             ЪЪЪЪЪЪ           ЪЪЪЪЪЪЪ          ЪЪЪЪЪЪЪЪ          ЪЪЪЪЪЪЪЪ           ЪЪЪЪЪЪЪЪЪ            ЪЪЪЪЪЪЪЪЪЪ          ЪЪЪЪЪЪЪЪЪЪЪ         ЪЪЪЪЪЪЪЪЪЪЪ  ЪЪЪЪЪЪЪЪЪЪЪ     ЪЪЪЪЪЪЪЪЪЪЪ       ЪЪЪЪЪЪЪЪЪЪЪ       ЪЪЪЪЪЪЪЪЪЪЪ          ЪЪЪЪЪЪЪЪЪЪЪ        ЪЪЪЪЪЪЪЪЪЪ         ЪЪЪЪЪЪЪЪ             ЪЪЪЪЪЪЪЪ             ЪЪЪЪЪЪ             ЪЪЪЪЪЪ          ЪЪЪЪЪ           ЪЪЪЪ          ЪЪЪ               ЪЪ              Ъ              Ъ                           ?                ЪЪЪЪЪЪЪЪЪЪЪ            ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ        ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ    @@@@@@@@@@@@        ЪЪЪЪЪ     @@@@@@@@      ЪЪЪЪЪЪЪЪЪЪЪЪЪ  AAAAAAAAAAAAAAAAAAAAAAAA      AAAAAAAAAAAAAAAAA     ЪЪЪЪЪЪЪЪ BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB   ЪЪЪЪЪ CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC  ЪЪЪЪ DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD ЪЪЪЪ EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE ЪЪЪ FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  ЪЪЪ GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG ЪЪЪЪ HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH  ЪЪЪЪ IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII ЪЪЪЪ JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ ЪЪЪ LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL ЪЪ  MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM ЪЪ NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN ЪЪ OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO ЪЪ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ ЪЪ AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ЪЪЪ BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB    BBBBBBBBBBBBBBBBBBBB ЪЪЪЪЪ  CCCCCCCCCCCCCC                 ЪЪЪЪ           CCCCCCCCC ЪЪЪЪЪЪЪ   DD  DDD    ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ         ЪЪЪЪЪЪ =ЪЪЪЪЪ  ЪЪ    ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ                                                                                                                                                                                                  TE  ' -------  #DECLARE DEFAULT╞RED&(32)  #DECLARE DEFAULT╞GREEN&(32)  #DECLARE DEFAULT╞BLUE&(32)  #DECLARE CURR╞RED&(32)  #DECLARE CURR╞GREEN&(32)  #DECLARE CURR╞BLUE&(32)  #DECLARE FADEVAL, TEMPVAL.OFFSETS#DEFINE оффсет╞дата╞сизе  = 0#DEFI NE оффсет╞нум╞фрамес = 2#DEFINE оффсет╞фраме0     = 3#DEFINE фрм╞оффсет╞ь          = 0#DEFINE фрм╞оффсет╞ы          = 1#DEFINE фрм╞оффсет╞в          = 2#DEFINE фрм╞оффсет╞х          = 3#DEFINE фрм╞оффсет╞хитбоьес   = 4#DEFINE фрм╞оффсет╞хб╞хеад  !  = 4#DEFINE фрм╞оффсет╞хб╞торсо   = 8#DEFINE фрм╞оффсет╞хб╞феет    = 12#DEFINE фрм╞оффсет╞хб╞аттацк  = 16#DEFINE фрм╞оффсет╞дата       = 20'----.MAIN'----  GOSUB INIT  GOSUB LOAD╞DATA  GOSUB STATE╞LOOP  GOSUB ANIMATE╞LOGO  END#DEFINE с т╞фаде╞то╞вхите = 0#DEFINE ст╞драв╞бацкдроп╞онлы = 1#DEFINE ст╞фаде╞то╞дефаулт = 2#DEFINE ст╞дроп╞ин╞б = 3#DEFINE ст╞пресентс = 4#DEFINE ст╞анатхема = 5'----------.STATE╞LOOP'----------  TSTART = TI  IF LOGO╞STATE = ст╞фаде╞то╞вхите THEN BEG# "----------"  RETURN'---------.DRAW╞CHAR'---------  ' POKE $40800 + X + Y*80, ASC(A$)  ' POKE $FF80000 + X + Y*80, RCOLOR(1)  PRINT A$;  RETURN'--------------------.CHECK╞ALT╞KEY╞INPUTS'--------------------  ALT╞KEY = PEEK($D611) AND 16 $ IF ALT╞KEY = 0 THEN RETURN  IF A$=кеы╞лефт THEN GOSUB SCROLL╞CANVAS╞LEFT  IF A$=кеы╞ригхт THEN GOSUB SCROLL╞CANVAS╞RIGHT  A$=""  RETURN'---------.DRAW╞INFO'---------  PRINT "";CHR$(27);"QFNAME=";FNAME$;"  DIDX%=";DIDX%;  RETURN'-------%.CHK╞REV'-------  IF REV╞FLAG& = 1 THEN PRINT "";:ELSE PRINT "▓";  RETURN'---------.PLAY╞DATA'---------  PRINT "⌠";  IF VER = 3 THEN GOSUB DRAW╞FONT╞GUIDE╞LINES  OFFS=0  PIDX% = 0  IF LASTFLAG = 1 THEN PIDX% = LAST╞GROUP╞IDX : LASTFLAG = 0&  DO WHILE PIDX% < DIDX%    CURSOR 0,49:PRINT CHR$(27);"QPIDX=";PIDX%;"[";LDATA&(PIDX%);LDATA&(PIDX%+1);LDATA&(PIDX%+2);    VAL& = LDATA&(PIDX%) : PIDX% = PIDX% + 1    IF VER<>2 AND VAL& = $FF THEN BEGIN      GOSUB DRAW╞FONT╞GUIDE╞LINES      IF P'IDX% > LAST╞GROUP╞IDX THEN LAST╞GROUP╞IDX = PIDX%      GOTO PD╞ENDLOOP    BEND    'IF VAL& = $FF THEN GROUP╞FLAG& = 1 : GOTO PD╞ENDLOOP    'IF VAL& = $FE THEN GROUP╞FLAG& = 0 : SLEEP .02 : GOTO PD╞ENDLOOP    X = VAL& AND $7F    IF VER=2 THEN BEGIN      X = VAL&      VAL& = LDATA&(PIDX%)      PIDX% = PIDX% + 1      X = X + (VAL& AND $7F) * 256    BEND    IF VAL& AND $80 THEN PRINT ""; : ELSE PRINT "▓";    Y = LDATA&(PIDX%) : PIDX% = PIDX% + 1    A$ = CHR$(LDATA&(PIDX%)) : PIDX% = PIDX% +0      POKE $50000 + оффсет╞нум╞фрамес, 0    BEND    PRINT "⌠";CLR╞LINE╞RIGHT$;  BEND  RETURN'---------------.CHECK╞EDIT╞FLAG'---------------  IF PEEK($5FFFC) = 1 THEN BEGIN ' EDITING?    POKE $5FFFC, 0    CURR╞FRAME = PEEK($5FFFD)    GOSUB GET╞CURR╞FRAME╞PTR    STARTX = PEEK(PTR + фрм╞оффсет╞ь)    STARTY = PEEK(PTR + фрм╞оффсет╞ы)    X = STARTX + PEEK(PTR + фрм╞оффсет╞в) - 1    Y = STARTY + PEEK(PTR + фрм╞оффсет╞х) - 1    NEW╞FRAME╞FLAG = 0    GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR    GOSUB DRAW╞CURR╞FRAME  BEND  RETURN'--------------.YANK╞SELECTION'--------------  POKE $D020, PEEK($D020) + 1  ' SELECT A REGION WITH CURSOR MOVEMENT  GOSUB GET╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2  ' COPY IT INTO A BASIC VAR  PTR = POINTER(CLIPBOARD╞CHAR&(0))  LN = X2-X1+1  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, $40800+X1+Y*80, PTR    PTR = PTR + LN  NEXT Y  PTR = POINTER(CLIPBOARD╞CLR&(0))  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, $FF80000+X1+Y*80, PTR    PTR = PTR + LN  NEXT Y  CLIPW = X2-X1+1  CLIPH = Y2-Y1+1  POKE $D020, PEEK($D020) - 1  RETURN'-----.PASTE'-----  ' COPY SELECTION FROM VARS ONTO SCREEN AT CURRENT CURSOR POSITION  X1 = X  Y1 = Y  X2 = X + CLIPW - 1  Y2 = Y + CLIPH - 1  PTR = POINTER(CLIPBOARD╞CHAR&(0))  LN = X2-X1+1  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, PTR, $40800+X1+Y*80    PTR = PTR + LN  NEXT Y  PTR = POINTER(CLIPBOARD╞CLR&(0))  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, PTR, $FF80000+X1+Y*80    PTR = PTR + LN  NEXT Y  ' тодо: RE-SAVE CURRENT FRAME  GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR  GOSUB GET╞CURR╞FRAME╞PTR  STARTX = PEEK(PTR + фрм╞оффсет╞ь)  STARTY = PEEK(PTR + фрм╞оффсет╞ы)  X = STARTX + PEEK(PTR + фрм╞оффсет╞в) - 1  Y = STARTY + PEEK(PTR + фрм╞оффсет╞х) - 1  NEW╞FRAME╞FLAG = 1 0  GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR  RETURN                                                                                                                                                                                                              	@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA     BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB      CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC      DDDDDDDDDDDDDDDDDD
DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD       EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE      FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF     GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG     HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH    IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII    JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ    KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK    LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL     MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM    MMMMMMMMMMMMMMMMMMMM        NNNNNNNNNNNNNN                                NNNNNNNNN           NN  NNN                                                                             $                                                                                                                                                                                                                                                              
&                ЪЪЪЪЪ   ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ          ЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪЪ             ЪЪЪЪЪЪЪЪЪЪЪЪ          ЪЪЪЪЪЪЪЪЪ          ЪЪЪЪЪ       ЪЪЪ         ЪЪЪ         ЪЪЪ       ЪЪЪ      ЪЪ          ЪЪЪЪ         ЪЪЪЪ      ЪЪЪЪЪ          ЪЪЪЪЪЪ           ЪЪЪЪЪЪЪ         ЪЪЪЪЪЪЪ       ------------------------  POKE PTR + фрм╞оффсет╞ь, STARTX  POKE PTR + фрм╞оффсет╞ы, STARTY  POKE PTR + фрм╞оффсет╞в, X - STARTX + 1  POKE PTR + фрм╞оффсет╞х, Y - STARTY + 1  IF NEW╞FRAME╞FLAG THEN BEGIN    LN = фрм╞оффсет╞дата - фрм╞оффсет╞хитбоьес    EDMA оп╞филл, LN, 0, PTR + фрм╞оффсет╞хитбоьес  BEND  PTR = PTR + фрм╞оффсет╞дата  FOR YIDX = STARTY TO Y    FOR XIDX = STARTX TO X     POKE PTR, PEEK($40800 + XIDX + YIDX * 80)     PTR = PTR + 1    NEXT XIDX  NEXT YIDX  FOR YIDX = STARTY TO Y    FOR XIDX = STARTX TO X     POKE PTR, PEEK($FF80000 + XIDX + YIDX * 80)     PTR = PTR + 1    NEXT XIDX  NEXT YIDX  IF NEW╞FRAME╞FLAG THEN BEGIN    WPOKE $50000 + оффсет╞дата╞сизе, PTR - $50000    POKE $50000 + оффсет╞нум╞фрамес, FRAME╞COUNT + 1  BEND  CURSOR 0,49  PRINT CLR╞LINE╞RIGHT$;"FRAME COUNT=";PEEK($50000 + оффсет╞нум╞фрамес);  PRINT ", NEXT-FREE=$";HEX$(PTR);  CURSOR 0,0  NEW╞FRAME╞FLAG = 0  RETURN'----------.LOAD╞FRAME'----------  PRINT "";CLR╞LINE╞RIGHT$;  INPUT "FRAME#";CURR╞FRAME  GOSUB DRAW╞CURR╞FRAME  RETURN'------------.DELETE╞FRAME'------------  GOSUB GET╞END╞PTR  END╞PTR = PTR  ' DECREMENT FRAME COUNT  FRAME╞COUNT = FRAME╞COUNT - 1  POKE $50000 + оффсет╞нум╞фрамес, FRAME╞COUNT  GOSUB DELETE╞FRAME╞SIZE╞FROM╞TOTAL  IF CURR╞FRAME = FRAME╞COUNT THEN BEGIN    CURR╞FRAME = CURR╞FRAME - 1  BEND : ELSE BEGIN    GOSUB SHIFT╞REMAINING╞FRAMES╞ALONG  BEND  GOSUB DRAW╞CURR╞FRAME  RETURN'----------------------------.DELETE╞FRAME╞SIZE╞FROM╞TOTAL'----------------------------  GOSUB GET╞CURR╞FRAME╞PTR  CURR╞PTR = PTR  FRMW = PEEK(CURR╞PTR + фрм╞оффсет╞в)  FRMH = PEEK(CURR╞PTR + фрм╞оффсет╞х)  SZ = WPEEK($50000 + оффсет╞дата╞сизе)  SZ = SZ - (фрм╞оффсет╞дата + FRMW * FRMH * 2)  WPOKE $50000 + оффсет╞дата╞сизе, SZ  RETURN'----------------------------.SHIFT╞REMAINING╞FRAMES╞ALONG'----------------------------  GOSUB GET╞CURR╞FRAME╞PTR  CURR╞PTR = PTR  FRMW = PEEK(CURR╞PTR + фрм╞оффсет╞в)  FRMH = PEEK(CURR╞PTR + фрм╞оффсет╞х)  START╞PTR = CURR╞PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  LN = END╞PTR - START╞PTR + 1  ' PRINT "CURR╞PTR = ";HEX$(CURR╞PTR)  ' PRINT "START╞PTR = ";HEX$(START╞PTR)  ' PRINT "END╞PTR = ";HEX$(END╞PTR)  ' PRINT "LN = ";HEX$(LN)  ' GET KEY A$  ' A$=""  EDMA оп╞цопы, LN, START╞PTR, CURR╞PTR    RETURN'-----------.GET╞END╞PTR'-----------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  PTR = $50000 + оффсет╞фраме0  FRMIDX = 0  IF FRMIDX >= FRAME╞COUNT THEN BEGIN    CURSOR 0,0    PRINT CLR╞LINE╞RIGHT$;"INVALID BLOCK#!"    RETURN  BEND  ' TRAVERSE TO FIND BLOCK  FOR FRMIDX = 0 TO FRAME╞COUNT - 1    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT FRMIDX  RETURN'------------------.GET╞CURR╞FRAME╞PTR'------------------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  ' TRAVERSE TO FIND BLOCK  PTR = $50000 + оффсет╞фраме0  FOR FRMIDX = 0 TO FRAME╞COUNT    IF FRMIDX = CURR╞FRAME THEN RETURN    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT FRMIDX  PTR = 0  RETURN'---------------.DRAW╞CURR╞FRAME'---------------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  PTR = $50000 + оффсет╞фраме0  FRMIDX = 0  IF FRMIDX >= FRAME╞COUNT THEN BEGIN    CURSOR 0,0    PRINT CLR╞LINE╞RIGHT$;"INVALID BLOCK#!"    RETURN  BEND  GOSUB GET╞CURR╞FRAME╞PTR  IF PTR = 0 THEN PRINT "NOT FOUND!" : RETURN    X = PEEK(PTR + фрм╞оффсет╞ь)  Y = PEEK(PTR + фрм╞оффсет╞ы)  FRMW = PEEK(PTR + фрм╞оффсет╞в)  FRMH = PEEK(PTR + фрм╞оффсет╞х)  ENDX = X + FRMW - 1  ENDY = Y + FRMH - 1  PRINT "";CLR╞LINE╞RIGHT$;  PRINT "X=";X;", Y=";Y;", W=";FRMW;", H=";FRMH;  PRINT ", PTR=$";HEX$(PTR);  PRINT "";CHR$(27);"J";CLR╞LINE╞RIGHT$;"FRAME=";CURR╞FRAME;  PRINT ", NXT=$";HEX$(PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2);  SRC╞CHAR╞PTR = PTR + фрм╞оффсет╞дата  SRC╞CLR╞PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH  DEST╞CHAR╞ PTR =$40800 + X + Y * 80  DEST╞CLR╞PTR = $FF80000 + X + Y * 80  FOR YIDX = Y TO ENDY    EDMA оп╞цопы, FRMW, SRC╞CHAR╞PTR, DEST╞CHAR╞PTR    EDMA оп╞цопы, FRMW, SRC╞CLR╞PTR, DEST╞CLR╞PTR    SRC╞CHAR╞PTR = SRC╞CHAR╞PTR + FRMW    SRC╞CLR╞PTR = SRC╞CLR!╞PTR + FRMW    DEST╞CHAR╞PTR = DEST╞CHAR╞PTR + 80    DEST╞CLR╞PTR = DEST╞CLR╞PTR + 80  NEXT YIDX  RETURN'-------------------------.RESTORE╞CHAR╞UNDER╞CURSOR'-------------------------  IF STORE╞STATE = сторе╞старт╞пос THEN BEGIN    POKE $40800" + X + Y * 80, START╞CHAR    POKE $FF80000 + X + Y * 80, START╞COLOR  BEND:ELSE BEGIN  ' сторе╞енд╞пос    POKE $40800 + X + Y * 80, END╞CHAR    POKE $FF80000 + X + Y * 80, END╞COLOR        BEND  RETURN'-----------.DRAW╞CURSOR'-----------  POK#E $40800 + X + Y * 80, 43  POKE $FF80000 + X + Y * 80, 1  RETURN'-----------.DRAW╞FOOTER'-----------  CURSOR 0,49  PRINT CLR╞LINE╞RIGHT$;"FRAME COUNT=";PEEK($50000 + оффсет╞нум╞фрамес);", NEXT-FREE=$";  PRINT HEX$(PTR);  RETURN'-------------$---.STORE╞STATE╞INFO'----------------  IF STORE╞STATE = сторе╞старт╞пос THEN BEGIN    START╞CHAR = PEEK($40800 + X + Y * 80)    START╞COLOR = PEEK($FF80000 + X + Y * 80)    STARTX = X    STARTY = Y  BEND:ELSE BEGIN ' сторе╞енд╞пос    END╞CHAR = %PEEK($40800 + X + Y * 80)    END╞COLOR = PEEK($FF80000 + X + Y * 80)    ENDX = X    ENDY = Y  BEND  RETURN'---------.INIT╞VARS'---------  CURRENT╞FRAME = 0  STORE╞STATE = сторе╞старт╞пос  X = 0  Y = 0  CURR╞FRAME = 0  RETURN  '-------&--------------.LOCATE╞NEXT╞FREE╞BYTE'---------------------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  FRMIDX = 0  PTR = $50000 + оффсет╞фраме0  DO WHILE 1    IF FRMIDX = FRAME╞COUNT THEN BEGIN      BYTES╞USED = PTR-$50000      RETURN  '  BEND    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2    FRMIDX = FRMIDX + 1  LOOP  RETURN'---------------------.CHECK╞MAGIC╞SIGNATURE'---------------------  IF PEEK( $5FFFE) <> 71 OR PEEK($5FFFF) <> 73 THEN BEGIN    WPOKE $5FFFE, $4947    PRINT "⌠";CLR╞LINE╞RIGHT$;    PRINT "MAGIC SIGNATURE APPLIED. RESET FRAME COUNT TO ZERO? (Y/N)";    GET KEY A$    IF A$ = "Y" THEN BEGIN      WPOKE $50000 + оффсет╞дата╞сизе, 80000 + ENDX + ENDY * 80, END╞COLOR  RETURN'----------------------------------.PEEK╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2'----------------------------------  X1 = PEEK(CURR╞PTR + K)  Y1 = PEEK(CURR╞PTR + K + 1)  X2 = PEEK(CURR╞PTR + K + 2)  Y2 = PEEK(CURR╞PTR + K + 3)  RETURN'------------------.SHOW╞HITBOX╞COORDS'------------------  GOSUB PEEK╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2  PRINT X1;",";Y1;",";X2;",";Y2;  RETURN'--------.LOAD╞BIN'--------  INPUT "LOAD NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  BLOAD (FNAME$),P($50000)  ' GOSUB ONE╞OFF╞REPAIR  RETURN'--------------.ONE╞OFF╞REPAIR'--------------  ' INJECT SPACES WHERE NEEDED  SRC╞PTR = $42000  DEST╞PTR = $50000  FRAME╞COUNT = PEEK(SRC╞PTR)  POKE DEST╞PTR + оффсет╞нум╞фрамес, FRAME╞COUNT  SRC╞PTR = SRC╞PTR + 1  DEST╞PTR = DEST╞PTR + оффсет╞фраме0  SZ = оффсет╞фраме0  FOR K = 0 TO FRAME╞COUNT - 1    POKE DEST╞PTR + фрм╞оффсет╞ь, PEEK(SRC╞PTR)    SRC╞PTR = SRC╞PTR + 1    POKE DEST╞PTR + фрм╞оффсет╞ы, PEEK(SRC╞PTR)    SRC╞PTR = SRC╞PTR + 1    FRMW = PEEK(SRC╞PTR)    POKE DEST╞PTR + фрм╞оффсет╞в, FRMW    SRC╞PTR = SRC╞PTR + 1    FRMH = PEEK(SRC╞PTR)    POKE DEST╞PTR + фрм╞оффсет╞х, FRMH    SRC╞PTR = SRC╞PTR + 1    LN = фрм╞оффсет╞дата - фрм╞оффсет╞хитбоьес    EDMA оп╞филл, LN, 0, DEST╞PTR + фрм╞оффсет╞хитбоьес    LN = FRMW * FRMH * 2    EDMA оп╞цопы, LN, SRC╞PTR, DEST╞PTR + фрм╞оффсет╞дата    SRC╞PTR = SRC╞PTR + LN    DEST╞PTR = DEST╞PTR + фрм╞оффсет╞дата + LN    SZ = SZ + фрм╞оффсет╞дата + LN      NEXT K  DEST╞PTR = $50000  WPOKE DEST╞PTR + оффсет╞дата╞сизе, SZ  RETURN'--------.SAVE╞BIN'--------  INPUT "SAVE NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  PTR = $50000 + WPEEK($50000 + оффсет╞дата╞сизе)  DELETE (FNAME$)  BSAVE (FNAME$),P($50000) TO P(PTR)  RETURN'-------------------------------------.CALCULATE╞OPTIMISED╞DATA╞SIZE╞INTO╞SZ'-------------------------------------  SZ = WPEEK($50000 + оффсет╞дата╞сизе)  PTR = $50000 + оффсет╞фраме0  FOR K = 0 TO FRAME╞COUNT - 1 	   FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    SZ = SZ - FRMW * FRMH    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT K  RETURN'--------------.SAVE╞OPTIMISED'--------------  INPUT "SAVE NAME (OPTIMISED): ";FNAME
$  IF FNAME$ = "" THEN RETURN  DELETE (FNAME$)  DOPEN #2,(FNAME$ + ",P"),W,U8  PRINT #2, CHR$(1);  PRINT #2, CHR$(2);  ' DUMMY ADDRESS  GOSUB CALCULATE╞OPTIMISED╞DATA╞SIZE╞INTO╞SZ    PRINT #2, CHR$(MOD(SZ, 256));  PRINT #2, CHR$(INT(SZ / 256));  PRINT #2, CHR$(FRAME╞COUNT);  PTR = $50000 + оффсет╞фраме0  FOR FRMIDX = 0 TO FRAME╞COUNT - 1    X = PEEK(PTR + фрм╞оффсет╞ь)    Y = PEEK(PTR + фрм╞оффсет╞ы)    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PRINT #2, CHR$(X);CHR$(Y);CHR$(FRMW);CHR$(FRMH);    FOR K=0 TO 15      PRINT #2, CHR$(PEEK(PTR + фрм╞оффсет╞хитбоьес + K));    NEXT K    SRC╞CHAR╞PTR = PTR + фрм╞оффсет╞дата    SRC╞CLR╞PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH        FOR K = 0 TO FRMW * FRMH - 1      CVAL = PEEK(SRC╞CLR╞PTR + K)      IF PEEK(SRC╞CHAR╞PTR + K) = 102 THEN BEGIN        CVAL = $FF      BEND      PRINT #2, CHR$(CVAL);    NEXT K    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT FRMIDX  DCLOSE #2  RETURN'------------------------.SAVE╞NEW╞FRAME╞TO╞MEMORY'------------------------  POKE $40800 + STARTX + STARTY * 80, START╞CHAR  POKE $FF80000 + STARTX + STARTY * 80, START╞COLOR  POKE $40800 + ENDX + ENDY * 80, END╞CHAR  POKE $FF80000 + ENDX + ENDY * 80, END╞COLOR  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  GOSUB LOCATE╞NEXT╞FREE╞BYTE  PTR = $50000 + BYTES╞USED  NEW╞FRAME╞FLAG = 1  GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR  RETURN'---------------------------.SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR'-------.MAIN'----  KEY OFF  POKE $D020, 11, 14  GOSUB INIT╞VARS  GOSUB CHECK╞MAGIC╞SIGNATURE  GOSUB CHECK╞EDIT╞FLAG  GOSUB LOCATE╞NEXT╞FREE╞BYTE  GOSUB DRAW╞FOOTER  DO WHILE 1    GOSUB STORE╞STATE╞INFO    GOSUB DRAW╞CURSOR    GOSUB GET╞USER╞INPUT    GOSUB SHOW╞COORDS  LOOP'-----------.SHOW╞COORDS'-----------  CURSOR 0, 49  PRINT CLR╞LINE╞RIGHT$;  IF STORE╞STATE = сторе╞старт╞пос THEN BEGIN    PRINT CHR$(27)+"QX=";X;", Y=";Y;  BEND  IF STORE╞STATE = сторе╞енд╞пос THEN BEGIN    PRINT CHR$(27)+"QX=";STARTX;", Y=";STARTY;    PRINT ", W=";X-STARTX+1;", H=";Y-STARTY+1;  BEND  PRINT CLR╞LINE╞RIGHT$;  RETURN'-----------.ENTER╞COORD'-----------  DO WHILE 1    GOSUB STORE╞STATE╞INFO    GOSUB DRAW╞CURSOR    GET KEY A$    IF A$ <> кеы╞ретурн THEN GOSUB RESTORE╞CHAR╞UNDER╞CURSOR    IF A$ = кеы╞лефт AND X > 0 THEN X = X - 1    IF A$ = кеы╞ригхт AND X < 79 THEN X = X + 1    IF A$ = кеы╞уп AND Y > 0 THEN Y = Y - 1    IF A$ = кеы╞довн AND Y < 49 THEN Y = Y + 1    IF A$=кеы╞ретурн THEN EXIT  LOOP  RETURN'--------------.GET╞USER╞INPUT'--------------  GETKEY A$  IF A$ <> " " THEN GOSUB RESTORE╞CHAR╞UNDER╞CURSOR  IF A$ = кеы╞лефт AND X > 0 THEN X = X - 1  IF A$ = кеы╞ригхт AND X < 79 THEN X = X + 1  IF A$ = кеы╞уп AND Y > 0 THEN Y = Y - 1  IF A$ = кеы╞довн AND Y < 49 THEN Y = Y + 1  IF A$ = "D" THEN GOSUB DELETE╞FRAME  IF A$ = "Y" THEN GOSUB YANK╞SELECTION  IF A$ = "P" THEN GOSUB PASTE  IF A$ = "C" THEN BEGIN    PRINT "⌠";    CURR╞FRAME = 0    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$="-" AND CURR╞FRAME > 0 THEN BEGIN    CURR╞FRAME = CURR╞FRAME - 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$="=" AND CURR╞FRAME < PEEK($50002)-1 THEN BEGIN    CURR╞FRAME = CURR╞FRAME + 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$=" " THEN BEGIN    STORE╞STATE = STORE╞STATE + 1    IF STORE╞STATE = 2 THEN BEGIN      GOSUB SAVE╞NEW╞FRAME╞TO╞MEMORY      END    BEND  BEND  IF A$="L" THEN GOSUB LOAD╞FRAME  IF A$="X" THEN BEGIN    CURSOR 0,0    KEY ON    END  BEND  IF A$="E" THEN BEGIN    CURSOR 0,40    POKE $5FFFC, 1  ' EDIT FLAG ON    POKE $5FFFD, CURR╞FRAME    KEY ON    END  BEND  IF A$ = кеы╞ф1 THEN GOSUB LOAD╞BIN  IF A$ = кеы╞ф3 THEN GOSUB SAVE╞BIN  IF A$ = кеы╞ф5 THEN GOSUB SAVE╞OPTIMISED  IF A$ = кеы╞ф7 THEN GOSUB EDIT╞HIT╞BOXES  RETURN'--------------.EDIT╞HIT╞BOXES'--------------  HB╞MODE = хб╞моде╞бровсе  DO WHILE 1    GOSUB SHOW╞HITBOX╞TABLE    GOSUB DRAW╞HITBOXES    GOSUB хб╞GET╞USER╞INPUT    IF A$="X" OR A$=кеы╞есц OR A$=кеы╞ф7 THEN BEGIN      PRINT CHR$(147);      GOSUB DRAW╞CURR╞FRAME      EXIT    BEND  LOOP  RETURN#DEFINE цхар╞боь╞тл = 112#DEFINE цхар╞боь╞тр = 110#DEFINE цхар╞боь╞бл = 109#DEFINE цхар╞боь╞бр = 125#DEFINE цхар╞хорз   = 64#DEFINE цхар╞жерт   = 93#DEFINE цхар╞спаце  = 32'---------.DRAW╞CHAR'---------  IF PEEK($40800 + X + Y * 80) <> цхар╞спаце THEN BEGIN    K = K + 128  BEND:ELSE BEGIN    POKE $FF80000 + X + Y * 80, 1  BEND  POKE $40800 + X + Y * 80, K  RETURN'-------------.DRAW╞HITBOXES'-------------  GOSUB DRAW╞CURR╞FRAME  GOSUB GET╞CURR╞FRAME╞PTR  FOR IDX = 0 TO 3    X1 = PEEK(PTR + BX╞OFFS(IDX))    Y1 = PEEK(PTR + BX╞OFFS(IDX) + 1)    X2 = PEEK(PTR + BX╞OFFS(IDX) + 2)    Y2 = PEEK(PTR + BX╞OFFS(IDX) + 3)    IF NOT (X1=0 AND Y1=0 AND X2=0 AND Y2=0) THEN BEGIN      ' DRAW CORNERS      ' ------------      X = X1 : Y = Y1 : K = цхар╞боь╞тл : GOSUB DRAW╞CHAR      X = X2 : Y = Y1 : K = цхар╞боь╞тр : GOSUB DRAW╞CHAR      X = X1 : Y = Y2 : K = цхар╞боь╞бл : GOSUB DRAW╞CHAR      X = X2 : Y = Y2 : K = цхар╞боь╞бр : GOSUB DRAW╞CHAR      ' DRAW HORIZONTALS      ' ----------------      FOR X = X1+1 TO X2-1        Y = Y1 : K = цхар╞хорз : GOSUB DRAW╞CHAR        Y = Y2 : K = цхар╞хорз : GOSUB DRAW╞CHAR      NEXT X      ' DRAW VERTICALS      ' --------------      FOR Y = Y1+1 TO Y2-1        X = X1 : K = цхар╞жерт : GOSUB DRAW╞CHAR        X = X2 : K = цхар╞жерт : GOSUB DRAW╞CHAR      NEXT Y    BEND  NEXT IDX  RETURN'-----------------.SHOW╞HITBOX╞TABLE '-----------------  GOSUB GET╞CURR╞FRAME╞PTR  CURR╞PTR = PTR  IF HB╞SEL = 0 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,40:PRINT кеы╞есц;"Q  HEAD: ";  K = фрм╞оффсет╞хб╞хеад:GOSUB SHOW╞HITBOX╞COORDS  IF HB╞SEL = 1 THEN PRINT кеы╞ре!ж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,41:PRINT кеы╞есц;"Q TORSO: ";  K = фрм╞оффсет╞хб╞торсо:GOSUB SHOW╞HITBOX╞COORDS  IF HB╞SEL = 2 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,42:PRINT кеы╞есц;"Q  FEET: ";   K = фрм╞оффсет╞хб╞феет":GOSUB SHOW╞HITBOX╞COORDS  IF HB╞SEL = 3 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,43:PRINT кеы╞есц;"QATTACK: ";  K = фрм╞оффсет╞хб╞аттацк:GOSUB SHOW╞HITBOX╞COORDS  PRINT кеы╞реж╞офф;  GOSUB GET╞SELECTED╞COORDS  RETURN'------#--------------------.GET╞SELECTED╞OFFSET╞INTO╞K'--------------------------  IF HB╞SEL = 0 THEN K = фрм╞оффсет╞хб╞хеад  IF HB╞SEL = 1 THEN K = фрм╞оффсет╞хб╞торсо  IF HB╞SEL = 2 THEN K = фрм╞оффсет╞хб╞феет  IF HB╞SEL = 3 THEN K = фрм╞оффсет╞хб╞аттац$к  RETURN'-------------------.GET╞SELECTED╞COORDS'-------------------  GOSUB GET╞SELECTED╞OFFSET╞INTO╞K  GOSUB PEEK╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2  RETURN  '-----------------.хб╞GET╞USER╞INPUT'-----------------  GET KEY A$  IF A$=кеы╞уп AN%D HB╞SEL > 0 THEN HB╞SEL = HB╞SEL - 1  IF A$=кеы╞довн AND HB╞SEL < 3 THEN HB╞SEL = HB╞SEL + 1  IF A$="-" AND CURR╞FRAME > 0 THEN BEGIN    CURR╞FRAME = CURR╞FRAME - 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$="=" AND CURR╞FRAME < PEEK($50002)-1 THEN BE&GIN    CURR╞FRAME = CURR╞FRAME + 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$=кеы╞ретурн THEN BEGIN    GOSUB GET╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2    GOSUB GET╞SELECTED╞OFFSET╞INTO╞K    POKE CURR╞PTR + K    , X1    POKE CURR╞PTR + K + 1, Y1    POKE CU'RR╞PTR + K + 2, X2    POKE CURR╞PTR + K + 3, Y2  BEND  RETURN'---------------------------------.GET╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2'---------------------------------  ' COORD1  X = X1 : Y = Y1  STORE╞STATE = сторе╞старт╞пос  GOSUB ENTER╞COORD   X1 = X  Y1 = Y  ' COORD2  STORE╞STATE = сторе╞енд╞пос  GOSUB ENTER╞COORD  X2 = X  Y2 = Y  POKE $40800 + STARTX + STARTY * 80, START╞CHAR  POKE $FF80000 + STARTX + STARTY * 80, START╞COLOR  POKE $40800 + ENDX + ENDY * 80, END╞CHAR  POKE $FF'----.DOCS'----' гRABBER тOOL - PORTED TO еLEVEN (FOR EASIER MAINTENANCE)' ============'' уSAGE:' -----' - пRESS 'SPACE' KEY ON TOP-LEFT POINT' - тHEN USE CURSOR KEYS TO MOVE TO BOTTOM-RIGHT POINT & PRESS 'SPACE'' - пRESS '-' AND '+' KEYS TO MOVE BETWEEN PREVIOUS AND NEXT FRAMES' - пRESS 'C' TO REDRAW CURRENT FRAME' - пRESS 'Y' TO YANK/COPY A SELECTED REGION' - пRESS 'P' TO PASTE A SELECTED REGION TO CURRENT CURSOR LOCATION' - пRESS 'E' TO EDIT CURRENT FRAME' - пRESS 'D' TO DELETE THE CURRENT FRAME' - пRESS 'L' THEN A FRAME# TO LOAD THAT FRAME' - пRESS 'X' TO EXIT PROGRAM' - ф1 = LOAD CHAR+COLOR .BIN FILE' - ф3 = SAVE CHAR+COLOR .BIN FILE' - ф5 = SAVE OPTIMIZED+REPAIRED .BIN FILE' - ф7 = EDIT HIT BOXES#OUTPUT "GRABBER"' цHAR+цOLOR фILE фORMAT (ф1/ф3 KEYS)' ======================' ворд: PROG-ADDRESS (IGNORED)' ворд: SIZE OF DATA (INCLUDING THIS ворд AND ONWARDS)' быте: # OF FRAMES' ' фраме #0' --------'   быте: X'   быте: Y'   быте: W'   быте: H'   дворд: HEAD BOX (X1,Y1,X2,Y2)'   дворд: TORSO BOX (X1,Y1,X2,Y2)'   дворд: FEET BOX (X1,Y1,X2,Y2)'   дворд: ATTACK BOX (X1,Y1,X2,Y2)'   быте[W*H]: CHAR DATA'   быте[W*H]: COLOR DATA'' фраме #1' --------'   (AS BEFORE...)'' фраме #N' --------'   (AS BEFORE...)' цOLOR-ONLY фILE фORMAT (ф5 KEY)' ======================' ворд: PROG-ADDRESS (IGNORED)' ворд: SIZE OF DATA (INCLUDING THIS ворд AND ONWARDS)' быте: # OF FRAMES' ' фраме #0' --------'   быте: X'   быте: Y'   быте: W'   быте: H'   дворд: HEAD BOX (X1,Y1,X2,Y2)'   дворд: TORSO BOX (X1,Y1,X2,Y2)'   дворд: FEET BOX (X1,Y1,X2,Y2)'   дворд: ATTACK BOX (X1,Y1,X2,Y2)'   быте[W*H]: COLOR DATA'' фраме #1' --------'   (AS BEFORE...)'' фраме #N' --------'   (AS BEFORE...)'--------.DECLARES'--------#DECLARE CLR╞LINE╞RIGHT$ = CHR$(27)+"Q"   ' OLD CL$#DECLARE CURRENT╞FRAME  ' OLD FF#DECLARE X, Y  ' CURSOR POSITION#DECLARE PTR  ' POINTER TO DATA BYTES IN MEMORY#DECLARE FRAME╞COUNT#DECLARE FRMIDX#DECLARE BYTES╞USED  ' OLD L#DEC	LARE FRMW, FRMH#DECLARE START╞CHAR, START╞COLOR, END╞CHAR, END╞COLOR#DECLARE STARTX, STARTY, ENDX, ENDY#DECLARE CURR╞FRAME#DECLARE SRC╞CHAR╞PTR, SRC╞CLR╞PTR#DECLARE A$, XIDX, YIDX#DECLARE DEST╞CHAR╞PTR, DEST╞CLR╞PTR#DECLARE FNAME$#DECLARE CVAL#D
ECLARE START╞PTR, END╞PTR, CURR╞PTR, SRC╞PTR, DEST╞PTR, SZ, K, LN#DECLARE B(50,3)  ' HITBOXES#DECLARE X1, Y1, X2, Y2#DECLARE HB╞SEL = 0, HB╞MODE, IDX#DECLARE CLIPBOARD╞CHAR&(80*50)#DECLARE CLIPBOARD╞CLR&(80*50)#DECLARE CLIPW, CLIPH#DEFINE сторе╞старт╞пос = 0#DEFINE сторе╞енд╞пос = 1#DECLARE STORE╞STATE  ' ARE WE STORING START/END POS CHAR/COLOUR DETAILS#DECLARE NEW╞FRAME╞FLAG#DEFINE кеы╞уп = "▒"#DEFINE кеы╞довн = ""#DEFINE кеы╞лефт = "²"#DEFINE кеы╞ригхт = ""#DEFINE кеы╞ф1 = "┘"#DEFINE кеы╞ф3 = "├"#DEFINE кеы╞ф4 = "┼"#DEFINE кеы╞ф5 = "┤"#DEFINE кеы╞ф7 = "┬"#DEFINE кеы╞ф8 = "▄"#DEFINE кеы╞есц = CHR$(27)#DEFINE кеы╞реж╞он = ""#DEFINE кеы╞реж╞офф = "▓"#DEFINE кеы╞ретурн = CHR$(13)#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE хб╞моде╞бровсе     = 0#DEFINE хб╞моде╞сел╞цоорд1 = 1#DEFINE хб╞моде╞сел╞цоорд2 = 2#DEFINE хб╞моде╞цомплете   = 3.OFFSETS#DEFINE оффсет╞дата╞сизе  = 0#DEFINE оффсет╞нум╞фрамес = 2#DEFINE оффсет╞фраме0     = 3#DEFINE фрм╞оффсет╞ь          = 0#DEFINE фрм╞оффсет╞ы          = 1#DEFINE фрм╞оффсет╞в          = 2#DEFINE фрм╞оффсет╞х          = 3#DEFINE фрм╞оффсет╞хитбоьес   = 4#DEFINE фрм╞оффсет╞хб╞хеад    = 4#DEFINE фрм╞оффсет╞хб╞торсо   = 8#DEFINE фрм╞оффсет╞хб╞феет    = 12#DEFINE фрм╞оффсет╞хб╞аттацк  = 16#DEFINE фрм╞оффсет╞дата       = 20#DECLARE BX╞OFFS(3)BX╞OFFS(0) = фрм╞оффсет╞хб╞хеадBX╞OFFS(1) = фрм╞оффсет╞хб╞торсоBX╞OFFS(2) = фрм╞оффсет╞хб╞феетBX╞OFFS(3) = фрм╞оффсет╞хб╞аттацк'ет╞х)  START╞PTR = CURR╞PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  LN = END╞PTR - START╞PTR + 1  ' PRINT "CURR╞PTR = ";HEX$(CURR╞PTR)  ' PRINT "START╞PTR = ";HEX$(START╞PTR)  ' PRINT "END╞PTR = ";HEX$(END╞PTR)  ' PRINT "LN = ";HEX$(LN)  ' GET KEY A$  ' A$=""  EDMA оп╞цопы, LN, START╞PTR, CURR╞PTR    RETURN'-----------.GET╞END╞PTR'-----------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  PTR = $50000 + оффсет╞фраме0  FRMIDX = 0  IF FRMIDX >= FRAME╞COUNT THEN BEGIN    CURSOR 0,0    PRINT CLR╞LINE╞RIGHT$;"INVALID BLOCK#!"    RETURN  BEND  ' TRAVERSE TO FIND BLOCK  FOR FRMIDX = 0 TO FRAME╞COUNT - 1    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT FRMIDX  RETURN'------------------.GET╞CURR╞FRAME╞PTR'------------------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  ' TRAVERSE TO FIND BLOCK  PTR = $50000 + оффсет╞фраме0  FOR FRMIDX = 0 TO FRAME╞COUNT    IF FRMIDX = CURR╞FRAME THEN RETURN    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT FRMIDX  PTR = 0  RETURN'---------------.DRAW╞CURR╞FRAME'---------------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  PTR = $50000 + оффсет╞фраме0  FRMIDX = 0  IF FRMIDX >= FRAME╞COUNT THEN BEGIN    CURSOR 0,0    PRINT CLR╞LINE╞RIGHT$;"INVALID BLOCK#!"    RETURN  BEND  GOSUB GET╞CURR╞FRAME╞PTR  IF PTR = 0 THEN PRINT "NOT FOUND!" : RETURN    X = PEEK(PTR + фрм╞оффсет╞ь)  Y = PEEK(PTR + фрм╞оффсет╞ы)  FRMW = PEEK(PTR + фрм╞оффсет╞в)  FRMH = PEEK(PTR + фрм╞оффсет╞х)  ENDX = X + FRMW - 1  ENDY = Y + FRMH - 1  PRINT "";CLR╞LINE╞RIGHT$;  PRINT "X=";X;", Y=";Y;", W=";FRMW;", H=";FRMH;  PRINT ", PTR=$";HEX$(PTR);  PRINT "";CHR$(27);"J";CLR╞LINE╞RIGHT$;"FRAME=";CURR╞FRAME;  PRINT ", NXT=$";HEX$(PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2);  SRC╞CHAR╞PTR = PTR + фрм╞оффсет╞дата  SRC╞CLR╞PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH  DEST╞CHAR╞PTR =$40800 + X + Y * 80  DEST╞CLR╞PTR = $FF80000 + X + Y * 80  FOR YIDX = Y TO ENDY    EDMA оп╞цопы, FRMW, SRC╞CHAR╞PTR, DEST╞CHAR╞PTR    EDMA оп╞цопы, FRMW, SRC╞CLR╞PTR, DEST╞CLR╞PTR    SRC╞CHAR╞PTR = SRC╞CHAR╞PTR + FRMW    SRC╞CLR╞PTR = SRC╞CLR╞PTR + FRMW    DEST╞CHAR╞PTR = DEST╞CHAR╞PTR + 80    DEST╞CLR╞PTR = DEST╞CLR╞PTR + 80  NEXT YIDX  RETURN'-------------------------.RESTORE╞CHAR╞UNDER╞CURSOR'-------------------------  IF STORE╞STATE = сторе╞старт╞пос THEN BEGIN    POKE $40800 + X + Y * 80, START╞CHAR    POKE $FF80000 + X + Y * 80, START╞COLOR  BEND:ELSE BEGIN  ' сторе╞енд╞пос    POKE $40800 + X + Y * 80, END╞CHAR    POKE $FF80000 + X + Y * 80, END╞COLOR        BEND  RETURN'-----------.DRAW╞CURSOR'-----------  POKE $40800 + X + Y * 80, 43  POKE $FF80000 + X + Y * 80, 1  RETURN'-----------.DRAW╞FOOTER'-----------  CURSOR 0,49  PRINT CLR╞LINE╞RIGHT$;"FRAME COUNT=";PEEK($50000 + оффсет╞нум╞фрамес);", NEXT-FREE=$";  PRINT HEX$(PTR);  RETURN'----------------.STORE╞STATE╞INFO'----------------  IF STORE╞STATE = сторе╞старт╞пос THEN BEGIN    START╞CHAR = PEEK($40800 + X + Y * 80)    START╞COLOR = PEEK($FF80000 + X + Y * 80)    STARTX = X    STARTY = Y  BEND:ELSE BEGIN ' сторе╞енд╞пос    END╞CHAR = PEEK($40800 + X + Y * 80)    END╞COLOR = PEEK($FF80000 + X + Y * 80)    ENDX = X    ENDY = Y  BEND  RETURN'---------.INIT╞VARS'---------  CURRENT╞FRAME = 0  STORE╞STATE = сторе╞старт╞пос  X = 0  Y = 0  CURR╞FRAME = 0  RETURN  '---------------------.LOCATE╞NEXT╞FREE╞BYTE'---------------------  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  FRMIDX = 0  PTR = $50000 + оффсет╞фраме0  DO WHILE 1    IF FRMIDX = FRAME╞COUNT THEN BEGIN      BYTES╞USED = PTR-$50000      RETURN    BEND    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2    FRMIDX = FRMIDX + 1  LOOP  RETURN'---------------------.CHECK╞MAGIC╞SIGNATURE'---------------------  IF PEEK($ 5FFFE) <> 71 OR PEEK($5FFFF) <> 73 THEN BEGIN    WPOKE $5FFFE, $4947    PRINT "⌠";CLR╞LINE╞RIGHT$;    PRINT "MAGIC SIGNATURE APPLIED. RESET FRAME COUNT TO ZERO? (Y/N)";    GET KEY A$    IF A$ = "Y" THEN BEGIN      WPOKE $50000 + оффсет╞дата╞сизе, 0!      POKE $50000 + оффсет╞нум╞фрамес, 0    BEND    PRINT "⌠";CLR╞LINE╞RIGHT$;  BEND  RETURN'---------------.CHECK╞EDIT╞FLAG'---------------  IF PEEK($5FFFC) = 1 THEN BEGIN ' EDITING?    POKE $5FFFC, 0    CURR╞FRAME = PEEK($5FFFD)    GOSUB "GET╞CURR╞FRAME╞PTR    STARTX = PEEK(PTR + фрм╞оффсет╞ь)    STARTY = PEEK(PTR + фрм╞оффсет╞ы)    X = STARTX + PEEK(PTR + фрм╞оффсет╞в) - 1    Y = STARTY + PEEK(PTR + фрм╞оффсет╞х) - 1    NEW╞FRAME╞FLAG = 0    GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR    G#OSUB DRAW╞CURR╞FRAME  BEND  RETURN'--------------.YANK╞SELECTION'--------------  POKE $D020, PEEK($D020) + 1  ' SELECT A REGION WITH CURSOR MOVEMENT  GOSUB GET╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2  ' COPY IT INTO A BASIC VAR  PTR = POINTER(CLIPBOAR$D╞CHAR&(0))  LN = X2-X1+1  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, $40800+X1+Y*80, PTR    PTR = PTR + LN  NEXT Y  PTR = POINTER(CLIPBOARD╞CLR&(0))  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, $FF80000+X1+Y*80, PTR    PTR = PTR + LN  NEXT Y  CLIPW = %X2-X1+1  CLIPH = Y2-Y1+1  POKE $D020, PEEK($D020) - 1  RETURN'-----.PASTE'-----  ' COPY SELECTION FROM VARS ONTO SCREEN AT CURRENT CURSOR POSITION  X1 = X  Y1 = Y  X2 = X + CLIPW - 1  Y2 = Y + CLIPH - 1  PTR = POINTER(CLIPBOARD╞CHAR&(0))&  LN = X2-X1+1  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, PTR, $40800+X1+Y*80    PTR = PTR + LN  NEXT Y  PTR = POINTER(CLIPBOARD╞CLR&(0))  FOR Y = Y1 TO Y2    EDMA оп╞цопы, LN, PTR, $FF80000+X1+Y*80    PTR = PTR + LN  NEXT Y  ' тодо: RE-SAVE CURR'ENT FRAME  GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR  GOSUB GET╞CURR╞FRAME╞PTR  STARTX = PEEK(PTR + фрм╞оффсет╞ь)  STARTY = PEEK(PTR + фрм╞оффсет╞ы)  X = STARTX + PEEK(PTR + фрм╞оффсет╞в) - 1  Y = STARTY + PEEK(PTR + фрм╞оффсет╞х) - 1  NEW╞FRAME╞FLAG =  00  GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR  RETURN                                                                                                                                                                                                               ══════════════════════════════════════════════Аff════════════════════════════════════════════════════════════aff═══════════════════════════════════════════════════════════afffЭ═════════════════════════════════bbbb════════════════════АfffffБb══════════════bbbbbbbbbbЪББББББffffБББББbbbbbb═════════ЪfffffffБb══bb═══lbББffffffffffffffffffffffffffffffffБББbbbbББfffffffffffББffБББ~fffffffffffffffffffffffffffffffffffffffffffffff                                                                                                                                                     @@@@@@@@@@@@@@@@, CHR$(X);CHR$(Y);CHR$(FRMW);CHR$(FRMH);    FOR K=0 TO 15      PRINT #2, CHR$(PEEK(PTR + фрм╞оффсет╞хитбоьес + K));    NEXT K    SRC╞CHAR╞PTR = PTR + фрм╞оффсет╞дата    SRC╞CLR╞PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH        FOR K = 0 TO FRMW * FRMH - 1      CVAL = PEEK(SRC╞CLR╞PTR + K)      IF PEEK(SRC╞CHAR╞PTR + K) = 32 THEN BEGIN        CVAL = $FF      BEND      PRINT #2, CHR$(CVAL);    NEXT K    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT FRMIDX  DCLOSE #2  RETURN'------------------------.SAVE╞NEW╞FRAME╞TO╞MEMORY'------------------------  POKE $40800 + STARTX + STARTY * 80, START╞CHAR  POKE $FF80000 + STARTX + STARTY * 80, START╞COLOR  POKE $40800 + ENDX + ENDY * 80, END╞CHAR  POKE $FF80000 + ENDX + ENDY * 80, END╞COLOR  FRAME╞COUNT = PEEK($50000 + оффсет╞нум╞фрамес)  GOSUB LOCATE╞NEXT╞FREE╞BYTE  PTR = $50000 + BYTES╞USED  NEW╞FRAME╞FLAG = 1  GOSUB SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR  RETURN'---------------------------.SAVE╞FRAME╞TO╞MEMORY╞AT╞PTR'---------------------------  POKE PTR + фрм╞оффсет╞ь, STARTX  POKE PTR + фрм╞оффсет╞ы, STARTY  POKE PTR + фрм╞оффсет╞в, X - STARTX + 1  POKE PTR + фрм╞оффсет╞х, Y - STARTY + 1  IF NEW╞FRAME╞FLAG THEN BEGIN    LN = фрм╞оффсет╞дата - фрм╞оффсет╞хитбоьес	    EDMA оп╞филл, LN, 0, PTR + фрм╞оффсет╞хитбоьес  BEND  PTR = PTR + фрм╞оффсет╞дата  FOR YIDX = STARTY TO Y    FOR XIDX = STARTX TO X     POKE PTR, PEEK($40800 + XIDX + YIDX * 80)     PTR = PTR + 1    NEXT XIDX  NEXT YIDX  FOR YIDX = STARTY
 TO Y    FOR XIDX = STARTX TO X     POKE PTR, PEEK($FF80000 + XIDX + YIDX * 80)     PTR = PTR + 1    NEXT XIDX  NEXT YIDX  IF NEW╞FRAME╞FLAG THEN BEGIN    WPOKE $50000 + оффсет╞дата╞сизе, PTR - $50000    POKE $50000 + оффсет╞нум╞фрамес, FRAME╞COUNT + 1  BEND  CURSOR 0,49  PRINT CLR╞LINE╞RIGHT$;"FRAME COUNT=";PEEK($50000 + оффсет╞нум╞фрамес);  PRINT ", NEXT-FREE=$";HEX$(PTR);  CURSOR 0,0  NEW╞FRAME╞FLAG = 0  RETURN'----------.LOAD╞FRAME'----------  PRINT "";CLR╞LINE╞RIGHT$;  INPUT "FRAME#";CURR╞FRAME  GOSUB DRAW╞CURR╞FRAME  RETURN'------------.DELETE╞FRAME'------------  GOSUB GET╞END╞PTR  END╞PTR = PTR  ' DECREMENT FRAME COUNT  FRAME╞COUNT = FRAME╞COUNT - 1  POKE $50000 + оффсет╞нум╞фрамес, FRAME╞COUNT  GOSUB DELETE╞FRAME╞SIZE╞FROM╞TOTAL  IF CURR╞FRAME = FRAME╞COUNT THEN BEGIN    CURR╞FRAME = CURR╞FRAME - 1  BEND : ELSE BEGIN    GOSUB SHIFT╞REMAINING╞FRAMES╞ALONG  BEND  GOSUB DRAW╞CURR╞FRAME  RETURN'----------------------------.DELETE╞FRAME╞SIZE╞FROM╞TOTAL'----------------------------  GOSUB GET╞CURR╞FRAME╞PTR  CURR╞PTR = PTR  FRMW = PEEK(CURR╞PTR + фрм╞оффсет╞в)  FRMH = PEEK(CURR╞PTR + фрм╞оффсет╞х)  SZ = WPEEK($50000 + оффсет╞дата╞сизе)  SZ = SZ - (фрм╞оффсет╞дата + FRMW * FRMH * 2)  WPOKE $50000 + оффсет╞дата╞сизе, SZ  RETURN'----------------------------.SHIFT╞REMAINING╞FRAMES╞ALONG'----------------------------  GOSUB GET╞CURR╞FRAME╞PTR  CURR╞PTR = PTR  FRMW = PEEK(CURR╞PTR + фрм╞оффсет╞в)  FRMH = PEEK(CURR╞PTR + фрм╞оффсGIN    CURR╞FRAME = CURR╞FRAME + 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$=кеы╞ретурн THEN BEGIN    GOSUB GET╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2    GOSUB GET╞SELECTED╞OFFSET╞INTO╞K    POKE CURR╞PTR + K    , X1    POKE CURR╞PTR + K + 1, Y1    POKE CURR╞PTR + K + 2, X2    POKE CURR╞PTR + K + 3, Y2  BEND  RETURN'---------------------------------.GET╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2'---------------------------------  ' COORD1  X = X1 : Y = Y1  STORE╞STATE = сторе╞старт╞пос  GOSUB ENTER╞COORD  X1 = X  Y1 = Y  ' COORD2  STORE╞STATE = сторе╞енд╞пос  GOSUB ENTER╞COORD  X2 = X  Y2 = Y  POKE $40800 + STARTX + STARTY * 80, START╞CHAR  POKE $FF80000 + STARTX + STARTY * 80, START╞COLOR  POKE $40800 + ENDX + ENDY * 80, END╞CHAR  POKE $FF80000 + ENDX + ENDY * 80, END╞COLOR  RETURN'----------------------------------.PEEK╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2'----------------------------------  X1 = PEEK(CURR╞PTR + K)  Y1 = PEEK(CURR╞PTR + K + 1)  X2 = PEEK(CURR╞PTR + K + 2)  Y2 = PEEK(CURR╞PTR + K + 3)  RETURN'------------------.SHOW╞HITBOX╞COORDS'------------------  GOSUB PEEK╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2  PRINT X1;",";Y1;",";X2;",";Y2;  RETURN'--------.LOAD╞BIN'--------  INPUT "LOAD NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  BLOAD (FNAME$),P($50000)  ' GOSUB ONE╞OFF╞REPAIR  RETURN'--------------.ONE╞OFF╞REPAIR'--------------  ' INJECT SPACES WHERE NEEDED  SRC╞PTR = $42000  DEST╞PTR = $50000  FRAME╞COUNT = PEEK(SRC╞PTR)  POKE DEST╞PTR + оффсет╞нум╞фрамес, FRAME╞COUNT  SRC╞PTR = SRC╞PTR + 1  DEST╞PTR = DEST╞PTR + оффсет╞фраме0  SZ = оффсет╞фраме0  FOR K = 0 TO FRAME╞COUNT - 1    POKE DEST╞PTR + фрм╞оффсет╞ь, PEEK(SRC╞PTR)    SRC╞PTR = SRC╞PTR + 1    POKE DEST╞PTR + фрм╞оффсет╞ы, PEEK(SRC╞PTR)    SRC╞PTR = SRC╞PTR + 1    FRMW = PEEK(SRC╞PTR)    POKE DEST╞PTR + фрм╞оффсет╞в, FRMW    SRC╞PTR = SRC╞PTR + 1    FRMH = PEEK(SRC╞PTR)    POKE DEST╞PTR + фрм╞оффсет╞х, FRMH    SRC╞PTR = SRC╞PTR + 1    LN = фрм╞оффсет╞дата - фрм╞оффсет╞хитбоьес    EDMA оп╞филл, LN, 0, DEST╞PTR + фрм╞оффсет╞хитбоьес    LN = FRMW * FRMH * 2    EDMA оп╞цопы, LN, SRC╞PTR, DEST╞PTR + фрм╞оффсет╞дата    SRC╞PTR = SRC╞PTR + LN    DEST╞PTR = DEST╞PTR + фрм╞оффсет╞дата + LN    SZ = SZ + фрм╞оффсет╞дата + LN      NEXT K  DEST╞PTR = $50000  WPOKE DEST╞PTR + оффсет╞дата╞сизе, SZ  RETURN'--------.SAVE╞BIN'--------  INPUT "SAVE NAME: ";FNAME$  IF FNAME$ = "" THEN RETURN  PTR = $50000 + WPEEK($50000 + оффсет╞дата╞сизе)  DELETE (FNAME$)  BSAVE (FNAME$),P($50000) TO P(PTR)  RETURN'-------------------------------------.CALCULATE╞OPTIMISED╞DATA╞SIZE╞INTO╞SZ'-------------------------------------  SZ = WPEEK($50000 + оффсет╞дата╞сизе)  PTR = $50000 + оффсет╞фраме0  FOR K = 0 TO FRAME╞COUNT - 1    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    SZ = SZ - FRMW * FRMH    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2  NEXT K  RETURN'--------------.SAVE╞OPTIMISED'--------------  INPUT "SAVE NAME (OPTIMISED): ";FNAME$  IF FNAME$ = "" THEN RETURN  DELETE (FNAME$)  DOPEN #2,(FNAME$ + ",P"),W,U8  PRINT #2, CHR$(1);  PRINT #2, CHR$(2);  ' DUMMY ADDRESS  GOSUB CALCULATE╞OPTIMISED╞DATA╞SIZE╞INTO╞SZ    PRINT #2, CHR$(MOD(SZ, 256));  PRINT #2, CHR$(INT(SZ / 256));  PRINT #2, CHR$(FRAME╞COUNT);  PTR = $50000 + оффсет╞фраме0  FOR FRMIDX = 0 TO FRAME╞COUNT - 1    X = PEEK(PTR + фрм╞оффсет╞ь)    Y = PEEK(PTR + фрм╞оффсет╞ы)    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    PRINT #2   afffLb══                  lafffШ══~       bВ═Вo      Аffff|═Й      l═ОБwБШ═{  obЛfffffШЖ     l═~     |ГШ═══afffff|Ж     ЧЛ  .R   Шa═══~ffffffЖ     ═  / Cм  vЙЕ══fffffffА     ═  T  YG g═Е═ЙffffffffЭ    ═  H   t АЙЕ═uffffffffА    Шa  MoK  Чa══tfffffffffa   |═{     l═══ffffffffffА    |═b  bЬ═~ |afffffffffffe    |О═══О~   BfffffffffffG              KfffffffffffJRR           wIfffffffffffY          FRRFKfffffffffff.C    obbo     afffffffffffN   l══ОО═В{   fffffffffffЭ  l═Б    Ш═{  АffffffffffЧ══a═Л       Ш═   affffffffl═══АГ  /wwM  ═e  ШffffffffЧ═══ТЖ j  Pj  Еa  vtfffffflОО══ТГ j   j  Еa  vЖffffffЧ    v═  M  /  ═a  v═fffffб~     ═{  ww  l═   v═Эffff═      |═{    b═~   Ч══fffЧ═       |═ЦЬЬЦ═~   l═══{ff══Э        xЫЫx    l══l|afЧ═══Цo            oЬ═══lЧ═f!ООООООООООООООООООООООООООa                                                                                                                                                                     "                                                                                                                                                                #                                                                                                                                                                                  $                                                                                                                                                            %                                    ?                fffffffffffbbbbbbbbbbbbffffffffffffffffffbbbbbbbbfffffffffffffffffffffbБББ════════════БББББbbbffffflbbББ════════ББББb{fffffffffffffЪБ════════════════════════БББББ~═════════════════|ББb{ffffffffЪ═══&══════════════════════════════════════════════════|{fffffА════════════════════════════════════════════════════════|{ffffА═════════════════════════════════════════════════════════Аffffa══════════════════════════════════════════════════════════afffa══════'═══════════════════════════════════════════════════l~fffА═════════════════════════════════════════════════════════ЪffffА════════════════════════════════════════════════════════l~ffffa════════════════════════════════════════════════════════АffffЪ═════════ ════════════════════════════════════════════════afffА══════════════════════════════════════════════════════════affl~══════════════════════════════════════════════════════════affa═══════════════════════════════════════════════════════════Аffa═════════════ IF A$=" " THEN BEGIN    STORE╞STATE = STORE╞STATE + 1    IF STORE╞STATE = 2 THEN BEGIN      GOSUB SAVE╞NEW╞FRAME╞TO╞MEMORY      END    BEND  BEND  IF A$="L" THEN GOSUB LOAD╞FRAME  IF A$="X" THEN BEGIN    CURSOR 0,0    KEY ON    END  BEND  IF A$="E" THEN BEGIN    CURSOR 0,40    POKE $5FFFC, 1  ' EDIT FLAG ON    POKE $5FFFD, CURR╞FRAME    KEY ON    END  BEND  IF A$ = кеы╞ф1 THEN GOSUB LOAD╞BIN  IF A$ = кеы╞ф3 THEN GOSUB SAVE╞BIN  IF A$ = кеы╞ф5 THEN GOSUB SAVE╞OPTIMISED  IF A$ = кеы╞ф7 THEN GOSUB EDIT╞HIT╞BOXES  RETURN'--------------.EDIT╞HIT╞BOXES'--------------  HB╞MODE = хб╞моде╞бровсе  DO WHILE 1    GOSUB SHOW╞HITBOX╞TABLE    GOSUB DRAW╞HITBOXES    GOSUB хб╞GET╞USER╞INPUT    IF A$="X" OR A$=кеы╞есц OR A$=кеы╞ф7 THEN BEGIN      PRINT CHR$(147);      GOSUB DRAW╞CURR╞FRAME      EXIT    BEND  LOOP  RETURN#DEFINE цхар╞боь╞тл = 112#DEFINE цхар╞боь╞тр = 110#DEFINE цхар╞боь╞бл = 109#DEFINE цхар╞боь╞бр = 125#DEFINE цхар╞хорз   = 64#DEFINE цхар╞жерт   = 93#DEFINE цхар╞спаце  = 32'---------.DRAW╞CHAR'---------  IF PEEK($40800 + X + Y * 80) <> цхар╞спаце THEN BEGIN    K = K + 128  BEND:ELSE BEGIN    POKE $FF80000 + X + Y * 80, 1  BEND  POKE $40800 + X + Y * 80, K  RETURN'-------------.DRAW╞HITBOXES'-------------  GOSUB DRAW╞CURR╞FRAME  GOSUB GET╞CURR╞FRAME╞PTR  FOR IDX = 0 TO 3    X1 = PEEK(PTR + BX╞OFFS(IDX))    Y1 = PEEK(PTR + BX╞OFFS(IDX) + 1)    X2 = PEEK(PTR + BX╞OFFS(IDX) + 2)    Y2 = PEEK(PTR + BX╞OFFS(IDX) + 3)    IF NOT (X1=0 AND Y1=0 AND X2=0 AND Y2=0) THEN BEGIN      ' DRAW CORNERS      ' ------------      X = X1 : Y = Y1 : K = цхар╞боь╞тл : GOSUB DRAW╞CHAR      X = X2 : Y = Y1 : K = цхар╞боь╞тр : GOSUB DRAW╞CHAR      X = X1 : Y = Y2 : K = цхар╞боь╞бл : GOSUB DRAW╞CHAR      X = X2 : Y = Y2 : K = цхар╞боь╞бр : GOSUB DRAW╞CHAR      ' DRAW HORIZONTALS      ' ----------------      FOR X = X1+1 TO X2-1        Y = Y1 : K = цхар╞хорз : GOSUB DRAW╞CHAR        Y = Y2 : K = цхар╞хорз : GOSUB DRAW╞CHAR      NEXT X 	     ' DRAW VERTICALS      ' --------------      FOR Y = Y1+1 TO Y2-1        X = X1 : K = цхар╞жерт : GOSUB DRAW╞CHAR        X = X2 : K = цхар╞жерт : GOSUB DRAW╞CHAR      NEXT Y    BEND  NEXT IDX  RETURN'-----------------.SHOW╞HITBOX╞TABLE
'-----------------  GOSUB GET╞CURR╞FRAME╞PTR  CURR╞PTR = PTR  IF HB╞SEL = 0 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,40:PRINT кеы╞есц;"Q  HEAD: ";  K = фрм╞оффсет╞хб╞хеад:GOSUB SHOW╞HITBOX╞COORDS  IF HB╞SEL = 1 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,41:PRINT кеы╞есц;"Q TORSO: ";  K = фрм╞оффсет╞хб╞торсо:GOSUB SHOW╞HITBOX╞COORDS  IF HB╞SEL = 2 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,42:PRINT кеы╞есц;"Q  FEET: ";   K = фрм╞оффсет╞хб╞феет:GOSUB SHOW╞HITBOX╞COORDS  IF HB╞SEL = 3 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  CURSOR 40,43:PRINT кеы╞есц;"QATTACK: ";  K = фрм╞оффсет╞хб╞аттацк:GOSUB SHOW╞HITBOX╞COORDS  PRINT кеы╞реж╞офф;  GOSUB GET╞SELECTED╞COORDS  RETURN'--------------------------.GET╞SELECTED╞OFFSET╞INTO╞K'--------------------------  IF HB╞SEL = 0 THEN K = фрм╞оффсет╞хб╞хеад  IF HB╞SEL = 1 THEN K = фрм╞оффсет╞хб╞торсо  IF HB╞SEL = 2 THEN K = фрм╞оффсет╞хб╞феет  IF HB╞SEL = 3 THEN K = фрм╞оффсет╞хб╞аттацк  RETURN'-------------------.GET╞SELECTED╞COORDS'-------------------  GOSUB GET╞SELECTED╞OFFSET╞INTO╞K  GOSUB PEEK╞SELECTED╞COORDS╞INTO╞X1Y1X2Y2  RETURN  '-----------------.хб╞GET╞USER╞INPUT'-----------------  GET KEY A$  IF A$=кеы╞уп AND HB╞SEL > 0 THEN HB╞SEL = HB╞SEL - 1  IF A$=кеы╞довн AND HB╞SEL < 3 THEN HB╞SEL = HB╞SEL + 1  IF A$="-" AND CURR╞FRAME > 0 THEN BEGIN    CURR╞FRAME = CURR╞FRAME - 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$="=" AND CURR╞FRAME < PEEK($50002)-1 THEN BE  А
&                fffff RCR  ffffffffffffffffffff oCw///PDFofffffffffffffffflCE 'c.E '   wDFoffffffffffffАБОВbo           wDCRfffffffffa  wxБbb            wECRfffffА       ББbb            wMfffА           ББbbb       ttefffa               ББbb  BGMBfffa                   ББЧбGгfffА                     |═══~ffА         bЦ═══b       |══ffffa       ЧЛ~  |══       ═~ffffА      ЧЛ      ШЭ      ═fffffА     l═  lCC{ |═      uffffffa    АГ  K -Ъ{ Тt    АfffffffА    Аa g   GT Тu    afffffffА    АЭ |I  U  ═t   Аffffffff|{    ═{ |CC~ l═    Ъfffffffffa    |═     l═~    afffffffffА     |═booЬ═~    Аffffffffff|{     |О══О~     afffffffffffa               АffffffffffffB              bЛffffffffffffB           cxБ═~ffffffffffffUC    obb      |affffffffffffg    ══ОО═В CRR/IffffffffffffBccl═~    Ы═  .MJffffffffffffe  ═~      Аa  P IffffffffffА  АЛ  UEEI  ═   aJffffffffffa  Аa  e'Pv  ═e  А{MffffffffА   Аa v   v  ═e    Ifffffffa   АЭ  M  N  ═ `  |{JffffffА     ═{  ww  АЛ     Ш tfffffa     |═o    l═      |{BffffА       |═ВbbВ═~       Эvffffa         БООБ         ═{tffА                      Ч═ЭtffОООООООООООООООООООООООООО~f                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ff/DCCRoooffffffffffffffff'///U    wwEDDCRffffffff|ЛxББББbbbbb  :':MffffffffЭ          БББББbMfffffffА{               Шffffffffa               Аffffffff═                afffffff|a               АffffffffШВЦЦОБED        |{fffffff══Б              afffffffЛ    .RRo        АffffffА~   /,C  M       |{fffffЧ   //     M       fffffa  gj      g       Аffffl~  HH  ЧЭ   t       afffА   YH  ЧЛ   T       fffЧ   g|{ a    t       Аfff═    MJR|bR'N         afg═t    Docco/          АfА══{     EE             aОООООООООООООООООООООООО~                                                                                                                                                                                                                                                                                                                                                                               )&                fffffffffffffffffRECFofffffffffffffffffffRCECECo wEDШ{fffffffffffoCw   EC   obВ═fffffffffoCw        lb═════ffffffoCw        lbБ~   |═afffRDw        bbБ~       Тtffv T      lbБ~          АfffH tt/ lbББ             ЧfffBtбBbББ                 PRINT CHR$(27)+"QX=";STARTX;", Y=";STARTY;    PRINT ", W=";X-STARTX+1;", H=";Y-STARTY+1;  BEND  PRINT CLR╞LINE╞RIGHT$;  RETURN'-----------.ENTER╞COORD'-----------  DO WHILE 1    GOSUB STORE╞STATE╞INFO    GOSUB DRAW╞CURSOR    GET KEY A$    IF A$ <> кеы╞ретурн THEN GOSUB RESTORE╞CHAR╞UNDER╞CURSOR    IF A$ = кеы╞лефт AND X > 0 THEN X = X - 1    IF A$ = кеы╞ригхт AND X < 79 THEN X = X + 1    IF A$ = кеы╞уп AND Y > 0 THEN Y = Y - 1    IF A$ = кеы╞довн AND Y < 49 THEN Y = Y + 1    IF &A$=кеы╞ретурн THEN EXIT  LOOP  RETURN'--------------.GET╞USER╞INPUT'--------------  GETKEY A$  IF A$ <> " " THEN GOSUB RESTORE╞CHAR╞UNDER╞CURSOR  IF A$ = кеы╞лефт AND X > 0 THEN X = X - 1  IF A$ = кеы╞ригхт AND X < 79 THEN X = X + 1  IF A$ =!;д ▐ K = :A: О;е ▐ MENU╞SELECTION = :B: Щ;ф ▐ M = :C: <г ▐ C = :D: <х ▐  = :E: )<и ▐ M0% = :A%: :<й ▐ M1% = :B%: J<к ▐ X% = :C%: Z<л ▐ Y% = :D%: j<м ▐ W% = :E%: z<н ▐ H% = :F%: ▀<о ▐ X2% = :G%: °<п ▐ Y2% = :H%: ╜<я ▐ MX% = :I%: ╬<р ▐ MY% = :J%: о<с ▐ M"B% = :K%: Д<т ▐ MB╞OLD% = :L%: Ж<у ▐ RET% = :M%: =ж ▐ LAST╞COLOUR% = :N%: .=в ▐ SELECTED╞COLOUR% = :O%: O=ь ▐ OLD╞MENU╞SELECTION% = :P%: b=ы ▐ YMIN% = :Q%: u=з ▐ YMAX% = :R%: ┤=ш ▐ IDX% = :S%:  =э ▐ PIDX% = :T%: ╚=щ ▐ PX% = :U%: ╫=ч ▐ REV% = :V%: н=ъ ▐ #Y0% = :W%: ъ=Ю ▐ Y1% = :X%: П=А ▐ X0% = :Y%: >Б ▐ X1% = :Z%: >Ц ▐ TMP% = :AA%: %>Д ▐ I% = :AB%: 6>Е ▐ J% = :AC%: M>Ф ▐ SWAPPED% = :AD%: g>Г ▐ LOAD╞STATE% = :AE%: │>Х ▐ FILL╞STATE% = :AF%: ⌡>И ▐ LINE╞STATE% = :AG%: ╝>Й ▐ LX0% = :AH%: а>К ▐ LY0% = :AI%: $щ>Л ▐ CIRCLE╞STATE% = :AJ%: П>М ▐ CX0% = :AK%: ?Н ▐ CY0% = :AL%: ?О ▐ RADIUS% = :AM%: 6?П ▐ ELLIPSE╞STATE% = :AN%: I?Я ▐ EX0% = :AO%: \?Р ▐ EY0% = :AP%: s?С ▐ XRADIUS% = :AQ%: ┼?Т ▐ YRADIUS% = :AR%: ё?У ▐ BOX╞STATE% = :AS%: ╤?Ж ▐ BX0% = :AT%: и?В ▐ BY0%% = :AU%: Ц?Ь ▐ POLY╞STATE% = :AV%: Ш?Ы ▐ POLY╞IDX% = :AW%: @З ▐ POLY╞X% = :AX%: '@Ш ▐ POLY╞Y% = :AY%: ?@Э ▐ VEC╞DATA% = :AZ%: W@Щ ▐ VEC╞SIZE% = :BA%: k@Ч ▐ STOR% = :BB%: ┐@Ъ ▐ STOR╞CNT% = :BC%: ≥@ ▐ BTNS╞X% = :BD%: ╞@▐ BTNS╞Y% = :BE%: е@▐ BTNS╞W%  ╧= :BF%: ш@▐ BTNS╞H% = :BG%: Т@▐ BTNS╞TYPE% = :BH%: A▐ BTNS╞STATE% = :BI%: A▐  = :BJ%: /A▐ KEY$ = :A$: ?A▐ A$ = :B$: WA	▐ BTNS╞TEXT$ = :C$: eA
▐  = :D$: sA▐  = :A&:                                                                         ' кеы╞уп AND Y > 0 THEN Y = Y - 1  IF A$ = кеы╞довн AND Y < 49 THEN Y = Y + 1  IF A$ = "D" THEN GOSUB DELETE╞FRAME  IF A$ = "Y" THEN GOSUB YANK╞SELECTION  IF A$ = "P" THEN GOSUB PASTE  IF A$ = "C" THEN BEGIN    PRINT "⌠";    CURR╞FRAME = 0    GOS UB DRAW╞CURR╞FRAME  BEND  IF A$="-" AND CURR╞FRAME > 0 THEN BEGIN    CURR╞FRAME = CURR╞FRAME - 1    GOSUB DRAW╞CURR╞FRAME  BEND  IF A$="=" AND CURR╞FRAME < PEEK($50002)-1 THEN BEGIN    CURR╞FRAME = CURR╞FRAME + 1    GOSUB DRAW╞CURR╞FRAME  BEND >":уЧ ╧Q~≥г(9);G$(V(AN)):Ч юQЧ жQ─▀AX╡.╞U(AN)╡╚1╖Ч НQ│AX╡1:≥г(9);V(AN):Ч ШQ┌▀AX╡.╖Ч R┐≥г(9);V(AN):Ч R└≥"▓"; (R┘AN╡AN╙1:Л:▌ FR├▀AG╡AN╞AC╡AD╖≥"";:у≥"▓"; LR┤▌ dR┬█ 210:▀O$╡"A"╖█ 443 vR┴▀O$╡"I"╖█ 442 ┬R┼▀O$╡"D"╖█ 426 ║R▀▀O$╡"▒"╞AG╠.╖AG╡AG╚1 ╫R▄▀O$╡""╞AGЁAF╚1╖AG╡AG╙1 лR█▀O$╡"²"╖Ч ыR▌▀AC╡1╖Ч БR▐AC╡. МR░Ч:уЧ  S▒▀(AG╚43)╠╡.╖Ч S▓AC╡1:AG╡AG╚43:Ч S⌠Ч #S■Ч 2S∙▀O$╡""╖Ч ?S√▀AC╡.╖Ч HS≈AC╡1 SS≤Ч:уЧ fS≥▀(AG╙43)ЁAF╖Ч {S AC╡.:AG╡AG╙43:Ч ┌S⌡Ч ┴S°Ч ⌡S²▀O$╡г(141)╖Ч ╫S·AY╡.:AZ╡1:Z╡.:Ч:█ 52:ЧA%:Ч лS÷▀O$╡" "╖Ч ОS═AY╡AG:AZ╡1:Z╡.:Ч:█ 52:ЧA%:Ч T║▀O$╡г(13)╖█ 431 T╒▀O$╡"C"╖█ 440 )Tё▀O$╡г(27)╖█ 425 :T╓▀O$╡""╖AG╡. NT╔▀O$╡"⌠"╖AG╡AF╚1 mT╕▀(╣(AG╜43)╛43)ЁAE╖AE╡AE╚43 ▒T╖▀(╣(AG╜43)╛43)╠(AE╙43)╖AE╡AE╙43 ≈T╗▌ ╩T╘AY╡╚1:AZ╡.:Ч:█ 52:ЧA%:█ 261:▌ гT╙▀AF╡.╖▌ U╚AN╡AG:КЩANЁAF╚1:U(AN)╡U(AN╙1):V(AN)╡V(AN╙1):AN╡AN╙1:Л:AF╡AF╚1:▀AG╡AF╞AG╠.╖AG╡AG╚1 #U╛▌ /U╜▀AF╡.╖▌ ╓U╝≥"";г(9);г(9);г(27);"Q";:AL╡.:┘"CHUNK#: ",AL:U(AG)╡AL:≥"";г(9);г(9);г(27);"Q";:AL╡╚1:┘"EXTRA#: ",AL:V(AG)╡AL:▌ ╟U╞▀AF╡.╖▌ нU╟≥"";г(9);г(9);г(27);"Q"; шU╠▀AC╡.╖Ч 	V╡AL╡U(AG):H$╡д(AL):▀х(H$,1)╡" "╖H$╡й(H$,2) DVЁ≥"CHUNK#: ";г(27);"^";H$;г(27);"_";:┘"",AL:U(AG)╡AL:Ч QV╢▀AC╡1╖Ч V╣AL╡V(AG):H$╡д(AL):▀х(H$,1)╡" "╖H$╡й(H$,2) ╨V╤≥"EXTRA#: ";г(27);"^";H$;г(27);"_";:┘"",AL:V(AG)╡AL:Ч юV╥▌ W╦AL╡╚U(AG):≥"⌠";:│AH╡1╓11╚1:≥AH;":";N$(AH):┌AH:≥:┘"CMD: ",AL:▀AL╠.╖U(AG)╡╚AL W╧▌ kW╨AF╡AF╙1:AN╡AF╚2:КЩAN╠╡AG:U(AN╙1)╡U(AN):V(AN╙1)╡V(AN):AN╡AN╚1:Л:U(AG)╡.:V(AG)╡.:▌ ▐W╩AG╡AF:AF╡AF╙1:U(AG)╡.:V(AG)╡.:▌ ╔W╪▐ CHUNK╞IDX = :A: ╩W╫▐ CHUNK╞CNT = :B: лW╬▐ VIDX = :C: эW©▐ IDX = :D: ЯWю▐ CURSOR╞X = :E: Xа▐ CURSOR╞Y = :F: Xб▐ ENVS╞ATTACK = :G: 5Xц▐ ENVS╞DECAY = :H: NXд▐ ENVS╞SUSTAIN = :I: gXе▐ ENVS╞RELEASE = :J: │Xф▐ ENVS╞WAVEFORM = :K: ∙Xг▐ ENVS╞PW = :L: ╚Xх▐ FILT╞FREQ = :M: ©Xи▐ FILT╞LP = :N: сXй▐ FILT╞BP = :O: ГXк▐ FILT╞HP = :P: ЭXл▐ FILT╞RES = :Q: Yм▐ FILT╞DIR = :R: &Yн▐ FILT╞MIN = :S: =Yо▐ FILT╞SWEEP = :T: SYп▐ SEQ╞CHUNK = :U: iYя▐ SEQ╞EXTRA = :V: |Yр▐ ECHO╞M = :W: ▐Yс▐ ECHO╞B = 	:X: ёYт▐ ECHO╞SZ = :Y: ╧Yу▐ CHUNK╞RPT = :Z: яYж▐ ECHO╞DELAY = :AA: БYв▐ TMP = :AB: УYь▐ SSCOL = :AC: Zы▐ S = :AD: Zз▐ SEQ╞OFFS = :AE: .Zш▐ SEQCNT = :AF: BZэ▐ SEQPTR = :AG: SZщ▐ ROW = :AH: dZч▐ COL = :AI: vZъ▐ SROW = :AJ: ┬ZЮ▐ SCOL = :AK: ≈
ZА▐ V = :AL: ╘ZБ▐ MAXV = :AM: ╦ZЦ▐ K = :AN: кZД▐ DELTA = :AO: ЮZЕ▐ FPRESET = :AP: СZФ▐ FSCOL = :AQ: [Г▐ FSROW = :AR: [Х▐ FFOCUS = :AS: ,[И▐ FSEL = :AT: =[Й▐ OCT = :AU: T[К▐ CURR╞FREQ = :AV: j[Л▐ CURR╞DIR = :AW: [М▐ HANDLED = :AX: ⌠[Н▐ PLYPTR = :AY: ╗[О▐ PLYFLAG = :AZ: ╨[П▐ SDUR = :BA: о[Я▐ ALT╞KEY = :BB: Б[Р▐ LIMIT = :BC: Я[С▐ Y = :BD: Ъ[Т▐  = :BE: \У▐ TMPO% = :A%: )\Ж▐ ESC╞FLAG% = :B%: ;\В▐ RET% = :C%: I\Ь▐  = :D%: Y\Ы▐ V$ = :A$: k\З▐ KEY$ = :B$: \Ш▐ VALID$ = :C$: ▒\Э▐ VAL$ = :D$: ╘\Щ▐ ENVS╞NAME$ = :E$: ю\Ч▐ DIR╞NAME$ = :F$: ь\Ъ▐ FILT╞NAME$ = :G$: И\ ▐ V1$ = :H$: З\▐ V2$ = :I$: ]▐ V3$ = :J$: ]▐ V4$ = :K$: -]▐ V5$ = :L$: >]▐ V6$ = :M$: X]▐ SEQ╞CMDNAME$ = :N$: h]▐ A$ = :O$: x]▐ V$ = :P$: ▌]	▐ KEYS╞ ╪IN$ = :Q$: ╔]
▐ KEYS╞OUT$ = :R$: ╦]▐ PSTR$ = :S$: л]▐ WNAME$ = :T$: Й]▐ FILT╞STATE╞NAME$ = :U$: Э]▐ DUR$ = :V$: ^▐ CLIP$ = :W$:  ^▐ CP$ = :X$: .^▐  = :Y$: <^▐  = :A&:                                                                      ▌ v)( BB%(.)╡3╙64╛BI%(5):BB%(1)╡AT%╞255:BB%(2)╡AT%ЧS8:BB%(3)╡AU%╞255:BB%(4)╡AU%ЧS8:BB%(5)╡I%╞255:BB%(6)╡I%ЧS8:BB%(7)╡J%╞255:BB%(8)╡J%ЧS8 ┤)) BC%╡8:█ 22:▌ ∙)* ▀AS%╡.╖Ч ╡)+ █ 19:AT%╡I%:AU%╡J%:AS%╡1 Х), Ч:у▀AS%╡1╖Ч:АAT%,AU%,I%,J%,BI%(5):█ 40:AS%╡.:Ч Н)- ▌ )*. Q%╡AY%(.):R%╡AY%(.):│S%╡.╓AW%╚1:▀AY%(S%)ЁQ%╖Q%╡AY%(S%) D*/ ▀AY%(S%)╠R%╖R%╡AY%(S%) N*0 ┌S%:▌ ■*1 M%╡.:V%╡.:W%╡AY%(S%╚1):X%╡AY%(S%):▀W%╠X%╖AA%╡W%:W%╡X%:X%╡AA%:V%╡1 ╚*2 ▀W%Ё╡D%╞D%ЁX%╖M%╡1 ╠*3 ▌ б*4 █ 49:▀M%╡.╖▌ Ь*5 Y%╡AX%(S%╚1):Z%╡AX%(S%):▀V%╡1╖AA%╡Y%:Y%╡Z%:Z%╡AA% +6 ▀Y%╡Z%╖C%╡Y%:M%╡1:▌ C+7 C╡(X%╚W%)╜(Z%╚Y%):D╡W%╚C╛Y%:C%╡(D%╚D)╜C:M%╡1:▌ ⌠+8 T%╡.:AX%(AW%)╡AX%(.):AY%(AW%)╡AY%(.):│S%╡1╓AW%:█ 52:▀M%╡1╖U%(T%)╡C%:T%╡T%╙1 ²+9 ┌S%:▌ ц+: │AB%╡.╓T%╚2:AD%╡.:│AC%╡.╓T%╚AB%╚2 щ+; ▀U%(AC%)╠U%(AC%╙1)╖Ч ,< AA%╡U%(AC%):U%(AC%)╡U%(AC%╙1):U%(AC%╙1)╡AA%:AD%╡1:Ч -,= ┌AC%:▀AD%╡.╖AB%╡T% 8,> ┌AB%:▌ p,? █ 56:█ 58:│S%╡.╓T%╚1╘2:ЕU%(S%),D%,U%(S%╙1),D%:┌S%:▌ ▌,@ █ 46:│D%╡Q%╓R%:█ 63:┌D%:▌ "-A BB%(.)╡4╙64╛BI%(5):BB%(1)╡AW%:BC%╡1:│A╡.╓AW%╚1:I%╡AX%(A):J%╡AY%(A):BC%╡BC%╙1:BB%(BC%)╡I%╞255:BC%╡BC%╙1:BB%(BC%)╡I%ЧS8:BC%╡BC%╙1:BB%(BC%)╡J%╞255 I-B BC%╡BC%╙1:BB%(BC%)╡J%ЧS8:┌A:█ 22:▌ W-C ▀AV%╡.╖Ч o-D █ 19:AV%╡1:AW%╡.:Ч }-E ▀AW%╠.╖Ч ║-F ▀AX%(AW%╚1)╡I%╞AY%(AW%╚1)╡J%╖Ч т-G ЕI%,J%,AX%(.),AY%(.):█ 65:AV%╡.:▀BI%(5)╡1╖█ 64 з-H ▌ А-I Ч Х-J Ч .K AX%(AW%)╡I%:AY%(AW%)╡J% .L ▀AW%╡.╖Ч .M ЧLI%,J% I.N Ч:уЧ:ЕAX%(AW%╚1),AY%(AW%╚1),I%,J%:Ч Y.O AW%╡AW%╙1:▌ z.P ▀BI%(5)╡.╖BI%(5)╡1:уBI%(5)╡. ─.Q ▌ ю.R Ч<3:Ч #2,"@TEST.V",W,U8:│A╡.╓BA%╚1:≤2,г(AZ%(A));:┌A:Ч#2:▌ я.S Ч<2:AE%╡╚4:▌ Г.T M%╡.:▀AЁ╠ф("V")╖▌ /U ║#2,A:≥A;:▀AЁ╠ф("E")╖▌ /V ║#2,A:≥A;:▀AЁ╠ф("C")╖▌ 5/W M%╡1:BA%╡3:AE%╡╚1:▌ l/X AE%╡╚4:Ч #2,"TEST.V",R,U8:К:║#2,A:≥"RD=";A;:▀ST╖М {/Y ▀AE%╡╚4╖Ч ⌠/Z ≥"CHECK╞VEC ";:█ 84 ╚/[ ▀M%╡.╖█ 83:М:у┴ 123 ╡/\ Ч а/] ▀AE%╡╚1╖Ч Ш/^ ≥"NEW╞CMD ";:AF%╡(A╞64)╜64:BI%(5)╡AF%:A╡A╞63:AE%╡A:Ч 
0_ ▀AE%╡63╖Ч f0` ≥"COLOUR ";:║#2,A:≥A;:Ч3.,A:AZ%(BA%)╡63:BA%╡BA%╙1:AZ%(BA%)╡A:BA%╡BA%╙1:N%╡A:O%╡A:AE%╡╚1 s0a ┴ 123:Ч │0b ▀AE%╡0╖Ч Ж0c ≥"LINE ";:║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AH%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; o1d AI%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:I%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; °1e J%╡A%╙(B%ЧR8):ЕAH%,AI%,I%,J%:█ 23:AE%╡╚1 ╘1f ┴ 123:Ч ╥1g ▀AE%╡1╖Ч .2h ≥"CIRCLE ";:║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AK%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; °2i AL%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AM%╡A%╙(B%ЧR8):БAK%,AL%,AM%,BI%(5):█ 29:AE%╡╚1 ╘2j ┴ 123:Ч ╥2k ▀AE%╡2╖Ч /3l ≥"ELLIPSE ";:║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AO%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; ╘3m AP%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AQ%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; А3n AR%╡A%╙(B%ЧR8):Ч0AO%,AP%,AQ%,AR%,BI%(5):█ 34:AE%╡╚1 Н3o ┴ 123:Ч Э3p ▀AE%╡3╖Ч p4q ≥"BOX ";:║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AT%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; И4r AU%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:I%╡A%╙(B%ЧR8):║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%; 5s J%╡A%╙(B%ЧR8):АAT%,AU%,I%,J%,BI%(5):█ 40:AE%╡╚1 *5t ┴ 123:Ч 85u ▀AE%╡4╖Ч ё5v ≥"POLY ";:║#2,A:A╡A╞255:AW%╡A:│A╡.╓AW%╚1:║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AX%(A)╡A%╙(B%ЧR8) 6w ║#2,A%:A%╡A%╞255:≥A%;:║#2,B%:B%╡B%╞255:≥B%;:AY%(A)╡A%╙(B%ЧR8):▀(A╠.)╖ЕAX%(A╚1),AY%(A╚1),AX%(A),AY%(A) H6x ┌A:ЕAX%(AW%╚1),AY%(AW%╚1),AX%(.),AY%(.):▀BI%(5)╡1╖█ 64 X6y █ 65:AE%╡╚1 e6z ┴ 123:Ч r6{ Л:Ч#2:▌ ё6| AE%╡╚4:AF%╡.:AG%╡.:AJ%╡.:AN%╡.:AS%╡.:AV%╡.:▌ ╠6} ▀B╡0╖█ 25 ©6~ ▀B╡1╖█ 30 м6 ▀B╡2╖█ 36 ш6─ ▀B╡3╖█ 42 И6│ ▀B╡4╖█ 67 О6┌ ▌ Ъ6┐ Ч.,I%,J%:▌ 7└ ▀B$╡г(144)╖O%╡. %7┘ ▀B$╡г(5)╖O%╡1 87├ ▀B$╡г(28)╖O%╡2 L7┤ ▀B$╡г(159)╖O%╡3 `7┬ ▀B$╡г(156)╖O%╡4 s7┴ ▀B$╡г(30)╖O%╡5 ├7┼ ▀B$╡г(31)╖O%╡6  7▀ ▀B$╡г(158)╖O%╡7 ╝7▄ ▀B$╡г(129)╖O%╡8 б7█ ▀B$╡г(149)╖O%╡9 в7▌ ▀B$╡г(150)╖O%╡10 Л7▐ ▀B$╡г(151)╖O%╡11 8░ ▀B$╡г(152)╖O%╡12 8▒ ▀B$╡г(153)╖O%╡13 +8▓ ▀B$╡г(154)╖O%╡14 @8⌠ ▀B$╡г(155)╖O%╡15 ┐8■ Ч3.,O%:Ч.,1,O%:I%╡н(.,.):J%╡н(.,1):▀B$╡г(157)╖I%╡I%╚1:█ 131 ÷8∙ ▀B$╡г(29)╖I%╡I%╙1:█ 131 ╪8√ ▀B$╡г(145)╖J%╡J%╚1:█ 131 ь8≈ ▀B$╡г(17)╖J%╡J%╙1:█ 131 Р8≤ ▀B$╡г(13)╖█ 154:█ 125 Ь8≥ ▌ #9  Ч?I%,J%,K%:I%╡(I%╚24)╛2:J%╡(J%╚50)╛2:▌ 59⌡ ║B$:▀B$╡"X"╖▌ E9° █ 132:█ 154 Y9² ▀K%╡128╞L%╡.╖Ч j9· L%╡128:█ 165 w9÷ ▀M%╡1╖Ч ▄9═ █ 124:▀B╡8╖Ч.═:─ ═9║ Ч:уЧ:█ 125:Ч ╖9╒ Ч ╫9ё ▀L%╡128╞K%╡.╖L%╡. г9╓ ┴ 155 :╔ M%╡.:│A╡.╓9╚1:C%╡BD%(A)╛8:D%╡BE%(A)╛8:E%╡BF%(A)╛8:F%╡BG%(A)╛8:G%╡C%╙E%:H%╡D%╙F% ?:╕ ▀C%Ё╡I%╞I%Ё╡G%╞D%Ё╡J%╞J%Ё╡H%╖Ч L:╖ P%╡B:B╡A X:╗ ▀B╡5╖Ч f:╘ █ 80:B╡P% {:╙ Ч:у▀B╡6╖Ч:█ 82 ⌠:╚ Ч:у▀B╡7╖Ч:█ 88:Ч ╙:╛ M%╡1:█ 11:A╡9╚1:Ч Ё:╜ ┌A:▌ б:╝ Ч.═:Ч>Ч$:▌ о:╞ ┐25 5,0,0 э:╟ ┐254,0,0 И:╠ ┐252,0,0 Ж:╡ ┐248,0,0 ;Ё ┐252,0,0 ;╢ ┐238,0,0 ;╣ ┐199,0,0 ,;╤ ┐131,128,0 9;╥ ┐1,192,0 F;╦ ┐0,224,0 S;╧ ┐0,112,0 _;╨ ┐0,56,0 k;╩ ┐0,28,0 w;╪ ┐0,14,0 ┌;╫ ┐0,7,0 ▐;╬ ┐0,3,128  ;© ┐0,1,0 ╔;ю ┐0,0,0 ╟;а ┐0,0,0 ╩;б ┐0,0,0 ф;ц ┐0,0,0 т!L╠2047╖AL╡2047 иI*▀ALЁ.╖AL╡. ыI+S(AR)╡AL:Ч ФI,▀AQ╡8╖Ч J-AL╡е(A$):▀AL╠2047╖AL╡2047 J.▀ALЁ.╖AL╡. #J/T(AR)╡AL:Ч *J0Ч FJ1S$╡"X0":▀ATЁ╠╚1╖S$╡"X1" ┼J2S$╡S$╙V$(BA,1):S$╡S$╙"O"╙д(AU):│AN╡.╓11:▀O$╡Q$(AN)╖S$╡S$╙R$(AN) ▓J3┌AN ╒J4▀ц(S$)╠.╖Ч ╦J5Ч""T"╙д(AJ)╙S$:Ч ╬J6▌ ыJ7█ 168:AM╡15:▀AK╡5╖AM╡4 КJ8▀AK╡6╖AM╡4095 K9AL╡AL╙AO:▀AL╠AM╖AL╡AM K:█ 351:▌ /K;█ 168:AL╡AL╚AO:▀ALЁ.╖AL╡. ;K<█ 351:▌ HK=▀AQ╡1╖Ч iK>AL╡M(AR)╙AO:▀AL╠2047╖AL╡2047 yK?M(AR)╡AL:Ч ▀K@▀AQ╡2╖N(AR)╡1 ²KA▀AQ╡3╖O(AR)╡1 ╞KB▀AQ╡4╖#P(AR)╡1 ╪KC▀AQ╡5╖Ч ыKDAL╡Q(AR)╙AO:▀AL╠15╖AL╡15 ИKEQ(AR)╡AL:Ч 	LF▀AQ╡6╞R(AR)Ё3╖R(AR)╡R(AR)╙1 !LG▀AQ╡7╞S(AR)Ё2047╖Ч BLHAL╡S(AR)╙AO:▀AL╠2047╖AL╡2047 RLIS(AR)╡AL:Ч jLJ▀AQ╡8╞T(AR)Ё2047╖Ч ▀LKAL╡T(AR)╙AO:▀AL╠2047╖AL╡2047 ⌡LLT(AR)╡AL:Ч ╖LM█ 261:$▌ ╢LN▀AQ╡1╖Ч оLOAL╡M(AR)╚AO:▀ALЁ.╖AL╡. ъLPM(AR)╡AL:Ч ЯLQ▀AQ╡2╖N(AR)╡. MR▀AQ╡3╖O(AR)╡. MS▀AQ╡4╖P(AR)╡. "MT▀AQ╡5╖Ч =MUAL╡Q(AR)╚AO:▀ALЁ.╖AL╡. MMVQ(AR)╡AL:Ч mMW▀AQ╡6╞R(AR)╠.╖R(AR)╡R(AR)╚1 ┌MX▀AQ╡7╞S(AR)╠.╖Ч ²MYAL╡S(AR)╚AO:▀ALЁ.╖AL╡. ╜MZS(%AR)╡AL:Ч бM[▀AQ╡8╞T(AR)╠.╖Ч щM\AL╡T(AR)╚AO:▀ALЁ.╖AL╡. МM]T(AR)╡AL:Ч ЫM^█ 261:▌ N_▀AK╡.╖E$(AJ)╡A$  N`▀AK╡1╖G(AJ)╡AL 3Na▀AK╡2╖H(AJ)╡AL FNb▀AK╡3╖I(AJ)╡AL YNc▀AK╡4╖J(AJ)╡AL lNd▀AK╡5╖K(AJ)╡AL Ne▀AK╡6╖L(AJ)╡AL ▒NfAH╡AJ:█ 359:▌ юNgЧ
AH,G(AH),H&(AH),I(AH),J(AH),K(AH),L(AH):▌ мNh▀ER╡30╖ж ВNiв:≥с(ER);" ERROR":≥" IN LINE";EL:Ы▒:─ OjКЩ1:█ 364:█ 392:▀O$╡"╚"╖М OkЛ:▌ ∙Ol≥"⌠SEQUENCE EDITOR":≥"---------------":≥"а)DD и)NSERT д)ELETE, еDIT=ртн, пLAYаLL=схфт+ртн, пLAY=спц - SEQCNT = ";AF ЫOm≥"ц: E'DIT цмд, есц: STOP MUSIC, мега+я: EXIT":≥" цMD            еXTRA":≥" ---            -----" *Pn▀╣((AF╚1)╜43)╠1╞(╣(AE╜43)╙1)Ё╣((AF╚1)╜43)╖Ч @PoЧA75,5:≥"--->":Ч MPp▀AE╠.╖Ч cPqЧA70,5:≥"<---":Ч uPrAN╡AE:КЩANЁAF ∙Ps▀AN╠(AE╙43╛2╚1)╖AN╡AF:┴ 389 ╦Pt▀(AN ╚AE)╠╡43╖ЧA40,6╙(AN╚AE╚43) пPu▀AY╡AN╖≥">";:у≥" "; ъPvAD╡.:█ 390 ШPw▀U(AN)Ё.╞╤(U(AN))Ё11╖Ч 8QxA$╡N$(╤(U(AN))):AD╡10╚ц(A$):≥A$;:КЩAD╠╡.:≥" ";:AD╡AD╚1:Л SQyЧ:уЧ:≥U(AN);г(9);:Ч gQzAD╡1:█ 390:AX╡. xQ{▀U(AN)╡╚2╖Ч │Q|AX╡1 ╒Q}▀V(AN)╡╚1╖≥г(9);"<NONE":V$(3,0)╡"EIGHTH" O* V$(3,1)╡"I":V$(3,2)╡"4":V$(4,0)╡"SIXTEENTH":V$(4,1)╡"S":V$(4,2)╡"5":├ X$(6): |* ≥"⌠";г(14);г(27);"5";:Ч:Ч"":Ч;.:Ч<.:Г5 ▌* ЫЧ$:█ 22:█ 70 ≈* ┴ 20 '+ ЧA.,.:≥"⌠PLAYMAKER V0.5 - BY GURCE ISIKYILDIZ":≥"---------":≥"<: PREV CHUNK, >: NEXT CHUNK, -/+ TEMPO, ф7=ENV EDITOR, ф9/цтрл-п=SEQ EDITOR" |+ ≥"ртн: PLAY CURR VOICE, схфт+ртн: PLAY ALL VOICE, ф1=LOAD, ф3=SAVE, мега+я=QUIT" з+ ≥"алт-ь/ц/ж: ROW CUT/COPY/PASTE, есц-есц: STOP MUSIC, алт-ртн: PLAY FROM CURSOR":≥:█ 25:▌ , ≥"TEMPO: ";A%:≥"CHUNK╞IDX: ";A:│C╡.╓5 , ▀FЁ╠C╖Ч @, ЧA.,9╙C╛2:≥г(27);"Q";"V";C╙1;": ";A$(C,A); ~, Ч:уЧ:ЧA.,9╙C╛2:≥г(27);"Q";"V";C╙1;": ";:│D╡1╓ц(A$(C,A)) ▄, ▀E╡D╚1╖Ч ╘, ≥"";й(A$(C,A),D,1);"▓"; х, Ч:уЧ:≥й(A$(C,A),D,1);:Ч Р,  ┌D:▀ц(A$(C,A))╡.╟E╡ц(A$(C,A))╖≥" ▓"; Ы,! Ч -" ┌C:▌ -# │D╡1╓ц(C$):D$╡й(C$,D,1) ,-$ ▀B$╡D$╖Ч A-% ▀EЁц(A$(F,A))╖Ч t-& A$(F,A)╡х(A$(F,A),E)╙D$╙й(A$(F,A),E╙1):E╡E╙1:▌ {-' Ч  -( A$(F,A)╡A$(F,A)╙D$:E╡E╙1:▌ ║-) Ч ╙-* ┌D:▌ ╬-+ ▀E╡ц(A$(F,A))╖▌ П-, КЩй(A$(F,A),E╙1,1)Ё╠" ":E╡E╙1:▀E╡ц(A$(F,A))╖▌ #.- Л:КЩй(A$(F,A),E╙1,1)╡" ":E╡E╙1:▀E╡ц(A$(F,A))╖▌ +.. Л:▌ 6./ ▀E╡.╖▌ E.0 ▀E╡1╖E╡.:▌ s.1 E╡E╚1:КЩй(A$(F,A),E╙1,1)╡" ":E╡E╚1:▀E╡.╖▌ ·.2 Л:КЩй(A$(F,A),E╙1,1)Ё╠" ":E╡E╚1:▀E╡.╖▌ ╛.3 Л:E╡E╙1:▌ д.4 │AH╡.╓9:█ 359:┌AH:▌ Ц.5 ┘"LOAD NAME: ";B$:▀B$╡""╖▌ O/6 Ч#2,(B$),R,U8:└2,B:│A╡.╓B╚1:│C╡.╓5:└2,A$(C,A):┌C:┌A:└2,A%:│AH╡.╓9:└2,E$(AH):└2,G(AH):└2,H(AH):└2,I(AH) ╠/7 └2,J(AH):└2,K(AH):└2,L(AH):█ 359:┌AH:≥:│AH╡.╓10:└2,G$(AH):└2,M(AH):└2,N(AH):└2,O(AH):└2,P(AH) 08 └2,Q(AH):└2,R(AH):└2,S(AH):└2,T(AH):┌AH:AF╡.:└2,AF:AH╡.:КЩAHЁAF:└2,U(AH):└2,V(AH):AH╡AH╙1:Л:Ч#2:A╡.  09 ▌ 10: B╡.:│AN╡.╓50 ┤0; ▀A$(.,AN)Ё╠""╟A$(1,AN)Ё╠""╟A$(2,AN)Ё╠""╟A$(3,AN)Ё╠""╟A$(4,AN)Ё╠""╟A$(5,AN)Ё╠""╖Ч ∙0< B╡AN╙1:Ч ÷0= ┌AN:▌ ╬0> ┘"SAVE NAME: ";B$:▀B$╡""╖▌ 1? В(B$):Ч#2,(B$),W,U8:AB╡A:█ 58:≤2,B:│A╡.╓B╚1:│C╡.╓5:≤2,A$(C,A):┌C:┌A:≤2,A%:│AH╡.╓9:≤2,E$(AH) ┌1@ ≤2,G(AH):≤2,H(AH):≤2,I(AH):≤2,J(AH):≤2,K(AH):≤2,L(AH):┌AH:│AH╡.╓10:≤2,G$(AH):≤2,M(AH):≤2,N(AH) М1A ≤2,O(AH):≤2,P(AH):≤2,Q(AH):≤2,R(AH):≤2,S(AH):≤2,T(AH):┌AH:≤2,AF:AH╡.:КЩAHЁAF:≤2,U(AH)	:≤2,V(AH):AH╡AH╙1 Ъ1B Л:Ч#2:A╡AB:▌ (2C ┘"SAVE (AS TEXT) NAME: ";B$:▀B$╡""╖▌ ▓2D В(B$):Ч#2,(B$),W,U8:│A╡.╓50:│C╡.╓5:≤2,"V";г(49╙C);"$(";д(A);")=";:≤2,г(34);A$(C,A);г(34):┌C:≤2,"":┌A ║2E Ч#2:A╡.:▌ ╥2F █ 210:B$╡O$:█ 108 й2G ▀B$╡""╞FЁ5╖Ч Р2H F╡F╙1:▀E╠ц(
A$(F,A))╖E╡ц(A$(F,A)):Ч 3I ▀B$╡"▒"╞F╠.╖Ч -3J F╡F╚1:▀E╠ц(A$(F,A))╖E╡ц(A$(F,A)):Ч I3K ▀B$╡""╞EЁц(A$(F,A))╖Ч V3L E╡E╙1:Ч l3M ▀B$╡"²"╞E╠.╖E╡E╚1 3N ▀B$╡""╞E╠.╖Ч ╡3O A$(F,A)╡х(A$(F,A),E╚1)╙й(A$(F,A),E╙1):E╡E╚1:Ч ╫3P ▀B%╖Ч ь3Q B%╡.:▀B$╡"J"╖Ч:E╡.:Ч В3R ▀B$╡"K"╖Ч:E╡ц(A$(F,A)):Ч 4S ▀B$╡г(27)╖█ 425 4T B$╡"":Ч 14U ▀B$╡г(27)╖B%╡╤(B%╚1) B4V ▀B$╡""╖█ 43 S4W ▀B$╡""╖█ 47 f4X ▀B$╡"<"╞A╠.╖Ч w4Y A╡A╚1:E╡.:Ч ▀4Z ▀B$╡">"╞AЁ50╖Ч °4[ A╡A╙1:E╡.:Ч ╟4\ ▀B$╡"-"╖A%╡A%╚1 д4] ▀B$╡"+"╖A%╡A%╙1 с4^ ▀B$╡"╚"╖Ч  5_ ≥"ARE YOU SURE? (Y/N)":║ЫO$:▀O$╡"Y"╖Ы▒:─ 5` Ч 5a ▀B$╡"┘"╖█ 53 )5b ▀B$╡"├"╖█ 62 ;5c ▀B$╡"┬"╖█ 151 O5d ▀B$╡г(16)╖█ 362 `5e ▀B$╡"┼"╖█ 67 }5f ▀B$╡г(13)╖ЧA%:ЧA$(F,A) ▐5g ▀B$╡г(141)╖Ч ║5h ЧA%:█ 135:Ч ╟5i ▀B$╡"■"╖Ч Б5j H$╡A$(F,A):H$╡х(H$,E)╙й(H$,E╙2):A$(F,A)╡H$:Ч М5k █ 35:▌ 6l BB╡б(54801)╞16:▀BB╡.╖▌ *6m ▀B$╡"X"╖W$╡A$(F,A):A$(F,A)╡"" A6n ▀B$╡"C"╖W$╡A$(F,A) X6o ▀B$╡"V"╖A$(F,A)╡W$ j6p ▀B$╡"ц"╖█ 120 |6q ▀B$╡"ж"╖█ 121 █6r ▀B$╡г(13)╖Ч ╟6s H$╡й(A$(F,A),E╙1):ЧA%:ЧH$:Ч х6t ▀B$╡","╖AO╡╚1:█ 124 ъ6u ▀B$╡"."╖AO╡1:█ 124 Я6v ▀B$╡"I"╖█ 122 Щ6w B$╡"":▌ 7x │BD╡.╓5:X$(BD)╡A$(BD,A):┌BD:▌ A7y │BD╡.╓5:A$(BD,A)╡X$(BD):┌BD:▌ ╣7z │AN╡50╚1╓A╙1╘╚1:│BD╡.╓5:A$(BD,AN)╡A$(BD,AN╚1):┌BD:┌AN:│BD╡.╓5:A$(BD,A)╡"":┌BD:│AN╡.╓100:▀U(AN)╠╡A╖U(AN)╡U(AN)╙1 ©7{ ┌AN:▌ ч7| H$╡A$(F,A):BC╡.:▀AO╡1╖BC╡6 Э7} C%╡.:█ 130:▀C%╡.╖≥г(7);:▌  8~ AN╡.:КЩANЁц(H$):I$╡й(H$,AN╙1,1) <8 ▀I$╡"O"╞(AN╙1)Ёц(H$)╖Ч ┐8─ I$╡д(е(й(H$,AN╙2,1))╙AO):I$╡й(I$,2):H$╡х(H$,AN╙1)╙I$╙й(H$,AN╙3):Ч ·8│ AN╡AN╙1:Л:A$(F,A)╡H$:▌ г8┌ C%╡1:AN╡.:КЩANЁц(H$):I$╡й(H$,AN╙1,1) Ц8┐ ▀I$╡"O"╞(AN╙1)Ёц(H$)╖Ч 9└ I$╡й(H$,AN╙2,1):▀е(I$)╡BC╖C%╡.:▌ 9┘ Ч 9├ AN╡AN╙1:Л:▌ e9┤ H$╡A$(.,A):I$╡A$(1,A):J$╡A$(2,A):K$╡A$(3,A):L$╡A$(4,A):M$╡A$(5,A) r9┬ ▀AA╡1╖Ч и9┴ ЧH$:Ч(Y):Ч,I$:Ч(Y):Ч,,J$:Ч(Y):Ч,,,K$:Ч(Y):Ч,,,,L$:Ч(Y):Ч,,,,,M$:Ч(Y):▌ п9┼ Ч Ю9▀ ▀W╡.╞X╡.╖Ч З9▄ ЧH$,I$,J$,K$,L$,M$:▌ :█ Ч :▌ ▀W╡1╞X╡.╖Ч 8:▐ ЧH$,I$,J$,,L$,M$:Ч(Y):Ч,,,H$:Ч H:░ ▀W╡1╞X╡1╖Ч p:▒ ЧH$,I$,J$,,L$:Ч(Y):Ч,,,H$,,J$:Ч ─:▓ ▀W╡2╞X╡.╖Ч ╬:⌠ ЧH$,,J$,,,M$:Ч(Y):Ч,,,H$:Ч(Y):Ч,H$:Ч(Y):Ч,,,,H$:Ч н:■ ▀W╡2╞X╡1╖Ч ;∙ ЧH$,,J$:Ч(Y):Ч,,,H$:Ч(Y):Ч,H$,,,,J$:Ч(Y):Ч,,,,H$:Ч ;√ ▌ 1;≈ КЩ1:█ 153:█ 184:▀O$╡"╚"╖М 9;≤ Л:▌ y;≥ ≥"⌠ENV EDITOR";г(9);V$(BA,0);г(9);"OCTAVE";AU:≥"----------" н;  ≥"-/+: DECR/INCR, </>: OCTAVE, ртн: EDIT, таб: FOCUS ENV/FILTER, мега+я: EXIT":≥ F<⌡ ≥"   наме";г(9);г(9);"аттацк";г(9);"децаы";г(9);"сустаин";г(9);"релеасе";г(9);:≥"важефрм";г(9);"пулсевидтх":│AH╡.╓9 ^<° ▀AJ╡AH╖≥">";:у≥" "; ╫<² ≥AH;": ";:AI╡.:A$╡E$(AH):█ 176:AI╡1:AL╡G(AH):█ 176:AI╡2:AL╡H(AH):█ 176:AI╡3:AL╡I(AH):█ 176 =· AI╡4:AL╡J(AH):█ 176:AI╡5:AL╡K(AH):█ 176:AI╡6:AL╡L(AH):█ 176:≥:┌AH:≥:≥"FILTER EDITOR" ┤=÷ ≥"-------------";:≥г(9);"FREQ";г(9);"LP";г(9);"BP";г(9);"HP";г(9);"RES";:≥г(9);"DIR";г(9);"MIN";г(9);"SWEEP" ═=═ │AP╡.╓10:█ 161:┌AP:▌ ╦=║ ▀AT╡AP╖≥">";:у≥" "; Р=╒ AN╡.:█ 167:≥G$(AP);"  ";г(9);:AN╡1:█ 167:≥M(AP);г(9); .>ё AN╡2:█ 167:≥U$(N(AP));г(9);:AN╡3:█ 167:≥U$(O(AP));г(9); f>╓ AN╡4:█ 167:≥U$(P(AP));г(9);:AN╡5:█ 167:≥Q(AP);г(9); ·>╔ AN╡6:█ 167:≥F$(R(AP));г(9);:AN╡7:█ 167:≥S(AP);г(9); ╪>╕ AN╡8:█ 167:≥T(AP);:≥"▓":▌ А>╖ ▀AR╡AP╞AS╡1╞AQ╡AN╖≥"";:у≥"▓";:▌ У>╗ ▀AK╡.╖A$╡E$(AJ) ?╘ ▀AK╡1╖AL╡G(AJ) ?╙ ▀AK╡2╖AL╡H(AJ) .?╚ ▀AK╡3╖AL╡I(AJ) A?╛ ▀AK╡4╖AL╡J(AJ) T?╜ ▀AK╡5╖AL╡K(AJ) g?╝ ▀AK╡6╖AL╡L(AJ) m?╞ ▌ ░?╟ ▀AJ╡AH╞AK╡AI╞AS╡.╖≥"";:у≥"▓"; ²?╠ ▀AI╡.╖Ч ╠?╡ ≥A$;г(9);"▓";:▌ ╦?Ё Ч е?╢ ▀AI╡5╖Ч щ?╣ ≥T$(AL);г(9);"▓";:▌ Д?╤ Ч Ь?╥ ≥AL;г(9);"▓";:▌ @╦ █ 210:▀O$╡"²"╞AK╠.╖AK╡AK╚1 0@╧ ▀O$╡""╞AKЁ6╖AK╡AK╙1 I@╨ ▀O$╡"▒"╞AJ╠.╖AJ╡AJ╚1 b@╩ ▀O$╡""╞AJЁ9╖AJ╡AJ╙1 ─@╪ ▀O$╡"+"╟O$╡"="╖AO╡1:█ 311 ≈@╫ ▀O$╡"-"╖AO╡1:█ 315 ╟@╬ ▀O$╡"ш"╖AO╡100:█ 311 и@© ▀O$╡"щ"╖AO╡100:█ 315 Д@ю ▀O$╡г(13)╖O$╡"+":█ 268  Aа ▀O$╡г(141)╖O$╡"-":█ 268 Aб ▀O$╡г(9)╖AS╡1:█ 196 *Aц █ 237:█ 305:▌ SAд КЩ1:█ 153:█ 210:▀O$╡"²"╞AQ╠.╖AQ╡AQ╚1 lAе ▀O$╡""╞AQЁ8╖AQ╡AQ╙1 ┘Aф ▀O$╡"▒"╞AR╠.╖AR╡AR╚1 ÷Aг ▀O$╡""╞ARЁ10╖AR╡AR╙1 ╫Aх ▀O$╡"+"╟O$╡"="╖AO╡1:█ 317 тAи ▀O$╡"-"╖AO╡1:█ 334 МAй ▀O$╡"ш"╖AO╡100:█ 317 Bк ▀O$╡"щ"╖AO╡100:█ 334 Bл ▀O$╡" "╖Ч -Bм ▀AT╡AR╖AT╡╚1:уAT╡AR :Bн █ 261:Ч TBо ▀O$╡г(13)╖█ 277:█ 261 jBп ▀O$╡г(9)╟O$╡"╚"╖М ┐Bя █ 237:█ 305:Л:AS╡.:▌ ≥Bр O$╡"":КЩO$╡"":║O$ ╗Bс ▀ATЁ╠╚1╖Ч ╣Bт █ 241:Ч бBу ▀AZ╡1╖Ч уBж ▀н(1)╡.╖█ 217 эBв Ч ДBь Л:▌ ЯBы AN╡U(AY) ЪBз ▀AN╠╡.╖Ч Cш A╡AN:▀ZЁ╡.╖Z╡V(AY) .Cэ █ 135:Ч.1:█ 364:Ч <Cщ ▀AN╡╚1╖Ч YCч AN╡V(AY):Ч(AN):A%╡AN:Ч gCъ ▀AN╡╚2╖Ч ┴CЮ AN╡V(AY):AR╡AN:AT╡AN:█ 261:Ч ²CА ▀AN╡╚4╖W╡1:AA╡. ╠CБ ▀AN╡╚5╖W╡2:AA╡. еCЦ ▀AN╡╚6╖X╡1:AA╡. ьCД ▀AN╡╚7╖W╡.:X╡. КCЕ ▀AN╡╚8╖Y╡V(AY) DФ ▀AN╡╚10╖AA╡1:W╡.:X╡. DГ ▀AN╡╚9╖AL╡V(AY):шAL,AL .DХ ▀Z╠.╖Z╡Z╚1 @DИ ▀ZЁ╡.╖AY╡AY╙1 PDЙ ▀AN╡╚3╖AY╡. gDК ▀AY╠╡AF╖AZ╡.:AY╡╚1 mDЛ ▌ ▄DМ │AN╡0╓4:▀O$╡V$(AN,2)╖BA╡AN ╘DН ┌AN:▀O$╡">"╞AUЁ6╖AU╡AU╙1 бDО ▀O$╡"<"╞AU╠.╖AU╡AU╚1 хDП ▌ уDЯ ▀AT╡╚1╖▌ АDР ▀AW╡0╖▌ UEС ≥"";г(9);г(9);г(9);г(9);г(9);г(27);"QCURR╞FREQ=";AV;:Ч54293,(AV╞7)╙((AVЧS3)╛256):Ч54357,(AV╞7)╙((AVЧS3)╛256) bEТ ▀AW╡1╖Ч rEУ AV╡AV╙T(AT) ┐EЖ ▀AV╠M(AT)╖Ч ·EВ AV╡M(AT):▀R(AT)╡3╖AW╡2 ╢EЬ ▀R(AT)╡1╖AV╡S(AT) ╩EЫ Ч аEЗ ▌ хEШ Ч уEЭ ▀AW╡2╖Ч ЕEЩ AV╡AV╚T(AT) ЖEЧ ▀AVЁS(AT)╖Ч FЪ AV╡S(AT):▀R(AT)╡3╖AW╡1 'F ▀R(AT)╡2╖AV╡M(AT) .FЧ 4F▌ ;FЧ AF▌ NF▀AT╡╚1╖▌ ┘FAV╡M(AT):AW╡0:▀R(AT)╡1╟R(AT)╡3╖Ч:AV╡S(AT):AW╡1:Ч ∙F▀R(AT)╡2╖Ч ║FAW╡2:Ч КF	Ч1,M(AT),N(AT),O(AT),P(AT),Q(AT):Ч2,M(AT),N(AT),O(AT),P(AT),Q(AT):▌ G
A$╡"":┘"NEW NAME: ",A$:▀A$Ё╠""╖E$(AJ)╡A$ G▌ 0G▀AK╡.╖█ 266:▌ =G▀AK╡6╖Ч sGA$╡"":┘"NEW VALUE: ",A$:AL╡е(A$):▀AL╠4095╖AL╡4095 ┌G▀ALЁ.╖AL╡. ▒GL(AJ)╡AL:▌ ≤GЧ ╞G▀O$╡"+"╖AO╡1:█ 311 фG▀O$╡"-"╖AO╡1:█ 315 лG▌ ЬG▀AQ╡2╖AL╡N(AR):AL╡н(AL╙1,2):N(AR)╡AL:▌ $H▀AQ╡3╖AL╡O(AR):AL╡н(AL╙1,2):O(AR)╡AL:▌ PH▀AQ╡4╖AL╡P(AR):AL╡н(AL╙1,2):P(AR)╡AL:▌ |H▀AQ╡6╖AL╡R(AR):AL╡н(AL╙1,4):R(AR)╡AL:▌ ≤HA$╡"":┘"NEW VALUE: ",A$ ╖H▀A$Ё╠""╖Ч ╩H▀A Q╡.╖G$(AR)╡A$ хH▀AQ╡1╖Ч ФHAL╡е(A$):▀AL╠2047╖AL╡2047 УH▀ALЁ.╖AL╡. IM(AR)╡AL:Ч I ▀AQ╡5╖Ч ,I!AL╡е(A$):▀AL╠15╖AL╡15 ;I"▀ALЁ.╖AL╡. KI#Q(AR)╡AL:Ч XI$▀AQ╡6╖Ч pI%AL╡е(A$):▀AL╠3╖AL╡3 I&▀ALЁ.╖AL╡. ▐I'R(AR)╡AL:Ч °I(▀AQ╡7╖Ч ╨I)AL╡е(A$):▀A!╡.:E$(6)╡"хARPSICRD":G(6)╡.:H(6)╡9:I(6)╡.:J(6)╡.:K(6)╡2:L(6)╡512:E$(7)╡"оRGAN":G(7)╡.:H(7)╡9:I(7)╡9:J(7)╡.:K(7)╡2 # L(7)╡2048:E$(8)╡"тRUMPET":G(8)╡8:H(8)╡9:I(8)╡4:J(8)╡1:K(8)╡2:L(8)╡512:E$(9)╡"ьYLOPHONE":G(9)╡.:H(9)╡9:I(9)╡.:J(9)╡.:K(9)╡.:L(9)╡.:├ F$(3"):F$(.)╡"ноне" ⌠# F$(1)╡"уп":F$(2)╡"довн":F$(3)╡"осц":├ G$(10):├ M(10):├ N(10):├ O(10):├ P(10):├ Q(10):├ R(10):├ S(10):├ T(10):G$(.)╡"LOWP╞UP":M(.)╡1000 .$ N(.)╡1:O(.)╡0:P(.)╡0:Q(.)╡15:R(.)╡1:S(.)╡100:T(.)╡10:G$(1)╡"LOWP╞DOWN":M(1)╡1000:N(1)╡1:O(1)╡0:P#(1)╡0:Q(1)╡15:R(1)╡2:S(1)╡100:T(1)╡10:G$(2)╡"LOWP╞OSC" а$ M(2)╡1000:N(2)╡1:O(2)╡0:P(2)╡0:Q(2)╡15:R(2)╡3:S(2)╡100:T(2)╡10:G$(3)╡"BANDP╞UP":M(3)╡1000:N(3)╡0:O(3)╡1:P(3)╡0:Q(3)╡15:R(3)╡1:S(3)╡100:T(3)╡10 `%	 G$(4)╡"BANDP╞DOWN":M(4)╡1000:N(4)╡0:O(4)╡1:P(4)╡$0:Q(4)╡15:R(4)╡2:S(4)╡100:T(4)╡10:G$(5)╡"BANDP╞OSC":M(5)╡1000:N(5)╡0:O(5)╡1:P(5)╡0:Q(5)╡15:R(5)╡3:S(5)╡100 Щ%
 T(5)╡10:G$(6)╡"HIGHP╞UP":M(6)╡1000:N(6)╡0:O(6)╡0:P(6)╡1:Q(6)╡15:R(6)╡1:S(6)╡100:T(6)╡10:G$(7)╡"HIGHP╞DOWN":M(7)╡1000:N(7)╡0:O(7)╡0:P(7)╡1:Q(7)╡%15:R(7)╡2 ²& S(7)╡100:T(7)╡10:G$(8)╡"HIGHP╞OSC":M(8)╡1000:N(8)╡0:O(8)╡0:P(8)╡1:Q(8)╡15:R(8)╡3:S(8)╡100:T(8)╡10:G$(9)╡"SPARE╞1":M(9)╡.:N(9)╡0:O(9)╡0:P(9)╡0:Q(9)╡.:R(9)╡0 ' S(9)╡.:T(9)╡.:G$(10)╡"SPARE╞2":M(10)╡.:N(10)╡0:O(10)╡0:P(10)╡0:Q(10)╡.:R(10)╡0:S&(10)╡.:T(10)╡.:├ U(200):├ V(200):Y╡.05: ╛' ├ N$(10):N$(1)╡"темпо":N$(2)╡"филтер":N$(3)╡"лооп":N$(4)╡"ецхо╞м1":N$(5)╡"ецхо╞м2":N$(6)╡"ецхо╞б":N$(7)╡"ецхо╞офф":N$(8)╡"ецхо╞сз":N$(9)╡"жол" A( N$(10)╡"делаы":├ Q$(11):├ R$(11):Q$(.)╡"A":R$(.)╡"C":Q$(1)╡"W":'R$(1)╡"#C":Q$(2)╡"S":R$(2)╡"D":Q$(3)╡"E":R$(3)╡"#D":Q$(4)╡"D":R$(4)╡"E":Q$(5)╡"F" в( R$(5)╡"F":Q$(6)╡"T":R$(6)╡"#F":Q$(7)╡"G":R$(7)╡"G":Q$(8)╡"Y":R$(8)╡"#G":Q$(9)╡"H":R$(9)╡"A":Q$(10)╡"U":R$(10)╡"#A":Q$(11)╡"J":R$(11)╡"B":├ T$(4): a) T$(.)╡"три":T$(1)╡ "сав":T$(2)╡"пулсе":T$(3)╡"ноисе":T$(4)╡"ринг":├ U$(2):U$(.)╡"офф":U$(1)╡"он":AP╡1:AQ╡0:AR╡0:AS╡0:AT╡╚1:AU╡5:AY╡╚1: Ч) BA╡2:├ V$(5,2):V$(0,0)╡"WHOLE":V$(0,1)╡"W":V$(0,2)╡"1":V$(1,0)╡"HALF":V$(1,1)╡"H":V$(1,2)╡"2":V$(2,0)╡"QUARTER":V$(2,1)╡"Q":V$(2,2)╡"3CE WE HAVE THE "LOAD AT ADDRESS" COMMAND O.(▐ (UNLESS FOLKS START WHINING ABOUT COMPATIBLITY WITH THE FIVE │.2▐ ALREADY EXISTING BASIC10 PROGRAMS AGAIN...) ┤.<: ▓.FЧ 128 е.P≈ 208,2     : ▐ NO OF CHARS IN KEYBOARD BUFFER Ю.Z≈ 688,13,13 : ▐ RETURN Ф.d─ /n▐ --- CHAIN LOAD PREFS f/x≥"⌠EDMA 0,$1FFF,$8020000,$2001:NEW RESTORE":≥"RUN";:▐ LOAD '11.SETTINGS' FROM ATTIC CACHE q/┌Ч 128 ╔/▄≈ 208,2      : ▐ NO OF CHARS IN KEYBOARD BUFFER а/√≈ 688,13,13  : ▐ RETURN г/═─ А/╙▐ --- ATTIC RAM CHECK В/╢HA&╡1:TA╡$8000000 0╬│ T╡0 ╓ 32 0хRA╡TA╙(T╛$1000) &0рO╡б(RA) 40э≈ RA,T╙15 N0Ф▀ б(RA)Ё╠T╙15 ╖ HA&╡0 Y0П≈ RA,O a0З┌ T n0▀ HA& ╖▌ |0Ч< 0:Ч; 0 ═0≥ "⌠ERROR: 11 NEEDS AT LEAST " е0"≥ "128KB OF ATTIC RAM INSTALLED. Л0,≥ "SORRY FOR THE INCONVENIENCE. " Т06К:Л З0@: +1J▐ --- QUICK AND DIRTY ATTIC RAM SANITY CHECK N1T≥ "CHECKING ATTIC RAM SANITY"; f1^A╡$30000:B╡$8000000 z1hЧ! 0,$10000,A,B ░1r│ C╡0 ╓ $FFFE ╘ 7 ╦1|▀ н(A╙C)Ё╠н(B╙C) ╖ ┴ 1710: ▐ FAIL с1├▀ н(C,$400)╡0 ╖ ≥"."; ы1░┌ 2 ≥:≥ "ATTIC RAM SEEMS STABLE. PHEW." 2╓▌ <2╝≥"⌠ATTIC RAM SANITY TEST FAILURE▓"╙г(27)╙"O" B2╦≥ ∙2б≥"ELEVEN'S INITIAL TEST HAS DETERMINED THAT ATTIC RAM SEEMS TO BE ON THE FRITZ Щ2л≥"(AGAIN). PLEASE INSTALL THE MOST RECENT STABLE MEGA65 CORE ON YOUR MACHINE.     IF THE PROBLEM "; .3ж≥"PERSISTS, PLEASE CONTACT THE MEGA65 TEAM." E3Ю≥"ERROR DETAIL:" z3Й≥"EXPECTED $";р(н(A╙C));" AT ADDRESS $";р(B╙C); ≤3Т≥ " BUT GOT $";р(н(B╙C)) ╫3Ч≥"SORRY FOR THE INCONVENIENCE" е3К:Л 4п▐ SUB --- CHECK FOR AUTOLOAD, RETURN FILENAME IN AL$ --- 4зI╡0:AL$╡"":AA╡0 Q4Д▀ б(2048╙I)╙64Ё╠ф(й("AUTOLOAD",I╙1,1)) ╖ AA╡0:AL$╡"":▌ h4НI╡I╙1:▀ IЁ8 ╖ 2020 √4ЬA╡б(2048╙I):▀ AЁ╠34 ╞ IЁ20 ╖ I╡I╙1:┴ 2040 ╚4▀ AЁ╠34 ╖ AA╡0:▌ л4I╡I╙1:▀ I╠40 ╖ AL$╡"":AA╡0:▌ Й4A╡б(2048╙I):▀ A╡34 ╖ 2100 5 ▀ A╠╡1 ╞ AЁ╡26 ╖ A╡A╙64 5*AL$╡AL$╙г(A):┴ 2060 <54▀ ц(AL$)╠16 ╖ AL$╡"":AA╡0 G5>AA╡1:▌ p5≤▐ SUB --- INJECT AUTOLOD INTO $4FF10 5╒▀ AA╡0 ╖ ▌ ё5╛≈ $4FF07, б($4FF07) ╟ 1 : I ╡ 0 ╤5╤│ K╡1 ╓ ц(AL$) ж5ю  ≈ $4FF10╙I, ф(й(AL$,K,1 1)) Б5й  I╡I╙1 Й5т┌ K Ш5ч≈ $4FF10╙I,0 6Х▌                                                                                                                                                                                                                 
'----.DOCS'----' гRABBER тOOL - PORTED TO еLEVEN (FOR EASIER MAINTENANCE)' ============'' уSAGE:' -----' - пRESS 'SPACE' KEY ON TOP-LEFT POINT' - тHEN USE CURSOR KEYS TO MOVE TO BOTTOM-RIGHT POINT & PRESS 'SPACE'' - пRESS '-' AND '+' KEYS TO MOVE BETWEEN PREVIOUS AND NEXT FRAMES' - пRESS 'C' TO REDRAW CURRENT FRAME' - пRESS 'Y' TO YANK/COPY A SELECTED REGION' - пRESS 'P' TO PASTE A SELECTED REGION TO CURRENT CURSOR LOCATION' - пRESS 'E' TO EDIT CURRENT FRAME' - пRESS 'D' TO DELETE THE CURRENT FRAME' - пRESS 'L' THEN A FRAME# TO LOAD THAT FRAME' - пRESS 'X' TO EXIT PROGRAM' - ф1 = LOAD CHAR+COLOR .BIN FILE' - ф3 = SAVE CHAR+COLOR .BIN FILE' - ф5 = SAVE OPTIMIZED+REPAIRED .BIN FILE' - ф7 = EDIT HIT BOXES#OUTPUT "GRABBER"' цHAR+цOLOR фILE фORMAT (ф1/ф3 KEYS)' ======================' ворд: PROG-ADDRESS (IGNORED)' ворд: SIZE OF DATA (INCLUDING THIS ворд AND ONWARDS)' быте: # OF FRAMES' ' фраме #0' --------'   быте: X'   быте: Y'   быте: W'   быте: H'   дворд: HEAD BOX (X1,Y1,X2,Y2)'   дворд: TORSO BOX (X1,Y1,X2,Y2)'   дворд: FEET BOX (X1,Y1,X2,Y2)'   дворд: ATTACK BOX (X1,Y1,X2,Y2)'   быте[W*H]: CHAR DATA'   быте[W*H]: COLOR DATA'' фраме #1' --------'   (AS BEFORE...)'' фраме #N' --------'   (AS BEFORE...)' цOLOR-ONLY фILE фORMAT (ф5 KEY)' ======================' ворд: PROG-ADDRESS (IGNORED)' ворд: SIZE OF DATA (INCLUDING THIS ворд AND ONWARDS)' быте: # OF FRAMES' ' фраме #0' --------'   быте: X'   быте: Y'   быте: W'   быте: H'   дворд: HEAD BOX (X1,Y1,X2,Y2)'   дворд: TORSO BOX (X1,Y1,X2,Y2)'   дворд: FEET BOX (X1,Y1,X2,Y2)'   дворд: ATTACK BOX (X1,Y1,X2,Y2)'   быте[W*H]: COLOR DATA'' фраме #1' --------'   (AS BEFORE...)'' фраме #N' --------'   (AS BEFORE...)'--------.DECLARES'--------#DECLARE CLR╞LINE╞RIGHT$ = CHR$(27)+"Q"   ' OLD CL$#DECLARE CURRENT╞FRAME  ' OLD FF#DECLARE X, Y  ' CURSOR POSITION#DECLARE PTR  ' POINTER TO DATA BYTES IN MEMORY#DECLARE FRAME╞COUNT#DECLARE FRMIDX#DECLARE BYTES╞USED  ' OLD L#DECLARE FRMW, FRMH#DECLARE START╞CHAR, START╞COLOR, END╞CHAR, END╞COLOR#DECLARE STARTX, STARTY, ENDX, ENDY#DECLARE CURR╞FRAME#DECLARE SRC╞CHAR╞PTR, SRC╞CLR╞PTR#DECLARE A$, XIDX, YIDX#DECLARE DEST╞CHAR╞PTR, DEST╞CLR╞PTR#DECLARE FNAME$#DECLARE CVAL#DECLARE START╞PTR, END╞PTR, CURR╞PTR, SRC╞PTR, DEST╞PTR, SZ, K, LN#DECLARE B(50,3)  ' HITBOXES#DECLARE X1, Y1, X2, Y2#DECLARE HB╞SEL = 0, HB╞MODE, IDX#DECLARE CLIPBOARD╞CHAR&(80*50)#DECLARE CLIPBOARD╞CLR&(80*50)#DECLARE CLIPW, CLIPH#DEFINE сторе╞старт╞пос = 0#DEFINE сторе╞енд╞пос = 1#DECLARE STORE╞STATE  ' ARE WE STORING START/END POS CHAR/COLOUR DETAILS#DECLARE NEW╞FRAME╞FLAG#DEFINE кеы╞уп = "▒"#DEFINE кеы╞довн = ""#DEFINE кеы╞лефт = "²"#DEFINE кеы╞ригхт = ""#DEFINE кеы╞ф1 = "┘"#DEFINE кеы╞ф3 = "├"#DEFINE кеы╞ф4 = "┼"#DEFINE кеы╞ф5 = "┤"#DEFINE кеы╞ф7 = "┬"#DEFINE кеы╞ф8 = "▄"#DEFINE кеы╞есц = CHR$(27)#DEFINE кеы╞реж╞он = ""#DEFINE кеы╞реж╞офф = "▓"#DEFINE кеы╞ретурн = CHR$(13)#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE хб╞моде╞бровсе     = 0#DEFINE хб╞моде╞сел╞цоорд1 = 1#DEFINE хб╞моде╞сел╞цоорд2 = 2#DEFINE хб╞моде╞цомплете   = 3.OFFSETS#DEFINE оффсет╞дата╞сизе  = 0#DEFINE оффсет╞нум╞фрамес = 2#DEFINE оффсет╞фраме0     = 3#DEFINE фрм╞оффсет╞ь          = 0#DEFINE фрм╞оффсет╞ы          = 1#DEFINE фрм╞оффсет╞в          = 2#DEFINE фрм╞оффсет╞х          = 3#DEFINE фрм╞оффсет╞хитбоьес   = 4#DEFINE фрм╞оффсет╞хб╞хеад    = 4#DEFINE фрм╞оффсет╞хб╞торсо   = 8#DEFINDR%(25), SRC╞ADDR, DEST╞ADDR, LENGTH, TRANSP#DECLARE FRAMEIDX, FX, FY, MIRROR, DATA╞ADDR%, FRMX, FRMY#DECLARE FRMX1, FRMY1, SCRADDR%, CLRADDR%, CDATA╞ADDR%, YY#DECLARE INC(3), INC╞DIR(3), A$, X, Y#DECLARE TEMPR, TEMPG, TEMPB, M#DECLARE LOGO╞STATE#DECLARE FLIP╞VAR, UPPER╞NIBBLE, LOWER╞NIBBLE#DECLARE CLR1, CLR2, TSTART#DECLARE BAS╞STATE = 0#DECLARE FRMY(3), ORIG╞FRMY(3), FINISH╞CNT, BCNT#DECLARE LOC, INC%  #DECLARE RAIN╞IDX, PLEN, RAINBOWSTR$, RAINBOW╞X, RAINBOW╞Y  #DECLARE SUBTEXT$(2)  #DECLARE SUBTEXT╞IDX = 0  SUBTEXT$(0) = "PRESENTS..."  SUBTEXT$(1) = "A SONG BY..."#DEFINE фрм╞б = 0#DEFINE фрм╞а = 1#DEFINE фрм╞с = 2#DEFINE фрм╞бацкдроп = 3#DECLARE хотрег╞7 = $D05D#DEFINE сцрнптрлсб = $D060#DEFINE сцрнптрбнк = $D062  ' PALETE фрм╞оффсет╞хб╞феет    = 12#DEFINE фрм╞оффсет╞хб╞аттацк  = 16#DEFINE фрм╞оффсет╞дата       = 20#DECLARE BX╞OFFS(3)BX╞OFFS(0) = фрм╞оффсет╞хб╞хеадBX╞OFFS(1) = фрм╞оффсет╞хб╞торсоBX╞OFFS(2) = фрм╞оффсет╞хб╞феетBX╞OFFS(3) = фрм╞оффсет╞хб╞аттацк'----.MAIN'----  KEY OFF  POKE $D020, 11, 14  GOSUB INIT╞VARS  GOSUB CHECK╞MAGIC╞SIGNATURE  GOSUB CHECK╞EDIT╞FLAG  GOSUB LOCATE╞NEXT╞FREE╞BYTE  GOSUB DRAW╞FOOTER  DO WHILE 1    GOSUB STORE╞STATE╞INFO    GOSUB DRAW╞CURSOR    GOSUB GET╞USER╞INPUT    GOSUB SHOW╞COORDS  LOOP'-----------.SHOW╞COORDS'-----------  CURSOR 0, 49  PRINT CLR╞LINE╞RIGHT$;  IF STORE╞STATE = сторе╞старт╞пос THEN BEGIN    PRINT CHR$(27)+"QX=";X;", Y=";Y;  BEND  IF STORE╞STATE = сторе╞енд╞пос THEN BEGIN  ▀  B╡╚1:N%╡╚1:O%╡1:P%╡╚1:├ U%(20):AE%╡╚4:AF%╡0:AW%╡0:├ AX%(250):├ AY%(250):├ AZ%(12000):AZ%(.)╡ф("V"):AZ%(1)╡ф("E"):AZ%(2)╡ф("C"):BA%╡3: ! ├ BB%(1000):├ BD%(9):├ BE%(9):├ BF%(9):├ BG%(9):├ BH%(9):├ BI%(9):├ C$(9):BD%(.)╡.:BE%(.)╡.:BF%(.)╡.:BG%(.)╡.:    в 360 ∙  A╡0:B╡0:E╡0:F╡0:├ A$(5,50):C$╡"CDEFGAB0123456789 #$.HIQRSWOTUXMPL":A%╡12:B%╡0:B%╡0:├ E$(9):├ G(9):├ H(9):├ I(9):├ J(9):├ K(9):├ L(9): 1! E$(.)╡"пIANO":G(.)╡.:H(.)╡9:I(.)╡.:J(.)╡.:K(.)╡2:L(.)╡1536:E$(1)╡"аCCORDION":G(1)╡12:H(1)╡.:I(1)╡12: J(1)╡.:K(1)╡1:L(1)╡.:E$(2)╡"цALLIOPE":G(2)╡.:H(2)╡. п! I(2)╡15:J(2)╡.:K(2)╡.:L(2)╡.:E$(3)╡"дRUM":G(3)╡.:H(3)╡5:I(3)╡5:J(3)╡.:K(3)╡3:L(3)╡.:E$(4)╡"фLUTE":G(4)╡9:H(4)╡4:I(4)╡4:J(4)╡.:K(4)╡.:L(4)╡.:E$(5)╡"гUITAR" m" G(5)╡.:H(5)╡9:I(5)╡2:J(5)╡1:K(5)╡1:L(5)!BH%(.)╡0:BI%(.)╡.:C$(.)╡"LINE" ╫! BD%(1)╡.:BE%(1)╡.:BF%(1)╡.:BG%(1)╡.:BH%(1)╡0:BI%(1)╡.:C$(1)╡"CIRCLE":BD%(2)╡.:BE%(2)╡.:BF%(2)╡.:BG%(2)╡.:BH%(2)╡0:BI%(2)╡.:C$(2)╡"ELLIPSE":BD%(3)╡.:BE%(3)╡. X" BF%(3)╡.:BG%(3)╡.:BH%(3)╡0:BI%(3)╡.:C$(3)╡"BOX":BD%(4)╡.:B"E%(4)╡.:BF%(4)╡.:BG%(4)╡.:BH%(4)╡0:BI%(4)╡.:C$(4)╡"POLY":BD%(5)╡.:BE%(5)╡.:BF%(5)╡.:BG%(5)╡. Т" BH%(5)╡1:BI%(5)╡.:C$(5)╡"FILL":BD%(6)╡.:BE%(6)╡.:BF%(6)╡.:BG%(6)╡.:BH%(6)╡0:BI%(6)╡.:C$(6)╡"SAVE":BD%(7)╡.:BE%(7)╡.:BF%(7)╡.:BG%(7)╡.:BH%(7)╡0:BI%(7)╡. H# C#$(7)╡"LOAD":BD%(8)╡.:BE%(8)╡.:BF%(8)╡.:BG%(8)╡.:BH%(8)╡0:BI%(8)╡.:C$(8)╡"EXIT" ╖# BF%(.)╡ц(C$(.))╙2:BG%(.)╡3:│A╡1╓9╚1:BD%(A)╡BD%(A╚1)╙BF%(A╚1):BF%(A)╡ц(C$(A))╙2:BG%(A)╡3:┌A б# █ 9:█ 11:█ 155:█ 174:─  $	 Ч..,640,400,4:│A╡.╓62:┤C%:≈1536╙A,C%:┌A:Ч>▒,1,.:Ч$.,1,1:▌ +$
 │A╡.╓7:Ч!3,640╛2,.,262144╙A╛16384:┌A:▌ {$ █ 10:Ч3.,1:│A╡.╓9╚1:C%╡BD%(A):D%╡BE%(A):E%╡(C%╙BF%(A)):F%╡(D%╙BG%(A)):Ч3.,1 ▒$ ▀B╡A╞BH%(A)Ё╠1╖Ч ╡$ АC%╛8,D%╛8,E%╛8,F%╛8,1:Ч3.,. р$ Ч:уЧ:АC%╛8,D%╛8,E%╛8,F%╛8 М$ ▀BH%(A)╡1╞BI%(A)Ё╠.╖Ч % Ч3.,%3:АC%╛8,D%╛8,E%╛8,F%╛8,1:Ч3.,.:Ч % Ч V% ЮC%╙1,D%╛8╙4,2,1,2,C$(A):Ч3.,1:┌A:Ч3.,O%:Ч.,1,O%:▌ e% ▀N%Ё╠O%╖Ч ·% AZ%(BA%)╡63:BA%╡BA%╙1:AZ%(BA%)╡O%:BA%╡BA%╙1:N%╡O%:Ч ╓% ▌ п% │A╡.╓BC%:AZ%(BA%)╡BB%(A):BA%╡BA%╙1:┌A:▌ W& BB%(.)╡0╙64╛BI%(5):BB%(1)╡AH%╞2&55:BB%(2)╡AH%ЧS8:BB%(3)╡AI%╞255:BB%(4)╡AI%ЧS8:BB%(5)╡I%╞255:BB%(6)╡I%ЧS8:BB%(7)╡J%╞255:BB%(8)╡J%ЧS8 h& BC%╡8:█ 22:▌ v& ▀AG%╡.╖Ч ⌡& █ 19:AH%╡I%:AI%╡J%:ЧLI%,J%:AG%╡1 й& Ч:у▀AG%╡1╖Ч:ЕAH%,AI%,I%,J%:█ 23:AG%╡.:Ч п& ▌ K' BB%(.)╡1╙64╛BI%(5):BB%(1)╡AK%'╞255:BB%(2)╡AK%ЧS8:BB%(3)╡AL%╞255:BB%(4)╡AL%ЧS8:BB%(5)╡AM%╞255:BB%(6)╡AM%ЧS8:BC%╡6:█ 22:▌ Y' ▀AJ%╡.╖Ч v' █ 19:AK%╡I%:AL%╡J%:AJ%╡1 г'  Ч:у▀AJ%╡1╖Ч:AM%╡╨((I%╚AK%)╝2╙(J%╚AL%)╝2):БAK%,AL%,AM%,BI%(5):█ 29:AJ%╡.:Ч м'! ▌ X(" BB%(.)╡2╙64╛BI%(5):BB%(1)╡AO%╞255:BB%(2)╡AO%ЧS8:BB%(3)╡AP%╞255:BB%(4)╡AP%ЧS8:BB%(5)╡AQ%╞255:BB%(6)╡AQ%ЧS8:BB%(7)╡AR%╞255:BB%(8)╡AR%ЧS8 i(# BC%╡8:█ 22:▌ w($ ▀AN%╡.╖Ч ■(% █ 19:AO%╡I%:AP%╡J%:AN%╡1 И(& Ч:у▀AN%╡1╖Ч:AQ%╡╤(I%╚AO%):AR%╡╤(J%╚AP%):Ч0AO%,AP%,AQ%,AR%,BI%(5):█ 34:AN%╡.:Ч О('  A$=кеы╞ф1 THEN GOSUB LOAD╞FILE : RETURN  IF A$=кеы╞ф3 THEN GOSUB SAVE╞FILE : RETURN  IF A$=кеы╞ф7 THEN GOSUB SET╞GROUP╞FLAG : RETURN  IF A$=кеы╞ф9 THEN GOSUB TOGGLE╞VERSION  IF A$=кеы╞ф5 THEN GOSUB PLAY╞DATA : RETURN  IF A$=кеы╞ф6 THEN LASTFLAG=1:GOSUB PLAY╞DATA : RETURN  IF A$=кеы╞реж╞он THEN REV╞FLAG& = 1 : RETURN  IF A$=кеы╞реж╞офф THEN REV╞FLAG& = 0 : RETURN  IF A$=кеы╞ф10 THEN INPUT K, V:LDATA&(K) = V  IF A$="" THEN DEBUG=MOD(DEBUG+1,2):A$="":CURSOR 0,0:PRINT CHR$(27);"QDEBUG=";DEBUG  IF A$<>"" THEN BEGIN    CURSOR X, Y    GOSUB RESTORE╞CHAR    GOSUB CHK╞REV    XX = X : YY = Y    GOSUB DRAW╞CHAR    GOSUB SAVE╞CHAR  BEND  RETURN'--------------.TOGGLE╞VERSION'--------------  VER = VER + 1  IF VER = 4 THEN VER = 1  PRINT """;CHR$(27);"QVERSION";VER;  A$=""  IF VER = 3 THEN GOSUB DRAW╞FONT╞GUIDE╞LINES  RETURN'---------------------.DRAW╞FONT╞GUIDE╞LINES'---------------------  PRINT "⌠▓----------"  PRINT  PRINT  PRINT ".........."  PRINT  PRINT  PRINT  PRINT#OUTPUT "LINE"' кEYS:' ----'  уP/дOWN/лEFT/рIGHT = мOVE CURSOR POSITION'  цтрл+9/0 = сET REVERSE ON/OFF'  ф1 = LOAD FILE'  ф3 = SAVE FILE'  ф5 = PLAY DATA'  ф7 = TOGGLE GROUP FLAG'       - ADDS $FF (START) OR $FE (STOP) TO DATA STREAM'        ' аN EXPERIMENT TO DROP 5 (OR 6) SPRITES (EACH 64X200) OVER THE 320X200 SCREEN' TO ACT LIKE AN OVERLAY THAT и CAN DRAW LINES ON TOP OF' еACH SPRITE WILL CONSUME 1.6KB ($640 IN HEX)' вILL NEED A ROUTINE THAT TAKES VECTOR COORDS FOR LINES (MAYBE FROM VART)' AND DRAWS THEM ONTO THIS MULTI-SPRITE OVERLAY#OUTPUT "SPRITELINE"' банк4 мEMORY USAGE' ------------------' 4.0000 сприте 0 дата' 4.0640 сприте 1 дата' 4.12ц0 сприте 2 дата' 4.1900 сприте 3 дата' 4.1ф40 сприте 4 дата' 4.2580 сприте 5 да  d ▐ ================= 1 n ▐ ELEVEN BOOTLOADER I x ▐ ================= i } █ 2000:▐ CHECK FOR AUTOLOAD o ┌ : █ ▄ ▀ н	(2)Ё╠80 ╖≥ г(27)╙"X"; ÷ √ ≥"⌠":≈ 0,65 л ═ Ч 4:CF$╡г(б(я("FF00")))╙г(б(я("FF01"))) Ь ╙ CB ╡ CF$Ё╠"SK" : ▐ CB=1 IF COLD BOOTING !╢ L	P╡0 : ▐ LOAD PREFS FLAG <!╬ MV╡920371  : ▐ MINIMUM ROM VERSION b!х ▐ CHECK CORRECT ROM VERSION FIRST █!р Ч 2:│ I╡0 ╓ 5:V$╡V$╙г(б(я("17")╙I)):┌ ≥!э V╡е(V$) ╬!Ф ▀ VЁMV ╖█940: ▐ VERSION MISMATCH т!П BD$╡"24-JUN-2022" Д!З VN$╡"0.5.0" З!DF$╡"11.DEFAULTS" 
"X$╡г(27)╙г(27) "Ч 128 ;""█900: ▐ CHECK FOR 'P' KEYPRESS z",≈ 248,б(248)╟2╝6    : ▐ DISABLE SCREEN EDITOR LINE LINKING °"6Ч< 6: Ч; 6:Ч9 1:≥"⌠"╙г(142) ╓"@W╡6 ╡"J│ S╡0 ╓ W к"TЧA79╚(W╛2)╙(S╛2)╚9,S ъ"^≥"▓ъ        "; З"h│L╡0╓(12╚S╛2):≥" ";:┌L #r┌ S #|█ 1020 #├Ч9 1 ?#░≥"ELEVEN▓ DEVELOPMENT ENVIRONMENT" ^# ≥"VERSION ";VN$;╕3);BD$ ┘#╓≥"WRITTEN BY STEPHAN KLEINERT" ╪#╝≥"COPYRIGHT (C) 2021-2022 7 TURTLES SOFTWARE" з#╦█ 1450: ▐ CHECK ATTIC RAM $б▀ CB ╖ ≥ "** COLD BOOT * THE INTENT IS TO DRAW SUCH GROUPS IN ONE HIT'         (RATHER THAN CHAR BY CHAR)'  ф9 = TOGGLE BETWEEN VERSION 1 OR 2 OF FILE FORMAT (DEFAULT VER2)'  алт+лEFT/рIGHT = SCROLL CANVAS LEFT/RIGHT.DECLARES'--------#DECLARE A$, Z$, LOC, K, V, DEBUG=0#DECLARE X=0, Y=0, XX, YY#DECLARE T0=0#DECLARE MODIFIED%=0#DECLARE OLDX, OLDY, OLDOFFS#DECLARE FNAME$, ALT╞KEY#DECLARE LDATA&(12288), DIDX%=0, PIDX%=0#DECLARE GROUP╞FLAG&, VAL&, REV╞FLAG& = 0#DECLARE OFFS, VER=2#DECLARE LASTFLAG, LAST╞GROUP╞IDX.DEFINES'-------#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE дст╞дец = 32#DEFINE срц╞дец = 16.KEYS'----#DEFINE кеы╞уп = "▒"#DEFINE кеы╞довн = ""#DEFINE кеы╞лефт = "²"#DEFINE кеы╞ригхт = ""#DEFINE кеы╞спаце = " "#DEFINE кеы╞дел = ""#DEFINE кеы╞цтрл╞в = ""#DEFINE кеы╞цтрл╞у = ""#DEFINE кеы╞мега╞я = "╚"#DEFINE кеы╞ф1 = "┘"#DEFINE кеы╞ф3 = "├"#DEFINE кеы╞ф4 = "┼"#DEFINE кеы╞ф5 = "┤"#DEFINE кеы╞ф6 = "▀"#DEFINE кеы╞ф7 = "┬"#DEFINE кеы╞ф8 = "▄"#DEFINE кеы╞ф9 = ""#DEFINE кеы╞ф10 = ""#DEFINE кеы╞ретурн = CHR$(13)#DEFINE кеы╞есцапе = CHR$(27)#DEFINE кеы╞схифт╞ретурн = CHR$(141)#DEFINE кеы╞схифт╞плус = "ш"#DEFINE кеы╞схифт╞минус = "щ"#DEFINE кеы╞реж╞он = ""#DEFINE кеы╞реж╞офф = "▓"#DEFINE кеы╞таб = CHR$(9)#DEFINE кеы╞хоме = ""#DEFINE кеы╞цлр  = "⌠"#DEFINE кеы╞ловерцасе = CHR$(14)#DEFINE кеы╞упперцасе = CHR$(142)#DEFINE кеы╞бееп = CHR$(7)#DEFINE кеы╞инст = "■"#DEFINE кеы╞дел  = ""#DEFINE кеы╞мега╞к = "║"#DEFINE кеы╞мега╞й = "╣"#DEFINE кеы╞мега╞х = "╢"#DEFINE кеы╞мега╞л = "╤"GOSUB INIT.MAINGOSUB CHECK╞INPUTGOSUB SHOW╞CURSORGOTO MAIN'----.INIT'----  KEY OFF  ' SWITCH BACK TO UPPER-CASE  ' POKE $D018, PEEK($D018) AND $FD  OLDX = -1 : OLDY = -1 : OLDOFFS = 0  DIDX% = 0  GROUP╞FLAG& = 0 : REV╞FLAG& = 0  PRINT "⌠";  POKE $D020, 11  POKE $D021, 0  OFFS = 0  RETURN'-----------.CHECK╞INPUT'-----------  GET A$  GOSUB CHECK╞ALT╞KEY╞INPUTS  IF A$<>"" THEN GOSUB DRAW╞INFO  IF A$=кеы╞лефт AND X>0 THEN GOSUB RESTORE╞CHAR : X=X-1 : RETURN  IF A$=кеы╞ригхт AND X<78 THEN GOSUB RESTORE╞CHAR : X=X+1 : RETURN  IF A$=кеы╞уп AND Y>0 THEN GOSUB RESTORE╞CHAR : Y=Y-1 : RETURN            IF A$=кеы╞довн AND Y<49 THEN GOSUB RESTORE╞CHAR : Y=Y+1 : RETURN  IF A$=кеы╞ф1 THEN GOSUB LOAD╞FILE : RETURN  IF A$=кеы╞ф3 THEN GOSUB SAVE╞FILE : RETURN  IF A$=кеы╞ф7 THEN GOSUB SET╞GROUP╞FLAG : RETURN  IF A$=кеы╞ф9 THEN GOSUB TOGGLE╞VERSION  IF A$=кеы╞ф5 THEN GOSUB PLAY╞DATA : RETURN  IF A$=кеы╞ф6 THEN LASTFLAG=1:GOSUB PLAY╞DATA : RETURN  IF A$=кеы╞реж╞он THEN REV╞FLAG& = 1 : RETURN  IF A$=кеы╞реж╞офф THEN REV╞FLAG& = 0 : RETURN  IF A$=кеы╞ф10 THEN INPUT K, V:LDATA&(K) = V  IF A$="" THEN DEBUG=MOD(DEBUG+1,2):A$="":CURSOR 0,0:PRINT CHR$(27);"QDEBUG=";DEBUG  IF A$<>"" THEN BEGIN    CURSOR X, Y    GOSUB RESTORE╞CHAR    GOSUB CHK╞REV    XX = X : YY = Y    GOSUB DRAW╞CHAR    GOSUB SAVE╞CHAR  BEND  RETURN'--------------.TOGGLE╞VERSION'--------------  VER = VER + 1  IF VER = 4 THEN VER = 1  PRINT "";CHR$(27);"QVERSION";VER;  A$=""  IF VER = 3 THEN GOSUB DRAW╞FONT╞GUIDE╞LINES  RETURN'---------------------.DRAW╞FONT╞GUIDE╞LINES'---------------------  PRINT "⌠▓----------"  PRINT  PRINT  PRINT ".........."  PRINT  PRINT  PRINT  PRINT*":█ 1610: ▐ CHECK ATTIC RAM STATE #$л° TI W$ж≥ "PRESS 'P▓' DURING BOOT TO SET PREFERENCES" ┼$Ю≥ "PRESS 'C▓' DURING BOOT TO FORCE COLD BOOT" ░$Й≥ ╓$Т≥ "CLEANING UP" ц$ЧР "11TEMP":Р "11TOKENIZED" л$█900 Л$≥ "LOADING DEFAULTS" : █640 !%≈ $4FF70,0,0 : ▐ FORCE LOAD FROM DISC ON STARTUP V%&≈ $4FF08,0   : ▐ CLEAR EXTERNAL ERROR ON STARTUP _%0█900 ┘%:▀ LP╡0 ╖TB╡TI:К:█900:Л Щ TI╚TBЁ.1 ▌%DЧ 0 ║%NК:║T$:ЛЩT$Ё╠"" ╪%X█ 1110: ▐ LOAD MODULES )&bЫ ▒:Ы16,"⌠EDMA 0,$D400,$8000000,$2001:NEW RESTORE"╙г(13)╙"RUN"╙г(13):▐ LOAD '11.EDIT' FROM ATTIC CACHE G&lЧ128:≈ $D61A,б($D61A)╟16 └&q▀ SM ╖ ≥ г(27)╙"5";:▐ SWITCH TO 80X50 IF SETTINGS SAY SO ╨&v▀ LP╡0 ╖ ┴ 1250: у ┴ 1390: ▐ LOAD EDITOR OR PREFS А&─▐ --- LOAD SETTINGS TO MAILBOX RAM '┼T$╡г(б($4FF00))╙г(б($4FF01)) 4'■▀ T$╡"SK" ╖ ┴ 830 : ▐ SETTINGS ALREADY LOADED ='·в890 X'╗Ч (DF$),B(4),P($FF00) ^'╡в ┤'╪▀ DSЁ╠0 ╖≥ "COULD NOT LOAD DEFAULTS" Ё'фЧ 4:T$╡г(б(я("FF00")))╙г(б(я("FF01"))) ╪'пRT╡0 о'з▀ T$Ё╠"SK" ╖Ч (ДBG╡0:FG╡5:BO╡6:HL╡2:SB╡14 : ▐ STANDARD COLOURS (НCF$╡"" : BU╡1 : RT╡1 ?(Ь≈ $4FF00,ф("S"):≈ $4FF01,ф("K") c(≈ $4FF00,ф("S"):≈ $4FF01,ф("K") ▐(≈ $4FF02,BO : ≈ $4FF03,BG : ≈ $4FF04,FG ╜(≈ $4FF05,HL : ≈ $4FF06,SB й( ≈ $4FF10,0  : ▐ FILENAME я(*Ч ъ(4▀ RT╡1 ╖▌ )9█ 2200:▐ INJECT AUTOLOAD INTO $4FF10 ()>TF$╡"":I╡$4FF10:К Щ б(I)Ё╠0 D)HTF$╡TF$╙г(б(I)):I╡I╙1:Л o)RBO╡б($4FF02):BG╡б($4FF03):FG╡б($4FF04) █)\HL╡б($4FF05):SB╡б($4FF06) ╓)aSM ╡ б($4FF07)╞2╛5 ╥)fCF$╡TF$:Ч 128 ╫)p▌ д)zж┌ у)└│T╡0╓400:║T$ Ф)▌▀T$╡"P"╖LP╡1 Ь)≤▀T$╡"C"╖CB╡╚1 *╒┌T:▌ *╛▐ --- VERSION MISMATCH J*╤≥ "ROM VERSION TOO OLD▓"╙г(27)╙г(27) }*ю≥ "ROM VERSION >= ";:≥ Ш"######";MV;:≥ "▓ "; ╞*й≥ "REQUIRED, BUT VERSION ";V$;"▓ INSTALLED!" Е*т≥ "SORRY FOR THE INCONVENIENCE. PLEASE UPDATE "; +ч ≥ "YOUR MEGA65 AND TRY AGAIN." +ХК:Л +Р▌ (+Э▐ --- PALETTE 6+│ R╡0 ╓ 7 R+Ч4 Г 16╙R,15,15╚(R╛2),R Z+┌ R t+$Ч 1:BA╡$FF80000:A╡80 ┌+.│ R╡0 ╓ 7 °+8Ч! 3,80,R╟64,BA╙(R╛A) ╒+B┌ ╗+L▌ ©+V▐ --- LOAD MODULES м+`▀ CB ╖ Ч И+j≥"INSTALLING EDITOR...'" ,tЧ "11.EDIT",P($8000000) ",~≥"INSTALLING PARSER..." @,┬Ч "11.PARSE",P($8010000) [,▓≥"INSTALLING PREFS..." |,°Ч "11.SETTINGS",P($8020000) ⌡,╕≥"INSTALLING TOKENIZER..." ╪,╟Ч "11.TOKENIZE",P($8022000) ъ,╨≥"INSTALLING POST COMPILER..." Э,дЧIM-FANDANGO/MEGAPLOT/BLOB/MASTER/MEGAPLOT.A'--------.DECLARES'--------#DECLARE пиь╞тл = 126#DECLARE пиь╞тр = 124#DECLARE пиь╞бл = 123#DECLARE пиь╞бр = 108#DECLARE пиь╞инж╞тл = 254#DECLARE пиь╞инж╞тр = 252#DECLARE пиь╞инж╞бл = 251#DECLARE пи#ь╞инж╞бр = 236#DECLARE пиь╞диаг╞тл╞бр = 127#DECLARE пиь╞диаг╞бл╞тр = 255#DECLARE пиь╞хлине╞бот = 98#DECLARE пиь╞хлине╞топ = 226#DECLARE пиь╞жлине╞лефт = 97#DECLARE пиь╞жлине╞ригхт = 225#DECLARE пиь╞ноне = 32#DECLARE пиь╞алл = 160#DECLARE пи = 3.141592654269'----.VARS'----#DECLARE X1, Y1, X2, Y2#DECLARE DX, DY, MX, MY, CX, CY#DECLARE CUR╞CHAR, PIX#DECLARE DIFFX, DIFFY, DELTAX, DELTAY, TANVAL, ANGLE#DECLARE A$, ANG, LINE╞LENGTH, K, DEBUG#DECLARE CENTREX, CENTREY, CENTREZ#DECLARE P%#OUTPUT "BASLOGO"' банк4 мEMORY USAGE' ------------------' 4.0000 дма-лист' 4.0020 VAR INTERFACE TO ASSEMBLY'        0020: PTR TO DEFAULT╞RED&'        0022: PTR TO DEFAULT╞GREEN&'        0024: PTR TO DEFAULT╞BLUE&'        0026: PTR TO CURR╞RED&&'        0028: PTR TO CURR╞GREEN&'        002A: PTR TO CURR╞BLUE&'        002C: PTR TO DATA╞ADDR%'        002E: PTR TO CDATA╞ADDR%'        0030: PTR TO SCRADDR%'        0032: PTR TO CLRADDR%'        0034: PTR TO INC%' 4.0800 сцреен меморы' 4.2000 петсции грапхицс FOR бас LOGO' банк5 мEMORY USAGE' ------------------' 5.0000 SCREEN BUFFER FOR DRAW╞PETSCII╞FRAME' 5.1000 COLOR RAM BUFFER FOR DRAW╞PETSCII╞FRAME.DEFINES#DECLARE K, PTR, TMP, MAX╞FRAMES, FRM╞IDX, FRMW, FRMH, SZ#DECLARE FRAME╞AD  "11.POST",P($8024000) -нЧ 	-ь▌ %-Б▐ --- CHAIN LOAD EDITOR +-Л: ▄-Ж≥"⌠EDMA 0,$D400,$8000000,$2001:NEW RESTORE":≥"RUN";:▐ LOAD '11.EDIT' FROM ATTIC CACHE ≈- Ч 128 ²-
: и-▐ HACK: LOAD NEXT MODULE IN DIRECT MODE .▐ THIS WILL GO AWAY ONRUN/STOP  TRAP  PRINT ERR$(ER);" ERROR"  PRINT " IN LINE";EL  KEY ON  END.CHUNK╞SEQUENCER'---------------  DO WHILE 1    GOSUB DRAW╞SEQUENCE    GOSUB GET╞USER╞INPUT╞FOR╞SEQUENCE    IF A$ = кеы╞мега╞я THEN EXIT  LOOP  RETURN.DRAW╞SEQUENCE'-------------  PRINT "⌠SEQUENCE EDITOR"  PRINT "---------------"  PRINT "а)DD и)NSERT д)ELETE, еDIT=ртн, пLAYаLL=схфт+ртн, пLAY=спц - SEQCNT = ";SEQCNT  PRINT "ц: EDIT цмд, есц: STOP MUSIC, мега+я: EXIT"  PRINT " цMD            еXTRA"           PRINT " ---            -----"  IF INT((SEQCNT-1)/43) > 1 AND (INT(SEQ╞OFFS/43)+1) < INT((SEQCNT-1)/43) THEN BEGIN    'IF INT((SEQCNT-1) / 43) * 43 > SEQ╞OFFS THEN BEGIN      CURSOR 75, 5:PRINT "--->"    'BEND  BEND  IF SEQ╞OFFS > 0 THEN BEGIN    CURSOR 70, 5:PRINT "<---"  BEND  K = SEQ╞OFFS  DO WHILE K < SEQCNT    IF K > (SEQ╞OFFS + 43 * 2 - 1) THEN K=SEQCNT:GOTO NXT    IF (K-SEQ╞OFFS) >= 43 THEN CURSOR 40,6+(K-SEQ╞OFFS-43)    IF PLYPTR = K THEN PRINT ">";:ELSE PRINT " ";    S=0:GOSUB HIGHLIGHT╞SELECTED╞SEQ╞COLUMN    ' CHUNK IS A SPECIAL цмд╞*?    IF SEQ╞CHUNK(K) < 0 AND ABS(SEQ╞CHUNK(K)) < цмд╞маь THEN BEGIN      V$ = SEQ╞CMDNAME$(ABS(SEQ╞CHUNK(K)))      S = 10-LEN(V$)      PRINT V$;      DO WHILE S >= 0        PRINT " ";        S = S - 1      LOOP    BEND:ELSE BEGIN      PRINT SEQ╞CHUNK(K);кеы╞таб;    BEND    S=1:GOSUB HIGHLIGHT╞SELECTED╞SEQ╞COLUMN    HANDLED = 0    IF SEQ╞CHUNK(K) = цмд╞филтер THEN BEGIN      HANDLED = 1      IF SEQ╞EXTRA(K) = -1 THEN PRINT кеы╞таб;"<NONE>":ELSE BEGIN        PRINT кеы╞таб;FILT╞NAME$(SEQ╞EXTRA(K))      BEND    BEND    IF HANDLED=0 AND SEQ╞CHUNK(K) = цмд╞темпо THEN BEGIN      HANDLED = 1      PRINT кеы╞таб;SEQ╞EXTRA(K)    BEND    ' елсе    IF HANDLED = 0 THEN BEGIN       PRINT кеы╞таб;SEQ╞EXTRA(K)    BEND    PRINT кеы╞реж╞офф;.NXT    K = K + 1  LOOP    RETURN.HIGHLIGHT╞SELECTED╞SEQ╞COLUMN'-----------------------------  IF SEQPTR = K AND SSCOL=S THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  RETURN.GET╞U	SER╞INPUT╞FOR╞SEQUENCE'---------------------------  GOSUB READ╞KEY╞LOOP  IF A$="A" THEN GOSUB ADD╞CHUNK╞TO╞SEQ  IF A$="I" THEN GOSUB INSERT╞CHUNK╞TO╞SEQ  ' IF A$="E" THEN GOSUB EDIT╞CHUNK╞SEQ  IF A$="D" THEN GOSUB DELETE╞CHUNK╞SEQ  IF A$=кеы╞уп 
AND SEQPTR > 0 THEN SEQPTR = SEQPTR - 1  IF A$=кеы╞довн AND SEQPTR < SEQCNT-1 THEN SEQPTR = SEQPTR + 1   IF A$=кеы╞лефт THEN BEGIN    IF SSCOL = 1 THEN BEGIN      SSCOL = 0    BEND:ELSE BEGIN      IF (SEQPTR-43)>=0 THEN BEGIN        SSCOL = 1        SEQPTR = SEQPTR - 43      BEND    BEND  BEND  IF A$=кеы╞ригхт THEN BEGIN    IF SSCOL = 0 THEN BEGIN      SSCOL = 1    BEND:ELSE BEGIN      IF (SEQPTR+43) < SEQCNT THEN BEGIN        SSCOL = 0        SEQPTR = SEQPTR + 43      BEND    BEND  BEND  IF A$=кеы╞схифт╞ретурн THEN BEGIN    PLYPTR = 0    PLYFLAG = 1    CHUNK╞RPT = 0    PLAY    GOSUB SET╞ALL╞ENV    TEMPO TMPO%  BEND  IF A$=кеы╞спаце THEN BEGIN    PLYPTR = SEQPTR    PLYFLAG = 1    CHUNK╞RPT = 0    PLAY    GOSUB SET╞ALL╞ENV    TEMPO TMPO%  BEND  IF A$=кеы╞ретурн THEN GOSUB EDIT╞CHUNK╞CELL  IF A$="C" THEN GOSUB EDIT╞CHUNK╞CMD  IF A$=кеы╞есцапе THEN GOSUB STOP╞ALL╞MUSIC  IF A$=кеы╞хоме THEN SEQPTR = 0  IF A$=кеы╞цлр THEN SEQPTR = SEQCNT-1  ' FINALLY, ADJUST SEQ╞OFFS IF NEEDBE  IF (INT(SEQPTR / 43) * 43) < SEQ╞OFFS THEN SEQ╞OFFS = SEQ╞OFFS - 43  IF (INT(SEQPTR / 43) * 43) > (SEQ╞OFFS+43) THEN SEQ╞OFFS = SEQ╞OFFS + 43  RETURN.STOP╞ALL╞MUSIC'--------------  PLYPTR = -1  PLYFLAG = 0  PLAY  GOSUB SET╞ALL╞ENV  TEMPO TMPO%  GOSUB APPLY╞SELECTED╞FILTER  RETURN.DELETE╞CHUNK╞SEQ'----------------  IF SEQCNT = 0 THEN RETURN  K = SEQPTR  DO WHILE K < SEQCNT - 1    SEQ╞CHUNK(K) = SEQ╞CHUNK(K + 1)    SEQ╞EXTRA(K) = SEQ╞EXTRA(K + 1)    K = K + 1  LOOP  SEQCNT = SEQCNT - 1  IF SEQPTR = SEQCNT AND SEQPTR>0 THEN SEQPTR = SEQPTR - 1  RETURN.EDIT╞CHUNK╞SEQ'--------------  IF SEQCNT = 0 THEN RETURN  PRINT кеы╞хоме;кеы╞таб;кеы╞таб;кеы╞есцапе;"Q";  V=0:INPUT "CHUNK#: ", V  SEQ╞CHUNK(SEQPTR) = V  PRINT кеы╞хоме;кеы╞таб;кеы╞таб;кеы╞есцапе;"Q";  V=-1:INPUT "EXTRA#: ", V  SEQ╞EXTRA(SEQPTR) = V  RETURN.EDIT╞CHUNK╞CELL'---------------  IF SEQCNT = 0 THEN RETURN  PRINT кеы╞хоме;кеы╞таб;кеы╞таб;кеы╞есцапе;"Q";  IF SSCOL = 0 THEN BEGIN    V = SEQ╞CHUNK(SEQPTR)    V1$ = STR$(V)    IF LEFT$(V1$,1) = " " THEN V1$=MID$(V1$,2)    PRINT "CHUNK#: ";кеы╞есцапе;"^";V1$;кеы╞есцапе;"_";    INPUT "", V    SEQ╞CHUNK(SEQPTR) = V  BEND  IF SSCOL = 1 THEN BEGIN    V = SEQ╞EXTRA(SEQPTR)    V1$ = STR$(V)    IF LEFT$(V1$,1) = " " THEN V1$=MID$(V1$,2)    PRINT "EXTRA#: ";кеы╞есцапе;"^";V1$;кеы╞есцапе;"_";    INPUT "", V    SEQ╞EXTRA(SEQPTR) = V  BEND  RETURN.EDIT╞CHUNK╞CMD'--------------  V = -SEQ╞CHUNK(SEQPTR)  PRINT кеы╞цлр;  FOR ROW = 1 TO цмд╞маь - 1    PRINT ROW;":"; SEQ╞CMDNAME$(ROW)  NEXT ROW  PRINT  INPUT "CMD: ", V  IF V > 0 THEN SEQ╞CHUNK(SEQPTR) = -V  RETURN.INSERT╞CHUNK╞TO╞SEQ'-------------------  SEQCNT = SEQCNT + 1  ' MOVE ALL HIGHER CHUNK SEQUENCES UP ONE  K = SEQCNT - 2  DO WHILE K >= SEQPTR    SEQ╞CHUNK(K+1) = SEQ╞CHUNK(K)    SEQ╞EXTRA(K+1) = SEQ╞EXTRA(K)    K = K - 1  LOOP  SEQ╞CHUNK(SEQPTR) = 0  SEQ╞EXTRA(SEQPTR) = 0  RETURN.ADD╞CHUNK╞TO╞SEQ'----------------  SEQPTR = SEQCNT  SE LQCNT = SEQCNT + 1  SEQ╞CHUNK(SEQPTR) = 0  SEQ╞EXTRA(SEQPTR) = 0  RETURN                                                                                                                                                                                     
 
 Ы Ч$   ≥ "⌠BOOT MENU:" J  ≥ "(USE SHIFT TO LOAD COMPILED BINARY)" P ( ≥ _ 2 ≥ "ELEVEN" n < ≥ "======" ∙ F ≥ "1) LINE.EL (TRY LOAD 'ANA.LN')" ╙ P ≥ "2) ROTATE.EL" ц Z ≥ "3) SPRITELINE.EL" Н d ≥ "4) MELODY.EL (TRY LOAD 'ENIGMA.P')" !n ≥ "5) VART.#OUTPUT "LINE"' кEYS:' ----'  уP/дOWN/лEFT/рIGHT = мOVE CURSOR POSITION'  цтрл+9/0 = сET REVERSE ON/OFF'  ф1 = LOAD FILE'  ф3 = SAVE FILE'  ф5 = PLAY DATA'  ф7 = TOGGLE GROUP FLAG'       - ADDS $FF (START) OR $FE (STOP) TO DATA STREAM'         THE INTENT IS TO DRAW SUCH GROUPS IN ONE HIT'         (RATHER THAN CHAR BY CHAR)'  ф9 = TOGGLE BETWEEN VERSION 1 OR 2 OF FILE FORMAT (DEFAULT VER2)'  алт+лEFT/рIGHT = SCROLL CANVAS LEFT/RIGHT.DECLARES'--------#DECLARE A$, Z$, LOC, K, V, DEBUG=0#DECLARE X=0, Y=0, XX, YY#DECLARE T0=0#DECLARE MODIFIED%=0#DECLARE OLDX, OLDY, OLDOFFS#DECLARE FNAME$, ALT╞KEY#DECLARE LDATA&(12288), DIDX%=0, PIDX%=0#DECLARE GROUP╞FLAG&, VAL&, REV╞FLAG& = 0#DECLARE OFFS, VER=2#DECLARE LASTFLAG, LAST╞GROUP╞IDX.DEFINES'-------#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE дст╞дец = 32#DEFINE срц╞дец = 16.KEYS'----#DEFINE кеы╞уп = "▒"#DEFINE кеы╞довн = ""#DEFINE кеы╞лефт = "²"#DEFINE кеы╞ригхт = ""#DEFINE кеы╞спаце = " "#DEFINE кеы╞дел = ""#DEFINE кеы╞цтрл╞в = ""#DEFINE кеы╞цтрл╞у = ""#DEFINE кеы╞мега╞я = "╚"#DEFINE кеы╞ф1 = "┘"#DEFINE кеы╞ф3 = "├"#DEFINE кеы╞ф4 = "┼"#DEFINE кеы╞ф5 = "┤"#DEFINE кеы╞ф6 = "▀"#DEFINE кеы╞ф7 = "┬"#DEFINE кеы╞ф8 = "▄"#DEFINE кеы╞ф9 = ""#DEFINE кеы╞ф10 = ""#DEFINE кеы╞ретурн = CHR$(13)#DEFINE кеы╞есцапе = CHR$(27)#DEFINE кеы╞схифт╞ретурн = CHR$(141)#DEFINE кеы╞схифт╞плус = "ш"#DEFINE кеы╞схифт╞минус = "щ"#DEFINE кеы╞реж╞он = ""#DEFINE кеы╞реж╞офф = "▓"#DEFINE кеы╞таб = CHR$(9)#DEFINE кеы╞хоме = ""#DEFINE кеы╞цлр  = "⌠"#DEFINE кеы╞ловерцасе = CHR$(14)#DEFINE кеы╞упперцасе = CHR$(142)#DEFINE кеы╞бееп = CHR$(7)#DEFINE кеы╞инст = "■"#DEFINE кеы╞дел  = ""#DEFINE кеы╞мега╞к = "║"#DEFINE кеы╞мега╞й = "╣"#DEFINE кеы╞мега╞х = "╢"#DEFINE кеы╞мега╞л = "╤"GOSUB INIT.MAINGOSUB CHECK╞INPUTGOSUB SHOW╞CURSORGOTO MAIN'----.INIT'----  KEY OFF  ' SWITCH BACK TO UPPER-CASE  ' POKE $D018, PEEK($D018) AND $FD  OLDX = -1 : OLDY = -1 : OLDOFFS '= 0  DIDX% = 0  GROUP╞FLAG& = 0 : REV╞FLAG& = 0  PRINT "⌠";  POKE $D020, 11  POKE $D021, 0  OFFS = 0  RETURN'-----------.CHECK╞INPUT'-----------  GET A$  GOSUB CHECK╞ALT╞KEY╞INPUTS  IF A$<>"" THEN GOSUB DRAW╞INFO  IF A$=кеы╞лефт AND X>0 !EL" !x ≥ "6) GRABBER.EL" *!┌ ≥ "7) FOOT.EL" @!▄ ≥ "8) BASLOGO.EL" U!█ ≥ "9) WRITER.EL" k!▌ ≥ "A) PETLINE.EL" ┐!▐ ≥ "B) STARFIELD.EL" ┴!∙ ≥ ═!√ ≥ "MEGA ASSEMBLER" ╥!═ ≥ "==============" м!╙ ≥ "Z) ROTATE.ASM" ь!╢ ║ Ы A$ З!╬ ▀ A$╡"1" ╖ Z$╡"LINE.EL":┴ 390 ""х ▀ A$╡"2" ╖ Z$╡"ROTATE.EL":┴ 390 F"р ▀ A$╡"3" ╖ Z$╡"SPRITELINE.EL":┴ 390 j"э ▀ A$╡"4" ╖ Z$╡"MELODY.EL":┴ 390 ▄"Ф ▀ A$╡"5" ╖ Z$╡"VART.EL":┴ 390 ╠"П ▀ A$╡"6" ╖ Z$╡"GRABBER.EL":┴ 390 с"З ▀ A$╡"7" ╖ Z$╡"FOOT.EL":┴ 390 Ь"▀ A$╡"8" ╖ Z$╡"BASLOGO.EL":┴ 390 ##▀ A$╡"9" ╖ Z$╡"WRITER.EL":┴ 390 A#▀ A$╡"A" ╖ Z$╡"PETLINE.EL":┴ 390 h#▀ A$╡"B" ╖ Z$╡"STARFIELD.EL":┴ 390 ╢#▀ A$╡"Z" ╖ °:≥ "⌠AUTOLOAD ";г(34);"ROTATE.ASM";г(34):П "MEGA ASSEMBLER" ш#"▀ A$╡"!" ╖ ≥ г(27);"5";:°:П "LINE" Ы#,▀ A$╡г(34) ╖ °:П "ROTATE4$" $6▀ A$╡"#" ╖ °:П "SPRITELINE" 8$@▀ A$╡"$" ╖ °:П "PLAYMAKER" R$J▀ A$╡"%" ╖ °:П "VART" |$T▀ A$╡"&" ╖ °:≥ г(27);"5";:П "GRABBER" √$^▀ A$╡"'" ╖ °:П "FOOT" Ё$h▀ A$╡"(" ╖ °:П "BASLOGO" о$r▀ A$╡")" ╖ °:П "WRITER" Л$w▀ A$╡"а" ╖ °:П "PETLINE" %x▀ A$╡&#OUTPUT "PETLINE"' DRAW LINES IN 80X50 WITH PETSCII BLOCK CHARS' GIVING A FULL RESOLUTION OF 160X100' ноте: вHEN и LATER WANT TO MOVE THE LOGIC INTO ASSEMBLY,' CONSIDER REFERENCING GRIM FANDANGO'S мегаплот ASSEMBLY SOURCE:' - HTTPS://GITHUB.COM/GR!#OUTPUT "PETLINE"' DRAW LINES IN 80X50 WITH PETSCII BLOCK CHARS' GIVING A FULL RESOLUTION OF 160X100' ноте: вHEN и LATER WANT TO MOVE THE LOGIC INTO ASSEMBLY,' CONSIDER REFERENCING GRIM FANDANGO'S мегаплот ASSEMBLY SOURCE:' - HTTPS://GITHUB.COM/GR"IM-FANDANGO/MEGAPLOT/BLOB/MASTER/MEGAPLOT.A'--------.DECLARES'--------#DECLARE пиь╞тл = 126#DECLARE пиь╞тр = 124#DECLARE пиь╞бл = 123#DECLARE пиь╞бр = 108#DECLARE пиь╞инж╞тл = 254#DECLARE пиь╞инж╞тр = 252#DECLARE пиь╞инж╞бл = 251#DECLARE пи THEN GOSUB RESTORE╞CHAR : X=X-1 : RETURN  IF A$=кеы╞ригхт AND X<78 THEN GOSUB RESTORE╞CHAR : X=X+1 : RETURN  IF A$=кеы╞уп AND Y>0 THEN GOSUB RESTORE╞CHAR : Y=Y-1 : RETURN            IF A$=кеы╞довн AND Y<49 THEN GOSUB RESTORE╞CHAR : Y=Y+1 : RETURN  IFLTER╞HIGHLIGHT'---------------------------  IF FSROW = FPRESET AND FFOCUS = 1 AND FSCOL = K THEN _    PRINT кеы╞реж╞он; : ELSE PRINT кеы╞реж╞офф;  RETURN.GET╞VAL'-------  IF SCOL = 0 THEN V$ = ENVS╞NAME$(SROW)  IF SCOL = 1 THEN V = ENVS╞ATTACK(SROW)  IF SCOL = 2 THEN V = ENVS╞DECAY(SROW)  IF SCOL = 3 THEN V = ENVS╞SUSTAIN(SROW)  IF SCOL = 4 THEN V = ENVS╞RELEASE(SROW)  IF SCOL = 5 THEN V = ENVS╞WAVEFORM(SROW)  IF SCOL = 6 THEN V = ENVS╞PW(SROW)  RETURN.SHOW╞CELL'---------  IF SROW=ROW AND SCOL = COL AND FFOCUS=0 THEN PRINT кеы╞реж╞он;:ELSE PRINT кеы╞реж╞офф;  IF COL = 0 THEN BEGIN    PRINT V$;кеы╞таб;"▓";    RETURN  BEND  IF COL = 5 THEN BEGIN    PRINT WNAME$(V);кеы╞таб;кеы╞реж╞офф;    RETURN  BEND  ' ELSE  PRINT V;кеы╞таб;кеы╞реж╞офф;  RETURN.GET╞USER╞INPUT╞FOR╞TABLE'------------------------  ' GET KEY A$  GOSUB READ╞KEY╞LOOP  IF A$ = кеы╞лефт AND SCOL > 0 THEN SCOL = SCOL - 1  IF A$ = кеы╞ригхт AND SCOL < 6 THEN SCOL = SCOL + 1  IF A$ = кеы╞уп AND SROW > 0 THEN SROW = SROW - 1  IF A$ = кеы╞довн AND SROW < 9 THEN SROW = SROW + 1  IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCR╞VAL  IF A$ = "-" THEN DELTA=1 : GOSUB DECR╞VAL  IF A$ = кеы╞схифт╞плус THEN DELTA=100 : GOSUB INCR╞VAL  IF A$ = кеы╞схифт╞минус THEN DELTA=100 : GOSUB DECR╞VAL  IF A$ = кеы╞ретурн THEN A$ = "+" : GOSUB EDIT╞ENV╞FIELD  IF A$ = кеы╞схифт╞ретурн THEN A$ = "-" : GOSUB EDIT╞ENV╞FIELD  IF A$ = кеы╞таб THEN FFOCUS = 1 : GOSUB GET╞USER╞INPUT╞FOR╞FILTERS  GOSUB CHECK╞DURATION╞CHANGE  GOSUB CHECK╞PIANO╞KEYS  RETURN.GET╞USER╞INPUT╞FOR╞FILTERS'--------------------------  DO WHILE 1    GOSUB DRAW╞TABLE    ' GET KEY A$    GOSUB READ╞KEY╞LOOP    IF A$ = кеы╞лефт AND FSCOL > 0 THEN FSCOL = FSCOL - 1    IF A$ = кеы╞ригхт AND FSCOL < 8 THEN FSCOL = FSCOL + 1    IF A$ = кеы╞уп AND FSROW > 0 THEN FSROW = FSROW - 1    IF A$ = кеы╞довн AND FSROW < 10 THEN FSROW = FSROW + 1    IF A$ = "+" OR A$="=" THEN DELTA=1 : GOSUB INCR╞FVAL    IF A$ = "-" THEN DELTA=1 : GOSUB DECR╞FVAL 	   IF A$ = кеы╞схифт╞плус THEN DELTA = 100 : GOSUB INCR╞FVAL    IF A$ = кеы╞схифт╞минус THEN DELTA = 100 : GOSUB DECR╞FVAL    IF A$ = " " THEN BEGIN      IF FSEL = FSROW THEN FSEL = -1:ELSE FSEL = FSROW      GOSUB APPLY╞SELECTED╞FILTER    BEND   
 IF A$ = кеы╞ретурн THEN GOSUB EDIT╞FILTER╞FIELD:GOSUB APPLY╞SELECTED╞FILTER    IF A$ = кеы╞таб OR A$ = кеы╞мега╞я THEN EXIT    GOSUB CHECK╞DURATION╞CHANGE    GOSUB CHECK╞PIANO╞KEYS  LOOP  FFOCUS = 0  RETURN.READ╞KEY╞LOOP'-------------  A$ = ""  DO WHILE A$=""    GET A$    IF FSEL <> -1 THEN BEGIN      GOSUB UPDATE╞SELECTED╞FILTER    BEND    IF PLYFLAG = 1 THEN BEGIN      IF RPLAY(1) = 0 THEN GOSUB PARSE╞CURRENT╞SEQPTR    BEND  LOOP  RETURN.PARSE╞CURRENT╞SEQPTR'--------------------  K = SEQ╞CHUNK(PLYPTR)    IF K >= 0 THEN BEGIN    CHUNK╞IDX = K    IF CHUNK╞RPT <= 0 THEN CHUNK╞RPT = SEQ╞EXTRA(PLYPTR)    GOSUB PLAY╞CHUNK╞IDX    SLEEP .1    GOSUB DRAW╞SEQUENCE  BEND  IF K = цмд╞темпо THEN BEGIN    K = SEQ╞EXTRA(PLYPTR)    TEMPO (K)    TMPO% = K  BEND  IF K = цмд╞филтер THEN BEGIN    K = SEQ╞EXTRA(PLYPTR)    FSROW = K    FSEL = K    GOSUB APPLY╞SELECTED╞FILTER  BEND  IF K = цмд╞ецхо╞м1 THEN ECHO╞M = 1 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞м2 THEN ECHO╞M = 2 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞б  THEN ECHO╞B = 1 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞офф THEN ECHO╞M = 0 : ECHO╞B = 0  IF K = цмд╞ецхо╞сз THEN ECHO╞SZ = SEQ╞EXTRA(PLYPTR)  IF K = цмд╞делаы THEN ECHO╞DELAY = 1 : ECHO╞M = 0 : ECHO╞B = 0  IF K = цмд╞жол THEN V = SEQ╞EXTRA(PLYPTR) : VOL V, V  IF CHUNK╞RPT > 0 THEN CHUNK╞RPT = CHUNK╞RPT - 1  IF CHUNK╞RPT <= 0 THEN PLYPTR = PLYPTR + 1  IF K = цмд╞лооп THEN PLYPTR = 0  IF PLYPTR >= SEQCNT THEN PLYFLAG = 0 : PLYPTR = -1  RETURN.CHECK╞DURATION╞CHANGE'---------------------  FOR K = д╞вхоле TO д╞сиьтеентх    IF A$ = DUR$(K, дкеы) THEN SDUR = K  NEXT K  ' CHECK OCTAVE TOO  IF A$ = ">" AND OCT < 6 THEN OCT = OCT + 1  IF A$ = "<" AND OCT > 0 THEN OCT = OCT - 1  RETURN.UPDATE╞SELECTED╞FILTER'----------------------  IF FSEL = -1 THEN RETURN  IF CURR╞DIR = дир╞ноне THEN RETURN  PRINT "";кеы╞таб;кеы╞таб;кеы╞таб;кеы╞таб;кеы╞таб;CHR$(27);"QCURR╞FREQ=";CURR╞FREQ;    ' ноте: цAN'T USE сетбит FOR сид REGISTERS AS THE REGS ARE WRITE-ONLY  '       (сетбит WILL INTERNALLY NEED A READ PRIOR TO THE WRITE)  ' буг? и COULDN'T DO поке $д415 (IT BECAME 868691 = $д4153 ?!)  WPOKE 54293, (CURR╞FREQ AND 7) + ((CURR╞FREQ >> 3) * 256)  WPOKE 54357, (CURR╞FREQ AND 7) + ((CURR╞FREQ >> 3) * 256)  IF CURR╞DIR = дир╞уп THEN BEGIN    CURR╞FREQ = CURR╞FREQ + FILT╞SWEEP(FSEL)    IF CURR╞FREQ > FILT╞FREQ(FSEL) THEN BEGIN      CURR╞FREQ = FILT╞FREQ(FSEL)      IF FILT╞DIR(FSEL) = дир╞осц THEN CURR╞DIR = дир╞довн      IF FILT╞DIR(FSEL) = дир╞уп THEN CURR╞FREQ = FILT╞MIN(FSEL)    BEND    RETURN  BEND  IF CURR╞DIR = дир╞довн THEN BEGIN    CURR╞FREQ = CURR╞FREQ - FILT╞SWEEP(FSEL)    IF CURR╞FREQ < FILT╞MIN(FSEL) THEN BEGIN      CURR╞FREQ = FILT╞MIN(FSEL)      IF FILT╞DIR(FSEL) = дир╞осц THEN CURR╞DIR = дир╞уп      IF FILT╞DIR(FSEL) = дир╞довн THEN CURR╞FREQ = FILT╞FREQ(FSEL)    BEND    RETURN  BEND  RETURN.APPLY╞SELECTED╞FILTER'---------------------  IF FSEL = -1 THEN RETURN  CURR╞FREQ = FILT╞FREQ(FSEL)  CURR╞DIR = дир╞ноне  IF   FILT╞DIR(FSEL) = дир╞уп _    OR FILT╞DIR(FSEL) = дир╞осц THEN BEGIN    CURR╞FREQ = FILT╞MIN(FSEL)    CURR╞DIR = дир╞уп  BEND  IF FILT╞DIR(FSEL) = дир╞довн THEN BEGIN    CURR╞DIR = дир╞довн  BEND  FILTER 1, FILT╞FREQ(FSEL), FILT╞LP(FSEL), _          FILT╞BP(FSEL), FILT╞HP(FSEL), FILT╞RES(FSEL)  FILTER 2, FILT╞FREQ(FSEL), FILT╞LP(FSEL), _          FILT╞BP(FSEL), FILT╞HP(FSEL), FILT╞RES(FSEL)  RETURN.CHANGE╞ENV╞NAME'---------------  V$=""  INPUT "NEW NAME: ",V$  IF V$<>"" THEN ENVS╞NAME$(SROW) = V$  RETURN.EDIT╞ENV╞FIELD'--------------  IF SCOL = 0 THEN GOSUB CHANGE╞ENV╞NAME : RETURN  IF SCOL = 6 THEN BEGIN    V$=""    INPUT "NEW VALUE: ",V$    V = VAL(V$)    IF V > 4095 THEN V = 4095    IF V < 0 THEN V = 0    ENVS╞PW(SROW) = V    RETURN  BEND  IF A$="+" THEN DELTA=1 : GOSUB INCR╞VAL  IF A$="-" THEN DELTA=1 : GOSUB DECR╞VAL  RETURN.EDIT╞FILTER╞FIELD'-----------------  IF FSCOL = 2 THEN V=FILT╞LP(FSROW):V=MOD(V+1,2):FILT╞LP(FSROW)=V:RETURN  IF FSCOL = 3 THEN V=FILT╞BP(FSROW):V=MOD(V+1,2):FILT╞BP(FSROW)=V:RETURN  IF FSCOL = 4 THEN V=FILT╞HP(FSROW):V=MOD(V+1,2):FILT╞HP(FSROW)=V:RETURN  IF FSCOL = 6 THEN V=FILT╞DIR(FSROW):V=MOD(V+1,4):FILT╞DIR(FSROW)=V:RETURN  V$=""  INPUT "NEW VALUE: ",V$  IF V$<>"" THEN BEGIN    IF FSCOL = 0 THEN FILT╞NAME$(FSROW) = V$    IF FSCOL = 1 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILT╞FREQ(FSROW) = V    BEND    IF FSCOL = 5 THEN BEGIN      V = VAL(V$)      IF V > 15 THEN V = 15      IF V < 0 THEN V = 0      FILT╞RES(FSROW) = V    BEND    IF FSCOL = 6 THEN BEGIN      V = VAL(V$)      IF V > 3 THEN V = 3      IF V < 0 THEN V = 0      FILT╞DIR(FSROW) = V    BEND    IF FSCOL = 7 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILT╞MIN(FSROW) = V    BEND    IF FSCOL = 8 THEN BEGIN      V = VAL(V$)      IF V > 2047 THEN V = 2047      IF V < 0 THEN V = 0      FILT╞SWEEP(FSROW) = V    BEND  BEND.CHECK╞PIANO╞KEYS'----------------  ' APPLY FILTER  PSTR$ = "X0"  IF FSEL <> -1 THEN PSTR$ = "X1"  ' DECIDE NOTE LENGTH  PSTR$ = PSTR$ + DUR$(SDUR, дцхар)  ' DECIDE OCTAVE  PSTR$ = PSTR$ + "O" + STR$(OCT)  ' WHICH NOTE TO PLAY  FOR K = 0 TO 11    IF A$ = KEYS╞IN$(K) THEN PSTR$ = PSTR$ + KEYS╞OUT$(K)  NEXT K  IF LEN(PSTR$)>0 THEN BEGIN    PLAY "T"+STR$(SROW)+PSTR$  BEND  RETURN.INCR╞VAL'--------  GOSUB GET╞VAL  MAXV = 15  IF SCOL = 5 THEN MAXV = 4  IF SCOL = 6 THEN MAXV = 4095  V = V + DEL TA  IF V > MAXV THEN V = MAXV  GOSUB APPLY╞VAL  RETURN.DECR╞VAL'--------  GOSUB GET╞VAL  V = V - DELTA  IF V < 0 THEN V = 0  GOSUB APPLY╞VAL  RETURN.INCR╞FVAL'---------  IF FSCOL = 1 THEN BEGIN    V = FILT╞FREQ(FSROW) + DELTA    IF V !> 2047 THEN V = 2047    FILT╞FREQ(FSROW) = V  BEND  IF FSCOL = 2 THEN FILT╞LP(FSROW) = 1  IF FSCOL = 3 THEN FILT╞BP(FSROW) = 1  IF FSCOL = 4 THEN FILT╞HP(FSROW) = 1  IF FSCOL = 5 THEN BEGIN    V = FILT╞RES(FSROW) + DELTA    IF V > 15 THEN V = 1"5    FILT╞RES(FSROW) = V  BEND  IF FSCOL=6 AND FILT╞DIR(FSROW) < 3 THEN FILT╞DIR(FSROW) = FILT╞DIR(FSROW) + 1  IF FSCOL=7 AND FILT╞MIN(FSROW) < 2047 THEN BEGIN    V = FILT╞MIN(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILT╞MIN(FSROW) = V  #BEND      IF FSCOL=8 AND FILT╞SWEEP(FSROW) < 2047 THEN BEGIN    V = FILT╞SWEEP(FSROW) + DELTA    IF V > 2047 THEN V = 2047    FILT╞SWEEP(FSROW) = V  BEND  GOSUB APPLY╞SELECTED╞FILTER  RETURN.DECR╞FVAL'---------  IF FSCOL = 1 THEN BEGIN    $V = FILT╞FREQ(FSROW) - DELTA    IF V < 0 THEN V = 0    FILT╞FREQ(FSROW) = V  BEND  IF FSCOL = 2 THEN FILT╞LP(FSROW) = 0  IF FSCOL = 3 THEN FILT╞BP(FSROW) = 0  IF FSCOL = 4 THEN FILT╞HP(FSROW) = 0  IF FSCOL = 5 THEN BEGIN    V = FILT╞RES(FSROW) %- DELTA    IF V < 0 THEN V = 0    FILT╞RES(FSROW) = V  BEND  IF FSCOL=6 AND FILT╞DIR(FSROW) > 0 THEN FILT╞DIR(FSROW) = FILT╞DIR(FSROW) - 1  IF FSCOL=7 AND FILT╞MIN(FSROW) > 0 THEN BEGIN    V = FILT╞MIN(FSROW) - DELTA    IF V < 0 THEN V = 0    F&ILT╞MIN(FSROW) = V  BEND  IF FSCOL=8 AND FILT╞SWEEP(FSROW) > 0 THEN BEGIN    V = FILT╞SWEEP(FSROW) - DELTA    IF V < 0 THEN V = 0    FILT╞SWEEP(FSROW) = V  BEND  GOSUB APPLY╞SELECTED╞FILTER  RETURN.APPLY╞VAL'---------  IF SCOL=0 THEN ENVS╞'NAME$(SROW) = V$  IF SCOL=1 THEN ENVS╞ATTACK(SROW) = V  IF SCOL=2 THEN ENVS╞DECAY(SROW) = V  IF SCOL=3 THEN ENVS╞SUSTAIN(SROW) = V  IF SCOL=4 THEN ENVS╞RELEASE(SROW) = V  IF SCOL=5 THEN ENVS╞WAVEFORM(SROW) = V  IF SCOL=6 THEN ENVS╞PW(SROW) = V  R OW = SROW  GOSUB SET╞ENV  RETURN.SET╞ENV'-------  ENVELOPE ROW, ENVS╞ATTACK(ROW), ENVS╞DECAY(ROW), ENVS╞SUSTAIN(ROW), ENVS╞RELEASE(ROW), ENVS╞WAVEFORM(ROW), ENVS╞PW(ROW)  RETURN.RUNSTOP╞TRAPPER'---------------  IF ER=30 THEN RESUME  ' IGNORE  W)    INPUT #2, FILT╞DIR(ROW)    INPUT #2, FILT╞MIN(ROW)    INPUT #2, FILT╞SWEEP(ROW)  NEXT ROW  ' LOAD SEQUENCE  ' -------------  SEQCNT = 0  INPUT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    INPUT #2, SEQ╞CHUNK(ROW)    INPUT #2, SEQ╞EXTR A(ROW)    ROW = ROW + 1  LOOP' #ENDIF  DCLOSE #2  CHUNK╞IDX = 0  RETURN.GET╞CHUNK╞CNT'-------------  CHUNK╞CNT = 0  FOR K = 0 TO CHUNK╞MAX    IF V$(0,K)<>"" OR V$(1,K)<>"" OR V$(2,K)<>"" OR V$(3,K)<>"" OR V$(4,K)<>"" OR V$(5,K)<>"" THEN BE GIN      CHUNK╞CNT = K + 1    BEND  NEXT K  RETURN.SAVE'----  INPUT "SAVE NAME: ";KEY$  IF KEY$="" THEN RETURN    DELETE (KEY$)  DOPEN #2,(KEY$),W,U8  TMP = CHUNK╞IDX  ' SAVE MELODY CHUNKS  ' ------------------  GOSUB GET╞CHUNK╞CNT  P RINT #2, CHUNK╞CNT  FOR CHUNK╞IDX = 0 TO CHUNK╞CNT - 1    FOR VIDX=0 TO 5      PRINT #2,V$(VIDX, CHUNK╞IDX)    NEXT VIDX  NEXT CHUNK╞IDX  PRINT #2,TMPO%  ' SAVE ENVELOPES  ' --------------  FOR ROW = 0 TO 9    PRINT #2, ENVS╞NAME$(ROW)    PRI NT #2, ENVS╞ATTACK(ROW)    PRINT #2, ENVS╞DECAY(ROW)    PRINT #2, ENVS╞SUSTAIN(ROW)    PRINT #2, ENVS╞RELEASE(ROW)    PRINT #2, ENVS╞WAVEFORM(ROW)    PRINT #2, ENVS╞PW(ROW)  NEXT ROW  ' SAVE FILTER PRESETS  ' -------------------  FOR ROW = 0 TO  10    PRINT #2, FILT╞NAME$(ROW)    PRINT #2, FILT╞FREQ(ROW)    PRINT #2, FILT╞LP(ROW)    PRINT #2, FILT╞BP(ROW)    PRINT #2, FILT╞HP(ROW)    PRINT #2, FILT╞RES(ROW)    PRINT #2, FILT╞DIR(ROW)    PRINT #2, FILT╞MIN(ROW)    PRINT #2, FILT╞SWEEP(R OW)  NEXT ROW  ' SAVE SEQUENCE  ' -------------  PRINT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    PRINT #2, SEQ╞CHUNK(ROW)    PRINT #2, SEQ╞EXTRA(ROW)    ROW = ROW + 1  LOOP  DCLOSE #2  CHUNK╞IDX = TMP  RETURN.SAVE╞AS╞TEXT'--------- ---  INPUT "SAVE (AS TEXT) NAME: ";KEY$  IF KEY$="" THEN RETURN  DELETE (KEY$)      DOPEN #2,(KEY$),W,U8  FOR CHUNK╞IDX = 0 TO CHUNK╞MAX    FOR VIDX=0 TO 5      PRINT #2, "V";CHR$(49+VIDX);"$(";STR$(CHUNK╞IDX);")=";      PRINT #2, CHR$(34);V$(V 	IDX, CHUNK╞IDX);CHR$(34)    NEXT VIDX      PRINT #2, ""  NEXT CHUNK╞IDX  DCLOSE #2  CHUNK╞IDX = 0  RETURN.USER╞INPUT'----------  ' GETKEY KEY$  GOSUB READ╞KEY╞LOOP  KEY$ = A$  GOSUB CHECK╞ALT╞KEY╞INPUTS  ' DOWN ARROW?  IF KEY$ = кеы╞до 
вн AND CURSOR╞Y<5 THEN BEGIN    CURSOR╞Y = CURSOR╞Y + 1    IF CURSOR╞X > LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN CURSOR╞X = _      LEN(V$(CURSOR╞Y,CHUNK╞IDX))  BEND  ' UP ARROW?  IF KEY$ = кеы╞уп AND CURSOR╞Y>0 THEN BEGIN    CURSOR╞Y = CURSOR╞Y - 1     IF CURSOR╞X > LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN _      CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX))  BEND  ' RIGHT ARROW?  IF KEY$ = кеы╞ригхт AND CURSOR╞X < LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN BEGIN    CURSOR╞X=CURSOR╞X+1  BEND  ' LEFT ARROW?  IF KEY$ =  кеы╞лефт AND CURSOR╞X > 0 THEN CURSOR╞X=CURSOR╞X-1  ' BACKSPACE (INST/DEL)?  IF KEY$ = кеы╞дел AND CURSOR╞X > 0 THEN BEGIN    V$(CURSOR╞Y,CHUNK╞IDX)=LEFT$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X-1) _      + MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1)    CURSO R╞X=CURSOR╞X-1  BEND  IF ESC╞FLAG% THEN BEGIN    ESC╞FLAG%=0    IF KEY$ = "J" THEN BEGIN:CURSOR╞X=0:BEND    IF KEY$ = "K" THEN BEGIN:CURSOR╞X=LEN(V$(CURSOR╞Y,CHUNK╞IDX)):BEND    IF KEY$=кеы╞есцапе THEN GOSUB STOP╞ALL╞MUSIC    KEY$=""  BEND  IF  KEY$ = кеы╞есцапе THEN ESC╞FLAG%=ABS(ESC╞FLAG%-1)  ' CTRL-W = FORWARD ONE WORD  IF KEY$ = кеы╞цтрл╞в THEN GOSUB FORWARD╞WORD  ' CTRL-U = BACK ONE WORD  IF KEY$ = кеы╞цтрл╞у THEN GOSUB PREVIOUS╞WORD  ' < / > = PREVIOUS/NEXT CHUNK  IF KEY$ = "<"  AND CHUNK╞IDX>0 THEN BEGIN    CHUNK╞IDX=CHUNK╞IDX-1    CURSOR╞X=0  BEND  IF KEY$ = ">" AND CHUNK╞IDX<CHUNK╞MAX THEN BEGIN    CHUNK╞IDX=CHUNK╞IDX+1    CURSOR╞X=0  BEND  ' +/- = TEMPO CHANGE  IF KEY$="-" THEN TMPO%=TMPO%-1  IF KEY$="+" THEN TMPO %=TMPO%+1  ' MEGA-Q = EXIT  IF KEY$ = кеы╞мега╞я THEN BEGIN    PRINT "ARE YOU SURE? (Y/N)"    GET KEY A$    IF A$="Y" THEN KEY ON:END  BEND  IF KEY$ = кеы╞ф1 THEN GOSUB LOAD  IF KEY$ = кеы╞ф3 THEN GOSUB SAVE  IF KEY$ = кеы╞ф7 THEN GOSUB ENVELO PE╞EDITOR  IF KEY$ = кеы╞ф9 THEN GOSUB CHUNK╞SEQUENCER  ' ф4 = SAVE AS TEXT  IF KEY$ = кеы╞ф4 THEN GOSUB SAVE╞AS╞TEXT  ' RETURN=PLAY ROW  IF KEY$ = кеы╞ретурн THEN TEMPO TMPO% : PLAY V$(CURSOR╞Y,CHUNK╞IDX)  ' SHIFT+RETURN=PLAY ALL CHANNELS  IF  KEY$ = кеы╞схифт╞ретурн THEN BEGIN    TEMPO TMPO%    GOSUB PLAY╞CHUNK╞IDX  BEND  IF KEY$ = кеы╞инст THEN BEGIN    V1$ = V$(CURSOR╞Y, CHUNK╞IDX)    V1$ = LEFT$(V1$,CURSOR╞X) + MID$(V1$,CURSOR╞X+2)    V$(CURSOR╞Y, CHUNK╞IDX) = V1$  BEND  GOSUB C HECK╞VALID╞KEY  RETURN.CHECK╞ALT╞KEY╞INPUTS'--------------------  ALT╞KEY = PEEK($D611) AND 16  IF ALT╞KEY = 0 THEN RETURN  IF KEY$="X" THEN CLIP$=V$(CURSOR╞Y, CHUNK╞IDX) : V$(CURSOR╞Y, CHUNK╞IDX) = ""  IF KEY$="C" THEN CLIP$=V$(CURSOR╞Y, CHUNK ╞IDX)  IF KEY$="V" THEN V$(CURSOR╞Y, CHUNK╞IDX) = CLIP$  IF KEY$="ц" THEN GOSUB COPY╞ALL╞VOICES╞TO╞CLIPBOARD  IF KEY$="ж" THEN GOSUB PASTE╞ALL╞VOICES╞FROM╞CLIPBOARD  IF KEY$=кеы╞ретурн THEN BEGIN    V1$ = MID$(V$(CURSOR╞Y, CHUNK╞IDX), CURSOR╞X + 1)     TEMPO TMPO% : PLAY V1$  BEND  IF KEY$="," THEN DELTA = -1 : GOSUB TRANSPOSE╞OCTAVE  IF KEY$="." THEN DELTA = 1  : GOSUB TRANSPOSE╞OCTAVE  IF KEY$="I" THEN GOSUB INSERT╞CHUNK  KEY$ = ""  RETURN.COPY╞ALL╞VOICES╞TO╞CLIPBOARD'---------------- ------------  FOR Y = 0 TO 5    CP$(Y) = V$(Y, CHUNK╞IDX)  NEXT Y  RETURN.PASTE╞ALL╞VOICES╞FROM╞CLIPBOARD'-------------------------------  FOR Y = 0 TO 5    V$(Y, CHUNK╞IDX) = CP$(Y)  NEXT Y  RETURN.INSERT╞CHUNK'------------  FOR K = CHUNK ╞MAX-1 TO CHUNK╞IDX + 1 STEP -1    FOR Y = 0 TO 5      V$(Y, K) = V$(Y, K-1)    NEXT Y  NEXT K  FOR Y = 0 TO 5    V$(Y, CHUNK╞IDX) = ""  NEXT Y  ' REPAIR ITEMS IN THE SEQUENCE THAT ARE AFFECTED  FOR K = 0 TO 100    IF SEQ╞CHUNK(K) >= CHUNK╞ID X THEN SEQ╞CHUNK(K) = SEQ╞CHUNK(K) + 1  NEXT K  RETURN.TRANSPOSE╞OCTAVE'----------------  V1$ = V$(CURSOR╞Y, CHUNK╞IDX)  LIMIT = 0  IF DELTA = 1 THEN LIMIT = 6  RET% = 0  GOSUB CAN╞TRANSPOSE╞OCTAVE  IF RET% = 0 THEN PRINT кеы╞бееп; : RETUR N  K = 0  DO WHILE K < LEN(V1$)    V2$ = MID$(V1$,K+1,1)    IF V2$ = "O" AND (K + 1) < LEN(V1$) THEN BEGIN      V2$ = STR$(VAL(MID$(V1$,K+2,1)) + DELTA)      V2$ = MID$(V2$,2)      V1$ = LEFT$(V1$,K+1) + V2$ + MID$(V1$, K+3)    BEND    K = K +  1  LOOP  V$(CURSOR╞Y, CHUNK╞IDX) = V1$  RETURN.CAN╞TRANSPOSE╞OCTAVE'--------------------  RET% = 1  K = 0  DO WHILE K < LEN(V1$)    V2$ = MID$(V1$,K+1,1)    IF V2$ = "O" AND (K+1) < LEN(V1$) THEN BEGIN      V2$ = MID$(V1$,K+2,1)      IF V AL(V2$) = LIMIT THEN RET% = 0 : RETURN    BEND    K = K + 1  LOOP  RETURN.PLAY╞CHUNK╞IDX'--------------  V1$ = V$(0,CHUNK╞IDX)  V2$ = V$(1,CHUNK╞IDX)  V3$ = V$(2,CHUNK╞IDX)  V4$ = V$(3,CHUNK╞IDX)  V5$ = V$(4,CHUNK╞IDX)  V6$ = V$(5,CHUNK╞ID X)  IF ECHO╞DELAY = 1 THEN BEGIN    PLAY V1$    SLEEP (ECHO╞SZ)    PLAY ,V2$    SLEEP (ECHO╞SZ)    PLAY ,,V3$    SLEEP (ECHO╞SZ)    PLAY ,,,V4$    SLEEP (ECHO╞SZ)    PLAY ,,,,V5$    SLEEP (ECHO╞SZ)    PLAY ,,,,,V6$    SLEEP (ECHO╞SZ)    RE TURN  BEND  IF ECHO╞M = 0 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$, V2$, V3$, V4$, V5$, V6$    RETURN  BEND  IF ECHO╞M = 1 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$, V6$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$  BEND  IF E CHO╞M = 1 AND ECHO╞B = 1 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$,    , V3$  BEND  IF ECHO╞M = 2 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$,    , V3$,    ,    , V6$    SLEEP (ECHO╞SZ)    PLAY    ,    ,     , V1$    SLEEP (ECHO╞SZ)    PLAY    , V1$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    ,    , V1$  BEND  IF ECHO╞M = 2 AND ECHO╞B = 1 THEN BEGIN    PLAY V1$,    , V3$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$    SLEEP (ECHO╞SZ)    PLAY    ,   V1$,    ,    ,    , V3$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    ,    , V1$  BEND  RETURN.ENVELOPE╞EDITOR'---------------  DO WHILE 1    GOSUB DRAW╞TABLE    GOSUB GET╞USER╞INPUT╞FOR╞TABLE    ' ALT+Q TO EXIT    IF A$ = кеы╞мега╞я THEN EXIT  ! LOOP  RETURN.DRAW╞TABLE'----------  PRINT "⌠ENV EDITOR";кеы╞таб;DUR$(SDUR, днаме);кеы╞таб;"OCTAVE";OCT  PRINT "----------"  PRINT "-/+: DECR/INCR, </>: OCTAVE, ртн: EDIT, таб: FOCUS ENV/FILTER, мега+я: EXIT"  PRINT  PRINT "   наме";кеы╞таб;ке "ы╞таб;"аттацк";кеы╞таб;"децаы";кеы╞таб;"сустаин";кеы╞таб;"релеасе";кеы╞таб;  PRINT "важефрм";кеы╞таб;"пулсевидтх"  FOR ROW = 0 TO 9    IF SROW = ROW THEN PRINT ">";:ELSE PRINT " ";    PRINT ROW;": ";    COL = 0 : V$ = ENVS╞NAME$(ROW)    GOSUB SHOW #╞CELL    COL = 1 : V = ENVS╞ATTACK(ROW)    GOSUB SHOW╞CELL    COL = 2 : V = ENVS╞DECAY(ROW)    GOSUB SHOW╞CELL    COL = 3 : V = ENVS╞SUSTAIN(ROW)    GOSUB SHOW╞CELL    COL = 4 : V = ENVS╞RELEASE(ROW)    GOSUB SHOW╞CELL    COL = 5 : V = ENVS╞WAVE $FORM(ROW)    GOSUB SHOW╞CELL    COL = 6 : V = ENVS╞PW(ROW)    GOSUB SHOW╞CELL    PRINT  NEXT ROW  PRINT  PRINT "FILTER EDITOR"  PRINT "-------------";  PRINT кеы╞таб;"FREQ";кеы╞таб;"LP";кеы╞таб;"BP";кеы╞таб;"HP";кеы╞таб;"RES";  PRINT кеы╞таб;" %DIR";кеы╞таб;"MIN";кеы╞таб;"SWEEP"  FOR FPRESET = 0 TO 10    GOSUB SHOW╞FILTER  NEXT FPRESET  RETURN.SHOW╞FILTER'-----------  IF FSEL = FPRESET THEN PRINT ">";:ELSE PRINT " ";  K = 0 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞NAME$(FPR &ESET);"  ";кеы╞таб;  K = 1 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞FREQ(FPRESET);кеы╞таб;  K = 2 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞STATE╞NAME$(FILT╞LP(FPRESET));кеы╞таб;  K = 3 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FIL 'T╞STATE╞NAME$(FILT╞BP(FPRESET));кеы╞таб;  K = 4 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞STATE╞NAME$(FILT╞HP(FPRESET));кеы╞таб;  K = 5 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞RES(FPRESET);кеы╞таб;  K = 6 : GOSUB CHECK╞SHOW╞FILTER╞H IGHLIGHT  PRINT DIR╞NAME$(FILT╞DIR(FPRESET));кеы╞таб;  K = 7 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞MIN(FPRESET);кеы╞таб;  K = 8 : GOSUB CHECK╞SHOW╞FILTER╞HIGHLIGHT  PRINT FILT╞SWEEP(FPRESET);  PRINT кеы╞реж╞офф  RETURN.CHECK╞SHOW╞FI!╛'▀╬╛▄ ╒█ ╒▌ ╧▐ ╧░ /н/≤╩╩≤╬≤╛╛≈ √╣√ ╬╬╬'д°╦°╖╛╬⌡ ║ ╣ ╢/ж/!,!м"е$╞%е&ц(д)╞*ц+ +╞,ц-е1е2е3-6-7╞8е9р:е;ф<╞=╞>╞?ф@дAеB,C'CыC╞@д?.>/>т>т>'?м@ еA дB еCрDдEнF ╕,G'H╞I'H╞EмDхDыGцHрJ-KмKыKгJ/IеHдGдF╞DеCмBцAе@╞?д>+=е<╞;е:у:╪;ф<е= =/<ф8/7т7м8м9е:ф;ф<ц=д@цAеB╞DеEцFеHцIеL╞M╞                                                                                          !#OUTPUT PLAYMAKER' кEYS:' ----'    уP ARROW = мOVE TO PREVIOUS VOICE'  дOWN ARROW = мOVE TO NEXT VOICE'  лEFT ARROW = мOVE LEFT WITHIN CURRRENT VOICE STRING' рIGHT ARROW = мOVE RIGHT WITHIN CURRENT VOICE STRING'    инст/дел = дELETE CHAR IN CURRE!NT VOICE STRING'       есц,й = мOVE TO START OF CURRENT VOICE STRING'       есц,к = мOVE TO END OF CURRENT VOICE STRING'      цтрл+в = мOVE FORWARD ONE WORD IN CURRENT VOICE STRING'      цтрл+у = мOVE BACK ONE WORD IN CURRENT VOICE STRING'          ! < = сHOW PREVIOUS SONG CHUNK'           > = сHOW NEXT SONG CHUNK'           - = дECREASE TEMPO'           + = иNCREASE TEMPO'      мега+я = яUIT PROGRAM / еXIT еNV еDITOR'          ф1 = лOAD'          ф3 = сAVE'          ф7 = еNVELOPE EDITOR'   !       ф8 = фILTER EDITOR'   ф9/цтрл-п = цHUNK SEQUENCERTRAP RUNSTOP╞TRAPPER.DECLARATIONS'------------#DECLARE CHUNK╞IDX = 0#DECLARE CHUNK╞CNT = 0#DEFINE CHUNK╞MAX = 50#DECLARE VIDX, IDX#DECLARE CURSOR╞X = 0#DECLARE CURSOR╞Y = 0#DECLARE V$!(5,CHUNK╞MAX)#DECLARE KEY$#DECLARE VALID$="CDEFGAB0123456789 #$.HIQRSWOTUXMPL"#DECLARE VAL$#DECLARE TMPO% = 12#DECLARE ESC╞FLAG% = 0#STRUCT енжтыпе NAME$, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PWенжтыпе ENVS(9) = [ _  [ "пIANO",       0,!  9,  0,  0,  2, 1536 ], _  [ "аCCORDION",  12,  0, 12,  0,  1,    0 ], _  [ "цALLIOPE",    0,  0, 15,  0,  0,    0 ], _  [ "дRUM",        0,  5,  5,  0,  3,    0 ], _  [ "фLUTE",       9,  4,  4,  0,  0,    0 ], _  [ "гUITAR",      0,  9,  2,  1,  !	1,    0 ], _  [ "хARPSICRD",   0,  9,  0,  0,  2,  512 ], _  [ "оRGAN",       0,  9,  9,  0,  2, 2048 ], _  [ "тRUMPET",     8,  9,  4,  1,  2,  512 ], _  [ "ьYLOPHONE",   0,  9,  0,  0,  0,    0 ]  _]#DEFINE дир╞ноне = 0#DEFINE дир╞уп   = 1#DEF!
INE дир╞довн = 2#DEFINE дир╞осц  = 3#DECLARE DIR╞NAME$(3)DIR╞NAME$(0) = "ноне"DIR╞NAME$(1) = "уп"DIR╞NAME$(2) = "довн"DIR╞NAME$(3) = "осц"#DEFINE ф╞офф = 0#DEFINE ф╞он  = 1#STRUCT филттыпе NAME$, FREQ, LP, BP, HP, RES, DIR, MIN, SWEEPфилтты!пе FILT(10) = [ _  [ "LOWP╞UP",    1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞уп,   100, 10 ], _  [ "LOWP╞DOWN",  1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞довн, 100, 10 ], _  [ "LOWP╞OSC",   1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞осц,  100, 10 ], __  [ "BANDP╞UP",   !1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞уп,   100, 10 ], _  [ "BANDP╞DOWN", 1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞довн, 100, 10 ], _  [ "BANDP╞OSC",  1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞осц,  100, 10 ], __  [ "HIGHP╞UP",   1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞у!п,   100, 10 ], _  [ "HIGHP╞DOWN", 1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞довн, 100, 10 ], _  [ "HIGHP╞OSC",  1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞осц,  100, 10 ], __  [ "SPARE╞1",    0,    ф╞офф, ф╞офф, ф╞офф, 0,  дир╞ноне, 0,   0  ], _  [ "SPARE╞2",    !0,    ф╞офф, ф╞офф, ф╞офф, 0,  дир╞ноне, 0,   0  ], __]#DECLARE SEQ╞CHUNK(200), SEQ╞EXTRA(200)#DECLARE ECHO╞M, ECHO╞B, ECHO╞SZ = .05, CHUNK╞RPT, ECHO╞DELAY#DECLARE V1$, V2$, V3$, V4$, V5$, V6$#DECLARE TMP#DECLARE SSCOL, S, SEQ╞OFFS#DEFINE оп╞ц!опы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DEFINE сцрнптрлсб = $D060#DEFINE сцрнптрмсб = $D061#DEFINE сцрнптрбнк = $D062.CMDS#DEFINE цмд╞темпо = -1#DEFINE цмд╞филтер = -2#DEFINE цмд╞лооп = -3#DEFINE цмд╞ецхо╞м1 = -4   '! ECHO MELODY: VOICE 1 ON VOICE 4#DEFINE цмд╞ецхо╞м2 = -5   ' ECHO MELODY: VOICE 1 ON VOICE 2 + 4 + 5#DEFINE цмд╞ецхо╞б  = -6   ' ECHO BASS:   VOICE 3 ON VOICE 6#DEFINE цмд╞ецхо╞офф = -7#DEFINE цмд╞ецхо╞сз = -8#DEFINE цмд╞жол = -9#DEFINE цмд╞делаы =! -10#DEFINE цмд╞маь = 11#DECLARE SEQ╞CMDNAME$(10)SEQ╞CMDNAME$(1) = "темпо"SEQ╞CMDNAME$(2) = "филтер"SEQ╞CMDNAME$(3) = "лооп"SEQ╞CMDNAME$(4) = "ецхо╞м1"SEQ╞CMDNAME$(5) = "ецхо╞м2"SEQ╞CMDNAME$(6) = "ецхо╞б"SEQ╞CMDNAME$(7) = "ецхо╞офф"SEQ╞CMDNAME!$(8) = "ецхо╞сз"SEQ╞CMDNAME$(9) = "жол"SEQ╞CMDNAME$(10) = "делаы"#DECLARE SEQCNT, SEQPTR#DECLARE ROW, COL, SROW, SCOL, A$, V, MAXV, V$#STRUCT кеы╞тыпе IN$, OUT$кеы╞тыпе KEYS(11) = [ _  [ "A", "C", ], _  [ "W", "#C", ], _  [ "S", "D", ], _  ![ "E", "#D", ], _  [ "D", "E", ], _  [ "F", "F", ], _  [ "T", "#F", ], _  [ "G", "G", ], _  [ "Y", "#G", ], _  [ "H", "A", ], _  [ "U", "#A", ], _  [ "J", "B", ] _]#DECLARE PSTR$, K, DELTA#DECLARE WNAME$(4)WNAME$(0) = "три"WNAME$(1) = "сав!"WNAME$(2) = "пулсе"WNAME$(3) = "ноисе"WNAME$(4) = "ринг"#DECLARE FILT╞STATE╞NAME$(2)FILT╞STATE╞NAME$(0) = "офф"FILT╞STATE╞NAME$(1) = "он"#DECLARE FPRESET = 1#DECLARE FSCOL = 0, FSROW = 0, FFOCUS = 0, FSEL = -1#DECLARE OCT = 5#DECLARE CURR╞!FREQ, CURR╞DIR#DECLARE HANDLED#DECLARE PLYPTR = -1, PLYFLAG.DURATION'--------#DEFINE днаме = 0#DEFINE дцхар = 1#DEFINE дкеы  = 2#DEFINE д╞вхоле = 0#DEFINE д╞халф = 1#DEFINE д╞яуартер = 2#DEFINE д╞еигхтх = 3#DEFINE д╞сиьтеентх = 4#DECLARE !SDUR = 2#DECLARE DUR$(5,2)DUR$(д╞вхоле, днаме) = "WHOLE"DUR$(д╞вхоле, дцхар) = "W"DUR$(д╞вхоле, дкеы)  = "1"DUR$(д╞халф, днаме) = "HALF"DUR$(д╞халф, дцхар) = "H"DUR$(д╞халф, дкеы)  = "2"DUR$(д╞яуартер, днаме) = "QUARTER"DUR$(д╞яуартер, дцхар) != "Q"DUR$(д╞яуартер, дкеы)  = "3"DUR$(д╞еигхтх, днаме) = "EIGHTH"DUR$(д╞еигхтх, дцхар) = "I"DUR$(д╞еигхтх, дкеы)  = "4"DUR$(д╞сиьтеентх, днаме) = "SIXTEENTH"DUR$(д╞сиьтеентх, дцхар) = "S"DUR$(д╞сиьтеентх, дкеы)  = "5"#DECLARE CLIP$, ALT╞KEY, L!IMIT, RET%, Y, CP$(6).KEYS'----#DEFINE кеы╞уп = "▒"#DEFINE кеы╞довн = ""#DEFINE кеы╞лефт = "²"#DEFINE кеы╞ригхт = ""#DEFINE кеы╞спаце = " "#DEFINE кеы╞дел = ""#DEFINE кеы╞цтрл╞в = ""#DEFINE кеы╞цтрл╞у = ""#DEFINE кеы╞мега╞я = "╚"#DEFINE! кеы╞ф1 = "┘"#DEFINE кеы╞ф3 = "├"#DEFINE кеы╞ф4 = "┼"#DEFINE кеы╞ф7 = "┬"#DEFINE кеы╞ф8 = "▄"#DEFINE кеы╞ф9 = CHR$(16)#DEFINE кеы╞ретурн = CHR$(13)#DEFINE кеы╞есцапе = CHR$(27)#DEFINE кеы╞схифт╞ретурн = CHR$(141)#DEFINE кеы╞схифт╞плус = "ш"#DEF!INE кеы╞схифт╞минус = "щ"#DEFINE кеы╞реж╞он = ""#DEFINE кеы╞реж╞офф = "▓"#DEFINE кеы╞таб = CHR$(9)#DEFINE кеы╞хоме = ""#DEFINE кеы╞цлр  = "⌠"#DEFINE кеы╞ловерцасе = CHR$(14)#DEFINE кеы╞упперцасе = CHR$(142)#DEFINE кеы╞бееп = CHR$(7)#DEFINE кеы!╞инст = "■"#DEFINE кеы╞дел  = "".INIT'----PRINT "⌠";кеы╞ловерцасе;кеы╞есцапе;"5";PLAY : PLAY ""BACKGROUND 0 : BORDER 0COLOR 5.MAIN'----  KEY OFF  GOSUB DRAW╞EDITOR╞SCREEN  GOSUB USER╞INPUT  GOTO MAIN.DRAW╞EDITOR╞SCREEN'----------------!--  CURSOR 0,0:PRINT "⌠PLAYMAKER V0.5 - BY GURCE ISIKYILDIZ"  PRINT "---------"  PRINT "<: PREV CHUNK, >: NEXT CHUNK, -/+ TEMPO, ф7=ENV EDITOR, ф9/цтрл-п=SEQ EDITOR"  PRINT "ртн: PLAY CURR VOICE, схфт+ртн: PLAY ALL VOICE, ф1=LOAD, ф3=SAVE, мега+я=QUI!T"  PRINT "алт-ь/ц/ж: ROW CUT/COPY/PASTE, есц-есц: STOP MUSIC, алт-ртн: PLAY FROM CURSOR"  PRINT  GOSUB DRAW╞CURRENT╞CHUNK  RETURN.DRAW╞CURRENT╞CHUNK'------------------  PRINT "TEMPO: "; TMPO%  PRINT "CHUNK╞IDX: "; CHUNK╞IDX       FOR VIDX=0 !TO 5    IF CURSOR╞Y <> VIDX THEN BEGIN      CURSOR 0,9+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX+1;": ";V$(VIDX,CHUNK╞IDX);    BEND:ELSE BEGIN      CURSOR 0,9+VIDX*2:PRINT CHR$(27);"Q";"V";VIDX+1;": ";      FOR IDX=1 TO LEN(V$(VIDX,CHUNK╞IDX))        IF C!URSOR╞X = IDX-1 THEN BEGIN          PRINT "";MID$(V$(VIDX,CHUNK╞IDX),IDX,1);"▓";        BEND:ELSE BEGIN          PRINT MID$(V$(VIDX,CHUNK╞IDX),IDX,1);        BEND      NEXT IDX      IF LEN(V$(VIDX,CHUNK╞IDX)) = 0 OR CURSOR╞X=LEN(V$(VIDX,CHUNK╞IDX)! ) THEN PRINT " ▓";    BEND  NEXT VIDX  RETURN.CHECK╞VALID╞KEY'---------------  FOR IDX=1 TO LEN(VALID$)    VAL$=MID$(VALID$,IDX,1)    IF KEY$= VAL$ THEN BEGIN      IF CURSOR╞X < LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN BEGIN        V$(CURSOR╞Y,CHUNK╞!!IDX) = LEFT$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X) _          + VAL$ + MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1)        CURSOR╞X=CURSOR╞X+1        RETURN      BEND      V$(CURSOR╞Y,CHUNK╞IDX)=V$(CURSOR╞Y,CHUNK╞IDX)+VAL$      CURSOR╞X=CURSOR╞X+1      RETU!"RN    BEND  NEXT IDX  RETURN.FORWARD╞WORD'------------  IF CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN RETURN  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) <> " "    CURSOR╞X=CURSOR╞X+1    IF CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN R!#ETURN  LOOP  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) = " "    CURSOR╞X=CURSOR╞X+1    IF CURSOR╞X = LEN(V$(CURSOR╞Y,CHUNK╞IDX)) THEN RETURN  LOOP  RETURN.PREVIOUS╞WORD'-------------  IF CURSOR╞X = 0 THEN RETURN  IF CURSOR╞X = 1 THEN!$ CURSOR╞X = 0: RETURN  CURSOR╞X = CURSOR╞X - 1  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) = " "    CURSOR╞X=CURSOR╞X-1    IF CURSOR╞X = 0 THEN RETURN  LOOP  DO WHILE MID$(V$(CURSOR╞Y,CHUNK╞IDX),CURSOR╞X+1,1) <> " "    CURSOR╞X=CURSOR╞X-1!%    IF CURSOR╞X = 0 THEN RETURN  LOOP  CURSOR╞X=CURSOR╞X+1  RETURN.SET╞ALL╞ENV'-----------  FOR ROW = 0 TO 9    GOSUB SET╞ENV  NEXT ROW  RETURN.LOAD'----  INPUT "LOAD NAME: ";KEY$  IF KEY$="" THEN RETURN  DOPEN #2,(KEY$),R,U8  ' LOAD!& MELODY CHUNKS  ' ------------------  INPUT #2, CHUNK╞CNT  FOR CHUNK╞IDX = 0 TO CHUNK╞CNT - 1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNK╞IDX)    NEXT VIDX  NEXT CHUNK╞IDX  INPUT #2,TMPO%' #IFDEF еьтра    ' LOAD ENVELOPES  ' ------------!'--  FOR ROW = 0 TO 9    INPUT #2, ENVS╞NAME$(ROW)    INPUT #2, ENVS╞ATTACK(ROW)    INPUT #2, ENVS╞DECAY(ROW)    INPUT #2, ENVS╞SUSTAIN(ROW)    INPUT #2, ENVS╞RELEASE(ROW)    INPUT #2, ENVS╞WAVEFORM(ROW)    INPUT #2, ENVS╞PW(ROW)    GOSUB SET╞ENV    NEXT ROW  PRINT  ' LOAD FILTER PRESETS  ' -------------------  FOR ROW = 0 TO 10    INPUT #2, FILT╞NAME$(ROW)    INPUT #2, FILT╞FREQ(ROW)    INPUT #2, FILT╞LP(ROW)    INPUT #2, FILT╞BP(ROW)    INPUT #2, FILT╞HP(ROW)    INPUT #2, FILT╞RES(RO"5100:▌ ┼Ф╙}█ 31200:▀ E ╖ ▌  Ф╢}B╡V:█ 16700 ═Ф╬}▌ ╨Фх}▐ INDIRECT ADDRESSING яФр}L$╡й(L$,2):█ 16000 шФэ}AM╡13 ГФ}OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100  ГП}█ 15600:▀ XC ╖ ▌ 6ГЗ}▀ L$Ё╠")" ╖ 17000 nГ~▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌" ┌Г~█ 31200:▀ E ╖ ▌ ▌Г~█ 31300 ■Г~▌ ╦Г,~▐ INDIRECT Z-INDEXED ADDRESSING оГ6~L$╡й(L$,2):█ 16000 ыГ@~AM╡12 	ХJ~OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 ХT~█ 15600:▀ XC ╖ ▌ EХY~▀ й(OP$,2,1)╡"Q" ╞ L$Ё╠")" ╖ 17000 oХ^~▀ й(OP$,2,1)Ё╠"Q" ╞ L$Ё╠"),Z" ╖ 17"000 ╔Хh~▀ VЁ0 ╟ V╠255 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ ╧Хr~█ 31200:▀ E ╖ ▌ иХ|~B╡V:█ 16700 оХ├~▌ ВХ░~▐ BASE PAGE AND RELATIVE ADDRESSING И ~AM╡14 И╓~█ 15600:V1╡V:▀ XC ╖ ▌ 6И╝~▀ х(L$,1)Ё╠"," ╖ 17000 BИ╦~█ 16200 WИб~█ 15600:▀ XC ╖ ▌ ▐Ил~▀ V1Ё0 ╟ V1╠25"5 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ ╜Иж~▀ PA╡1 ╖ V╡0:у V╡V╚(AD╙3) ХИЮ~▀ VЁ╚128 ╟ V╠127 ╖ EM$╡"BRANCH OUT OF RANGE":█ 15100:▌ ЙЙ~OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 ,ЙТ~█ 31200:▀ E ╖ ▌ =ЙЧ~B╡V1:█ 16700 SЙB╡V ╞ 255:█ 16700 YЙ▌ ┬ЙX▐ SP-INDEX"ED INDIRECT Y-INDEXED ADDRESSING ÷ЙbL$╡й(L$,2):█ 16000 ╘ЙlAM╡16 ыЙvOP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 НЙ─█ 15600:▀ XC ╖ ▌ 	К┼▀ L$Ё╠",SP),Y" ╖ 17000 ?К■▀ VЁ0 ╟ V╠255 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ SК·█ 31200:▀ E ╖ ▌ cК╗B╡V:█ 16700 iК"╡▌ ≥К╪▐ INDIRECT FLAT MEMORY Z-INDEXED ADDRESSING ╟КфL$╡й(L$,2):█ 16000 ╨КпAM╡18 ЙКзOP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 ЪКД█ 15600:▀ XC ╖ ▌ ЛФ▀ и(OP$,1)Ё╠"Z" ╖ 32745 =ЛГ▀ L$Ё╠"],Z" ╖ 17000:у ┴ 32760 dЛИ▀ й(OP$,2,1)╡"Q" ╞ L$Ё╠"]" ╖ 17000" ▌ЛН▀ й(OP$,2,1)Ё╠"Q" ╞ L$Ё╠"],Z" ╖ 17000 дЛЬ▀ VЁ0 ╟ V╠255 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ ьЛ─█ 31200:▀ E ╖ ▌ ХЛ─B╡V:█ 16700 НЛ─▌ ТЛ@°: ЗЛJ°▐ 2МT°▐ ******************** PROJECT ******************** 8М^°▐ >М╓°: kМ╝°▐ SUB ----- USE N$ AS PROJECT N"AME ----- qМ╦°: ╧Мб°▀ FI$╡"" ╖ EM$╡"FILE NEEDS TO BE SAVED FIRST":█ 15100:EA╡2:PR$╡"":▌ тМл°▀ PR$╡N$ ╞ PF$╡FI$ ╖ ▌ ЖМж°PF$╡FI$:LB╡0:▀ N$Ё╠PR$ ╖ LB╡1 	НЮ°▐ INIT PROJECT НЙ°PR$╡N$:ES╡0 6НТ°Ч#1,(PR$╙".PRJ"╙",S"),R HНЧ°▀ DS ╖ Ч#1:▌ `Н²└1,S$:▀ ST ╖ Ч#1:▌"	 ╖Н²▀ S$Ё╠PR$ ╖ EM$╡"PROJECT NAME MISMATCH":█ 15100:EA╡2:PR$╡"":Ч#1:▌ ╠Н&²└1,S$ ШН0²▀ ES╡ME ╖ EM$╡"EXTERNAL SYMBOL TABLE FULL":█ 15100:EA╡2:PR$╡"":Ч#1:▌ О:²ES╡ES╙1:ES$(ES)╡S$ %ОD²▀ ST╡0 ╖ 40230 .ОN²Ч#1 WОX²O$╡"EXTERNAL SYMBOLS LOADED":█ 16600 |Оl²▐ "
LOAD BINARY FILES FROM PROJECT ▓Оv²▀ LB╡0 ╟ ES╡0 ╖ ▌ ²О─²EF$╡"" ╜О┼²│ EI╡1 ╓ ES пО■²:  ▀ х(ES$(EI),1)Ё╠"*" ╖ 40400 ТО≥²:  ▀ и(ES$(EI),3)╡"---" ╖ 40400 )П·²:  F$╡й(ES$(EI),2):B╡е(и(F$,3)):F$╡х(F$,ц(F$)╚8) AПё²:  ▀ F$╡FI$ ╖ 40400 lП╗²:  ▀ и(F$,4)╡".ASM" ╖ "F$╡х(F$,ц(F$)╚4) ─П╡²:  F$╡F$╙".BIN" ∙П╪²:  Ч (F$),B (B) рПф²:  O$╡"BINARY FILE "╙F$╙" LOADED INTO BANK"╙д(B):█ 16600 шПп²┌ EI АПз²▌ ГП4·: %Я>·▐ SUB ----- FILL SYMBOL TABLE WITH EXTERNAL SYMBOLS ----- +ЯH·: ;ЯR·EI╡0:EF$╡"" LЯ\·▀ EI╠╡ES ╖ ▌  Яf·EI╡EI╙1:▀" х(ES$(EI),1)╡"*" ╖ EF$╡й(ES$(EI),2):EF$╡х(EF$,ц(EF$)╚8):┴ 40540 ╟Яk·▀ EF$╡FI$ ╖ 40540 еЯp·I╡т(ES$(EI),"=") ЯЯz·SN$╡х(ES$(EI),I╚1):SV╡е(й(ES$(EI),I╙1)) Р└·EF╡1:█ 15200:EF╡0 Р▌·┴ 40540 РЭ·: _Р÷▐ SUB ----- WRITE EXTERNAL SYMBOLS & BINARY TO PROJECT FIL"E ----- eР÷: vР÷▀ PR$╡"" ╖ ▌ ≈Р$÷Ч#1,("@"╙PR$╙".PRJ"╙",S"),W вР.÷▀ DSЁ╠0 ╖ EM$╡"DISK ERROR: "╙DS$:█ 15100:EA╡2:Ч#1:PR$╡"":▌ БР8÷≤1,PR$ ЭРB÷EF$╡"":▀ ES╡0 ╖ 40820 СL÷│ X╡1 ╓ ES JСV÷:  ▀ х(ES$(X),1)╡"*" ╖ EF$╡й(ES$(X),2):EF$╡х(EF$,ц(EF$)╚8) hС`÷:  ▀ EF"$Ё╠FI$ ╖ ≤1,ES$(X) pСj÷┌ X ≥Сt÷▀ RA ╖ S$╡и(д(1000╙RB),3):у S$╡"---" ЁСy÷≤1,"*";FI$;"@BANK";S$ фС~÷▀ NS╡0 ╖ 40870 уС┬÷│ X╡1 ╓ NS  Т▓÷:  ▀ SE%(X)╡2 ╖ ≤1,SN$(X)╙"="╙д(SV(X)) Т°÷┌ X Т╕÷Ч#1 CТ╟÷O$╡"PROJECT FILE "╙PR$╙".PRJ UPDATED":█ 16600 uТ╨÷▀ RA ╖ O$╡"N"EXT FREE BYTE AT $"╙р(AD):█ 16600 ║Т(═▐ SAVE BINARY FILE OF ASSEMBLED PROGRAM ╢Т-═▀ RA╡0 ╖ 41050 ЦТ2═F$╡FI$:▀ и(F$,4)╡".ASM" ╖ F$╡х(F$,ц(F$)╚4) ЗТ<═F$╡х(F$,12)╙".BIN" !УF═Ч ("@"╙F$),P (RA) ╓ P (AD),B (RB) KУP═O$╡"BINARY FILE "╙F$╙" SAVED":█ 16600 ]УZ═O$ ╡"":█ 16600 cУd═▌                                                                                                                                                                                                                                             "' ROTATE SCREEN CONTENTS#OUTPUT "ROTATE"' 4.0000 = 96X96 CLRBOX CANVAS (9216 BYTES)' 4.2400 = FREE.DEFINES'-------#DEFINE оп╞цопы = 0#DEFINE оп╞миь  = 1#DEFINE оп╞свап = 2#DEFINE оп╞филл = 3#DECLARE хотрег╞7 = $D05D#DECLARE сцрнптрлсб = $D0"60#DECLARE сцрнптрбнк = $D062#DECLARE T, X, Y, COLR, ANG, XINC, YINC, TX, TY, TXINC, TYINC#DECLARE Y1ADD#DECLARE XFRAC, YFRAC#DECLARE BOX╞ANG, CX, CY, HYP#DEFINE пи = 3.1415926535#DECLARE PL╞RAD, PL╞ANG, PL╞DIR, PL╞CLR#DECLARE A$#DECLARE STATE".MAIN'----  GOSUB INIT  GOSUB DUMMY╞CONTENT.MN╞LOOP  GOSUB ROTATE╞LOGIC  GOSUB DRAW╞CONTENT  GOTO MN╞LOOP.INIT'----  ^^BLOAD "ASMROTATE",B0  ' PRINT CHR$(27);"5";CHR$(147);  ANG = 2*пи + .1  STATE = 0  PL╞RAD = 0  PL╞ANG = 0  PL╞DIR =" 0  PL╞CLR = 0  ' SWITCH TO 80X50  BANK 128  SETBIT хотрег╞7, 7  POKE $D031, $E8 ' 1110 1000 = х640,фаст,аттр,ж400  ' MOVE сцрнптр TO BANK4 - $8000  WPOKE сцрнптрлсб, $8000  POKE сцрнптрбнк,$04  ' CLEAR 80X50 CHARS AND COLOUR RAM  EDMA 3, 40"00, 160, $48000  EDMA 3, 4000, 6, $FF80000  ' FOR IDX=0 TO 3999:POKE $48000+IDX,160:POKE $FF80000+IDX,6:NEXT IDX  RETURN.DUMMY╞CONTENT'-------------  EDMA оп╞филл, 96*96, 0, $40000  'POKE $40000 + 48*96, 1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5",6,6,6,6  'FOR T = 0 TO 50  '  COLR = INT(RND(1)*16)  '  X = INT(RND(1)*96)  '  Y = INT(RND(1)*96)  '  POKE $40000 + X + Y * 96, COLR  'NEXT T  'FOR Y = 0 TO 96  '  FOR X = 0 TO 95  '    POKE $40000 + X + Y * 96, MOD(Y, 16)  '  NEXT X  'NEXT" Y  RETURN.ROTATE╞LOGIC'------------  ANG = ANG - .1  IF ANG < 0 THEN ANG = ANG + (2 * пи)  HYP = SQR(25*25+40*40) * 65536  XINC = COS(ANG) * 65536  YINC = SIN(ANG) * 65536  TXINC = COS(ANG+пи/2) * 65536  TYINC = SIN(ANG+пи/2) * 65536  BOX╞"ANG = ATN(-25/-40)+ пи +ANG  IF BOX╞ANG < 0 THEN BOX╞ANG = BOX╞ANG + (2 * пи)  TX = HYP * COS(BOX╞ANG) + 48 * 65536  TY = HYP * SIN(BOX╞ANG) + 48 * 65536  CX = TX  CY = TY  XFRAC = 0  YFRAC = 0  Y1ADD = 0  RETURN.DRAW╞CONTENT'------------  "GOSUB PLOT╞ITERATION  GOSUB PLOT╞ITERATION  GOSUB ASM╞ROTATION  ' GOSUB BASIC╞ROTATION  'CURSOR 0,0:PRINT CHR$(27);"Q TX=";TX;", TY=";TY;  'CURSOR 0,1:PRINT CHR$(27);"Q ANG=";ANG;", HYP=";HYP;  'CURSOR 0,2:PRINT CHR$(27);"Q XINC=";XINC;", YINC=";Y"INC;  'CURSOR 0,3:PRINT CHR$(27);"Q TXINC=";TXINC;", TYINC=";TYINC;  'GET KEY A$  RETURN.PLOT╞ITERATION'--------------  X = 48 + COS(PL╞ANG) * PL╞RAD  Y = 48 + SIN(PL╞ANG) * PL╞RAD  POKE $40000 + X + INT(Y) * 96, PL╞CLR + 64  PL╞ANG = PL╞AN"G + .025  IF PL╞ANG > 2 * пи THEN PL╞ANG = PL╞ANG - 2 * пи  PL╞RAD = PL╞RAD + .05  IF PL╞RAD > 30 THEN BEGIN    PL╞RAD=0    PL╞CLR = PL╞CLR + 1    IF PL╞CLR = 16 THEN STATE = STATE + 1    PL╞ANG = .3926 * PL╞CLR  BEND  RETURN.ASM╞ROTATION'"------------  ' ассемблы VERSION  IF XINC < 0 THEN XINC = XINC + 4294967296  IF YINC < 0 THEN YINC = YINC + 4294967296  IF TXINC < 0 THEN TXINC = TXINC + 4294967296  IF TYINC < 0 THEN TYINC = TYINC + 4294967296  WPOKE $1A00, MOD(TX,65536)  WPOKE "$1A02, TX/65536  WPOKE $1A04, MOD(TY, 65536)  WPOKE $1A06, TY/65536  WPOKE $1A08, MOD(XINC,65536)  WPOKE $1A0A, XINC/65536  WPOKE $1A0C, MOD(YINC, 65536)  WPOKE $1A0E, YINC/65536  WPOKE $1A10, MOD(TXINC, 65536)  WPOKE $1A12, TXINC/65536  WP"OKE $1A14, MOD(TYINC, 65536)  WPOKE $1A16, TYINC/65536  BANK 0:SYS $1800:BANK 128  RETURN.BASIC╞ROTATION'--------------  ' басиц VERSION  FOR Y = 0 TO 49    CX = TX    CY = TY    FOR X = 0 TO 79      POKE $FF80000 + X + Y1ADD, PEEK($40000  б+ CX/65536 + INT(CY/65536) * 96)      CX = CX + XINC      CY = CY + YINC    NEXT X    TX = TX + TXINC    TY = TY + TYINC    Y1ADD = Y1ADD + 80  NEXT Y  GET KEY A$  RETURN                                                                      "  ╔Э█"╔Щ█#╔Ч█$╔Ъ█%╘ ██═ ╜ █╜█╜█╘ ██╜█╜█╜█ ╘ ██!╒ ╘ ┘Э┘Щ┘Ъ╘┘Ч╜eЭ┘Э╘ eЩ┘Щ╘ █'█(╜ █)╜!█*ёк'╟к)L√к)Н);пЛ╜'█+╜(█,╜)█-╜*█.ё╜+m'█'╜,m(█(╜-m)█)╜.m*█*;пь╜)eЭ┘Э╜*eЩ┘Щ╘ eЧ┘Чё Й╡Э█&╘ ┘Э У┘Щ╘Ь┘Ч╘┘Ъ┼eЭ┘Э╘ eЩ┘Щ╜eЭ┘Э╜eЩ┘Щё ╜&Й▓Э╜m█╜	m█╜
m█╜m█╜m█╜m█╜m █ ╜m!█!ХЮPсэЧ╜m █ ╜m█╜m█╜m█╜m█╜m█╜m█╜m█╘Pm█╘ m█хю2сEЧ╜"┘Э╜#┘Щ╜$┘Ч╜%┘ЪX`          ""╒▀╒┼ ┴ ┴╒
╩	╒╒┬ ┤ ╞├ ┘╦╛╬╒┌╬╣ ╣!й!р!р!ф!д ╞ д	.
╥ц╞д╞╧цдее╞╞╞╞╞╞╞еец╞д ф!╞"е#ф$╞%д&ц'ф(╞)╞*ф+ц,'-н.г.т-ы-и,е+'+╞*╞)е(у(т(й)р*к*и)ц(+'ц&╞%е$.#"#н!/ /ф╞╞фдмто ╬фдеди м ынрфй.ф=ж ж! е" ф# ╞$ ╞% ц& к'л'х'г'╔&ф%е$╞#ц"р!╒ ж÷╪╪·╢·╢╣╛÷ ÷╬═╛ ╛!д"е#и╓╬╔╛ё║╓╤ё ╒╬ё╛╒╛╒╩#ц$'%'&''╬',╗ '╛)╬╗║╘ ╘╬*║╙ +╬*╛╚╛╚╬,"$╬)е╚╛,д╖ ╗╛╖╛&╛╕║'╬'й(у).*/+/,/╜╤╛╬╜╬.╬╝ ╝║/║╞ 0╬╞║╟╤╟╢1╣0╛╠ 1╛2╩╛ ╛╛╚╬*╛╚╛*╪-/.//д0е1╩╟╩╟╬1╬╞╬╟╛.╤╞╖.╤/╣/й0'1'2'Ё 3╛╢ 4╛╣╛6ц5╛7╩╥║8╢╥╛6н5е4е4╬Ё Ё╩4д5е6,7'8'9т9/:/;╧<╩╪╢"%╪╤;╛╩ ╨╬╩╛╧╬╨╛<╬=н>н?ф?╛@║@╩©╬╬╬?║╬ =╛╫ >╬?╬©╛@/A,B╬BцA/Cиц╬ц╛б║б A╛а║B╬AбB'CнDнE/ф╬G║г╦H╬H╛IцJиJыф е║F║E╪F║F╪G'Hни╬й╛й K╬й║к к╬L╬K╛L╒и║J'KнL/M,MеLдKеJеI╞HфGдFеE╞DдCеB╞A"&д@е?╞>╞=ф<ц;ц:ф9р8,7/7т7т7м8м9е</<ы<и;ц:у:й;р<]=ц>е?╞@/A/C/DфEеF╞G╞HеIцJмJыJыJ/GрFфEйDйDгE/FеGдHиHкGдFжDжC╞BцAд@д?ц>л=х=х=╪?р@╞AеCгC,Bе@е?╞>ф<╞;':ф9'8ф6 6д5ц4ф3р2р1ф0ц-е,"'ц*ф)д(╞'╞&е%д$ф#╞"н!х!ы"╞#р$ф%'&н'г'г&ы&и%е$╞#╞"е!ц .  ,/деуем и х ╬.дде╞мыыт.е╞ф╞е р!д".#м$е%д'р(╞)ц(у(м*е+е,/-ы-х-и,е+╞*ц)ц(р'р%е$ф#╞"ж!ц ╞ц╞е! ц╞╞еееее╞┬╬	/
''''''''''/'▌╧╒╥░ ╥▒╩▒ ╞▓ ╬'▄╞╛█╦▌╥╒╦▌ ╬■ ╛■╤⌠╬▓ ⌠ ╣╤▓ ⌠ ▒║▓ ⌠ ▒║▓ ⌠ ▒╣▓ ⌠ ▒╣▓ ⌠╖▒╬▓ ⌠╖▒ ▓ ⌠╤▒ ▓ ⌠╤▒ ▓ ⌠╤╤▒ ▓ ⌠ ░ ▒╛▓╒╦░#0 Д╬nUI$╡".LONG":█ 15500:▀ F ╖ 23700 
©xUI$╡".PROJECT":█ 15500:▀ F ╖ 23800 .©yUI$╡".LIMIT":█ 15500:▀ F ╖ 23930 :©ФU┴ 30000 @©ПU: j©ЗU▐ ----- ASSEMBLER DIRECTIVE: *= ----- p©V: ╟©	VSX╡0:▐ DO NOT SKIP EXPRESSION EVALUATION FOR *= ON ANY PASS ╪©V█ 15600 Й#©V▀ XC ╖ EM$╡"CAN NOT SET *":█ 15100:EA╡2:▌ +ю"V▀ VЁ0 ╟ V╠65535 ╖ EM$╡"INVALID ADDRESS":█ 15100:XC╡1:┴ 22040 5ю,VAD╡XV Dю1V▀ PA╡1 ╖ ▌ Yю2V▀ L$Ё╠"" ╖ 22070 uю3V▀ OF$Ё╠"" ╖ Ч#1:OF$╡"" {ю4V▌  ю6V▀ х(L$,1)Ё╠"," ╖ █ 17000:▌ аю;V█ 16200:▀ х(L$,1)Ё╠"'" ╖ █ 17#000:▌ пю<VL$╡й(L$,2) Ею@V▀ OF$Ё╠"" ╖ Ч#1 ПюEVOF$╡"" 2аJVC$╡х(L$,1):▀ C$Ё╠"" ╞ C$Ё╠"'" ╖ OF$╡OF$╙C$:L$╡й(L$,2):┴ 22090 SаOV▀ C$Ё╠"'" ╖ OF$╡"":█ 17000:▌ {аTV█ 16200:▀ L$Ё╠"" ╖ OF$╡"":█ 17000:▌ даYV▀ OF$╡"" ╟ ц(OF$)╠16 ╖ EM$╡"INVALID FILE NAME":█ 15100:EA╡#2:OF$╡"":▌ ча^VЧ#1,("@"╙OF$╙",P"),W бcV▀ DSЁ╠0 ╖ EM$╡"DISK ERROR: "╙DS$:█ 15100:EA╡2:Ч#1:OF$╡"":▌ 7бhV≤1,г(я(и(р(AD),2))); UбiV≤1,г(я(х(и(р(AD),4),2))); [бrV▌ aб╦V: █ббV▐ ----- ASSEMBLER DIRECTIVE: .END ----- ⌠блV: ╚бжVEA╡1:▐ END ASSEMBLY ╠бЮV▌ ╥бW: #Еб&W▐ ----- ASSEMBLER DIRECTIVE: .PRINT ----- Кб0W: Сб5WH╡0 Ъб:W█ 15600 цDW▀ XC ╖ ▌ ,цNW▀ H ╖ T$╡р(V)╙" ":у T$╡д(V) ;цSWEO$╡EO$╙T$ bцXW█ 16100:▀ C$╡"," ╖ █ 16200:┴ 22330 wц]W▀ C$Ё╠"" ╖ 17000 }цbW▌ ┐ц─W: ╢ц┼W▐ ----- ASSEMBLER DIRECTIVE: .PRINTHEX ----- ╨#ц■W: йц·WH╡1:┴ 22330 пцДW: ЩцНW▐ ----- ASSEMBLER DIRECTIVE: .BYTE ----- дЬW: дX█ 15600 дX▀ XC ╖ ▌ RдX▀ VЁ0 ╟ V╠255 ╖ EM$╡"BYTE OUT OF RANGE":█ 15100:▌ bдXB╡V:█ 16700 ┴д X█ 16100:▀ C$╡"," ╖ █ 16200:┴ 22530 ▐д*X▌ ∙дHX: бдRX▐ ----- ASSEMBLER DIRECTIV#E: .WORD ----- хд\X: тдfX█ 15600 АдpX▀ XC ╖ ▌ еzX▀ VЁ0 ╟ V╠65535 ╖ EM$╡"WORD OUT OF RANGE":█ 15100:▌ 1еXB╡н(V,256):█ 16700 Hе─XB╡╣(V╜256):█ 16700 oе└X█ 16100:▀ C$╡"," ╖ █ 16200:┴ 22630 uе▌X▌ {е╛X: ╗е╤X▐ ----- ASSEMBLER DIRECTIVE: .TEXT ----- ╝еюX: Аей#X▀ х(L$,1)Ё╠"'" ╖ EM$╡"NO TEXT FOUND":█ 15100:▌ ПетXL$╡й(L$,2) %фчX▀ L$╡"" ╖ EM$╡"CLOSING QUOTES MISSING":█ 15100:▌ ?фЦX▀ х(L$,1)╡"'" ╖ 22780 XфХXB╡ф(х(L$,1)):█ 16700 dфРX┴ 22740 zфЭX▀ ц(L$)╠1 ╖ 17000 ─фY▌ ├фY: ╡фY▐ ----- ASSEMBLER DIRECTIVE: .RUN ---#	-- ╦ф$Y: Гф.YI$╡"CLEAR":█ 15500:▀ F ╖ RF╡RF ╟ 1:┴ 22860 г8YI$╡"WAIT":█ 15500:▀ F ╖ RF╡RF ╟ 2:┴ 22860 Cг9YI$╡"AUTO":█ 15500:▀ F ╖ RF╡RF ╟ 4:┴ 22860 sг=Y▀ L$Ё╠"" ╖ EM$╡"UNKNOWN RUN FLAG":█ 15100:▌ yгBY▌ ⌠гLY▀ х(L$,1)╡"," ╖ 22890 ╗гVY▀ L$Ё╠"" ╖ 17000 ╝г`Y▌#
 мгjYL$╡й(L$,2):█ 16000:┴ 22830 сгtY:  х~Y▐ ----- ASSEMBLER DIRECTIVE: .BANK ----- х┬Y: х▓Y█ 15600 :х°Y▀ XC ╖ EM$╡"BANK MISSING":█ 15100:▌ Oх╕Y▀ L$Ё╠"" ╖ 17000 ─х╟Y▀ VЁ0 ╟ V╠255 ╖ EM$╡"INVALID BANK":█ 15100:▌ ┴х╨YBK╡V ▐хдY▌ ∙хьY: цхБY▐ ----- ASSEMBLER #DIRECTIVE: .BASIC ----- ихЛY: МхЖY▀ х(L$,1)Ё╠"'" ╖ █ 17000:EA╡2:▌ Эх ZL$╡й(L$,2) и
Z▀ OF$Ё╠"" ╖ Ч#1 иZOF$╡"" ^иZC$╡х(L$,1):▀ C$Ё╠"" ╞ C$Ё╠"'" ╖ OF$╡OF$╙C$:L$╡й(L$,2):┴ 23070 └и(Z▀ C$Ё╠"'" ╖ OF$╡"":█ 17000:EA╡2:▌ ╠и2Z█ 16200:▀ L$Ё╠"" ╖ OF$╡"":█ 17000#:EA╡2:▌ Зи<Z▀ OF$╡"" ╟ ц(OF$)╠16 ╖ EM$╡"INVALID FILE NAME":█ 15100:EA╡2:OF$╡"":▌ йFZЧ#1,("@"╙OF$╙",P"),W TйPZ▀ DSЁ╠0 ╖ EM$╡"DISK ERROR: "╙DS$:█ 15100:EA╡2:Ч#1:OF$╡"":▌ eйUZ▀ C4 ╖ 23271 └йVZ▐ CREATE HEADER FOR MEGA65 ▒йZZAD╡$2001 ╡йdZ≤1,г(AD ╞ 255);г(╣#(AD╜256)); ЮйnZ▐ "10 BANK 0:SYS 8228:REM MEGA ASSEMBLER" ,кxZ▐ 2000 00 22 20 0A 00 FE 02 20 30 3A 9E 20 38 32 32 38 ........0:. 8228 xк┌Z▐ 2010 3A 8F 20 4D 45 47 41 20 41 53 53 45 4D 42 4C 45 :. MEGA ASSEMBLE ╦к▄Z▐ 2020 52 00 00 00                       #              R... Ек√Z≤1,г($22);г($20);г($A);г(0);г($FE);г(2); Ск═Z≤1," 0:"; л╙Z≤1,г($9E); л╢Z≤1," 8228:"; "л╬Z≤1,г($8F); <лхZ≤1," MEGA ASSEMBLER"; SлрZ≤1,г(0);г(0);г(0); _лэZAD╡8228 eлФZ▌ │лГZ▐ CREATE HEADER FOR C64 █лХZAD╡$801 ╝лИZ≤1,г(AD ╞ 255);г(╣#(AD╜256)); улЙZ▐ "10 SYS 2079:REM MEGA ASSEMBLER" !мКZ▐ 0800 00 0D 08 0A 00 9E 20 32 30 37 39 3A 8F 20 4D 45 ...0:. 2079:. ME lмЛZ▐ 0810 47 41 20 41 53 53 45 4D 42 4C 45 52 00 00 00    GA ASSEMBLER... ┼мНZ≤1,г($D);г(8);г($A);г(0); ≥мПZ≤1,г($9E); ╙мЯZ≤1,"# 2079:"; ╧мРZ≤1,г($8F); смСZ≤1," MEGA ASSEMBLER"; ЙмТZ≤1,г(0);г(0);г(0); ЖмУZAD╡2079 ЭмЖZ▌ н[: /н[▐ ----- ASSEMBLER DIRECTIVE: .6502 ----- 5н[: Jн"[▀ L$Ё╠"" ╖ 17000 Sн,[TA╡1 Yн6[▌ _нh[: ▄нr[▐ ----- ASSEMBLER DIRECTIVE: .4510 ----- ▓н|[: ╖н├[▀ L$Ё╠"" #╖ 17000 ╟н░[TA╡2 ╤н [▌ ╪нл[: Кнж[▐ ----- ASSEMBLER DIRECTIVE: .45GS02 ----- ЯнЮ[: оЙ[▀ L$Ё╠"" ╖ 17000 оТ[TA╡3 оЧ[▌ о0\: Iо:\▐ ----- ASSEMBLER DIRECTIVE: .PAUSE ----- OоD\: ^оI\▀ PA╡1 ╖ ▌ ╜оN\≥ "PAUSING ASSEMBLY, PRESS ESC TO ABORT OR ANY OTHER KEY T#O CONTINUE..." ╥оX\║Ы K$ ооb\≥ "▒";х(SP$,70);"▒" Еоl\▀ K$╡г(27) ╖ EA╡2 Коv\▌ Яо■\: п·\▐ ----- ASSEMBLER DIRECTIVE: .LONG ----- Iпё\▐ CAUTION: HANDLES ONLY UP TO 28 BITS! Oп╗\: [п╡\█ 15600 hп╪\▀ XC ╖ ▌ ёпф\▀ VЁ0 ╟ V╠$FFFFFFF ╖ EM$╡"LONG OUT OF RANGE":█ #15100:▌ ╩пк\B╡н(V,256):█ 16700 шпл\B╡н(╣(V╜$100),256):█ 16700 Щпм\B╡н(╣(V╜$10000),256):█ 16700 !ян\B╡н(╣(V╜$1000000),256):█ 16700 Hяп\█ 16100:▀ C$╡"," ╖ █ 16200:┴ 23730 Nяз\▌ TяЬ\: └я]▐ ----- ASSEMBLER DIRECTIVE: .PROJECT ----- ┼я]: ≥я]▀ PA╡2 ╖ ▌ #дя]▀ х(L$,1)Ё╠"'" ╖ PR$╡"":█ 17000:EA╡2:▌ ся ]L$╡й(L$,2) щя4]N$╡"" р>]C$╡х(L$,1):▀ C$Ё╠"" ╞ C$Ё╠"'" ╖ N$╡N$╙C$:L$╡й(L$,2):┴ 23870 CрH]▀ C$Ё╠"'" ╖ PR$╡"":█ 17000:EA╡2:▌ pрR]█ 16200:▀ L$Ё╠"" ╖ PR$╡"":█ 17000:EA╡2:▌ ╥р\]▀ N$╡"" ╟ ц(N$)╠12 ╖ EM$╡"INVALID F#ILE NAME":█ 15100:EA╡2:PR$╡"":▌ нрf]█ 40100:▀ EA╡2 ╖ ▌ эрp]█ 40500:▌ Брz]: с{]▐ ----- ASSEMBLER DIRECTIVE: .LIMIT ----- с|]: +с}]█ 15600:▀ XC ╖ ▌ 6с~]LI╡V:▌ <с0u: gс:u▐ ----- ASSEMBLE CPU INSTRUCTION ----- mсDu: │сNu▐ READ MNEMONIC ▄сXuMN$╡"" ⌡сbuC$╡х(#L$,1) есlu▀ C$╠╡"а" ╞ C$Ё╡"з" ╖ C$╡г(ф(C$)╚128) Щсvu▀ C$╠╡"A" ╞ C$Ё╡"Z" ╖ MN$╡MN$╙C$:L$╡й(L$,2):┴ 30050 @т{u▀ C$╠╡"0" ╞ C$Ё╡"9" ╞ ц(MN$)╠0 ╖ MN$╡MN$╙C$:L$╡й(L$,2):┴ 30050 sт─u▀ MN$╡"" ╖ EM$╡"INVALID INSTRUCTION":█ 15100:▌ т┼u█ 16000 ╗т■u▐ FIND MNEMONIC #IN INSTRUCTION TABLE Нт·uII╡SI(ф(MN$)╚65):▐ II=INSTRUCTION INDEX, AI=ADDRESSING MODE INDEX у╗u▀ MN$Ё╠MN$(II) ╖ II╡II╙1:▀ IIЁNI ╖ 30120 Tу╡u▀ II╠╡NI ╖ EM$╡"UNKNOWN INSTRUCTION: "╙MN$:█ 15100:▌ pуЬu▐ CHECK ADDRESSING MODE √уv▀ L$╡"" ╟ L$╡"A" ╟ L$╡"Q" ╖ 3#1000 ╟уv▀ х(L$,1)╡"#" ╖ 31400 зуv▀ х(L$,1)╡"(" ╞ и(L$,3)╡",X)" ╖ 32000 жv▀ х(L$,1)╡"(" ╞ и(L$,6)╡",SP),Y" ╖ 32600 1ж v▀ х(L$,1)╡"(" ╞ и(L$,3)╡"),Y" ╖ 32100 [ж%v▀ х(L$,1)╡"(" ╞ и(L$,3)╡"),Z" ╖ 32300 ⌡ж&v▀ х(L$,1)╡"(" ╞ и(L$,1)╡")" ╞ й(OP$(II,12),2,1)╡#"Q" ╖ 32300 еж'v▀ х(L$,1)╡"[" ╞ и(L$,3)╡"],Z" ╖ 32700 Мж(v▀ х(L$,1)╡"[" ╞ и(L$,1)╡"]" ╖ 32700 в*v▀ х(L$,1)╡"(" ╞ и(L$,1)╡")" ╖ 32200 0в4v▀ и(L$,2)╡",X" ╖ 31800 Kв>v▀ и(L$,2)╡",Y" ╖ 31900 sвHv▀ OP$(II,14)Ё╠"" ╖ 32400:▐ BP & REL вRv┴ 31500 ╓в╢x▐ NO VALID# ADDRESSING MODE FOUND нв╬xEM$╡"INVALID ADDRESSING MODE":█ 15100 твхx▌ Чвy▐ IMPLIED ADDRESSING OR ACCUMULATOR/Q ьyAM╡0 7ь"yOP$╡OP$(II,AM):AM$╡AM$(AM):▀ L$╡"A" ╖ 31040 Lь#y▀ L$╡"Q" ╖ 31070 aь'y▀ OP$╡"" ╖ 31100 uь,y█ 31200:▀ E ╖ ▌ {ь6y▌ ╨ь@yAM$╡"ACCUMUL#ATOR":▀ и(OP$,1)Ё╠"^" ╟ й(OP$,2,1)╡"Q" ╖ 31100 рьJyOP$╡х(OP$,ц(OP$)╚1) чьTy┴ 31015 $ы^yAM$╡"Q PSEUDO REGISTER":▀ и(OP$,1)Ё╠"^" ╟ й(OP$,2,1)Ё╠"Q" ╖ 31100 <ыhyOP$╡х(OP$,ц(OP$)╚1) Hыry┴ 31015 lы|y▐ ADDRESSING MODE NOT AVAILABLE ║ы├yEM$╡AM$╙" ADDRESSING MODE# NOT AVAILABLE":█ 15100 ╖ы░y▌ ЮыЮy▐ SUB WRITE OPCODE TO OUTPUT IF AVAILABLE FOR TARGET зАy▐ RETURN E=1 IF NOT AVAILABLE зБyE╡0:X╡1 'зЦy▀ х(OP$,1)╡"@" ╖ X╡2 @зДy▀ х(OP$,1)╡"\" ╖ X╡3 YзЕy▀ X╠1 ╖ OP$╡й(OP$,2) ║зФy▀ TAЁX ╖ E╡1:EM$╡"NOT AVAILABLE FOR SPECIF#IED TARGET CPU":█ 15100:▌ ╫зГy▀ х(OP$,1)Ё╠"Q" ╖ 31210 нзХyOP$╡й(OP$,2) ХзИyB╡$42:█ 16700:█ 16700 ШзЙy▀ ц(OP$)Ё2 ╖ ▌ шТyB╡я(х(OP$,2)):█ 16700 .шЧyOP$╡й(OP$,3):┴ 31210 iшDz▐ SUB WRITE ABSOLUTE VALUE V (LOW/HIGH BYTE) TO OUTPUT ▐шIz▐ WORKS ALSO FOR NEGATIV#E NUMBERS ╙шNzB╡я(и(р(V),2)):█ 16700 йшXzB╡я(х(и(р(V),4),2)):█ 16700 пшbz▌ Щш╗z▐ IMMEDIATE ADDRESSING OR IMMEDIATE WORD э╡zAM╡1:▀ OP$(II,17)Ё╠"" ╖ AM╡17 Oэ╪zOP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 fэфzL$╡й(L$,2):█ 16000 {эпz█ 15600:▀ XC ╖ ▌ ░эзz▀ L$#Ё╠"" ╖ 17000 ёэшz▀ AM╡1 ╖ 31460 шээz▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ Гэщz┴ 31470 щДz▀ VЁ0 ╟ V╠255 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ 1щНz█ 31200:▀ E ╖ ▌ OщСz▀ AM╡17 ╖ █ 31300:┴ 31490 _щЬzB╡V:█ 16700 eщ{▌ √щ{▐ ABSOLUTE, BASE PAGE OR#  RELATIVE ADDRESSING гщ{FA╡0:▀ х(L$,1)╡"!" ╖ L$╡й(L$,2):█ 16000:FA╡1 Сщ{▀ OP$(II,4)Ё╠"" ╟ OP$(II,5)Ё╠"" ╖ 31700 ч{█ 15600:▀ XC ╖ ▌ ч {▀ L$Ё╠"" ╖ 17000 Uч*{▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ ▌ч4{▀ FA╡0 ╞ US╡0 ╞ VЁ╡255 ╞ OP$(II,2)Ё╠""#! ╖ AM╡2:у AM╡3 ╬ч>{OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 рчH{█ 31200:▀ E ╖ ▌ УчR{▀ AM╡2 ╖ ZP╡ZP╙1:B╡V:█ 16700:▌ ъ\{█ 31300:▌ 0ът{▐ RELATIVE ADDRESSING OR 16 BIT RELATIVE Eъч{█ 15600:▀ XC ╖ ▌ Zъъ{▀ L$Ё╠"" ╖ 17000 ▓ъР{▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT#" OF RANGE":█ 15100:▌ ╚ъЭ{▀ FA╡1 ╖ AM╡5:у AM╡4 эъЪ{▀ AM╡4 ╞ OP$(II,4)╡"" ╞ OP$(II,5)Ё╠"" ╖ AM╡5 Уъ|▀ PA╡1 ╖ V╡0:┴ 31747 Ю|V╡V╚(AD╙2):▐ IF AM=5 THEN V=V-1 IЮ|OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 oЮ|▀ AM╡4 ╞ (VЁ╚128 ╟ V╠127) ╖ 31785 ┐Ю|█ 31200:##▀ E ╖ ▌  Ю|▀ AM╡5 ╖ █ 31300:▌ ╟Ю|B╡V ╞ 255:█ 16700 ╤Ю$|▌ тЮ)|EM$╡"BRANCH OUT OF RANGE" &А*|▀ TA╠1 ╞ OP$(II,5)Ё╠"" ╖ EM$╡EM$╙" (TRY USING '!' OR LB.. FOR 16 BIT BRANCH)" 4А+|█ 15100:▌ dА8|▐ X-INDEXED ABSOLUTE OR BASEPAGE ADDRESSING ∙А=|FA╡0:▀ х(L$,1)╡"!#$" ╖ L$╡й(L$,2):█ 16000:FA╡1 ╙АB|█ 15600:▀ XC ╖ ▌ аАL|▀ L$Ё╠",X" ╖ 17000 ЫАV|▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ 2Б`|▀ FA╡0 ╞ US╡0 ╞ VЁ╡255 ╞ OP$(II,5)Ё╠"" ╖ AM╡6:у AM╡8 bБj|OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 vБt|█ 31200:▀ E ╖ ▌ ≥#%Б~|▀ AM╡6 ╖ ZP╡ZP╙1:B╡V:█ 16700:▌ ╖Б┬|█ 31300:▌ вБ°|▐ Y-INDEXED ABSOLUTE OR BASEPAGE ADDRESSING Ц║|FA╡0:▀ х(L$,1)╡"!" ╖ L$╡й(L$,2):█ 16000:FA╡1 Ц╕|█ 15600:▀ XC ╖ ▌ 4Ц╟|▀ L$Ё╠",Y" ╖ 17000 lЦ╨|▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ ╔Цд|▀ FA╡#&0 ╞ US╡0 ╞ VЁ╡255 ╞ OP$(II,6)Ё╠"" ╖ AM╡7:у AM╡9 уЦн|OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 ИЦь|█ 31200:▀ E ╖ ▌ ДБ|▀ AM╡7 ╖ ZP╡ZP╙1:B╡V:█ 16700:▌ ДЛ|█ 31300:▌ LД }▐ X-INDEXED INDIRECT ADDRESSING (8 OR 16 BIT) cД
}L$╡й(L$,2):█ 16000 ▐Д}▀ TA╠1 ╞ OP$#'(II,15)Ё╠"" ╖ AM╡15:у AM╡10 ©Д}OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 тД(}█ 15600:▀ XC ╖ ▌ ЛД2}▀ L$Ё╠",X)" ╖ 17000 $Е7}▀ VЁ0 ╟ V╠65535 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ \Е<}▀ AM╡10 ╞ V╠255 ╖ EM$╡"DATA OUT OF RANGE":█ 15100:▌ pЕF}█ 31200:▀ E ╖ ▌ ┬" ЕK}▀ AM╡15 ╖ █ 31300:▌ ≤ЕP}B╡V:█ 16700 ·ЕZ}▌ бЕd}▐ INDIRECT Y-INDEXED ADDRESSING ыЕn}L$╡й(L$,2):█ 16000 ЦЕx}AM╡11 Ф┌}OP$╡OP$(II,AM):AM$╡AM$(AM):▀ OP$╡"" ╖ 31100 (Ф▄}█ 15600:▀ XC ╖ ▌ @Ф√}▀ L$Ё╠"),Y" ╖ 17000 vФ═}▀ VЁ0 ╟ V╠255 ╖ EM$╡"DATA OUT OF RANGE":█ 1$R OF THE ALPHABET j≈*5┐ 0,9,38,48,54,0,0,0,57,63,0,65,81,82,84,86,0,97,112,131,0,0,0,0,0,0 p≈≤:: v≈╒:▐ ╦≈╛:▐ *************** ASSEMBLER UTILITY FUNCTIONS *************** ╬≈╤:▐ д≈Э:: З≈;▐ SUB ----- PUT ERROR MESSAGE EM$ IN BUFFER -----  ≤;: ≤;▀ EB╡10 ╖$ 15140 E≤;▀ EB╡9 ╖ EM$╡"ERROR MESSAGE BUFFER OVERFLOW" Q≤;EB╡EB╙1 r≤;▀ AL╡0 ╖ EB$(EB)╡EM$:┴ 15140 ²≤;EB$(EB)╡"ERROR IN LINE"╙д(AL)╙": "╙EM$ ╘≤$;NE╡NE╙1 ╞≤.;▌ ╣≤`;: С≤j;▐ SUB ----- ADD SYMBOL/VALUE SN$/SV TO SYMBOL TABLE ----- 5≥o;▐ EF=1/2 FLAGS EXTER$NAL SYMBOLS (1=IMPORTED 2=TO BE EXPORTED) ;≥t;: \≥u;C$╡х(SN$,1):▀ C$╡"." ╖ 15223 ≤≥v;▀ ╗ ((C$╠╡"A" ╞ C$Ё╡"Z") ╟ (C$╠╡"а" ╞ C$Ё╡"з")) ╖ 15227 ╗≥w;T$╡й(SN$,2) ╪≥x;▀ T$╡"" ╖ 15230 ж≥y;C$╡х(T$,1):T$╡й(T$,2) - z;▀ (C$╠╡"A" ╞ C$Ё╡"Z") ╟ (C$╠╡"а" ╞ C$Ё╡"з") ╟ ($C$╠╡"0" ╞ C$Ё╡"9") ╟ C$╡"." ╖ 15224 S {;EM$╡"INVALID SYMBOL NAME":█ 15100 Y |;▌ ┴ ~;▀ NS╡MS ╖ EM$╡"SYMBOL TABLE FULL":█ 15100:▌ ╙ ┬;N$╡SN$:█ 17300:▀ I╡0 ╖ 15290 э ╕;EM$╡"SYMBOL "╙SN$╙ " ALREADY DEFINED":█ 15100 Б ╟;▌ ⌡╨;NS╡NS╙1:SN$(NS)╡SN$:SV(NS)╡SV:SE%$(NS)╡EF:█ 17200 ⌡©;▌ #⌡д;: Y⌡н;▐ SUB ----- FIND SYMBOL SN$ IN SYMBOL TABLE ----- ▀⌡с;▐           RETURN VALUE V, RC=1 IF NOT FOUND ╦⌡т;▐           DO NOT THROW ERROR WHEN NV=1 Ш⌡у;▐           RETURN 0 FOR UNKNOWN SYMBOLS IN IGNORE MODE (IG=1) 8°ж;▐ FIND$S GLOBAL SYMBOLS OR SYMBOLS IN CURRENT SECTION CS$ >°ь;: g°Б;▀ х(SN$,1)╡"." ╖ N$╡CS$╙SN$:у N$╡SN$ ├°Л;RC╡0:█ 17300:▀ I╡0 ╖ 15375 ■°
<V╡SV(I):▌ с°<▀ IG ╖ V╡0:O$╡"·WARNING: SYMBOL "╙N$╙" IGNORED":█ 16600:▌ ²<▀ NV╡0 ╖ EM$╡"SYMBOL "╙N$╙" NOT FOUND":█ 151$00 ²<RC╡1:V╡0:▌ ²(<: T²2<▐ SUB ----- DISPLAY ERROR MESSAGES FROM BUFFER ----- Z²<<: i²F<▀ EB╡0 ╖ ▌ x²P<│ X╡1 ╓ EB ≥²Z<   O$╡"│"╙EB$(X)╙"":█ 16600 ║²d<┌ X ╙²n<EB╡0 ╥²o<▀ EH ╖ ▌ ·p<≥ "ESC=ABORT   N=CONTINUE TO NEXT ERROR   ANY OTHER KEY=CONTINUE TO E$ND" ·q<║Ы K$ .·r<▀ K$╡г(27) ╖ EA╡2:┴ 15480 C·s<▀ K$╡"N" ╖ 15480 T·t<EH╡1:┴ 15480 l·x<≥ "▒";х(SP$,70);"▒" r·┌<▌ x·▄<: ©·√<▐ SUB ----- CHECK L$ FOR INSTRUCTION I$, RETURN F=1 IF FOUND ----- В·═<▐           AND REMOVE FROM L$ INCL. LEADING SPACES Щ·╙<: ÷$	╞<I╡1:К Щ й(L$,I,1)╡" ":I╡I╙1:Л 8÷╢<▀ т(L$,I$)╡I ╖ 15555 B÷╬<F╡0:▌ r÷ц<C$╡й(L$,ц(I$)╙I,1):▀ C$╡"" ╟ C$╡" " ╖ 15560 ╙÷д<▀ (C$╠╡"A" ╞ C$Ё╡"Z") ╟ (C$╠╡"а" ╞ C$Ё╡"з") ╖ 15550 й÷е<▀ C$╠╡"0" ╞ C$Ё╡"9" ╖ 15550 ъ÷х<L$╡й(L$,ц(I$)╙I)  ═р<К Щ х(L$,1)╡" ":L$╡й(L$,2)$
:Л 
═э<F╡1:▌ ═П<: P═З<▐ SUB ----- EVALUATE EXPRESSION IN L$, RETURN VALUE V ----- ┬═Ъ<▐           AND REMOVE FROM L$ INCL. LEADING SPACES ╠═ =▐           XC<>0 INDICATES AN ERROR Ь═=▐           SX=1 SKIPS EVALUATION OF YET UNKNOWN SYMBOLS ON PASS 1 =║$=▐           AND RETURNS US=1 / V=0 IF UNKNOWN SYMBOL ENCOUNTERED C║=: f║	=US╡0:NV╡0:▀ SX╡1 ╞ PA╡1 ╖ NV╡1 │║=XC╡0:▀ ц(L$)╠0 ╖ 15633 ╚║=EM$╡"MISSING EXPRESSION":█ 15100:XC╡1 ╣║=V╡0:▌ Ь║=▐ EXPRESSION VARIABLES: XS/XE START/END INDEX, XC=CANCEL EVAL. $╒=▐ XV=VALUE, XL=LEVEL OF RECURSION 4╒=XS╡1:XL╡0:█ 15800 f╒=▀ XC ╖ EM$╡"INVALID EXPRESSION":█ 15100:V╡0:▌ ─╒=L$╡й(L$,XE╙1):█ 16000 ░╒=▀ US ╖ XV╡0 ⌡╒=V╡XV:▌ ж╒"=▐ SUB EVALUATE COMPONENT OF EXPRESSION, STARTING AT XS ё#=▐ RETURN XV, XE (VALUE, LAST $INDEX OF EXPRESSION) ё$=XV╡0 Bё,=C$╡й(L$,XS,1):▀ C$╡" " ╖ XS╡XS╙1:┴ 15660 Wё-=▀ C$╡"(" ╖ 15730 uё.=▀ C$╡"<" ╟ C$╡">" ╖ 15720 ┼ё/=▀ C$╡"*" ╖ 15710 ╝ё0=▀ т("$%0123456789-",C$) ╖ 15680 Оё1=▀ (C$╠╡"A" ╞ C$Ё╡"Z") ╟ (C$╠╡"а" ╞ C$Ё╡"з") ╟ C$╡"." ╖ 15690 ╓2=▀ $C$╡"'" ╖ 15700 ╓6=XC╡1:XV╡0:▌:▐ ERROR 1╓@=▐ NUMBER LITERAL D╓A=█ 16300:XV╡V:▌ Q╓J=▐ SYMBOL b╓K=SN$╡C$:XE╡XS v╓L=C$╡й(L$,XE╙1,1) Б╓M=▀ (C$╠╡"A" ╞ C$Ё╡"Z") ╟ (C$╠╡"а" ╞ C$Ё╡"з") ╟ (C$╠╡"0" ╞ C$Ё╡"9") ╟ C$╡"." ╖ SN$╡SN$╙C$:XE╡XE╙1:┴ 15692 ╔N=V╡0:▀ US╡0 ╖ $█ 15300:▀ RC ╖ US╡1:┴ 15696 ╔O=XV╡V:▌ 1╔P=XV╡0:▀ NV╡0 ╖ XC╡1 7╔Q=▌ U╔T=▐ CHARACTER LITERAL ('C') u╔U=▀ й(L$,XS╙2,1)Ё╠"'" ╖ 15670 √╔V=XV╡ф(й(L$,XS╙1,1)):XE╡XS╙2:▌ ╗╔^=▐ ADDRESS (*) ╨╔_=XE╡XS:XV╡AD:▌ т╔h=▐ LOW/HIGH BYTE < / > ъ╔i=XC$╡C$ Э╔j=XS╡XS╙1:█ 1565$0:▀ XC ╖ ▌ )╕k=▀ XC$╡"<" ╖ XV╡н(XV,256):у XV╡╣(XV╜256) /╕l=▌ J╕r=▐ BRACKETED EXPRESSION V╕s=XS╡XS╙1 ∙╕t=▀ XL╡10 ╖ XC╡1:EM$╡"TOO MANY NESTED EXPRESSIONS":█ 15100:▌ ║╕u=XL╡XL╙1 ╩╕v=XS(XL)╡XS:XC$(XL)╡XC$ И╕w=PS(XL)╡PS:PF(XL)╡PF:PP(XL)╡PP:PO$(XL)╡PO$ Ч╕|=█ $15800:▀ XC ╖ ▌ ,╖│=PS╡PS(XL):PF╡PF(XL):PP╡PP(XL):PO$╡PO$(XL) F╖┌=XS╡XS(XL):XC$╡XC$(XL) R╖┐=XL╡XL╚1 }╖├=XE╡XE╙1:C$╡й(L$,XE,1):▀ C$╡" " ╖ 15750 ╨╖┤=▀ C$Ё╠")" ╖ XC╡1:EM$╡"CLOSING BRACKET MISSING":█ 15100:▌ ю╖┬=▌ И╖╦=▐ SUB EVALUATE SUM OF PRODUCTS AT XS ╗╧=$▐ RETURN XV, XE, XC C╗╨=▐ USE PS=SUM PP=PROD PF=1/-1 FOR PLUS/MINUS PO$=*/% OPERATION └╗╩=▐ THIS WILL ALSO EVALUATE LOGICAL OPERATORS &=AND .=OR :=EOR ╚╗╪=▐ WITH SAME PRIORITY AS *, / AND % ╧╗б=PS╡0:PF╡1 й╗ц=PP╡1:PO$╡"*" С╗д=█ 15650:▐ GET NEXT VALUE AT X$S AS XV ╘е=XS╡XE╙1:▀ XC ╖ ▌ 4╘ф=▀ US╡0 ╖ █ 15830:▐ COMBINE WITH PRODUCT a╘г=C$╡й(L$,XS,1):▀ C$╡" " ╖ XS╡XS╙1:┴ 15815 ▐╘х=▀ т("*/%&.:",C$) ╖ PO$╡C$:XS╡XS╙1:┴ 15812 ╡╘и=PS╡PS╙PF╛PP:▐ COMBINE WITH SUM щ╘й=▀ C$╡"+" ╖ PO$╡C$:PF╡1:XS╡XS╙1:┴ 15811 	╙к=▀ C$╡"-"$ ╖ PO$╡C$:PF╡╚1:XS╡XS╙1:┴ 15811 ╙л=▐ END OF TERM -╙м=XE╡XS╚1:XV╡PS 3╙н=▌ i╙ж=▐ SUB COMBINE XV WITH PRODUCT / LOGICAL OPERATORS └╙в=▀ PO$╡"*" ╖ PP╡PP╛XV:▌ ║╙ь=▀ PO$╡"&" ╖ PP╡PP ╞ XV:▌ ╬╙ы=▀ PO$╡"." ╖ PP╡PP ╟ XV:▌ ш╙з=▀ PO$╡":" ╖ PP╡PP И XV:▌ ╚Б=▀ XV╡0 ╖$ XC╡1:EM$╡"DIVISION BY ZERO":█ 15100:▌ ,╚Ц=▀ PO$╡"/" ╖ PP╡╣(PP╜XV):▌ K╚Д=▀ PO$╡"%" ╖ PP╡н(PP,XV):▌ V╚Е=XC╡1:▌ \╚─>: ░╚┼>▐ SUB ----- REMOVE LEADING SPACES FROM L$ ----- √╚■>: ╥╚·>К Щ х(L$,1)╡" ":L$╡й(L$,2):Л ╫╚╗>▌ ц╚Д>: ╛Н>▐ SUB ----- PREVIEW FIRST CHAR$ACTER FROM LINE IN C$ ----- ╛Ь>: ╛?C$╡х(L$,1):▌ ╛H?: \╛R?▐ SUB ----- CONSUME FIRST CHARACTER FROM LINE IN C$ ----- ~╛W?▐           AND REMOVE SPACES └╛\?: ⌠╛f?C$╡х(L$,1) ╙╛p?L$╡й(L$,2):█ 16000 ╟╛z?▌ ╤╛╛?: ╜╤?▐ SUB ----- READ NUMBER LITERAL IN BIN/DE$C/HEX, RETURN VALUE IN V ----- H╜╩?▐           READ FROM L$ AT POSITION XS, RETURN XE=LAST CHARACTER N╜ю?: z╜й?I╡XS:▀ й(L$,I,1)╡"-" ╖ S╡╚1:I╡I╙1:у S╡1 ÷╜т?V╡0:C$╡й(L$,I,1):▀ C$╡"" ╖ 16380 ╢╜ч?▀ C$╡"$" ╖ 16450 и╜Х?▀ C$╡"%" ╖ 16550 Й╜Р?▀ т("0123456789",C$)$ ╖ 16390 ╝Э?EM$╡"INVALID NUMBER":█ 15100:V╡0:XC╡1:▌ +╝@▐ DECIMAL NUMBER L╝@C$╡й(L$,I,1):▀ C$╡"" ╖ 16420 ┌╝@▀ т("0123456789",C$) ╖ V╡10╛V╙е(C$):I╡I╙1:┴ 16400 ∙╝$@V╡V╛S:XE╡I╚1:▌ ╝╝B@▐ HEXADECIMAL NUMBER у╝L@I╡I╙1:C$╡й(L$,I,1):▀ C$╡"" ╖ 16500 ╞V@X╡т("0$123456789ABCDEFабцдеф",C$):▀ X╡0 ╖ 16500 ╞`@▀ X╠16 ╖ X╡X╚6 2╞j@V╡16╛V╙X╚1:┴ 16460 E╞t@V╡V╛S:XE╡I╚1:▌ Y╞╕@▐ BINARY NUMBER ─╞╟@I╡I╙1:C$╡й(L$,I,1):▀ C$╡"" ╖ 16590 ÷╞╨@X╡т("01",C$):▀ X╡0 ╖ 16590 ╣╞д@V╡2╛V╙X╚1:┴ 16560 х╞н@V╡V╛S:XE╡I╚1:▌ н╞ь@: ╟Б@▐ SUB -----$ OUTPUT LINE O$ TO ASSEMBLY LISTING ----- ╟Л@: ╟Ж@≥ O$ ╟ A▌ "╟<A: V╟FA▐ SUB ----- OUTPUT BYTE B TO MACHINE CODE ----- \╟PA: ▒╟ZA▀ NB╡MB ╖ EM$╡"TOO MANY BYTES IN LINE":█ 15100:▌ ╗╟dANB╡NB╙1:BY(NB)╡B:▌ ╝╟═A: Й╟╙A▐ SUB ----- OUTPUT MACHINE CODE TO MEMORY$ OR FILE ----- ╠╢A▐           BYTE B IS WRITTEN TO ADDRESS AD  ╠╬A: ;╠хA▀ OF$Ё╠"" ╖ ≤1,г(B);:▌ L╠рAЧ BK:≈ AD,B R╠эA▌ X╠hB: ┼╠rB▐ ----- DISPLAY SYNTAX ERROR AND RETURN ----- ░╠|B: ╞╠├BEM$╡"SYNTAX ERROR":█ 15100 ╣╠░B▌ ╩╠лB: Ш╠жB▐ SUB ----- HIGHLIGHT COMM$ENTS IN OL$ AFTER ;; YELLOW ----- ╡ЮB: ╡ЙBI╡т(OL$,";;"):▀ I╡0 ╖ ▌ C╡ТBOL$╡х(OL$,I╙1)╙"·"╙й(OL$,I╙2)╙"" I╡ЧB▌ O╡0C: │╡:C▐ SUB ----- ADD LATEST SYMBOL TO B-TREE ----- ┤╡DC: ╝╡NCI╡1:BL%(NS)╡0:BG%(NS)╡0:▀ NS╡1 ╖ ▌ к╡XC▀ SN$(NS)ЁSN$(I) ╖ 17270 К╡bC▀ BG%(I)$ ╖ I╡BG%(I):┴ 17240 Ш╡lCBG%(I)╡NS:▌ ЁvC▀ BL%(I) ╖ I╡BL%(I):┴ 17240 +Ё─CBL%(I)╡NS:▌ 1Ё■C: eЁ·C▐ SUB ----- FIND SYMBOL N$ THROUGH B-TREE ----- ┐Ё╗C▐ --> INDEX I 0=NOT FOUND ┴Ё╡C: ·Ё╪CI╡1:▀ NS╡0 ╖ I╡0 ╛ЁфC▀ I╡0 ╖ ▌ юЁпC▀ SN$(I)╡N$ ╖ ▌ ФЁзC▀ N$ЁSN$(I) ╖ I╡B$L%(I):у I╡BG%(I) РЁДC┴ 17350 ЬЁ N: 0╢*N▐ SUB ********** RUN ASSEMBLER PASS (PA) ********** 6╢4N: j╢9NAD╡DA:BK╡DB:▐ START AT DEFAULT ADDRESS AND BANK ▌╢:NZP╡0:▐ COUNT ZERO PAGE ACCESSES ╥╢;NTA╡3:▐ TARGET 1=6502 2=4510 3=45GS02 т╢<NCS$╡"":▐ CURRENT SECTION$ Т╢>NAL╡0:▐ ASSEMBLY LINE NUMBER ╣HNAL╡AL╙1:▀ AL╠NL ╖ 20100 ╣RNL$╡L$(AL) *╣\N█ 21000 =╣fN▀ EA╡0 ╖ 20040 C╣└N▌ I╣R: p╣R▐ SUB ----- ASSEMBLE LINE L$ ----- v╣R: ▒╣R║ K$:▀ K$╡г(27) ╖ EA╡2 п╣ RSX╡0:▐ DO NOT SKIP EXPRESSION EVALUATION ON PASS 1 FOR NOW В$ ╣!REO$╡"":▐ NO EXTRA OUTPUT UNTIL NOW ╤&ROL$╡L$:▐ SAVE ORIGINAL LINE #╤'R█ 17100 P╤+RNB╡0:EB╡0:▐ CLEAR BYTES AND ERROR BUFFER y╤0R▐ STRIP COMMENTS AND TRAILING SPACES ё╤:RI╡т(L$,";"):▀ I ╖ L$╡х(L$,I╚1):█ 7100 ╨╤DR▀ L$Ё╠"" ╖ █ 21500 Я╤lR▐ LINE IS ASSEMBL$!ED, DISPLAY OUTPUT AND WRITE DATA ╥qR▀ PA╡1 ╖ AD╡AD╙NB 2╥vR▀ PA╡1 ╞ EB╠0 ╖ O$╡OL$:█ 16600:┴ 21200 A╥{R▀ PA╡1 ╖ ▌ o╥|R▀ NB╡0 ╖ O$╡х(SP$,20)╙OL$:█ 16600:┴ 21190 └╥─RO$╡р(AD):I╡0:F╡0 ⌠╥┼R│ X╡1 ╓ NB ╪╥■R   B╡BY(X):T$╡й(р(B),3):O$╡O$╙" "╙T$ Г╥∙R   █ 16800:▐ $"WRITE MACHINE CODE OUTPUT 1╦√R   ▀ RA╡0 ╞ OF$╡"" ╖ RA╡AD:RB╡BK:▐ SAVE START ADDRESS/BANK OF PROGRAM @╦≈R   AD╡AD╙1 M╦≥R   I╡I╙1 f╦ R   ▀ I╡8 ╟ X╡NB ╖ Ч {╦°R      ▀ F╡0 ╖ Ч ╚╦·R         ▀ ц(O$)Ё19 ╖ O$╡O$╙х(SP$,19╚ц(O$)) й╦÷R         O$╡O$╙" "╙OL$:F╡1 в$#╦═R      Ч Ж╦║R      █ 16600:O$╡р(AD):I╡0  ╧ёR   Ч ╧╗R┌ X '╧фR▀ EO$Ё╠"" ╖ O$╡EO$:█ 16600 L╧пR█ 15400:▐ DISPLAY ERROR MESSAGES R╧зR▌ X╧ЭS: ┴╧ЩS▐ SUB ----- ASSEMBLE NON-EMPTY LINE L$ ----- ▐╧ЧS: ё╧T▐ EXTRACT LABEL и╧TEF╡0:▀ х(L$,7)Ё╠"EXPORT " ╖ 21540 $$Е╧TL$╡й(L$,8):█ 16000:EF╡2 Т╧$TC$╡х(L$,1) 	╨.T▀ C$╡" " ╖ 21600 &╨8TI╡т(L$," "):I2╡т(L$,"=") @╨9T▀ IЁ╠0 ╞ I2╡0 ╖ 21570 a╨:T▀ I╡0 ╞ I2Ё╠0 ╖ I╡I2:┴ 21570 ┌╨;T▀ IЁ╠0 ╞ I2Ё╠0 ╞ I2ЁI ╖ I╡I2 ё╨BT▀ I ╖ SN$╡х(L$,I╚1):у SN$╡L$ а╨LTL$╡й(L$,ц(SN$)╙1):█ 16000 Д╨MT▀ $%х(L$,1)Ё╠"=" ╖ SV╡AD:┴ 21585 Ш╨NTL$╡й(L$,2):█ 16000 ╩OTS2$╡SN$:█ 15600:SV╡V:SN$╡S2$ :╩QT▀ х(SN$,1)Ё╠"." ╖ CS$╡SN$ w╩VT▀ PAЁ╠1 ╖ 21600:▐ ADD TO SYMBOL TABLE ONLY DURING PASS 1 ≤╩XT▀ х(SN$,1)╡"." ╖ SN$╡CS$╙SN$ ╓╩YT█ 15200 ю╩`T▐ REMOVE LEADING SPACES А╩jTК$& Щ х(L$,1)╡" ":L$╡й(L$,2):Л Я╩tT▀ L$╡"" ╖ ▌ "╪дT▐ ----- CHECK FOR ASSEMBLER DIRECTIVES ----- `╪иTSX╡1:▐ SKIP EXPRESSION EVALUATION ON PASS 1 STARTING HERE o╪нTC$╡х(L$,1) ▐╪ьT▀ C$Ё╠"*" ╞ C$Ё╠"." ╖ 21990 ©╪БT▀ х(L$,2)╡"*=" ╖ L$╡й(L$,3):█ 16000:┴ 22000 А╪ЛT$'I$╡".END":█ 15500:▀ F ╖ 22200 ╫ЖTI$╡".PRINTHEX":█ 15500:▀ F ╖ 22400 ,╫ UI$╡".PRINT":█ 15500:▀ F ╖ 22300 O╫
UI$╡".BYTE":█ 15500:▀ F ╖ 22500 r╫UI$╡".WORD":█ 15500:▀ F ╖ 22600 ∙╫UI$╡".TEXT":█ 15500:▀ F ╖ 22700 ╥╫(UI$╡".RUN":█ 15500:▀ F ╖ 22800 з╫2UI$╡".B# ANK":█ 15500:▀ F ╖ 22900 ╬<UI$╡".BASIC64":█ 15500:▀ F ╖ C4╡1:┴ 23000 2╬AUI$╡".BASIC":█ 15500:▀ F ╖ C4╡0:┴ 23000 U╬FUI$╡".6502":█ 15500:▀ F ╖ 23300 x╬PUI$╡".4510":█ 15500:▀ F ╖ 23400 ²╬ZUI$╡".45GS02":█ 15500:▀ F ╖ 23500 а╬dUI$╡".PAUSE":█ 15500:▀ F ╖ 2360% THE WHOLE PROJECT WHILE WORKING ON A SINGLE FILE." ФoУ&≥ "THE NEXT AVAILABLE ADDRESS, PRINTED OUT AFTER ASSEMBLY OF EACH FILE, WILL" (pЖ&≥ "HELP YOU TO ORGANIZE YOUR ASSEMBLY DESTINATION ADDRESSES." pВ&≥ "TIPP: START EACH FILE WITH A JMP TO THE MAIN %PROGRAM, SO YOU CAN QUICKLY TEST" уpЬ&≥ "DIRECTLY FROM MEGA ASSEMBLER, NO MATTER WHICH FILE YOU ARE CURRENTLY EDITING." %qЫ&≥ "USE IGNORE MODE TO REBUILD A PROJECT FILE IF YOU HAVE CROSS-REFERENCES." Bq'≥"PRESS ANY KEY";:║Ы K$ Lq'┴ 300 Rq': Xq'▐ ▓q$%'▐ ******************** ASSEMBLER ******************** ≤q.'▐ ·qt': еq~'▐ ----- INITIALIZE ASSEMBLER ----- кq┬': жq▓'≥ "⌠"; r≈'O$╡"MEGA ASSEMBLER V"╙VN$╙" BY THOMAS GRUBER":█ 16600 &r≤'█ 7700:▀ SE ╖ 300 8r≥'O$╡"":█ 16600 Ir°'▀ AI ╖ 10190 jr╕'▐ CREATE SYM%BOL TABLE ARRAYS ▒r╟'MS╡200:▐ MAXIMUM SYMBOL TABLE SIZE Уr╨'├ SN$(MS),SV(MS),SE%(MS),BL%(MS),BG%(MS):▐ SYMBOL NAME, VALUE, EXTERNAL (1=IMPORTED 2=EXPORTED) 3s╩'ME╡200:▐ MAXIMUM EXTERNAL SYMBOLS FOR MULTI-FILE PROJECTS us╪'├ ES$(ME):ES╡0:▐ EXTERNAL SYMBOL%S, NUMBER OF SYMBOLS IN ARRAY ╔s╬'MB╡80:▐ MAX NUMBER OF OUTPUT BYTES PER LINE мs©'├ BY(MB):▐ BYTES FROM ASSEMBLY LINE Вsю'├ EB$(10):EB╡0:▐ ERROR MESSAGE BUFFER tб'█ 12000:▐ READ INSTRUCTION TABLE @tд'AI╡1:▐ ASSEMBLER IS INITIALIZED ]tн'NS╡0:▐ NUMBER OF %SYMBOLS ytь'NE╡0:▐ NUMBER OF ERRORS ╖tщ'EH╡0:▐ ERROR HANDLING 0=PAUSE, 1=CONTINUE уtБ'NB╡0:▐ NUMBER OF BYTES FROM ASSEMBLY LINE uЛ'EA╡0:▐ END ASSEMBLY FLAG (1=END PASS, 2=ABORT ASSEMBLY) 6uМ'LI╡╚1:▐ NO LIMIT FOR OUTPUT SIZE auЖ'▐ ASSEMBLY RESULTS TO RET%URN TO EDITOR ⌠u (RA╡0:RB╡0:▐ START ADDRESS AND BANK OF PROGRAM нu
(RO╡0:▐ SET IF ASSEMBLY WAS OK AND ADDRESS HAS BEEN SET v(RF╡0:▐ RUNFLAGS: BIT 0=CLEAR SCREEN, BIT 1=WAIT FOR KEY, BIT 2=AUTORUN Qv(OF$╡"":▐ OUTPUT FILE, OR ASSEMBLE TO MEMORY IF NONE %}v((EF╡0:▐ EXTERNAL FLAG FOR ADDING SYMBOLS ┐vЬ*: ╕v+▐ ----- ASSEMBLE PROGRAM ----- ╛v+: ╧v+▐ PASS 1 шv +PA╡1:O$╡"PASS 1":█ 16600:EA╡0 Гv*+█ 20000 Зv4+▀ EA╡2 ╖ 11300 (w>+Z1╡ZP:▐ SAVE NUMBER OF ZERO PAGE ACCESSES 5w\+▐ PASS 2 Wwf+PA╡2:O$╡"PASS 2":█ 166%	00:EA╡0 iwg+O$╡"":█ 16600 uwp+█ 20000 ┤wq+O$╡"":█ 16600 ╒wr+▀ LI╡╚1 ╟ RA╡0 ╖ 11125 xs+▀ (AD╚RA)╠LI ╖ AL╡0:EH╡1:EM$╡"OUTPUT LIMIT EXCEEDED, POSSIBLE MEMORY CORRUPTION":█ 15100:█ 15400 xu+▀ EA╡2 ╖ 11300 yxw+▀ ZPЁ╠Z1 ╖ AL╡0:EH╡1:EM$╡"SYNCHRONIZATION ERROR%
: CHECK ZERO PAGE ACCESSES":█ 15100:█ 15400 ▌xy+▀ NE╡0 ╖ █ 40700 ╪xz+▀ NE ╖ S$╡д(NE):S$╡"│"╙й(S$,2):у S$╡"NO" Цx└+S$╡S$╙" ERROR":▀ NEЁ╠1 ╖ S$╡S$╙"S" Ыx▌+O$╡S$╙"":█ 16600 !y≤+▀ NE╡0 ╞ RAЁ╠0 ╖ RO╡1:▐ ASSEMBLY OK Cyю+▐ CLOSE FILE AND WAIT FOR KEY _yе+▀ OF%$Ё╠"" ╖ Ч#1:OF$╡"" ┤yф+▀ (RF ╞ 4)Ё╠0 ╞ AR╡0 ╞ ROЁ╠0 ╖ AR╡1 ║yг+▀ AR ╖ K$╡"R":┴ 11224 ╧yй+≥ "PRESS ANY KEY"; жyк+▀ RO ╖ ≥ " OR R TO RUN"; Юyл+≥ "" Йyт+║Ы K$ Эyь+▀ AR╡1 ╖ AR╡0 4zы+▀ (K$╡"R" ╟ K$╡"╡") ╞ RO╡1 ╖ ≥ "RUNNING...";:┴ 6100 >zч+┴ 300 Sz$,▐ ABORT% ASSEMBLY xz.,O$╡"│ABORTING ASSEMBLY":█ 16600 └z8,┴ 11200 ┼zЮ.: аzЙ.▐ SUB ----- READ ASSEMBLER INSTRUCTION TABLE ----- гzТ.: МzЫ.┤ NA:▐ NUMBER OF ADDRESSING MODES {З.├ AM$(NA╚1):│ X╡0 ╓ NA╚1:┤ AM$(X):┌ X 9{Ч.┤ NI:▐ NUMBER OF INSTRUCTIONS h{/├ MN$(NI╚1%):▐ MNEMONICS, INDEX STARTS AT 0 ╒{/├ OP$(NI╚1,NA╚1):▐ OPCODES, SECOND INDEXES START AT 0 е{/▄ 13500:├ PI(NI╚1):▐ PUT INDEX Б{/│ X╡0 ╓ NI╚1:┤ PI(X):┌ X |/├ SI(25):│ X╡0 ╓ 25:┤ SI(X):┌ X:▐ SEARCH INDEX %|/▄ 13005:C╡0 P|/┤ MN$:▀ MN$╡"*" ╖ 12100:▐ EN%D OF TABLE g|&/MN$(PI(C))╡MN$:I╡0 ▀|0/┤ OP$:▀ OP$╡"*" ╖ C╡C╙1:┴ 12060 ё|5/▀ OP$╡"--" ╖ OP$╡"" ф|:/OP$(PI(C),I)╡OP$:I╡I╙1:┴ 12080 }D/▀ CЁ╠NI ╖ ≥ "WARNING! INCONSISTENT INSTRUCTION TABLE!":░ 	}N/▌ }т0: G}ч0▐ ---------- ASSEMBLER INSTRUCTION TABLE -------%--- M}Х0: ≥}И0▐ IMPORTANT: RUN CODE GENERATOR AT 14000 WHEN INSTRUCTION TABLE CHANGES ÷}Й0: ╤}Р0▐ ADDRESSING MODES э}Э0┐ 19:▐ NUMBER OF ADDRESSING MODES "~1┐ IMPLIED,IMMEDIATE,BASE PAGE,ABSOLUTE, RELATIVE, 16-BIT RELATIVE P~1┐ X-INDEXED BASE PAGE,Y-IND%EXED BASE PAGE |~1┐ X-INDEXED ABSOLUTE,Y-INDEXED ABSOLUTE д~$1┐ X-INDEXED INDIRECT,INDIRECT Y-INDEXED,INDIRECT Z-INDEXED,INDIRECT Ш~)1┐ BASE PAGE AND RELATIVE,X-INDEXED INDIRECT 16 BIT .*1┐ SP-INDEXED INDIRECT Y-INDEXED,IMMEDIATE WORD S+1┐ INDIRECT FL%AT MEMORY Z-INDEXED Y.1: lх2▐ INSTRUCTIONS ⌡и2▐ EACH LINE ENDS WITH *, TABLE ENDS WITH * ║й2: дк2┐ 145:▐ NUMBER OF INSTRUCTIONS йл2: ─м2▐ PREFIX: @=4510, \=45GS02, \Q=QUAD   POSTFIX: ^=A/Q, Z=],Z NEEDED U─н2▐         ## BP AB RL 16 BX BY AX AY X) %)Y )Z () BR IX IS #W ]Z ·─о2┐ ADC,--,69,65,6D,--,--,75,--,7D,79,61,71,@72,--,--,--,--,--,\EA72,* Г─п2┐ AND,--,29,25,2D,--,--,35,--,3D,39,21,31,@32,--,--,--,--,--,\EA32,* │я2┐ ASL,0A^,--,06,0E,--,--,16,--,1E,* .│р2┐ BCC,--,--,--,--,90,@93,* M│с2┐ BCS,--,%--,--,--,B0,@B3,* l│т2┐ BEQ,--,--,--,--,F0,@F3,* √│у2┐ BIT,--,@89,24,2C,--,--,@34,--,@3C,* ╣│ж2┐ BMI,--,--,--,--,30,@33,* т│в2┐ BNE,--,--,--,--,D0,@D3,* С│ь2┐ BPL,--,--,--,--,10,@13,* ┌ы2┐ BRK,00,* !┌з2┐ BVC,--,--,--,--,50,@53,* @┌ш2┐ BVS,--,--,--,--,70%,@73,* O┌э2┐ CLC,18,* ^┌щ2┐ CLD,D8,* m┌ч2┐ CLI,58,* |┌ъ2┐ CLV,B8,* е┌Ю2┐ CMP,--,C9,C5,CD,--,--,D5,--,DD,D9,C1,D1,@D2,--,--,--,--,--,\EAD2,* щ┌А2┐ CPX,--,E0,E4,EC,* У┌Б2┐ CPY,--,C0,C4,CC,* ┐Ц2┐ DEC,@3A^,--,C6,CE,--,--,D6,--,DE,* -┐Д2┐ DEX,CA,* <┐Е2┐ DEY,%88,* ┘┐Ф2┐ EOR,--,49,45,4D,--,--,55,--,5D,59,41,51,@52,--,--,--,--,--,\EA52,* ╝┐Г2┐ INC,@1A^,--,E6,EE,--,--,F6,--,FE,* ╫┐Х2┐ INX,E8,* л┐И2┐ INY,C8,* 	└Й2┐ JMP,--,--,--,4C,--,--,--,--,--,--,--,--,--,6C,--,@7C,* G└К2┐ JSR,--,--,--,20,--,--,--,--,--,--,--,-%-,--,@22,--,@23,* ▒└Л2┐ LDA,--,A9,A5,AD,--,--,B5,--,BD,B9,A1,B1,@B2,--,--,--,@E2,--,\EAB2,* ╩└М2┐ LDX,--,A2,A6,AE,--,--,--,B6,--,BE,* Б└Н2┐ LDY,--,A0,A4,AC,--,--,B4,--,BC,* 
┘О2┐ LSR,4A^,--,46,4E,--,--,56,--,5E,* ┘П2┐ NOP,EA,* b┘Я2┐ ORA,--,09,05,0D,--,-%-,15,--,1D,19,01,11,@12,--,--,--,--,--,\EA12,* q┘Р2┐ PHA,48,* ─┘С2┐ PHP,08,* ▐┘Т2┐ PLA,68,* ·┘У2┐ PLP,28,* ф┘Ж2┐ ROL,2A^,--,26,2E,--,--,36,--,3E,* Н┘В2┐ ROR,6A^,--,66,6E,--,--,76,--,7E,* Щ┘Ь2┐ RTI,40,* ├Ы2┐ RTS,60,@62,* Y├З2┐ SBC,--,E9,E5,ED,--,--,F5,--%,FD,F9,E1,F1,@F2,--,--,--,--,--,\EAF2,* h├Ш2┐ SEC,38,* w├Э2┐ SED,F8,* ├├Щ2┐ SEI,78,* п├Ч2┐ STA,--,--,85,8D,--,--,95,--,9D,99,81,91,@92,--,--,--,@82,--,\EA92,* Ш├Ъ2┐ STX,--,--,86,8E,--,--,--,96,--,@9B,* #┤ 3┐ STY,--,--,84,8C,--,--,94,--,@8B,* 2┤3┐ TAX,AA%,* A┤3┐ TAY,A8,* P┤3┐ TSX,BA,* _┤3┐ TXA,8A,* n┤3┐ TXS,9A,* }┤3┐ TYA,98,* █┤3┐ MAP,@5C,* ²┤3┐ EOM,@EA,* ╜┤	3┐ TAZ,@4B,* ╫┤
3┐ TZA,@6B,* Г┤3┐ LDZ,--,@A3,--,@AB,--,--,--,--,@BB,* ┬3┐ STZ,--,--,@64,@9C,--,--,@74,--,@9E,* 7┬3┐ ASR,@43^,--,@44,--,--%,--,@54,* P┬3┐ ASW,--,--,--,@CB,* ▀┬3┐ BBR0,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@0F,* ф┬3┐ BBR1,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@1F,* ┴3┐ BBR2,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@2F,* <┴3┐ BBR3,--,--,--,--,--,--,--,--,--,--,-%-,--,--,--,@3F,* w┴3┐ BBR4,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@4F,* ╡┴3┐ BBR5,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@5F,* М┴3┐ BBR6,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@6F,* (┼3┐ BBR7,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@7F,* c%┼3┐ BBS0,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@8F,* ·┼3┐ BBS1,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@9F,* ы┼3┐ BBS2,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@AF,* ▀3┐ BBS3,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@BF,* O▀3┐ BBS4,--,--,--%,--,--,--,--,--,--,--,--,--,--,--,@CF,* ┼▀3┐ BBS5,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@DF,* е▀3┐ BBS6,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@EF,*  ▄3┐ BBS7,--,--,--,--,--,--,--,--,--,--,--,--,--,--,@FF,*  ▄3┐ BRA,--,--,--,--,@80,@83,* ?▄ 3┐% BSR,--,--,--,--,--,@63,* O▄!3┐ CLE,@02,* j▄"3┐ CPZ,--,@C2,@D4,@DC,* ─▄#3┐ DEW,--,--,@C3,* ░▄$3┐ DEZ,@3B,* ╕▄%3┐ INW,--,--,@E3,* ╤▄&3┐ INZ,@1B,* г▄'3┐ NEG,@42^,* █(3┐ PHW,--,--,--,@FC,--,--,--,--,--,--,--,--,--,--,--,--,--,@F4,* █)3┐ PHX,@DA,* +█*3┐ PH%Y,@5A,* ;█+3┐ PHZ,@DB,* K█,3┐ PLX,@FA,* [█-3┐ PLY,@7A,* k█.3┐ PLZ,@FB,* ┌█/3┐ RMB0,--,--,@07,* ≥█03┐ RMB1,--,--,@17,* ╟█13┐ RMB2,--,--,@27,* г█23┐ RMB3,--,--,@37,* ч█33┐ RMB4,--,--,@47,* У█43┐ RMB5,--,--,@57,* ▌53┐ RMB6,--,--,@67,* #▌63┐ RMB7,--,--,@77,% * <▌73┐ ROW,--,--,--,@EB,* L▌83┐ SEE,@03,* c▌93┐ SMB0,--,--,@87,* z▌:3┐ SMB1,--,--,@97,* ▒▌;3┐ SMB2,--,--,@A7,* ╗▌<3┐ SMB3,--,--,@B7,* ©▌=3┐ SMB4,--,--,@C7,* ж▌>3┐ SMB5,--,--,@D7,* М▌?3┐ SMB6,--,--,@E7,* ▐@3┐ SMB7,--,--,@F7,* ▐A3┐ TAB,@5B,* $▐B3┐ TBA,@%!7B,* >▐C3┐ TRB,--,--,@14,@1C,* X▐D3┐ TSB,--,--,@04,@0C,* h▐E3┐ TSY,@0B,* x▐F3┐ TYS,@2B,* х▐G3┐ ADCQ,--,--,\Q65,\Q6D,--,--,--,--,--,--,--,--,\Q72,--,--,--,--,--,\QEA72,* ░H3┐ ANDQ,--,--,\Q25,\Q2D,--,--,--,--,--,--,--,--,\Q32,--,--,--,--,--,\QEA32,* K░I3┐%" ASLQ,\Q0A^,--,\Q06,\Q0E,--,--,\Q16,--,\Q1E,* t░J3┐ ASRQ,\Q43^,--,\Q44,--,--,--,\Q54,* ▒░K3┐ BITQ,--,--,\Q24,\Q2C,* А░L3┐ CMPQ,--,--,\QC5,\QCD,--,--,--,--,--,--,--,--,\QD2,--,--,--,--,--,\QEAD2,* ▒M3┐ DEQ,\Q3A^,--,\QC6,\QCE,--,--,\QD6,--,\QDE,* c▒N3┐ EO%#RQ,--,--,\Q45,\Q4D,--,--,--,--,--,--,--,--,\Q52,--,--,--,--,--,\QEA52,* ∙▒O3┐ INQ,\Q1A^,--,\QE6,\QEE,--,--,\QF6,--,\QFE,* Е▒P3┐ LDQ,--,--,\QA5,\QAD,--,--,--,--,--,--,--,--,\QB2,--,--,--,--,--,\QEAB2Z,* ▓Q3┐ LSRQ,\Q4A^,--,\Q46,\Q4E,--,--,\Q56,--,\Q5E,* g%$▓R3┐ ORQ,--,--,\Q05,\Q0D,--,--,--,--,--,--,--,--,\Q12,--,--,--,--,--,\QEA12,*  ▓S3┐ ROLQ,\Q2A^,--,\Q26,\Q2E,--,--,\Q36,--,\Q3E,* м▓T3┐ RORQ,\Q6A^,--,\Q66,\Q6E,--,--,\Q76,--,\Q7E,* ⌠U3┐ SBCQ,--,--,\QE5,\QED,--,--,--,--,--,--,--,--,\QF2,--,--,--,--,--,\QE%%AF2,* l⌠V3┐ STQ,--,--,\Q85,\Q8D,--,--,--,--,--,--,--,--,\Q92,--,--,--,--,--,\QEA92,* ▄⌠W3┐ LBCC,--,--,--,--,--,@93,* ╛⌠X3┐ LBCS,--,--,--,--,--,@B3,* л⌠Y3┐ LBEQ,--,--,--,--,--,@F3,* Л⌠Z3┐ LBMI,--,--,--,--,--,@33,* ■[3┐ LBNE,--,--,--,--,--,@D3,* ,■\3┐ LBP%&L,--,--,--,--,--,@13,* L■]3┐ LBVC,--,--,--,--,--,@53,* l■^3┐ LBVS,--,--,--,--,--,@73,* ▄■_3┐ LBRA,--,--,--,--,--,@83,* ■■X4┐ * л■╪4▐ INDEXES USED TO STORE INSTRUCTIONS ALPHABETICALLY ∙ф4┐ 0,2,4,25,26,27,28,30,31,32,34,36,37,38,39,41,42 ;∙г4┐ 43,45,46,48%',51,52,55,57,60,61,63,64,74,76,77,79,83 ─∙х4┐ 84,86,87,92,93,105,107,110,111,112,114,115,117,126,128,129,132 ╬∙и4┐ 133,138,140,141,142,81,54,134,144,78,130,6,8,9,10,11,12 В∙й4┐ 13,14,15,16,17,18,19,20,21,22,23,24,33,35,40,47,50 3√к4┐ 53,59,62,82,88,89,90$ ,91,94,95,96,97,98,99,100,101,102 }√л4┐ 103,104,109,116,118,119,120,121,122,123,124,125,131,135,136,137,139 ╥√м4┐ 143,1,3,5,7,29,44,49,56,58,75,80,85,106,108,113,127 ь√н4┐ 65,66,67,68,69,70,72,73,71 !≈ 5▐ INDEX TABLE INTO INSTRUCTION ARRAY FOR EACH LETTE&│ X╡M1 ╓ M2:C$(X╚M1╙1)╡L$(X):┌:NC╡M2╚M1╙1  H▄▀ NCЁMC ╖ │ X╡NC╙1 ╓ MC:C$(X)╡"":┌ 2H═│ X╡M1 ╓ NL╚(M2╚M1╙1):L$(X)╡L$(X╙M2╚M1╙1):┌ X [H╙│ X╡NL╚(M2╚M1╙1)╙1 ╓ NL:L$(X)╡"":┌ X H╢NL╡NL╚(M2╚M1╙1):▀ NLЁM1 ╖ NL╡M1 ёH╬CL╡M1:M1╡0:M2╡0:▀ CLЁFL ╖ FL╡CL ╢Hх█ 400:&┴ 1000 ╨H: ДH"▐ ----- MEGA-V: PASTE CLIPBOARD ----- ЙH,: I6▀ NL╙NC╠ML ╟ NC╡0 ╖ 1000 8I@│ X╡NL ╓ CL ╘ ╚1:L$(X╙NC)╡L$(X):┌ X:NL╡NL╙NC \IJ│ X╡1 ╓ NC:L$(CL╙X╚1)╡C$(X):┌ X ITCL╡CL╙NC:▀ CL╚FL╠23 ╖ FL╡CL╚23 ░I^█ 400:┴ 1000 √I|: ╣I├▐ ----- MEGA-F: F&IND ----- ╩I░: чI P$╡"FIND:":L$╡"":█ 7200:FS$╡L$ НI╦▐ FIND NEXT Jб▀ FS$╡"" ╖ 1000 JлL╡CL:C╡CC╙1:A╡0 ?Jж▀ L╡CL╙1 ╟ L╡NL ╖ A╡A╙1:▀ A╡2 ╖ 1000 [JЮ▀ т(L$(L),FS$,C) ╖ 5630 vJЙL╡L╙1:C╡1:▀ L╠NL ╖ L╡1 │JТ┴ 5590 °JЧCL╡L:CC╡т(L$(L),FS$,C) ╥J▀ CLЁFL ╖& FL╡CL:┴ 5660 яJ▀ CL╚FL╠23 ╖ FL╡CL╚23 БJ█ 400:┴ 1000 ХJD: KN▐ ----- MEGA-S: SAVE ----- KX: ,K]▀ NL╡1 ╞ ц(L$(1))╡0 ╖ 1000 TKbL$╡FI$:P$╡"SAVE AS (*.ASM):":█ 7200 gKl▀ L$╡"" ╖ 1000 ▄Kv▀ и(L$,4)Ё╠".ASM" ╖ L$╡L$╙".ASM" ╙K─FI$╡х(L$,16):█ 5770:┴ 3&00 ╟K┼: рK▀▐ SUB ----- SAVE AS FI$ ----- ьK▄: ЖK▐≥ "";:▀ SF ╖ ≥ "AUTO"; 	L░≥ "SAVING...▓" L■Ч#1,("@"╙FI$),W .L·▀ DS ╖ 5830 ]L╗│ X╡1 ╓ NL:≤1,г(34)╙L$(X)╙г(34):┌ X:≤1,"*" fL╡Ч#1 qL╪MF╡0:▌ ≈LфЧ#1:≥ "CAN NOT SAVE FILE: ";DS$ ╞Lп≥ "PRESS &ANY KEY▓" юLз║Ы K$:SE╡1:▌ фL: ЕL▐ ----- MEGA-L: LOAD ----- КL : M%▀ AL$Ё╠"" ╖ LF$╡AL$:AL$╡"":┴ 5970 M&AA╡0 DM*L$╡FI$:P$╡"LOAD FILE (*.ASM):":█ 7200 WM4▀ L$╡"" ╖ 1000 |M>▀ и(L$,4)Ё╠".ASM" ╖ L$╡L$╙".ASM" █MHLF$╡х(L$,16) ≤MJ█ 7800 ╝MM█ 7700:&▀ SE ╖ 300 еMR≥ "LOADING...▓" тM\Ч#1,(LF$) КMf▀ DS ╖ AA╡0:┴ 6030  Nk│ X╡1 ╓ NL:L$(X)╡"":┌ X:NL╡0:CL╡1:CC╡1:FL╡1:MF╡0 :Np└1,L$:▀ L$╡"*" ╖ 6005 MNq▀ NL╡ML ╖ 6060 jNrNL╡NL╙1:L$(NL)╡L$:┴ 6000 |Nu▀ NL╡0 ╖ NL╡1 ┘NzЧ#1 ╖N└FI$╡LF$:▀ ID$(ID)Ё╠FI$ ╖& ID╡0 ╡N┘█ 7900 ╪N┴┴ 300 БN▌Ч#1:≥ "CAN NOT LOAD FILE: ";DS$ ЗN≤≥ "PRESS ANY KEY▓" 
O╒║Ы K$:┴ 300 O╛Ч#1 ?O╤≥ "⌠UNRECOVERABLE ERROR: FILE TOO LONG" EOю─ POй┴ 6080 VOт: tOч▐ ----- RUN PROGRAM ----- zOХ: ▄OР▀ RO╡0 ╖ 1000 ╒OВ█ 7700:▀ SE ╖ 3&	00 ╦OЭ▀ RF ╞ 1 ╖ ≥ "⌠"; гOЧ RB:· RA эO▀ RF ╞ 2 ╖ ║Ы K$ ФO┴ 300 ЛO8: PB▐ ----- DISPLAY DIRECTORY OF .ASM FILES ----- $PL: ;PV≥ "⌠";:Н "*.ASM",W \P`≥ "PRESS ANY KEY"╙х(SP$,40); fPj║Ы K$ pPt┴ 300 vP°: ╘P╕▐ ----- ESC-Q: DELETE TO THE END OF&
 LINE ----- ╞P╟: щP╨L$╡х(L$(CL),CC╚1):█ 7100:L$(CL)╡L$:┴ 3100 ЦP : Q
▐ ----- MEGA-I: TOGGLE IGNORE MODE ----- Q: (QIG╡1╚IG:█ 360 3Q(┴ 1000 9Qd: [Qn▐ ----- ESC N: NEW FILE ----- aQx: sQ}▀ MF╡0 ╖ 6556 ═Q┌P$╡"REALLY START NEW FILE (Y/N)? ":L&$╡"" ╚Q▄█ 7200 еQ√▀ х(L$,1)Ё╠"Y" ╖ 1000 шQ⌡█ 7700:▀ SE ╖ 300 ФQ°█ 7800 R═│ X╡1 ╓ NL:L$(X)╡"":┌ X:NL╡1:CL╡1:CC╡1:FL╡1:MF╡0 8R╙FI$╡"":ID╡0:PR$╡"":┴ 300 >Rх: rRр▐ ----- CTRL-1 TO CTRL-0: SET FILE NUMBER ----- xRэ: ▄RФ▀ FI$╡"" ╖ 1000 ²RК▀ I╡10 ╖ &I╡0 ЁRЛ▀ ID ╖ ID$(ID)╡"" хRПID╡I:ID$(ID)╡FI$ ыRЗ█ 360:┴ 1000 ъR,: S6▐ ----- ESC 1-9: LOAD FILE NUMBER ----- S@: 7SJI╡е(K$):▀ I╡ID ╟ ID$(I)╡"" ╖ 1000 BSO█ 7800 WSTID╡I:LF$╡ID$(ID) bS^┴ 5965 hS░: ▓S ▐ ----- MEGA-*: TOGGLE AUTOSAVE ----- ≤S╓:& ╙S╝AS╡1╚AS:█ 360 ╣S╦┴ 1000 ╩SX: аSb▐  Tl▐ *************** EDITOR UTILITY FUNCTIONS *************** Tv▐ T╪: ATф▐ SUB ----- REMOVE TRAILING SPACES FROM L$ ----- GTп: nTзК Щ и(L$,1)╡" ":L$╡х(L$,ц(L$)╚1):Л tTД▌ zT : ╕T*▐ SUB ----- PROMPT P$ F&OR TEXT L$ ----- ╛T4: U>≥ "о╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥╥п" ^UH≥ "╢                                                                             ╖" ╤UR≥ "л╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞&╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╞╨" фUfЧ 1,2,77,2 щUp≥ P$;L$;:≥ "";P$; ОUzL$╡"":┘ "",L$ ЗU└≥ "" V≤█ 16000 V╒█ 400:┴ 7100 VХ: bVР▐ SUB ----- CHECK FOR AUTOLOAD/RUN, RETURN FILENAME IN AL$ ----- hVЭ: ■VI╡0:AL$╡"":AA╡0:▐ AUTO-ASSEMBLE AND R&UN фV▀ б(2048╙I)╙64Ё╠ф(й("AUTOLOAD",I╙1,1)) ╖ 7540 щVI╡I╙1:▀ IЁ8 ╖ 7440 W$A╡б(2048╙I):▀ AЁ╠34 ╞ IЁ20 ╖ I╡I╙1:┴ 7460  W.▀ AЁ╠34 ╖ AA╡0:▌ AW8I╡I╙1:▀ I╠40 ╖ AL$╡"":AA╡0:▌ _WBA╡б(2048╙I):▀ A╡34 ╖ 7520 {WL▀ A╠╡1 ╞ AЁ╡26 ╖ A╡A╙64 ⌠WVAL$╡AL$╙г(A):┴ 7&480 ╠W`▀ ц(AL$)╠16 ╖ AL$╡"":AA╡0 ╥Wj▌ ©WtI╡0 МW~▀ б(2048╙I)╙64Ё╠ф(й("AUTORUN",I╙1,1)) ╖ ▌ X┬I╡I╙1:▀ IЁ7 ╖ 7550 X▓AA╡1:┴ 7460 X╟: BX╨▐ SUB ----- FILE WAS MODIFIED ----- HXд: `Xн▀ MF╡0 ╖ MF╡1:█ 360 fXь▌ lX: ▀X▐ SUB ----- AUTOSAVE ----- ╛X&#▐ RETURN SE=1 FOR SAVE ERROR ╡X(: ╩X2SE╡0 ФX<▀ AS ╞ MF ╞ FI$Ё╠"" ╖ SF╡1:█ 5770:SF╡0 ЛXF▌ РXx: Y┌▐ SUB ----- SAVE EDITOR POSITION ----- #Y▄: UY√▀ ID ╖ ID%(ID,0)╡FL:ID%(ID,1)╡CL:ID%(ID,2)╡CC [Y═▌ aYэ: ▐YФ▐ SUB ----- RESTORE EDITOR POSITION --&--- ∙YП: гYЗ▀ ID ╖ FL╡ID%(ID,0):CL╡ID%(ID,1):CC╡ID%(ID,2) мY▌ сY(#: ыY2#▐ Z<#▐ ******************** HELP ********************** ZF#▐ Z▄#: :Z√#▐ ----- EDITOR HELP ----- @Z═#: \Z╙#≥ "⌠EDITOR FUNCTIONS" ▌Z╚#≥ "HOME          GO TO BEGINNING/END OF L&INE" ъZ╛#≥ "TAB           GO TO PREDEFINED COLUMNS FOR LABELS, COMMANDS AND COMMENTS" 6[╜#≥ "SHIFT-TAB     ALIGN TEXT FROM CURSOR POSITION TO NEXT TAB STOP (INSERT SPACES)" b[╝#≥ "RETURN        SPLIT LINE & NEW LINE" ⌠[╞#≥ "SHIFT-RETURN  NEW LINE WITHOUT& SPLITTING" г[╟#≥ "DEL           DELETE CHARACTER & JOIN LINES" О[╠#≥ "ESC I         INSERT EMPTY LINE" \╡#≥ "ESC D         DELETE LINE" I\Ё#≥ "ESC Q         DELETE FROM CURSOR TO END OF LINE" r\╢#≥ "CLR           CLEAR LINE CONTENT" ═\╣#≥ "F9/SHIFT-F9 &  SCROLL DOWN / PAGE DOWN" й\╤#≥ "F11/SHIFT-F11 SCROLL UP / PAGE UP" О\╥#≥ "ESC F9        BOTTOM OF FILE" ]╦#≥ "ESC F11       TOP OF FILE" F]╧#≥ "MEGA-M        MARK LINES WITH CURSOR UP/DOWN" ┌]╨#≥ "              ESC:ABORT   C/X:COPY/CUT TO CLIPBOARD" Ё&]╩#≥ "MEGA-V        PASTE LINES FROM CLIPBOARD" с]╪#≥ "MEGA-F        FIND TEXT" Щ]╫#≥ "MEGA-N        FIND NEXT OCCURENCE" ^ц#≥ "PRESS ANY KEY"; ^х#║Ы K$ x^р#≥ "⌠AUTOLOAD "╙г(34)╙"TESTDRIVE.ASM"╙г(34)╙"  ON TOP LEFT OF THE SCREEN (LIKE HERE)" д^э#≥ "WI&LL AUTOMATICALLY LOAD THE GIVEN FILE WHEN RUNNING MEGA ASSEMBLER." Ж^А#≥ "TRY IT NOW: PRESS STOP KEY, THEN TYPE RUN" "_Б#≥ "_ CAN BE USED AS ALTERNATE ESC KEY" P_Ц#≥ "PRESS _ TWICE TO ENTER AN _ CHARACTER" ²_Д#≥ "NOTE: QUOTATION MARKS (";г(34);") CAN N&OT BE ENTERED IN THE EDITOR!" ц_Е#≥ "USE SINGLE QUOTES (') INSTEAD" Ю_Ф#≥ "MULTI-FILE SUPPORT:" '`Г#≥ "CTRL-1 TO CTRL-9 MARKS THE LOADED FILE WITH THE PRESSED NUMBER" d`Х#≥ "ENTER ESC 1-9 TO SWITCH QUICKLY BETWEEN MARKED FILES" └`И#≥ "CTRL-0 REMOVES THE& MARK" °`П#≥ "PRESS ANY KEY"; ╕`З#║Ы K$ ╟`$┴ 300 ╤`%: в`&%▐ ----- ASSEMBLER HELP ----- щ`0%: В`:%≥ "⌠ASSEMBLER HELP" ?a;%≥ "*=         SET DESTINATION ADDRESS FOR ASSEMBLY (DEFAULT=$1800)" ├a<%≥ "           ADD ,'FILENAME' TO OUTPUT TO FILE INSTEAD &OF MEMORY" ╧a=%≥ "           (TO BE LOADED WITH BLOAD LATER)" Нa>%≥ "*          VALUE OF CURRENT ASSEMBLY ADDRESS" b?%≥ "=          ASSIGN VALUE TO SYMBOL" db@%≥ "!          FORCES ABSOLUTE ADDRESSING (NO ZERO PAGE), E.G. LDA !$12" ⌡bA%≥ "           OR &16 BIT BRANCH, E.G. BEQ !<LABEL>" ╤bB%≥ ";          COMMENT" ФbC%≥ ";;         HIGHLIGHT COMMENT IN LISTING" -cD%≥ "NUMBER LITERALS: DECIMAL, $HEXADECIMAL, %BINARY OR 'C' (CHAR)" icE%≥ "                 PREFIX WITH - FOR NEGATIVE NUMBERS" ═cF%≥ "OPERAT&ORS: PRIO 1: < =LOW BYTE   > =HIGH BYTE" ыcG%≥ "           PRIO 2: * / %=MODULO &=AND .=OR :=XOR" ЬcH%≥ "           PRIO 3: + -" EdI%≥ "           USE BRACKETS () AS NEEDED, MAY BE NESTED UP TO 10 LEVELS" bdL%≥ "PRESS ANY KEY":║Ы K$ wdN%≥ "⌠DIRECTIVES:&" ≤dR%≥ ".END       END ASSEMBLY" щdS%≥ ".BASIC     'FILENAME' OUTPUTS AS BASIC PROGRAM TO GIVEN FILE" eT%≥ "           (IS USED INSTEAD OF *=)" ReU%≥ ".BASIC64   AS BASIC, BUT OUTPUT FOR C64 (USE TOGETHER WITH .6502)" °eX%≥ ".PRINT     PRINT ARGUMENTS& DURING ASSEMBLY (COMMA SEPARATED LIST)" нeb%≥ ".PRINTHEX  PRINT ARGUMENTS IN HEXADECIMAL" Шel%≥ ".BYTE      OUTPUT ARGUMENTS AS BYTES" >fv%≥ ".WORD      OUTPUT ARGUMENTS AS WORDS (LOW BYTE, HIGH BYTE)" ┐fw%≥ ".LONG      OUTPUT ARGUMENTS AS LONGS (CAUTIO& N: MAX 28 BITS!)" ╜fx%≥ ".TEXT      OUTPUT 'TEXT' AS BYTES" Пfy%≥ ".BANK      SET DESTINATION BANK FOR ASSEMBLY (DEFAULT=128)" 6gz%≥ ".RUN       SET RUN FLAGS, SEPARATED BY COMMA (USED BY MEGA-R)" ┐g{%≥ "           CLEAR=CLEAR SCREEN FIRST, WAIT=WAIT FOR&! KEY AFTER RUNNING" ╫g|%≥ "           AUTO=AUTORUN AFTER SUCCESSFUL ASSEMBLY" Щg}%≥ ".PAUSE     PAUSE ASSEMBLY TO TAKE A LOOK AT THE LISTING" 2h─%≥ ".6502      SET TARGET TO 6502 CPU (C64 MODE)" gh│%≥ ".4510      SET TARGET TO 4510 CPU (C65 MODE)" ╙h┘%≥ &"".45GS02    SET TARGET TO 45GS02 CPU (MEGA65 MODE, DEFAULT)" Юh├%≥ ".LIMIT     SET MAXIMUM NUMBER OF OUTPUT BYTES" Щh┤%≥ "PRESS ANY KEY":║Ы K$ =i┬%≥ "⌠LABELS OR SYMBOLS MUST START WITH A LETTER ON COLUMN 1" xi┴%≥ "THEN MAY CONTINUE WITH A MIX OF LETTERS&# AND DIGITS" Ёi┼%≥ "GLOBAL LABELS START WITH A LETTER, E.G. 'GLABEL'." 	j▀%≥ "LOCAL LABELS START WITH A DOT, E.G. '.LLABEL'. THEY ARE LOCAL WITHIN THE LAST" ^j▄%≥ "SECTION THAT STARTED WITH A GLOBAL LABEL. LOCAL LABELS WITHIN OTHER SECTIONS" ╝j█%≥ "CAN &$BE REFERENCED BY FULLY QUALIFYING THE SECTION, E.G. 'GLABEL.LLABEL'" Чj▐%≥ "ASSEMBLY INSTRUCTIONS AND DIRECTIVES MUST NOT START ON LEFTMOST COLUMN" %k░%≥ "AT LEAST ONE SPACE IS REQUIRED" Qk■%≥ "PRESS ESC TO ABORT AN ASSEMBLY RUN" ▄k╚%≥ "TRY LOADING, A&%SSEMBLING AND RUNNING TESTDRIVE.ASM" мk╛%≥ "PRESS MEGA-L TO LOAD, ENTER 'TESTDRIVE' AND PRESS RETURN" l╜%≥ "PRESS MEGA-A TO ASSEMBLE, THEN ANY KEY TO RETURN TO THE EDITOR" Ll╝%≥ "RUN THE PROGRAM WITH MEGA-R, THEN PRESS ANY KEY" hlч&≥"PRESS ANY KEY":║Ы &&K$ ▀lХ&≥ "⌠USING MULTI-FILE PROJECTS" гlИ&≥ "YOU CAN SPLIT LARGER PROGRAMS INTO MULTIPLE FILES." mЙ&≥ "START EACH FILE WITH A .PROJECT 'PNAME' DIRECTIVE." 6mК&≥ "THIS WILL CREATE A PROJECT FILE 'PNAME.PRJ'" ┴mЛ&≥ "YOU CAN EXPORT GLOBAL LABELS TO THE PR&'OJECT FILE USING THE EXPORT KEYWORD:" ·mМ&≥ "EXPORT LABEL" НmН&≥ "WHEN THE FILE IS ASSEMBLED, ALL EXPORTED LABELS WILL BE WRITTEN TO THE" CnО&≥ "PROJECT FILE, WHERE THEY ARE AUTOMATICALLY IMPORTED INTO ALL ASSEMBLER FILES" knП&≥ "THAT USE THE SAME PROJE% CT NAME." ╧nЯ&≥ "BY SPLITTING THE PROJECT INTO MULTIPLE FILES, ASSEMBLY CAN BE FASTER" УnР&≥ "SINCE NOT ALL FILES HAVE TO BE ASSEMBLED EACH TIME." IoС&≥ "THE BINARY FILES OF EACH PROJECT FILE ARE LOADED INTO MEMORY AUTOMATICALLY," ⌠oТ&≥ "SO YOU CAN TEST'  
 ▐   MEGA ASSEMBLER   : O  ▐   WRITTEN IN 2022 BY THOMAS GRUBER (GRUBI) U ( : ⌡ 2 ▐   THE ONLY PURPOSE OF THIS IS TO PROVIDE A SIMPLE ASSEMBLER FOR ы < ▐   MYSELF SINCE NO ASSEMBLER ON THE MEGA65 WAS AVAILABLE #!F ▐   WHEN I GOT MY MEGA65 ON MAY-'11 2022. SO DON'T EXPECT TOO MUCH :-) )!P : u!Z ▐   THIS SOFTWARE IS OPEN SOURCE. USE, MODIFY AND SHARE IT AS YOU LIKE, Ё![ ▐   BUT PLEASE KEEP THE REFERENCE TO ITS ORIGINAL AUTHOR. ╧!\ : ь!b ┴ 100:▐ SKIP CONTINUE LINE "c ┴ 300:▐ TYPE GOTO99 TO CONTINUE' EDITING 
"d : 6"n ▐ ----- INITIALIZE MEGA ASSEMBLER ----- <"x : t"} VN$╡"2.0.3":▐ VERSION NUMBER (MUST BE 5 CHARS LONG) ё"~ TB(0)╡14:TB(1)╡22:TB(2)╡32:▐ TAB POSITIONS ©"┌ ML╡2000:▐ MAXIMUM LINES #▄ ├ L$(ML):▐ LINES ARE STORED HERE, INDEX=LINE NUMBER, S'TARTING WITH 1 J#√ NL╡1:L$(1)╡"":▐ NUMBER OF LINES, STARTING WITH ONE EMPTY LINE ┌#⌡              :▐ LINES NEVER CONTAIN TRAILING SPACES ╟#═ FL╡1:▐ FIRST LINE DISPLAYED ON THE SCREEN ч#╙ CL╡1:▐ CURRENT LINE (WHERE THE CURSOR IS) 	$╢ CC╡1:▐ CURRENT COLUMN', STARTING WITH 1 }$╬ SP$╡"                                                                                ":▐ 80 SPACES, VERY USEFUL ╒$х MC╡250:▐ MAXIMUM CLIPBOARD LINES с$р ├ C$(MC):NC╡0:▐ NUMBER OF LINES IN CLIPBOARD %э M1╡0:M2╡0:▐ FIRST AND LAST MAR'KED LINES, 0=NONE  %Ф FS$╡"":▐ FIND STRING 6%П FI$╡"":▐ FILENAME }%Я ID╡0:├ ID$(9),ID%(9,2):▐ FILE NUMBER/ID, NAMES, POSITION IN EDITOR ≈%У PR$╡"":▐ PROJECT NAME ц%З DA╡$1800:▐ DEFAULT ADDRESS FOR ASSEMBLY Й%DB╡128:▐ DEFAULT BANK FOR ASSEMBLY )&	AR╡0:'▐ AUTO-RUN AFTER SUCCESSFUL ASSEMBLY, 1=ONCE 2=ALWAYS T&
IG╡0:▐ IGNORE MODE FOR UNKNOWN SYMBOLS }&AS╡1:MF╡0:▐ AUTOSAVE / FILE MODIFIED ╓&█ 7400:▀ AL$Ё╠"" ╖ 5900:▐ AUTOLOAD ╙&,: Б&6▐  ----- DISPLAY MAIN SCREEN AND ENTER EDITOR ----- Х&@: 'EЫ Ч$:'▐ WHOLE EDITOR NEEDS TO RUN WITH KEY OFF %'I≥ "⌠"; ┐'J≥ "LINE    COL                                        PRESS HELP   MA V";VN$;"▓"; ╗'O▀ FI$Ё╠"" ╖ ≥ "";ё21);FI$;"▓"; ╡'Q█ 360 н'T█ 400:▐ DISPLAY CONTENT Х'^┴ 1000:▐ GO TO EDITOR (h▐ S'	UB DISPLAY INDICATORS IN STATUS LINE 6(i▀ ID ╖ I$╡и(д(ID),1):у I$╡" " N(j≥ "";ё39);I$;"▓"; k(k▀ AS ╖ I$╡"AS":у I$╡"  " ┐(l≥ "";ё43);I$;"▓"; ╗(m▀ IG ╖ I$╡"IGNORE":у I$╡"      " ю(n≥ "";ё48);I$;"▓"; ш(o▀ MF ╖ I$╡"*":у I$╡" " С(p≥ "";ё20);I$'
;"▓"; Ы(q▌ Ъ(░: ,) ▐ SUB ----- DISPLAY EDITOR CONTENT ----- 2)╓: >)╝≥ ""; M)╦│ X╡0 ╓ 23 |)╫   ▀ FL╙X╠╡M1 ╞ FL╙XЁ╡M2 ╖ ≥ "";:у ≥ "▓"; ╣)б   ▀ FL╙XЁ╡NL ╖ Ч ≥ L$(FL╙X);х(SP$,79╚ц(L$(FL╙X))); н)л   Ч:у ≥ х(SP$,79); Ю)я   ▀ XЁ23 ╖ ≥ Х)ж┌ X Н)Ю'▌ Т)Т: ,*Ч▐ SUB ----- DISPLAY CURSOR & LINE/COL NUMBERS ----- 2*: T*≥ "";и(д(10000╙CL),4); x*≥ "";и(д(100╙CC),2);"▓"; ░*&ЧA ▒,CC╚1,CL╚FL╙1,0 √*0▌ °*Х: ╫*Р▐ ----- MAIN EDIT LOOP ----- ц*Э: З*▀ AA ╖ AA╡0:AR╡1:K$╡"╟":┴ 1045:▐ A'UTO ASSEMBLE+RUN +█ 500:▐ SHOW CURSOR +║Ы K$ .+ЧA Ч$:K╡ф(K$) I+▀ K$╡"_" ╟ K╡27 ╖ 1500 j+$▀ K╡20 ╖ █ 7600:┴ 3200:▐ DEL █+.▀ K$╡"" ╖ 3400:▐ CURSOR RIGHT ╞+8▀ K$╡"²" ╖ 3500:▐ CURSOR LEFT й+B▀ K$╡"" ╖ 3600:▐ HOME Д+L▀ K$╡"	" ╖ 3700:▐ TAB ,V'▀ K$╡"" ╖ █ 7600:┴ 3760:▐ SHIFT-TAB (,╟▀ K$╡"╫" ╖ 2500:▐ EXIT K,╨▀ K$╡"╢" ╟ K╡132 ╖ 2000:▐ HELP o,д▀ K╡13 ╖ █ 7600:┴ 3800:▐ RETURN  ,н▀ K╡141 ╖ █ 7600:┴ 4000:▐ SHIFT-RETURN ╪,ь▀ K$╡"" ╖ 4100:▐ CURSOR DOWN э,Б▀ K$╡"▒" ╖ 4200:▐ CURSOR UP Ъ,Л▀ K$╡'"⌠" ╖ █ 7600:┴ 4300:▐ CLR -Ж▀ K╡16 ╖ 4580:▐ F9 3-Ш▀ K╡21 ╖ 4500:▐ SHIFT-F9 K- ▀ K╡22 ╖ 4470:▐ F11 i-▀ K╡23 ╖ 4400:▐ SHIFT-F11 ├-▀ K$╡"╖" ╖ 5000:▐ MEGA-M ╛-▀ K$╡"╬" ╖ █ 7600:┴ 5400:▐ MEGA-V и-(▀ K$╡"╩" ╖ 5500:▐ MEGA-F Ф-2▀ K$╡"╙" ╖ 5560:▐ MEGA'-N .<▀ K$╡"╝" ╖ 5700:▐ MEGA-S  .F▀ K$╡"╤" ╖ 5900:▐ MEGA-L N.P▀ K╡34 ╖ 1030:▐ NO QUOTATION MARK ALLOWED l.Z▀ K$╡"╟" ╖ 10100:▐ MEGA-A ┴.d▀ K$╡"╡" ╖ 6100:▐ MEGA-R ╕.e▀ K$╡"╛" ╖ 6200:▐ MEGA-D ц.f▀ K$╡"╒" ╖ 6400:▐ MEGA-I З.gI╡т("░÷°·▓",K$):▀ I ╖' 6600:▐ CTRL-1 TO CTRL-9 /h▀ K$╡"ъ" ╖ 6800:▐ MEGA-* U/x▀ (K╠╡32 ╞ KЁ╡94) ╟ (K╠╡193 ╞ KЁ╡218) ╖ 3000:▐ ENTER CHAR `/р┴ 1030 f/э: ÷/Ф▐ ----- HANDLE KEYBOARD COMMAND (ESC SEQUENCE) ----- ╔/П: ╫/ЗЧA ▒,CC╚1,CL╚FL╙1,1 о/║Ы K$:K╡ф(K$) ъ/ЧA Ч$,0,0,0 'З/▀ K╡16 ╖ 4700:▐ ESC F9 0"▀ K╡22 ╖ 4600:▐ ESC F11 ;0'▀ K$╡"I" ╖ █ 7600:┴ 4900:▐ ESC I `0,▀ K$╡"D" ╖ █ 7600:┴ 4800:▐ ESC D ┘06▀ K$╡"Q" ╖ █ 7600:┴ 6300:▐ ESC Q ≥0@▀ K$╡"_" ╖ 3000 ╣0J▀ K$╡"N" ╖ 6500:▐ ESC N ч0T▀ K$╠╡"1" ╞ K$Ё╡"9" ╖ 6700:▐ ESC 1-9' И0ф┴ 1000 О0п: 1з▐ ----- DISPLAY HELP ----- 1Д: !1Н≥ ""; h1Ь≥ "╟ююююююююююююююююююююююююююююююююююююююююююю╝" ╞1≥ "б              MEGA ASSEMBLER               б" Ж1≥ "б     WRITTEN IN 202'2 BY THOMAS GRUBER      б" =2≥ "б                                           б" └2 ≥ "б   KEYBOARD COMMANDS:                      б" к2*≥ "б     MEGA-X EXIT       MEGA-D DIR *.ASM    б" 3+≥ "'б     MEGA-L LOAD       MEGA-S SAVE         б" Y3,≥ "б     MEGA-A ASSEMBLE   MEGA-R RUN          б" ═3-≥ "б     MEGA-* AUTOSAVE   ESC  N NEW FILE     б" Г3.≥ "б                              '             б" .4/≥ "б     MEGA-I TOGGLE IGNORE MODE             б" u40≥ "б            (IGNORE UNKNOWN SYMBOLS)       б" ╪44≥ "б                                           б" 55≥ "б'   PRESS FOR DETAILED HELP:                б" J56≥ "б     E: EDITOR FUNCTIONS                   б" ▒57≥ "б     A: ASSEMBLER DIRECTIVES               б" ь5>≥ "б                                         '  б" 6H≥ "б          ANY OTHER KEY TO CLOSE           б" f6R≥ "╜ююююююююююююююююююююююююююююююююююююююююююю╫" p6Э║Ы K$ └6	▀ K$╡"E" ╖ 9100 ≤6	▀ K$╡"A" ╖ 9500 ╒6	┴ 300 ╗6д	: н6н	▐ ----- EXIT MEGA ASSEMBLER ----- т6ь'	: Т6Б	≥ "⌠EXITING MEGA ASSEMBLER" 07Д	▀ MF ╞ (AS╡0 ╟ FI$╡"") ╖ ≥ "·WARNING: UNSAVED CHANGES" ;7Г	█ 7700 o7Л	≥ "TYPE CONT OR GOTO99 TO RETURN TO THE EDITOR" ~7Я	Ч 128:Ы ▒ └7Ж	─ ▌7 
┴ 300 ■7╦: к7б▐ ----- ENTER CHARACTER K$ INTO CURRENT LINE ----- я7л': э7я█ 7600 Ж7ж▀ ц(L$(CL))Ё79 ╖ 3040 
8в▀ CCЁ╠79 ╖ 1000 28ьL$╡х(L$(CL),78)╙K$:█ 7100:L$(CL)╡L$ =8ы┴ 3100 r8Ю▀ K$╡" " ╞ ц(L$(CL))ЁCC ╞ CCЁ79 ╖ CC╡CC╙1:┴ 1000 ═8ЙL$╡х(L$(CL),CC╚1):L$╡L$╙х(SP$,CC╚1╚ц(L$)) ╬8ТL$(CL)╡L$╙K$╙й(L$(CL),CC) т8Ч▀ CCЁ79 ╖ C'C╡CC╙1 з8: 9&▐ ----- PRINT CURRENT LINE TO SCREEN AND GO TO EDIT LOOP ----- #90: 99:ЧA Ч$,0,CL╚FL╙1,0 [9D≥ L$(CL);х(SP$,79╚ц(L$(CL))); f9N┴ 1000 l9─: ┌9┼▐ ----- DEL ----- ┬9■:  9·▀ CC╡1 ╖ 3290 ю9╗▀ CC╠ц(L$(CL))╙1 ╖ CC╡CC╚1:┴ 1000 з9╡▀ CC╡ц('L$(CL))╙1 ╖ Ч :╪   L$╡х(L$(CL),ц(L$(CL))╚1):█ 7100:L$(CL)╡L$ 7:фЧ:у L$(CL)╡х(L$(CL),CC╚2)╙й(L$(CL),CC) J:пCC╡CC╚1:┴ 3100 \:з▀ CL╡1 ╖ 1000 ┌:Д▀ ц(L$(CL╚1))╙ц(L$(CL))╠79 ╖ 1000 ╟:НCC╡ц(L$(CL╚1))╙1:L$(CL╚1)╡L$(CL╚1)╙L$(CL) л:ЬCL╡CL╚1:▀ CLЁFL ╖ FL╡'CL Р:│ X╡CL╙1 ╓ NL╚1:L$(X)╡L$(X╙1):┌ X ;L$(NL)╡"":NL╡NL╚1 ;█ 400:┴ 1000 ;H: >;R▐ ----- CURSOR RIGHT ----- D;\: W;f▀ CC╡79 ╖ 3450 j;pCC╡CC╙1:┴ 1000 };z▀ CL╡NL ╖ 1000 █;└CC╡1:┴ 4100 ⌠;╛: ╠;╤▐ ----- CURSOR LEFT ----- ╥;ю: и;й▀ CC╡1 ╖ 355'0 э;тCC╡CC╚1:┴ 1000 Н;ч▀ CL╡1 ╖ 1000 Ъ;ХCC╡79:┴ 4200 <: <▐ ----- HOME ----- "<$: <<.▀ CCЁ╠1 ╖ CC╡1:┴ 1000 _<8CC╡ц(L$(CL))╙1:▀ CC╠79 ╖ CC╡79 j<B┴ 1000 p<t: ├<~▐ ----- TAB ----- ▄<┬: ■<▓I╡0 ╟<≈▀ TB(I)╡0 ╖ CC╡1:┴ 1000 о<°▀ CC╠╡TB(I) ╖ I╡I'╙1:┴ 3735 Ц<║CC╡TB(I):┴ 1000 И<╟: $=╠▐ ----- SHIFT-TAB: INSERT SPACES TO NEXT TAB POS ----- *=╡: H=╣I╡0:▀ CC╠ц(L$(CL)) ╖ 1000 ]=╤▀ TB(I)╡0 ╖ 1000 |=╥▀ CC╠╡TB(I) ╖ I╡I╙1:┴ 3766 ┬=╨C╡TB(I) ⌡=╪▀ CC╠╡C ╖ 1000 е=╫▀ й(L$(CL),CC,1)╡" " ╖ CC╡CC╙1:┴ 377'3 ь=╬▀ CC╠╡C ╖ 1000 >©IC╡C╚CC:▀ ц(L$(CL))╙IC╠79 ╖ IC╡79╚ц(L$(CL)) 9>юL$(CL)╡х(L$(CL),CC╚1)╙х(SP$,IC)╙й(L$(CL),CC) M>аCC╡CC╙IC:┴ 3100 S>ь: l>Б▐ ----- RETURN ----- r>Л: ┘>Ж▀ NL╡ML ╖ 1000 б> R$╡й(L$(CL),CC):L$╡х(L$(CL),CC╚1):█ 7100:L$(CL)╡L$:L$╡R$'  Х>S╡1:К Щ й(L$(CL),S,1)╡" ":S╡S╙1:Л Ш>
▀ CLЁNL ╖ 3900 3?NL╡NL╙1:L$(NL)╡L$:CL╡CL╙1:CC╡S:▀ CL╚FL╠23 ╖ FL╡FL╙1 D?█ 400:┴ 1000 m?<│ X╡NL ╓ CL╙1 ╘ ╚1:L$(X╙1)╡L$(X):┌ X ░?FNL╡NL╙1:CL╡CL╙1:L$(CL)╡L$:CC╡S ╘?P▀ CL╚FL╠23 ╖ FL╡FL╙1 ╨?Z█ 400:┴ 1000 ю?═:'! ъ?╙▐ ----- SHIFT-RETURN ----- Е?╢: Ь?╬▀ NL╡ML ╖ 1000 	@хL$╡"":┴ 3845 @: -@▐ ----- CURSOR DOWN ----- 3@: F@"▀ CL╡NL ╖ 1000 m@,CL╡CL╙1:▀ CL╚FL╠23 ╖ FL╡FL╙1:█ 400 x@6┴ 1000 ~@h:  @r▐ ----- CURSOR UP ----- ═@|: ╡@├▀ CL╡1 ╖ 1000 т@░CL╡CL╚1'":▀ CLЁFL ╖ FL╡CL:█ 400 ъ@ ┴ 1000 Е@л: Ш@ж▐ ----- CLR ----- AЮ: AЙL$(CL)╡"":CC╡1:┴ 3100 !A0: AA:▐ ----- F12 (PAGE UP) ----- GAD: bANCL╡CL╚23:▀ CLЁ1 ╖ CL╡1 tAX▀ FL╡1 ╖ 1000 ▐AbFL╡FL╚23:▀ FLЁ1 ╖ FL╡1 ═Al█ 400:┴ 1000 ╕Av: хAw▐ ----- F11 (SCRO'#LL UP) ----- нAx: ЯAy▀ FL╠1 ╖ FL╡FL╚1:CL╡CL╚1:█ 400 ЭAz┴ 1000 B■: $B·▐ ----- F10 (PAGE DOWN) ----- *B╗: GB╡CL╡CL╙23:▀ CL╠NL ╖ CL╡NL ]B╪▀ NL╚FLЁ24 ╖ 1000 ─BфL╡23:▀ L╠NL╚FL╚23 ╖ L╡NL╚FL╚23 ▄BпFL╡FL╙L ²Bз█ 400:┴ 1000 ёBД: фBЕ▐ ----- F9 (SCROLL'$ DOWN) ----- лBФ: ПBГ▀ CLЁNL ╖ FL╡FL╙1:CL╡CL╙1:█ 400 ШBХ┴ 1000 CЬ: -C▐ ----- ESC F11: GOTO TOP OF FILE ----- 3C: JCCL╡1:▀ FL╡1 ╖ 1000 `C FL╡1:█ 400:┴ 1000 fC\: ■Cf▐ ----- ESC F9: GOTO BOTTOM OF FILE -----  Cp: ╤CzCL╡NL:▀ CL╚FLЁ24 ╖ 1000 п'%C└FL╡NL╚23:█ 400:┴ 1000 жCю: ЩCй▐ ----- ESC DEL: DELETE LINE ----- Dт: "Dч▀ CL╡NL ╖ L$(CL)╡"":┴ 3100 FDХ│ X╡CL ╓ NL╚1:L$(X)╡L$(X╙1):┌ X \DРL$(NL)╡"":NL╡NL╚1 mDЭ█ 400:┴ 1000 sD$: ≈D.▐ ----- INST: INSERT LINE ----- ²D8: ╟DB▀ NL╡ML ╖ 1000 вDL│'& X╡NL ╓ CL ╘ ╚1:L$(X╙1)╡L$(X):┌ X МDVNL╡NL╙1:L$(CL)╡"" ЧD`█ 400:┴ 1000 E┬: )E▓▐ ----- MEGA-M: MARK LINES ----- /E°: EE╕M1╡CL:M2╡CL:█ 400 WE╟║Ы K$:K╡ф(K$) └E╨▀ K$╡"_" ╟ K╡27 ╖ M1╡0:M2╡0:█ 400:┴ 1000 ≤Eд▀ K$╡"" ╖ 5110 ╛Eн▀ K$╡"▒" ╖ 5160 юEь▀ K''$╡"C" ╖ 5210 тEБ▀ K$╡"X" ╖ 5240 ъEЛ┴ 5040 ЯEЖ▐ CURSOR DOWN F ▀ CL╡NL ╖ 5040 &F▀ CL╙1╠M2 ╞ M2╚M1╙2╠MC ╖ 5040 GF
CL╡CL╙1:▀ CL╚FL╠23 ╖ FL╡FL╙1 cF▀ CL╠M2 ╖ M2╡CL:у M1╡CL tF█ 400:┴ 5040 └F(▐ CURSOR UP √F2▀ CL╡1 ╖ 5040 ╦F7▀ CL╚1ЁM1 ╞ M2╚M1╙2╠MC & ╖ 5040 тF<CL╡CL╚1:▀ CLЁFL ╖ FL╡CL ПFF▀ CLЁM1 ╖ M1╡CL:у M2╡CL GP█ 400:┴ 5040 GZ▐ COPY TO CLIPBOARD GGd│ X╡M1 ╓ M2:C$(X╚M1╙1)╡L$(X):┌:NC╡M2╚M1╙1 nGi▀ NCЁMC ╖ │ X╡NC╙1 ╓ MC:C$(X)╡"":┌ ┴GnM1╡0:M2╡0:█ 400:┴ 1000 ═Gx▐ CUT TO CLIPBOARD ╚G}█ 7600 ыG┌(D SILENT ENIGMA════════3D══                                                                                                                                                                                                                                   (D╩══@         юЪ                                                                                                                                                                                                                                       ЬЪЪЪ ЪD╩══@                                                                                               !ЪЫЭЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(ЪЪЪЪЪ(│$BASLOGO.EL══════         3   │	GRABBER.EL.BAK══         X   │LINE.EL.BAK═════         !   ┌)11.DEFAULTS═════            ┌)"11.EDIT═════════         V   │%PETLINE.EL.BAK══         #   │LINE.EL═════════         !   ┌-11.POST═════════          (┌)11.TOKENIZE═════            ┌-11.SETTINGS═════            ┌)POST════════════            ┌) B65SUPPORT.BIN══            ┌, MEGAPLOT════════            ┌' MEGA ASSEMBLER══         ь   │BAGLOGO.BAK═════         2   │) ROTATE.ASM══════          (│Z.L═════════════            │"ROTATE.EL═══════            │SPRITELINE.EL═══            │!MELODY.EL═══════         ▄   │.VART.EL═════════         I   │ GRABBER.EL══════         X   │-#FOOT.EL═════════         ╓   │"!ANA.LN══════════         	 (│.ENIGMA.P════════            ┌"ASMROTATE═══════            ┌PLAYMAKER═══════         ?   ┌VART════════════         "   ┌11BOOT.C65══════            ┌BAS.BIN═════════         !   ┌BAS.DAT═════════            ┌GRABBER═════════          (┌4ASMHELPER═══════            │$PETLINE.EL══════         #   │ MELODY.EL.BAK═══         ▄   │
WRITER.EL.BAK═══            │STARFIELD.EL════         +   │S.L═════════════            │6SILENT.L════════         "   │"SPRITELINE.E.BAK          (	│ BIGSPRITE.EL════         ├   │ABC.LN══════════            │XANADU.EL═══════         V   │	WRITER.EL═══════            ┌ SPRITELINE══════            │ROTATE.EL.BAK═══            │XANADU.EL.BAK═══         V   ┌AUTOBOOT.C65════          (
┌ LINE════════════             11TEMP══════════        │   ┌$ROTATE══════════            ┌11.PARSE════════         ;   ┌7	STARFIELD═══════            ┌5PETLINE═════════            ┌5 WRITER══════════            ┌6BASLOGO═════════           Ъ 8 PETLINE═════════        ┌                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 )"; ROTATE - ASSEMBLY VERSION""; 17/04/2024 - GURCE""""; ASSEMBLE WITH MEGA-A, THEN RUN WITH MEGA-R""""; IT WILL BUILD A FILE 'ASMROTATE' ON YOUR DISK""""; LOAD IT WITH BLOAD 'ASMROTATE',B0""""; RUN IT WITH BANK 0:SYS $1800""""ZPTR32 = $FC""")"    *=$1800,'ASMROTATE'"".PAUSE""    ; BACKUP ZPTR32""      LDA ZPTR32""      STA ZBKP""      LDA ZPTR32+1""      STA ZBKP+1""      LDA ZPTR32+2""      STA ZBKP+2""      LDA ZPTR32+3""      STA ZBKP+3""""    ; INIT""      LDA #$00""      S)TA Y1ADD""      STA Y1ADD+1""""    ; FOR Y = 0 TO 49""      LDY #$00""""        ; CX = TX""LP1       LDA TX""          STA CX""          LDA TX+1""          STA CX+1""          LDA TX+2""          STA CX+2""          LDA #$00""          STA) TX+3""          STA CX+3""""        ; CY = TY""          LDA TY""          STA CY""          LDA TY+1""          STA CY+1""          LDA TY+2""          STA CY+2""          LDA #$00""          STA TY+3""          STA CY+3""""        ; FOR )X = 0 TO 79""          LDX #$00""""            ; POKE $FF80000 + X + Y1ADD, PEEK($40000 + CX/256 + CY/256 * 96)""                ; PUT $40000 IN ZPTR32""LP2               LDA #$00""                  STA ZPTR32""                  STA ZPTR32+1""   )               STA ZPTR32+3""                  LDA #$04""                  STA ZPTR32+2""""                ; ADD CX HIGH BYTE INTO ZPTR32""                  LDA CX+2""                  CLC""                  ADC ZPTR32""                  STA ZPTR)32""                  LDA #$00""                  ADC ZPTR32+1""                  STA ZPTR32+1""""                ; PUT HIGH WORD OF CY INTO TMPW1 AND LEFT-SHIFT 5 TIMES""                  CLC""                  LDA #$00""                  STA TM)PW1""                  STA TMPW1+1""                  LDA CY+2""                  STA TMPW1+2""                  LDA CY+3""                  STA TMPW1+3""""                  LDZ #$05"".SHIFTLOOP""                  ASW TMPW1""                  B)	CS .NXTCARRY1""                  ASW TMPW1+2""                  JMP .NXT"".NXTCARRY1""                  ASW TMPW1+2""                  INC TMPW1+2"".NXT""                  DEZ""                  BNE .SHIFTLOOP""""                ; STORE THIS SH)
IFTED VALUE INTO TMPW2""                  LDA TMPW1""                  STA TMPW2""                  LDA TMPW1+1""                  STA TMPW2+1""                  LDA TMPW1+2""                  STA TMPW2+2""                  LDA TMPW1+3""         )         STA TMPW2+3""""                ; ADD IT TO TMPW1 2 TIMES (TO GET MULTIPLE OF 96)""                  LDZ #$02""""LP3               CLC""                  LDA TMPW2""                  ADC TMPW1""                  STA TMPW1""              )    LDA TMPW2+1""                  ADC TMPW1+1""                  STA TMPW1+1""                  LDA TMPW2+2""                  ADC TMPW1+2""                  STA TMPW1+2""                  LDA TMPW2+3""                  ADC TMPW1+3""            )      STA TMPW1+3""""                  DEZ""                  BNE LP3""""                ; THEN ADD INTEGRAL PART OF TMPW1 (HIGH WORD) TO ZPTR32""                  CLC""                  LDA TMPW1+2""                  ADC ZPTR32""               )   STA ZPTR32""                  LDA TMPW1+3""                  ADC ZPTR32+1""                  STA ZPTR32+1""                  LDA #$00""                  ADC ZPTR32+2""                  STA ZPTR32+2""""                ; PERFORM THE PEEK AND STO)RE IT IN PEEKVAL""                  LDZ #$00""                  LDA [ZPTR32],Z""                  STA PEEKVAL""""                ; PUT $FF80000 INTO ZPTR32""                  LDA #$00""                  STA ZPTR32""                  STA ZPTR32+1")"                  LDA #$F8""                  STA ZPTR32+2""                  LDA #$0F""                  STA ZPTR32+3""""                ; ADD X TO ZPTR32""                  TXA""                  CLC""                  ADC ZPTR32""          )        STA ZPTR32""                  LDA #$00""                  ADC ZPTR32+1""                  STA ZPTR32+1""""                ; ADD Y1ADD TO ZPTR32""                  CLC""                  LDA Y1ADD""                  ADC ZPTR32""          )        STA ZPTR32""                  LDA Y1ADD+1""                  ADC ZPTR32+1""                  STA ZPTR32+1""""                ; POKE THIS ZPTR32 LOCATION WITH PEEKVAL""                  LDZ #$00""                  LDA PEEKVAL""            )      STA [ZPTR32],Z""""            ; CX = CX + XINC""              CLC""              LDA XINC""              ADC CX""              STA CX""              LDA XINC+1""              ADC CX+1""              STA CX+1""              LDA XINC+2""  )            ADC CX+2""              STA CX+2""              LDA XINC+3""              ADC CX+3""              STA CX+3""""            ; CY = CY + YINC""              CLC""              LDA YINC""              ADC CY""              STA CY""    )          LDA YINC+1""              ADC CY+1""              STA CY+1""              LDA YINC+2""              ADC CY+2""              STA CY+2""              LDA YINC+3""              ADC CY+3""              STA CY+3""""        ; NEXT X""     )   INX""        CPX #80""        BNE !LP2""""        ; TX = TX + TXINC""          CLC""          LDA TXINC""          ADC TX""          STA TX""          LDA TXINC+1""          ADC TX+1""          STA TX+1""          LDA TXINC+2""          A)DC TX+2""          STA TX+2""          LDA TXINC+3""          ADC TX+3""          STA TX+3""""        ; TY = TY + TYINC""          CLC""          LDA TYINC""          ADC TY""          STA TY""          LDA TYINC+1""          ADC TY+1""     )     STA TY+1""          LDA TYINC+2""          ADC TY+2""          STA TY+2""          LDA TYINC+3""          ADC TY+3""          STA TY+3""""        ; Y1ADD = Y1ADD + 80""          CLC""          LDA #80""          ADC Y1ADD""          STA )Y1ADD""          LDA #$00""          ADC Y1ADD+1""          STA Y1ADD+1""""    INY""    CPY #50""    BNE !LP1""""    ; RESTORE ZPTR32""    LDA ZBKP""    STA ZPTR32""    LDA ZBKP+1""    STA ZPTR32+1""    LDA ZBKP+2""    STA ZPTR32+2""    L)DA ZBKP+3""    STA ZPTR32+3""""    CLI""    RTS""""""    *=$1A00""TX           .LONG 0""TY           .LONG 0""XINC         .LONG 0""YINC         .LONG 0""TXINC        .LONG 0""TYINC        .LONG 0""""Y1ADD        .WORD 0""CX           .LO |NG 0""CY           .LONG 0""ZBKP         .LONG 0""PEEKVAL      .BYTE 0""TMPW1        .LONG 0""TMPW2        .LONG 0"*                                                                                                                                    ┐ ЪSK 	       BASLOGO.EL L                    LINE                                                                                                                                                                                                        ) -  }Ч128:│ X╡0╓5:┤A$:≈я("1600")╙X,я(A$):┌X S }≈ 248,0 : ▐ RESTORE ROW LINK MODE √ }≥:≥ "PASS 3: TOKENIZING":≥"▒▒▒"╙г(27)╙"T"╙"²"╙г(27)╙"B"; м }÷ 1,1,5,"11TEMP,S,R":·я("1600") : ▐ STDIN = 11TEMP Х }▐ FILL KEYBOARD BUFFER !!}≈208,4:≈ 688,ф("R ?"):≈689,ф("U"):≈690,ф("N"):≈ 691,13 9!}┐ A2,01,20,C6,FF,60                                                                                                                                                                                                   ) ! T$Ч "B65SUPPORT.BIN":· $1600 3 ^$F$╡"HELLO.EL" ] h$L$╡"/FILE:"╙F$:█ 9450:▐ POST FILENAME k r$Ч#2,(F$) u |$L$╡"" ─ ├$║#2,C$ █ ░$L$╡L$╙C$ Ё  $▀ ц(L$)╡128 ╖ █ 9450:▐ POST CHUNK ╫ ╓$≥ N$; т ╝$▀ ╗ ST ╞ 64 ╖ 9350 щ ╦$Ч#2 !б$▀ ц(L$)Ё╠0 ╖ █ 9450:▐ POST R ТEMAINING CHUNK D!л$█ 9450:▐ POST EMPTY CHUNK TO DECLARE WE'VE FINISHED ^!ж$≥ "FINISHED POSTING!" d!Ю$─ }!Й$▐ *** POST CHUNK *** ╣!Т$L$╡г(ц(L$)╙1) ╙ L$:▐ PREPEND THE LENGTH OF STRING+1 е!Ч$A╡╥("/"╙L$) ч!%≥ "POSTING CHUNK..." Х!%L$╡"" Н!%▌              )! ╘G█/п╘S█/п╒<═▌Ь▄Ы }ЪMEGA65 UNIT TEST SUPPORT INSTALLED `╔иЪП  ╕f╓gё ▌Ъ▄ °Lе╘ё ╕d╓e├╠└╡┘Ёd╢ё Й╡╠и=Пи/П'╕cЮпиPП(иFП/иDП6╒l ╘Ч н Ф╘П нLе╘Щ н ФLе╘Р нНLе╘С нНLен╘Ъ н╘ ╛ `H╜  З╜Ъ З╜ Зh З`тcП
Й╡╠ ЗLФ╘\ З`█C жЙ`                                                                                                                                                                                                                                                           )# 8   LL╡0:LZ╡0:XZ╡0:┴130:▐ BUFFER OF PAST LINE LOCATION e  A$╡й(A$,XI):B╡ц(A$):O╡B╠80:≥"▓";:▀O╖B╡79 ≥  P╡н
(A$):Ч0:M╡б(P╙1)╙256╛б(P╙2):C╡M╙B╚1:▀B╡0╖6 ╜  ▀ IV╡1 ╖ ≥ ""; Е  Ч1:│A╡M╓C:ZA╡б(A):≥A$(ZA);:▀ IV╡1 ╞ ZA╡34 ╖ ≥ ""; ! ┌:Ч128:▀O╖Ч9 HL:≥ё7)$9);"$";:Ч9 FG ! ▌ !d : =!n ▐ --- GENERAL INITIALIZATIONS --- C!x : M!┌ в8560 V!┤ Ч4 ▄ !▄ ≈ 0,65             : ▐ M65 FAST MODE ≤!√ █7940: ▐ INSTALL M/L ╙!═ PF$╡"11.EDIT" "╙ Ы 7,"SCRATCH "╙г(34)╙PF$╙г(34)╙":DSAVE"╙г(34)╙PF$╙г(34)╙":DVERIFY"╙г(34)╙PF$╙)%г(34) 3"╢ ▀ н	(2)Ё╠80 ╖≥ г(27)╙"X";:▐ FORCE 80COLS MODE M"╬ █7040:▐ READ DEFAULTS z"х Ч; BG: Ч< BO: Ч9 FG : ≥"⌠"╙г(27)╙"M"; ∙"р █5490:≥" EE V0.5.0▓"; б"э █ 10500           : ▐ ENABLE RAW FN KEYS х"Ф : З"П MX╡2000               : ▐ MAX NUMBER OF LINES)& $#Р ES%╡0                 : ▐ ESCAPE FLAG ░#У T$╡"                                                                               ":BL$╡T$╙T$╙T$:T$╡"" е#З Q$╡г(34)           : ▐ FAST ACCESS TO QUOTE CHAR О#FO$╡г(27)╙г(27) : ▐ ESCAPE FLASH ETC. 8$CC$╡)'"⌠┴└²▒┘├┤┬┼▄┐■"╙г(22)╙г(20)╙г(148)╙г(13) : ▐ CTRL CHARS r$HM$╡"²"╙г(20)     : ▐ HORIZONTAL MOVEMENT CHARACTERS ╚$"CH$(0)╡" ":CH$(1)╡"*" : ▐ FOR FILE CHANGED INDICATOR И$,CM$(0)╡"    ":        : ▐ FOR CONTROL CHAR MODE INDICATOR  %6CM$(1)╡"* CTRL"╙FO$ @%@R$(1)╡"SUCCESS: ":R$(0)╡"ERROR: " : ▐ DISC OPERATION RESULT ┤%JCO(1)╡SB:CO(0)╡HL                 : ▐ DISC OPERATION RESULT COLORS д%TDF$╡"11.DEFAULTS"                 : ▐ DEFAULTS FILE NAME Л%^├ LI$(MX)           : ▐ LINE BUFFER &c├ C*B$(100)        : ▐ CLIPBOARD OF LINES P&h├ MK$(72),MK(72),FI$(72),FI(72)   : ▐ MARKER TABLE s&rEE$(0)╡"VARIABLE NOT DECLARED" y&╓: ╓&╝▐ --- BUILD CHAR TRANSLATION TABLE --- ╙&╦: щ&б├ A$(255)           : ▐ CHAR TRANSLATION TABLE 'л│A╡1╓31:A$(A)╡"*"╙г(64╙A)╙"▓":A$(128╙A)╡""╙г(192╙A)╙"▓":┌A L'ж│A╡32╓127:A$(A)╡г(A):A$(A╙128)╡г(A╙128):┌A a'ЮA$(34)╡г(34)╙FO$ ▌'ЙA$(160)╡"╕" : ▐ MAKE SHIFT+SPACE VISIBLE ■'Т:  'Ч: о'XI╡1 : ▐ HORIZONTAL SCROLL INDEX IN CURRENT LINE з'Ч 128 (≈ 248,б(248)╟2╝6 *   : ▐ DISABLE SCREEN EDITOR LINE LINKING W(&XC╡0:YC╡0:SL╡н	(1)╚2 : ▐ CURSOR POS, STATUS LINE POSITION i(0▀ CF$Ё╠"" ╖Ч ▓(5  ▀ б($4FF70)╡55 ╞ б($4FF71)╡77 ╖ Ч ║(6    █ 9100 ╞(7  Ч:у Ч я(:    █5010: ▐ LOAD FILE IF SET )<    █ 9000: ▐ KEEP COPY *OF FILE IN ATTIC RAM )?    ≈ $4FF70,55,77 _)D    ▀ DEЁ╠0 ╖CF$╡"" : ▐ DELETE CURRENT FILENAME IF FILE NOT THERE h)I  Ч o)NЧ u)X: ╕)b▐ UNCOMMENT THIS FOR OUTPUT PERFORMANCE TEST Д)l▐ TS=TI:FORTE=0TO10:GOSUB2080:NEXTTE:PRINT""TI-TS:STOP Й)v: **─█5150: ▐ REDRAW SCREEN #*┼█5540: ▐ BUILD STATUS BAR )*п: F*з▐ ********************** c*Д▐ ** MAIN EDITOR LOOP ** ─*Н▐ ********************** ├*Ь: ╕*Ч128:·V4 : ▐ ENABLE VIC IV ╥*▀ JLЁ╠╚1 ╖Ч Г*  LY╡JL:CL╡5:█6600: ▐ BRING LINE IN CONTEXT  +*   ▀ б($4FF30)Ё╠0 ╖Ч ?+*    R╡0:PE$╡"":К:P╡б($4FF30╙R):PE$╡PE$╙г(P):R╡R╙1:Л Щ PЁ╠0 ^+>    █ 5490:≥ "";PE$;:NS╡1 q+C    ≈ $4FF30,0 z+H  Ч ╚+R  JY╡╚1:CL╡0             : ▐ CLEAR JUMP LINE ╡+\Ч ╦+fК с+p  ▀ YC╚CTЁ0 ╖CT╡0:YC╡0 ,z  ▀ NSЁ╠1 ╖PO$╡"*      ²²²²²²"╙й(д(XC),2)╙":"╙й(д(YC),2):█5400 ',└  CL$╡LI$(YC) P,┴   ▀ (YC╚CT)╠н	(1)╚1 ╖ YC╡CT╙н	(1)╚1 b,▌  ЧA XC,YC╚CT ┬,≤  Ч9 SB:ЧA ▒: ║Ы T$ : ЧA Ч$:Ч9 FG ╩,≥  ▀ MF╡1 ╖ █ 10050:┴ 2160:▐ MARK-MODE HANDLING Ю,╒  ▀ NS╡1 ╖█5540: Ч128:·V4: NS╡0 -╛ * Ч 128:AK ╡ б(54801) ╞ 16 : ▐ CHECK ALT KEY E-╠  ▐ -- IF T$=F11 (ALSO CTRL+5/GREEN FOR XEMU?) x-╤  ▀ T$╡"°" ╟ (AK ╞ T$╡"C") ╖CM╡╤(CM╚1) : ┴2170 ⌡-ю    CO╡(т(CC$,T$) ╞ CM╡0) ╟ AK ╚-й   ▀ CO ╖Ч Л-т    ▀ T$╡"G" ╖T$╡"" : ▐ WORKAROUND FOR CHALLENGED K*	EYBOARDS .ч    ▀ T$╡"S" ╖T$╡"" 6.Х    ▀ T$╡г(13) ╖CH╡1: █5650: ▐ INSERT RETURN W.Р    ▀ т(HM$,T$)╡0 ╞ XI╠1 ╖Ч ┬.Э       XI╡1:ЧA 0,YC╚CT:CL$╡LI$(YC):A$╡CL$:█1 ╪.	       ▀ T$╡г(13) ╖ЧA 0,YC╚CT╚1:A$╡LI$(YC╚1):█1 г.	    Ч Ж.	    ▀ T$╡"" ╖ █ 9510:*
▐ CTRL-W = NEXT WORD )/	    ▀ T$╡"" ╖ █ 9700:▐ CTRL-U = PREVIOUS WORD e/	    ▀ T$╡"■" ╖ █ 9900:▐ SHIFT-DEL = DELETE CURRENT CHAR ╚/	    ▀ T$╡"" ╖ ≈ $4FF07,б($4FF07) И 8:▀ б($4FF07)╞8 ╖ Ч "T0O5SG" щ/	    ▀ T$╡"P" ╖█9300:▐ POST CURRENT FILE TO PC 0*	    ▀ T$╡"Z" ╖█11000:▐ NAVIGATE TO LABEL UNDER CURSOR @0	    ▀ T$╡"F" ╖ FR%╡0 : █8000: ▐ FIND u0$	    ▀ T$╡"R" ╖ FR%╡1 : █8000: ▐ FIND AND REPLACE ∙0.	    ▀ T$╡"├" ╖█5990: ▐ SAVE ╫08	    ▀ T$╡"┼" ╖SA╡1:█5990: ▐ SAVE AS щ0B	    ▀ T$╡"┘" ╖█6260: ▐ LOAD *Щ0L	    ▀ T$╡"┐" ╖█7360: ▐ STOP 1V	    ▀ T$╡"┴" ╖█7230: ▐ NEW >1`	    ▀ T$╡"┬" ╖█7430: ▐ LABELS c1j	    ▀ T$╡"" ╖█6710: ▐ GOTO LINE ≥1o	    ▀ T$╡"▄" ╖█10700: ▐ GO TO PREVIOUS FILE (PV$) ╧1t	    ▀ T$╡"└" ╖█6790: ▐ HELP 2y	    ▀ T$╡"" ╖ TM╡YC:YC╡LL:LL╡*TM: TM╡CT:CT╡LZ:LZ╡TM: TM╡XC:XC╡XZ:XZ╡TM:█ 5150 72~	    ▀ T$╡"" ╖Ч           : ▐ HOME/END l2┬	      ▀ AK╡0 ╖LY╡0:XC╡0:█6600: уLY╡NL:XC╡0:█6600 w2▓	    Ч ╕2°	    ▀ T$╡"" ╖Ч : ▐ -------- CURSOR RIGHT ╧2╕	      ▀ AK ╖Ч Р2╟	         ▀ 79╙XIЁц(CL$) ╖XI╡*XI╙1:ЧA0,YC╚CT:A$╡CL$:█1 
3╨	      Ч : уXC╡XC╙1  3д	      ▀ XC╠79 ╖Ч J3н	        XC╡79:▀ XC╙XIЁц(CL$) ╖XI╡XI╙1 k3ь	        ЧA 0,YC╚CT:A$╡CL$:█1 x3Б	      Ч ┐3Л	    Ч ≤3Ж	    ▀ T$╡"²" ╖Ч Б3 
      ▀ XC╠0 ╖XC╡XC╚1 : у▀ YC╠0 ╖YC╡YC╚1:XC╡ц(LI$(YC)):▀ XC*╠79 ╖XC╡79 М3

    Ч 4
    ▀ T$╡"" ╖Ч *4
      ▀ AK ╖LY╡YC╙SL:█6600:уYC╡YC╙1 ]4(
      ▀ YC╚CT╠SL╚3 ╖█5250: ▀ YC╚CT╠SL ╖YC╡YC╚1 h42
    Ч }4<
    ▀ T$╡"▒" ╖Ч ╔4F
      ▀ AK ╖LY╡YC╚SL:█6600:уYC╡YC╚1 т4P
      ▀ YC╚CTЁ0 ╖█5330: ▀ YC╚CTЁ0 ╖YC╡YC╙1 ъ*4Z
    Ч 5d
    ▀ T$╡"┤" ╖█7790: ▐ --- F5 - COMPILE +5n
    ▀ T$╡г(20) ╖Ч:▐ DELETE :5x
      CH╡1 t5┌
      ▀ XC╡0 ╟ AK ╖█5840:уЧ : ▐ MERGE WITH LAST LINE ·5▄
      CL$╡х(CL$,XC╙XI╚2)╙й(CL$,XC╙XI) ╢5√
      LI$(YC)╡CL$ Е5═
      ЧA 0,YC╚CT:A$╡CL$:█1:*▀ц(CL$)Ё╡79╖≥" "; Ъ5╙
      ▀ XC╠0 ╖XC╡XC╚1 
6╢
    Ч 6╬
  Ч B6х
  ▀ T$╡"" ╖Ч : ▐ --- F14 - SAVE DEFAULTS i6р
    █5490:≥"SAVING DEFAULTS...▓"; ё6э
    Р (DF$):Ч (DF$),B(4),P(я("FF00")) ╓ P(я("FF80")) ╩6А
    DE╡DS : DE$╡DS$ р6Ф
    Ч9 CO(╤(DE╡0))* 7П
    █5490:≥ "";R$(╤(DE╡0));DE$;" ";:Ч9 SB 7З
    NS╡1 7  Ч K7Ч:у Ч:▀ T$╡г(27) ╖ Ч: ▐ -- CHECK ESCAPE FLAG o7  T$╡"":▀ ES%╡0 ╖ ES%╡1:у ES%╡0 ╖7Ч:у Ч:▀ ES%╡1 ╖ Ч : ▐ -- CHECK ESCAPE CHARACTERS Б7  ▀ T$╡"K" ╖ XC╡ц(CL$):▀ XC╠78 ╖ XI╡*XC╚78:XC╡78:█ 9970 8  ▀ T$╡"J" ╖ XC╡0:▀ XI╠1 ╖ XI╡1:█ 9970 /8  ▀ T$╡"D" ╖ AK╡1:█ 5840:CH╡1 X8  ▀ T$╡"M" ╖ MF╡1:MS╡YC:ME╡YC:█ 9970 q8  ▀ T$╡"P" ╖ █ 10200 }8  ES%╡0 ⌡8Ч:уЧ : ▐ -- INSERT CHAR ╗8    CH╡1 а8"    ▀ XC╡79 ╖XI╡XI╙1 9,    К Щ *ц(CL$)ЁXC:CL$╡CL$╙" ":Л: ▐ FILL UP SPACES IF NEEDED ,96    CL$╡х(CL$,XC╙XI╚1)╙T$╙й(CL$,XC╙XI) @9@    LI$(YC)╡CL$ ]9J    ЧA 0,YC╚CT:A$╡CL$:█1 ~9T    XC╡XC╙1 : ▀ XC╠79 ╖XC╡79 ∙9^  Ч:▐ ENDIF ES%=1 ╡9`  Ч:▐ ENDIF T$=CHR$(27) р9b  Ч:▐ ENDIF CO (CTRL*-CHAR) ъ9hЛ Э QU╡1 Е9r░ К9|: (:┬▐ ==================== SUBROUTINES ===================== =:▓▐ --- READ IN F$ b:°÷ 1,1,5,CF$╙",S,R":DE╡DS:DE$╡DS$ }:╕▀ DEЁ╠0 ╖CF$╡OF$:═ 1:▌ ⌡:╟│A╡0╓MX:LI$(A)╡"":┌A:LC╡0 Ё:╨NL╡0:CT╡0:YC╡0:XC╡0 ╧:дК м:н  L$╡"":Е └1*,L$ ч:ь  LI$(NL)╡L$ Л:Б  NL╡NL╙1 Ы:ЛЛ Щ ST╡0 
;ЖNL╡NL╚1:CH╡0 ; ═ 1 ;
▌ ;: 7;▐ ---  REDRAW SCREEN J;(Ч9 FG : ≥ "▓"; [;2▀ CTЁ0 ╖CT╡0 j;<│ I╡0 ╓ SL w;F  ЧA 0,I ┼;P  A$╡LI$(CT╙I) ╩;Z  ≥ г(27)╙"Q";:ZY╡YC:YC╡CT╙I:█10000:YC╡ZY:█1 ц;d┌ I и;n*▌ о;x: Ц;┌▐ --- SCROLL UP В;▄▀ CT╙SL╠NL╚1 ╖▌ <√CT╡CT╙1 : ▐ CURRENT TOP %<═S$╡LI$(CT╙SL) =<╙ЧA 0,0:≥ г(27)╙"V"; R<╢ЧA 0,SL:A$╡S$:█1 X<╬▌ ^<х: t<р▐ --- SCROLL DOWN ┐<э▀ CTЁ╡0 ╖▌ ▐<ФCT╡CT╚1 ·<ПS$╡LI$(CT) ╬<ЗЧA0,0:≥ г(27)╙"W";:A$╡S$:█1 д<▌ й*<: Й<▐ --- DISPLAY STATUS IN ST$ Т<"Ч9 SB =,≥"";:ЧA 20,SL╙1:≥""╙PO$; -=6ЧA 75,SL╙1:≥CM$(CM); M=@ЧA 0,SL╙1:≥""╙CH$(CH)╙"▓"; ^=JЧ 0,0,79,SL h=TЧ9 FG n=^▌ t=h: ╜=r▀ н	(1)╡25 ╖ CB╡2048╙(24╛80) : FB╡$FF80000 ╙ (24╛80) Х=t▀ н	(1)╡50 ╖ CB╡$4*0800╙(49╛80) : FB╡$FF80000 ╙ (49╛80) >wЧ! 3,80,160,CB       : ▐  --- CLEAR STATUS BAR O>|Ч! 3,80,SB,FB        : ▐  SET STATUS BAR COLOUR d>├≥"";:ЧA 0,SL╙1 n>░Ч9 SB t> ▌ ▀>╓▐ --- CLEAR STATUS √>╝█ 5490 Ж>л≥"";:ЧA 18,SL╙1:≥"щ       щ ▓F1LOAD* ▓F3SAVE ▓F5COMPILE ▓F7LBLS ▓F9GO ▓F11CMODE щ"; '?жЧA 2,SL╙1:▀ CF$Ё╠"" ╖≥ CF$;:у≥ "<UNTITLED>"; 8?ЮЧ 0,0,79,SL B?ЙЧ9 FG H?Т▌ N?Ч: f?▐ --- INSERT RETURN r?YC╡YC╙1 ~?NL╡NL╙1 ▒?&▀ YC╠NL ╖NL╡YC ц?0│A╡NL╙1╓YC╙1╘╚1:LI$(A)╡LI$(A╚1):┌A:LI$(YC)*╡"" Б?:LI$(YC)╡й(LI$(YC╚1),XC╙XI) @DLI$(YC╚1)╡х(LI$(YC╚1),XC╙XI╚1) !@NXC╡0:SC╡1:PL$╡LI$(YC╚1) L@XК Щ й(PL$,SC,1)╡" " : ▐ --- AUTOINDENT u@b  ▀ LI$(YC)Ё╠"" ╖LI$(YC)╡" "╙LI$(YC) ▀@l  SC╡SC╙1:XC╡XC╙1 ▒@vЛ ╢@─▀ YC╚CT╠SL ╖█5250: ▐ SCROLL UP я@┼ЧA XC*,YC╚CT:≥ г(27)╙"I"; Ц@■A$╡LI$(YC):█1 A·ЧA XC╚SC╙1,YC╚CT╚1:≥ г(27)╙"Q"; A╗A$╡LI$(YC╚1):█1 !A╡▌ 'A╪: =Aф▐ --- MERGE LINES RAп▀ AK╡0 ╞ YCЁ1 ╖▌ vAз▀ AK ╖SX╡XC:XC╡0:YC╡YC╚1:┴ 5880 ░AДYC╡YC╚1:XC╡ц(LI$(YC)) ╝AНLI$(YC)╡LI$(YC)╙LI$(YC╙1) рAЬ│A╡YC╙1╓N*L╚1:LI$(A)╡LI$(A╙1):┌A КA▀ YCЁ╡NL ╖LI$(NL)╡"" ЪA▀ NL╠0 ╖NL╡NL╚1 B: +B ▀ AK╡0 ╖ ЧA 0,YC╚CT:A$╡LI$(YC):█1 HB*ЧA 0,YC╚CT╙1:≥г(27)╙"D"; eB4ЧA 0,SL:A$╡LI$(CT╙SL):█1 ▄B>▀ CT╙SL╠NL╚1 ╖ЧA 0,SL:≥ г(27)╙"Q"; ╓BH▀ AK ╖XC╡SX:YC╡YC╙1 ╙BR▌ ╟B\: дBf▐ ---* SAVE FILE БBp▀ BU ╞ CF$Ё╠"" ╞ SA╡0 ╖Ч 
Cz  █5490:≥"BACKING UP OLD FILE..."; $C└  B$╡х(CF$,12)╙".BAK" 1C▌  В (B$) FC≤  Т (CF$) ╓ (B$) MC╒Ч zC╛▀ CF$╡"" ╟ SA╡1 ╖SA╡0 : █6520: ▐ SAVE AS ▒C╤▀ CF$╡"" ╖█5540: ▌ ╙Cю█5490:≥"SAVING..."; ╤CйВ (CF$) у*CтI╡MX:К Щ LI$(I)╡"":I╡I╚1:Л чCчNL╡I DХ÷ 1,1,3,CF$╙",S,W":DE╡DS:DE$╡DS$ DР│ A╡0 ╓ NL "DЭ  ≤1,LI$(A) *D┌ A >D▀ DSЁ╠0 ╖ DE╡DS FD═ 1 PD█5490 aD$▀ DE╡0 ╖CH╡0 tD.Ч9 CO(╤(DE╡0)) ∙D8≥ R$(╤(DE╡0));DE$;" ";:Ч9 SB ©DB█7720: ▐ SAVE FILENAME IN MA* ILBOX RAM хDLNS╡1 нDV▌ тD`: зDj: НDt▐ --- LOAD FILE ЬD~█5490 E┬OF$╡CF$ E▓▀ CH╡1 ╖Ч \E°  ≥ "CURRENT FILE "╙CF$╙" NOT SAVED. REALLY PROCEED? (Y/N) ╕"╙FO$; yE╕  К:║Ы T$:Л Э т("YN",T$) ┘E╟  █5490 ²E╨  ▀ T$╡"N" ╖█5540:▌ ╓EдЧ СEн█5490:≥ "L*!OAD FILE NAME ($ FOR DIRECTORY, RETURN TO CANCEL) "╙г(27)╙"T⌠"; ЧEьNF$╡"" FБЕ ┘ "";NF$ 0FЛ▀ ц(NF$)╠0 ╞ х(NF$,1)╡"$" ╖ Ч SFМ  Ч0,0,79,SL : ≥ "⌠"; : Ч9 FG qFН  ▀ ц(NF$) ╡ 1 ╖ Н : у Ч ├FО    Н (й(NF$,2)) ▐FП  Ч °FЯ  ┴ 6350 ёFРЧ ╢FЖ≥"";:█54*"90 пF ▀ NF$╡"" ╖█5540:█5150:▌ G
PV$╡CF$:PV╡YC:CF$╡NF$:≥ "LOADING "╙CF$╙"..."; G█5010 G≥"⌠"╙FO$; 8G(█5150: ▐ REDRAW SCREEN ^G2▀ DE╡0 ╖█7720: ▐ PERSIST FILENAME wG<█5490:Ч9 CO(╤(DE╡0)) ╕GF≥ "";CF$;" - ";R$(╤(DE╡0));DE$;" ";:Ч9 SB лGP▀ DE╡*#0 ╖≥"; READ ";NL; "LINES."; уGZNS╡1 шGd▌ АGn:  Hx▐ --- QUERY SAVE FILE NAME >H┌█5490:≥ "SAVE FILE NAME (RETURN TO CANCEL) "╙г(27)╙"T⌠"; IH▄NF$╡"" XH√Е ┘ "";NF$ iH═≥"";:█5490 uH╙CF$╡NF$ {H╢▌ │H╬: ╜Hх▐ --- ENSURE LY IS AT SANE POSITION END *$уHй▐     MAKE LINE LY THE CURRENT LINE УHм▐ IF LY>NL-SL THEN LY=NL-SL IрCT╡LY :YC╡LY Iэ▀ CT╠CL ╖CT╡CT╚CL &IФ┴6690 7IП▀ CTЁ0 ╖CT╡0 HIЗ▀ YCЁ0 ╖YC╡0 hI▀ YC╠NL ╖YC╡NL : CT╡YC╚SL╙3 ░I▀ CT╠CL ╖CT╡CT╚CL : ▐ CONTEXT LINES ║I▀ CTЁ0 ╖CT╡0 ╚I"█5150 *%╠I,▌ иI6▐ --- QUERY LINE NO J@█5490:≥ "JUMP TO LINE # (RETURN TO CANCEL) "╙г(27)╙"T⌠"; JJNN$╡"":Е ┘ NN$ 5JTNN╡е(NN$):≥"";:█5490 DJ^▀ NN╠NL ╖▌ YJhLY╡NN:CL╡8:█6600 cJr█5540 iJ|▌ xJ├▐ --- HELP ЁJ░≥"⌠-- CURSOR MOVEMENT --",,"-- EDITOR FUNCT*&IONS --" зJ ≥"CURSOR KEYS  ▓ MOVE THE CURSOR" K╓≥"ALT + UP     ▓ SCROLL UP 1 PAGE" ,K╝≥"ALT + DOWN   ▓ SCROLL DOWN 1 PAGE" YK╦≥"ALT + LEFT ═ ▓ SCROLL LEFT 1 CHAR(*)" ┤Kб≥"ALT + RIGHT  ▓ SCROLL RIGHT 1 CHAR(*)" ╠Kл≥"SHIFT + CLR  ▓ GO TO TOP*' OF FILE" зKж≥"ALT + CLR    ▓ GO TO END OF FILE" LЮ≥"ALT + DELETE ▓ DELETE CURRENT LINE" 4LЙ≥"ALT + RETURN ▓ TO START OF NEXT LINE" QLЛ≥"ALT + F      ▓ FIND" wLН≥"ALT + R      ▓ FIND & REPLACE" ╖LП≥"ALT + Z      ▓ GO TO LABEL UNDER CURSOR+ " тLТ≥"*) ONLY IN LINES WITH >80 CHARACTERS" ЧLУ≥"#▓) XEMU-EQUIVALENT SHORTCUT KEY" MЧ≥"",,,," F1 ▓ LOAD FILE" :M≥,,,," F2 ▓ NEW FILE" VM≥,,,," F3 ▓ SAVE FILE" uM≥,,,," F4 ▓ SAVE FILE AS" √M&≥,,,," F5 ▓ COMPILE + RUN" ╣M0≥,,,," F+6 ▓ JUST COMPILE" тM:≥,,,," F7 ▓ GO TO LABEL" ЗM?≥,,,," F8 ▓ GO TO PREVIOUS FILE" ,ND≥,,,," F9 ▓ GO TO LINE NR     (#▓)CTRL + P" XNF≥,,,,"CTRL-O▓ JUMP TO LOC PRIOR TO F7" ▀NN≥,,,,"F11 ▓ TOGGLE CTRL MODE  (#▓)CTRL + 5" ╬NX≥,,,,"F14 ▓ UPDA+TE DEFAULTS   (#▓)CTRL + Z" ОNb≥,,,,"HELP▓ THIS SCREEN       (#▓)PAGEUP" 	Og█ 10550 : ▐ MORE HELP MOl█5490:≥"EE CHEAT SHEET -- PRESS ANY KEY TO RETURN TO EDITOR▓"; eOv║Ы T$:█5150:█5540:▌ █O─▐ --- SET FILENAME FROM MAILBOX RAM ╧O┼Ч 4:T$╡г(б(я(+"FF00")))╙г(б(я("FF01"))) КO■▀ T$Ё╠"SK" ╖BO╡6:FG╡5:BG╡0:SB╡14:HL╡2:JL╡╚1:▌ P·JL╡╚1 : ▐ JUMP LINE ,P╗AL╡б(я("FF07"))╞1 : ▐ AUTOLOAD FLAG? >P╡▀ AL╡0 ╖┴7170 aP╪TF$╡"":I╡я("FF10"):К Щ б(I)Ё╠0 }PфTF$╡TF$╙г(б(I)):I╡I╙1:Л ┴PпCF$╡TF$ ╢Pз▀ б(я("FF07"))╞2+ ╖Ч : ▐ AUTOJUMP FLAG шPД≈ я("FF07"),б(я("FF07"))╞(255 И 2) QНJL╡б(я("FF09"))╙256╛б(я("FF0A")):EE╡б(я("FF08")) QЬЧ KQBO╡б(я("FF02")):BG╡б(я("FF03")):FG╡б(я("FF04")) oQHL╡б(я("FF05")):SB╡б(я("FF06")) ∙QBU╡б(я("FF07"))╞4 : ▐ BACKUP FLAG йQSM+╡б($4FF07)╞8:▀ SM ╖ ≥ г(27)╙"5";:у ≥ г(27)╙"8" уQ Ч 128 шQ*▌ АQ4: РQ>▐ ------ NEW ЪQH▀ CH ╖Ч HRR:  █5490:≥"цURRENT FILE WAS MODIFIED! рEALLY START OVER (Y/N)? ╕"; kR\:  К:║Ы T$:Л Э T$╡"Y" ╟ T$╡"N" ┬Rf:  ▀ T$╡"N" ╖█5540:    ▌ ▐RpЧ ╜Rz│A╡0╓M+X:LI$(A)╡"":┌A:LC╡0 ╦R└CF$╡"" иR▌≥"⌠":█5150 сR≤█5540 КR╒CH╡0:XC╡0:YC╡0:CT╡0 S╛█5490:≥"** нEW FILE **▓";:NS╡1 S╤▌ &Sю▐ ------ NEW RSй█5490:≥"REALLY QUIT EE? ╕"╙г(27)╙"O"; rSтК:║Ы T$:Л Э T$╡"Y" ╟ T$╡"N" ┬Sч▀ T$╡"N" ╖█5540:▌ ёSХЧ 128:≈248+,0:Ы ▒:Ч4 ▄ ╩SР≥"⌠TSCHUESSN...!" аSЭ─ ФSЩ▐ --- FILTER LABELS BASED ON FZ$ TЧ│A╡0╓72:FI$(A)╡"":FI(A)╡0:┌A:FZ╡0:MP╡╚1 NTЪ│A╡0╓MN╚1:▀ (ц(FZ$)╠0 ╞ т(MK$(A),FZ$)╠0)╟ ц(FZ$)╡0 ╖ Ч xT   FI$(FZ)╡MK$(A):FI(FZ)╡MK(A):FZ╡FZ╙1 √T  ▀ MK(A) Ё╡ YC ╖ MP╡MP╙1+ ²TЧ U┌ A:≥ "⌠";:█ 5490:▀ FZЁ╠0 ╖≥"цHOOSE LABEL WITH CURSOR KEYS + ретурн, ESCAPE WITH есц▓ - FILTER='";FZ$;"'"; PU▀ FZ╡0 ╖≥"нO LABELS FOUND▓ - FILTER='";FZ$;"'"╙FO$;:NS╡1:▌ ╚UL╡SL╙1:Ч0,0,79,SL:≥"⌠":│A╡0╓FZ:ЧA 20╛╣(A╜L),н(A,L):≥ FI$(A);:+	┌ A:▀ MPЁ0 ╖ MP╡0:▌:у ▌ ╪U▐ --- LABELS гUMP ╡ 0 пUЧ 1 V█5490:≥"цOLLECTING LABELS...";:▀ NZ%╡0 ╖ FZ$╡"" BV$│A╡0╓72:MK$(A)╡"":MK(A)╡0:FI$(A)╡"":FI(A)╡0:┌A:MN╡0:FZ╡0 rV.│A╡0╓NL:T$╡LI$(A):LB$╡"":▀х(T$,1)Ё╠"."╖7490  V8MK$(MN)╡й(T$,1,38):MK(MN)╡A+
:MN╡MN╙1 ═VB┌ ╠VL█5490:█ 7421 бVV▀ NZ%╡1 ╖ Ч ЕVX  ▀ FZ╡1 ╖ T$╡г(13):у T$╡г(27) ЬVZ  NZ%╡0:┴ 7690 ЪV\Ч 	W`NZ%╡0 W▓К 8W°  SX╡20╛╣(MP╜L): SY╡н(MP,L):ЧA 0,10 ZW╕  ЧA SX,SY:≥ "";FI$(MP);"▓"; fW╟  ║Ы T$ ─W╨  ЧA SX,SY:≥ FI$(MP); ≤Wд  ▀ T$╡"" +╖MP╡MP╙1 ╟Wн  ▀ T$╡"" ╖MP╡MP╙L гWь ▀ T$╡"▒" ╖MP╡MP╚1 чWБ ▀ T$╡"²" ╖MP╡MP╚L XГ ▀ (T$╠╡"A" ╞ T$Ё╡"Z") ╟ T$╡"╞" ╖ FZ$╡FZ$╙T$:█7421 LXХ ▀ T$╡г(20) ╞ ц(FZ$)╠0 ╖ FZ$╡х(FZ$,ц(FZ$)╚1):█7421 dXЛ ▀ MP╠FZ╚1 ╖MP╡FZ╚1 wXЖ  ▀ MPЁ0 ╖MP╡0 ⌠X Л Э T$╡г(13) ╟ T$╡+г(27) рX
▀ T$╡г(13) ╖ XZ╡XC:LL╡YC:LZ╡CT:XC╡0:LY╡FI(MP):█6600:у█5150 ЯX█5540: ▐ REDRAW STATUS BAR ВX▌ Y(▐ --- SAVE FILENAME IN MAILBOX RAM ;Y2█ 9000 : ▐ SAVE TO ATTIC mY<│ I╡1 ╓ ц(CF$):≈ $4FF10╙I╚1,ф(й(CF$,I,1)):┌ I ─YF≈ $4FF10╙I╚1,0 ⌡YP≈ $4FF0+0,ф("S"),ф("K") ╢YZ≈ $4FF07,б($4FF07)╟1 юYdЧ128:▌ рYn▐ --- COMPILE шYxAB╡0 Z┌▀ CF$╡"" ╖▌ : ▐ NOW FILENAME, NO CIGAR Z▄▀ CH╡1 ╖Ч (Z√  █5490: Ч9 HL aZ═  ≥ "CURRENT FILE NOT SAVED - PRESS ANY KEY";:║Ы T$ zZ╙  Ч9 FG: █5540: AB╡1 │Z╢Ч ▐Z╬▀ AB+╡1 ╖▌ ╔Zх≥"⌠"╙г(27)╙"L"; лZм▐ GOSUB9000 : REM SAVE LINE BUFFER .[р≥"⌠EDMA 0,$D400,$8010000,$2001:NEW RESTORE":≥"RUN";:▐ LOAD '11.PARSE' FROM ATTIC CACHE 9[эЧ 128 l[Ф≈ 208,2     : ▐ NO OF CHARS IN KEYBOARD BUFFER ┼[П≈ 688,13,13 : ▐ 2X RETU+RN ░[З─ ╣[▐ --- M/L HELPER FOR VIC-IV MODE е[Ч128:▄7970 Я[│ I╡0 ╓ 12:┤ A$:≈ я("1600")╙I,я(A$):┌ I \"┐ 78,A2,47,A0,53,8E,2F,D0,8C,2F,D0,58,60 /\,V4╡я("1600") 5\6▌ L\@▐ ================ c\J▐ FIND AND REPLACE z\T▐ ================ ─\^: ║\h█+5490:≥ "FIND:"╙г(27)╙"T⌠"; Д\rFS$╡"":RS$╡"":SD╡1 : ▐ FIND STRING, REPLACE STRING, SEARCH DIR Ч\|RA%╡0 : ▐ REPLACE ALL ]├÷ 1,0,0:Е └1,FS$:═ 1 )]░▀ FR%╡0 ╖8110 U]   ≥"";:█5490:≥"REPLACE:"╙г(27)╙"T⌠"; p]╓  ÷ 1,0,0:Е └1,RS$:═ 1 │]╝≥"";:█5490 ╣]+╦▀ FS$╡"" ╟ FS$╡" " ╖≥"FIND CANCELLED.";:NS╡1:▌ ╬]бS╡YC ы]л█5490:≥"SEARCHING..."; Н]жК Щ S╠╡0 ╞ SЁ╡NL ^Ю  FP╡т(LI$(S),FS$) : ▐ FOUND POS &^Й  ▀ FP╡0 ╖8240 @^Т     LY╡S:CL╡8: █6600 P^Ч     Ч 128 k^      ▐ MARK FOUND LINE ─^      │ RV╡0 ╓ 79 ²+^        I╡((YC╚CT)╛80)╙RV а^        ≈ 2048╙I,б(2048╙I) И 128 н^      ┌RV Л^      ▐ FLASH FOUND STRING _!      │ RV╡0 ╓ ц(FS$)╚1 )_"        I╡((YC╚CT)╛80)╙FP╙RV╚1 N_#        ≈ $D800╙I,б($D800╙I) ╟ 16 \_$      ┌ RV |_&      ▀ FR%╡0 ╖█8310: у█8390 ┴_0+   S╡S╙SD ▐_: Л й_D ▀ FD$╡"Q" ╖ █5540: у█5490:Ч9 HL:≥"END OF FOUND";:NS╡1 -`I ▀ FD$Ё╠"Q" ╞ S╠NL ╖ ≥ " - SEARCH FROM START?═(Y/N):";:║ Ы FD$: ▀ FD$╡"Y" ╖ S╡0:┴ 8140:у █ 5490 O`N XC╡0:ЧA XC,YC╚CT:≥ г(27)╙"Q"; Y`X Ч9 FG }`b A$╡LI$(YC):█1: ▐ REDRAW CURRENT +┐`l ▌ ≈`v ▐ --- FIND NEXT ╒`─ Ч 128 и`┼ █5490:≥ "FIND N)EXT P)REV Q)UIT"; Г`■ К:║Ы FD$:Л Э т("NPQ",FD$) Ш`· ▀ FD$╡"N" ╖SD╡1 a╗ ▀ FD$╡"P" ╖SD╡╚1 &a╡ ▀ FD$╡"Q" ╖S╡NL╙2 ,a╪ ▌ >aф ▐ --- REPLACE Iaп Ч 128 yaз █5490:≥ "R)EPLACE A)LL N)EXT P)REV Q)UIT"; ≥a+Д К:║Ы FD$:Л Э т("RANPQ",FD$) ╜aН ▀ FD$╡"N" ╖SD╡1 бaЬ ▀ FD$╡"P" ╖SD╡╚1 ьa!▀ FD$╡"Q" ╖S╡NL╙1 Мa!▀ FD$╡"R" ╖█8480 Сa!▌ b !TS$╡LI$(S) /b*!NS$╡х(TS$,FP╚1)╙RS$╙й(TS$,FP╙ц(FS$),255) >b4!LI$(S)╡NS$ [b>!ЧA XC,YC╚CT:≥ г(27)╙"Q"; lbH!A$╡LI$(S):█1 vbR!S╡S╚1 |b\+!▌ ┌bf!▌  bp!▐ --- ERROR HANDLER ╘bz!▀ ER╡30 ╖ж ╞b└!в йb▌!Ч 128:≈248,0:Ы ▒:Ч4 ▄ Пb≤!≥ г(27)╙"Q"╙г(27)╙"L≥";с(ER),EL Жb╒!─ c(#▐ --- COPY LINE BUFFER TO ATTIC RAM 5c<#CB╡$8030000 : C╡CB acA#Ч C,NL╙1 : C╡C╙2 : ▐ STORE NO OF LINES pcF#│ A╡0 ╓ NL ═cP#  P+╡н
(LI$(A)):L╡ц(LI$(A)):B╡$10000╙н(P╙1) ╢cZ#  ≈ C,L : C╡C╙1 сcd#  ▀ LЁ╠0 ╖Ч! 0,L,B,C:C╡C╙L ыcn#┌ ъcx#▌ d▄#▐ --- COPY ATTIC RAM TO LINE BUFFER d√#CB╡$8030000 : C╡CB 1d═#NL╡н(C):C╡C╙2 :d╙#CL╡0 Id╢#К Щ CLЁ╠NL ud╬#  L╡б(C):LI$(CL)╡х(BL$,L):P╡н
(LI$(CL)) +▓dц#  B╡$10000╙н(P╙1):C╡C╙1 ╢dм#  ▀ LЁ╠0 ╖ Ч! 0,L,C,B : C╡C╙L бdэ#  CL╡CL╙1 хdФ#Л нdП#▌ НdT$Ч "B65SUPPORT.BIN":· $1600 e^$A╡╥(0):▐ SET ISSUE# TO ZERO 9eh$L$╡"/FILE:"╙CF$:█ 9450:▐ POST FILENAME Her$Ч#2,(CF$) Re|$L$╡"" ]e├$║#2,C$ je░$L$╡L$╙C$ ░e $▀ ц(L+$)╡128 ╖ █ 9450:▐ POST CHUNK  e╓$≥ N$; ╠e╝$▀ ╗ ST ╞ 64 ╖ 9350 ╨e╦$Ч#2 Иeб$▀ ц(L$)Ё╠0 ╖ █ 9450:▐ POST REMAINING CHUNK !fл$█ 9450:▐ POST EMPTY CHUNK TO DECLARE WE'VE FINISHED ;fж$≥ "FINISHED POSTING!" AfЮ$▌ ZfЙ$▐ *** POST CHUNK *** ▓fТ$L$╡г(ц(L$)╙1) ╙ L$:+▐ PREPEND THE LENGTH OF STRING+1 ╒fЧ$A╡╥("/"╙L$) ╩f%≥ "POSTING CHUNK..." еf%L$╡"" кf%▌ Цf!%▐ MOVE TO NEXT WORD g&%К Щ й(CL$,XC╙XI,1) Ё╠ " " g0%  █ 9600 g:%  ▀ EF ╖ М #gD%Л @gN%К Щ й(CL$,XC╙XI,1) ╡ " " MgX%  █ 9600 \gb%  ▀ EF ╖ М bgl%Л hgv%▌ ─g─%▐ M+OVE TO NEXT CHAR ▒g┼%EF╡0:XC╡XC╙1 ╕g■%▀ XC╠ц(CL$) ╖ Ч Дg·%  ▀ YCЁ NL ╖ XC╡0:YC╡YC╙1:CL$╡LI$(YC):▀ YC╚CT╠20 ╖ █ 5250 Оgё%  EF╡1 Жg╗%Ч Эg╡%▌ hД%▐ MOVE TO PREVIOUS WORD /hИ%█ 9800:▐ PREV CHAR LhН%К Щ й(CL$,XC╙XI,1) ╡ " " YhЬ%  █ 9800 hh&  ▀ EF ╖ М nh&Л+ ▄h&К Щ й(CL$,XC╙XI,1) Ё╠ " " ≥h &  █ 9800 ╗h*&  ▀ EF ╖ М ╝h4&Л еh9&█ 9600:▐ NEXT CHAR кh>&▌ ЦhH&▐ MOVE TO PREV CHAR ТhR&EF╡0:XC╡XC╚1 i\&▀ XCЁ0 ╖ Ч Eif&  ▀ YC╠0 ╖ YC╡YC╚1:CL$╡LI$(YC):XC╡ц(CL$)╚1:▀ YC╚CTЁ0╖ █ 5330 Yik&  ▀ XCЁ0 ╖ XC╡0 dip&  EF╡1 kiz&Ч +▐i&▀ EF╡1 ╞ ц(CL$) ╞ YC╠0 ╖ ┴ 9810 ∙i└&▌ ╞i╛&▐ DELETE CURRENT CHAR дi╤&▀ XCЁц(CL$) ╖ Ч оiю&  CH╡1 Вiй&  CL$╡х(CL$,XC╙XI╚1)╙й(CL$,XC╙XI╙1) 	jт&  LI$(YC)╡CL$ jы&  █9970 jч&Ч "jХ&▌ <jР&▐ *** REDRAW LINE *** MjВ&IV╡0:█ 10000 yjЭ&ЧA 0,YC╚CT:A$╡CL$:█ 1:▀ц+(CL$)Ё╡79╖≥" "; ┌j'IV╡0 ┬j'▌ ╗j'▐ *** INVERT IF MARKED LINE ╪j'IV╡0:▀ MF╡0 ╖ ▌ Цj$'▀ MSЁME ╞ MSЁ╡YC ╞ YCЁ╡ME ╖ IV╡1:▌ 	k.'▀ MEЁ╡MS ╞ MEЁ╡YC ╞ YCЁ╡MS ╖ IV╡1 k8'▌ 0kB'▐ *** MARK-MODE HANDLING *** BkL'▀ T$╡"" ╖ Ч kkM'  ME╡YC╙1:CL$╡LI$(YC):█ 9970:YC╡Y+C╙1 ▌kN'  ▀ YC╚CT╠SL╚3 ╖ █ 5250:▌:у Ч ╚kO'    CL$╡LI$(YC):█ 9970:▌ ╢kP'  Ч ╩kQ'Ч тkV'▀ T$╡"▒" ╞ YC╠0 ╖ Ч ЩkW'  ME╡YC╚1:CL$╡LI$(YC):█ 9970:YC╡YC╚1 lX'  ▀ YC╚CTЁ0 ╖ █ 5330:▌:у Ч :lY'    CL$╡LI$(YC):█ 9970:▌ ClZ'  Ч Jl['Ч el`'▀ T$╡"X" ╟ T$╡"C" ╖ Ч + ┤lj'  ▀ MS╠ME ╖ IV╡MS:MS╡ME:ME╡IV ÷lt'  │ IV╡ME ╓ MS ╘ ╚1 ╪l~'    CB$(IV╚MS) ╡ LI$(IV) гl▓'  ┌ IV шl⌠'  ▀ T$╡"X" ╖ Ч Ыl■'    │ A╡MS ╓ NL╚(ME╚MS╙1) m∙'      LI$(A)╡LI$(A╙(ME╚MS╙1)) 'm√'    ┌ A em≈'    NL╡NL╚(ME╚MS╙1):│ A╡NL╙1 ╓ NL╙(ME╚MS╙1):LI$(A)╡"":┌ +!A ▄m≤'    YC╡MS:▀ YC╚CTЁ0 ╖ LY╡MS:█ 6600 ∙m '  Ч ╨m°'  IV╡0:MF╡0:CS╡ME╚MS╙1:MS╡0:ME╡0 аm╕'Ч лm╚'█ 5150 рm╟'▌ Фmь'▐ *** PASTE *** ЩmБ'│ IV╡CS╚1 ╓ 0 ╘ ╚1 nЛ'  ▐ INSERT A LINE AT YC ,nЖ'  MF╡YC:▐ TEMP >n (  CH╡1:█ 5650 On
(  YC╡MF:MF╡0 en(  LI$(YC)╡CB$(+"IV) nn(┌ IV yn((█ 5150 n2(▌ ╬n)▐ --- SET FN KEYS AND MAKE SURE F11 DOESN'T GENERATE PASTE фn)Ы ▒ Фn)FK$╡"┘┴├┼┤▀┬▄°"╙г(132) 	o")│ R╡1 ╓ 15:Ы R, й(FK$,R,1):┌ R o,)▌ do6)▀ н	(1)╡25 ╖ ≥ "-- PRESS ANY KEY FOR NEXT PAGE▓";:║ЫT$:≥"⌠";:█5490:у ≥ "+#"; █o@)≥"ALT + P▓ POST TO PC (M65POSTBOX)" ╠oJ)≥"ESC, J▓ GO TO START OF LINE" сoT)≥"ESC, K▓ GO TO END OF LINE" Вo^)≥"ESC, D▓ DELETE CURRENT LINE" ph)≥"CTRL + W▓ MOVE TO NEXT WORD" Cpr)≥"CTRL + U▓ MOVE TO PREVIOUS WORD" vp|)≥"SHIFT + INST/DEL▓ D+$ELETE CURRENT CHARACTER" ╛p├)≥"CTRL + =▓ TOGGLE COMPILATION DEBUGGING ON/OFF" яp░)≥"ESC, M▓ TURN 'MARK-MODE' ON" q )≥"  - WHEN 'MARK-MODE' IS ON, USE CURSOR UP/DOWN TO SELECT LINES" 5q╓)≥"  - PRESS 'X▓' TO CUT" Tq╝)≥"  - PRESS 'C▓' TO COPY" ▄q╦)≥" +% - тHEN USE ESC,P▓ TO PASTE CLIPBOARD CONTENTS" ▓qб)▌ ╡qл)▐ --- JUMP TO PREVIOUS FILE бqж)▀ CH╡1 ╖ Ч уqЮ)  █ 5490:Ч9 HL rЙ)  ≥ "CURRENT FILE NOT SAVED - PRESS ANY KEY";:║ Ы T$ %rТ)  █ 5490:█ 5540:▌ ,rЧ)Ч Er*TM╡PV:NF$╡PV$:█ 6390 Vr*LY╡TM:█ 6600 \r+&*▌ ┘rЬ*▐ --- NAVIGATE TO LABEL UNDER CURSOR ╙r+█ 11100: ▐ GET TERM UNDER CURSOR пr+NZ%╡1: ▐ NAV TO LABEL FLAG = TRUE Жr+█ 7430: ▐ GOSUB FIND LABEL SCREEN Эr +▌ %s\+▐ --- GET TERM UNDER CURSOR INTO FZ$ Ksf+█ 11200: ▐ START OF LABEL INTO SZ osp+█ 11300:+' ▐ END OF LABEL INTO EZ █sz+FZ$ ╡ й(CL$,SZ╙1,EZ╚SZ╙1) ⌠s└+▌ ╦sю+▐ --- GET START OF LABEL INTO SZ шsе+K ╡ XC ╚ 1 : ZZ$╡" :" : SZ ╡ 0 Йsй+К Щ K ╠╡ 0 tт+  ▀ т(ZZ$,й(CL$,K╙1,1)) ╖ SZ ╡ K ╙ 1 : М 'tч+  K ╡ K ╚ 1 -tХ+Л 3tР+▌ Vt$,▐ --- GET END OF LABEL INTO EZ ┐ |t.,K ╡ XC : ZZ$╡" :" : EZ ╡ ц(CL$)╚1 ▄t8,К Щ K Ё╡ EZ ╧tB,  ▀ т(ZZ$,й(CL$,K╙1,1)) ╖ EZ ╡ K ╚ 1 : М иtL,  K ╡ K ╙ 1 оtV,Л уt`,▌                                                                                                                               , ~L~L~Lb~L~~Li─HзZ ~zЗh b~`╘P█∙│╜1п)─п╘(█∙│╘2█√│╜1п)п╘█√│ B~`╘ █╖│█▒│█▓│╘┘╘Ь┘╜cп)┘╜bп┘`█┼│▌▄│▄▌│ B~ ╗─░` Л─ {│ m─`xH╘ █╠│█Ё│█╣│█╥│h█╟│и═░╘Ъ█╠│▌╡│┼╘Ъ█Ё│▄╢│≤и═░╘Ъ█╣│°╤│k╘Ъ█╥│ ~╜╢│8М╟│█╦│╜╣│М╠│█╧│╜╦│IЪi█╦│╜╧│IЪi █╧│╘█╪│╘ █╫│8╜╟│М╢│,█д│╜╠│М╣│█е│0╘Ъ█╪│█╫│╜╤│8М╡│█╨│╜╥│МЁ│█╩│0╜╨│IЪi█╨│╜╩│IЪi █╩│╘█╬│╘ █©│8╜╡│М╤│█д│╜Ё│М╥│█е│0╘Ъ█╬│█©│╜╦│m╨│█ю│╜╧│m╩│█а│╜╟│█┼│╜╠│█▀│╜╡│█▄│╜Ё│██│ k~╜┼│м╢│п╜▀│м╣│п╜▄│м╤│п
╜█│м╥│пX`╜ю│*█б│╜а│*█ц│8╜б│М╨│█д│╜ц│М╩│█е│0 ╜┼│м╢│п
╜▀│м╣│пX`╜ю│m╨│█ю│╜а│m╩│█,а│╜┼│m╪│█┼│╜▀│m╫│█▀│8╜б│М╦│█д│╜ц│М╧│█е│0д│ПL▌╜▄│м╤│п
╜█│м╥│пX`╜ю│m╦│█ю│╜а│m╧│█а│╜▄│m╬│█▄│╜█│m©│██│L▌X`█▌│`╜▒│п╜▓│П╒L█─╒L█─╜▓│П╒L█─╒┼╖│╙╫≈│ZШЙ▓╜▌│Й▓╕╓╚▒│`╜┼│и═░8`╜▄│8`╜∙│иPП	╜┼│иP░8`╜┼│и═░8`╜√│и2П	╜▄│и2░8`╜▄│иd░8``╜┼│j█▐│░╘Ъ,,ж400  PRINT CHR$(27);"5";  ' WPOKE сцрнптрлсб, $0800  ' POKE сцрнптрбнк, $04  RETURN'-------------.DRAW╞BACKDROP'-------------    FRAMEIDX = фрм╞бацкдроп    FX=-999 : FY = -999    MIRROR = 0    GOSUB DRAW╞PETSCII╞FRAME    RETURN'-----,-------.ANIMATE╞LOGO'------------  IF BAS╞STATE = 0 THEN BEGIN    ORIG╞FRMY(0) = 6    ORIG╞FRMY(1) = 23    ORIG╞FRMY(2) = 6    FRMY(0) = -44    FRMY(1) = -69    FRMY(2) = -107    BAS╞STATE = 1    INC╞DIR(0) = 1    INC(0) = 1    INC╞DIR(1), = 1    INC(1) = 1    INC╞DIR(2) = 1    INC(2) = 1    INC╞DIR(3) = 1    INC(3) = 1  BEND  IF BAS╞STATE = 1 THEN BEGIN    FINISH╞CNT = 0    FOR K = 0 TO 2      IF FRMY(K) < ORIG╞FRMY(K) THEN BEGIN        FRMY(K) = FRMY(K) + 2        IF FRM4Y(K) > ORIG╞FRMY(K) THEN FRMY(K) = ORIG╞FRMY(K)      BEND      IF FRMY(K) = ORIG╞FRMY(K) THEN FINISH╞CNT = FINISH╞CNT OR 2^K    NEXT K  BEND  GOSUB DRAW╞BAS  GOSUB PAGE╞FLIP  FOR FRAMEIDX = 0 TO 2    IF FINISH╞CNT AND 2^FRAMEIDX AND BCNT(FRAME о█▒│╜▄│j█░│░╘Ъ█▓│`╝`п╛aп├└╒ ═ ├└`ё ═ ╒ ╜░│BB█pв╜∙│BB█tвBB╜xв╗e┘┼e┘≤e┘┼e┘`╛▐│╚▐│Й╡м▌│П╒ ▌╖│`╒ ╫≈│ЙрПХЮпСЮП▌╖│`╘ █╖│ │ │ P│`          P2 ~|Б{aЪЛlАШbЭЧ═                               ╜┼│и═░8`╜√│и2П	╜▄│и2░8`╜▄│иd░8``╜┼│j█▐│░╘Ъ,	 FOUND = 1    ACTANIM = -1  BEND  'CURSOR 0,8:PRINT "FOUND = ";FOUND;  IF FOUND = 0 THEN BEGIN ' WE'RE DRAWING A PETSCII FRAME NOW?    FRAMEIDX = AVAL    'CURSOR 0,5:PRINT "DRAW FRAMEIDX=";FRAMEIDX;    'INPUT AVAL    GOSUB DRAW╞PETSCII╞FRAME,
    FRAMEDUR = ANIMS(ACTANIM,ANIMIDX)    ANIMIDX = ANIMIDX + 1    FRAME╞START = TI  BEND  RETURN.CLEAR╞TEXT'-----------  EDMA 3,80,32,$800  RETURN.DRAW╞TXT╞GREY'-------------  IF ACTTIMER = -1 THEN RETURN  SLEEP .05  CURSOR ACTX + ACT,TIMER, ACTY  PRINT "≤";MID$(ACTSTR$,1+ACTTIMER,1);  ACTTIMER = ACTTIMER + 1  IF ACTTIMER >= LEN(ACTSTR$) THEN ACTTIMER = -1  RETURN.DRAW╞TXT╞TALK'-------------  IF ACTTIMER = -1 THEN RETURN  SLEEP .05  ACTX=(80-LEN(ACTSTR$))/2+7  ACTY=1  CU,RSOR ACTX + ACTTIMER, ACTY  PRINT "";MID$(ACTSTR$,1+ACTTIMER,1);  ACTTIMER = ACTTIMER + 1  IF ACTTIMER >= LEN(ACTSTR$) THEN ACTTIMER = -1  IF MOD(ACTTIMER,2) = 0 THEN FRAMEIDX=фрм╞опен╞моутх:ELSE FRAMEIDX=фрм╞цлосе╞моутх  GOSUB DRAW╞PETSCII╞FRAME,  RETURN.CLEAR╞TXT╞TALK'--------------  CURSOR 0,1:PRINT CHR$(27);"Q";  RETURN.DRAW╞PETSCII╞FRAME'------------------  DATA╞ADDR = FRAME╞ADDR(FRAMEIDX)  FRMX = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMY = PEEK(DATA╞ADDR)  DATA╞ADDR = ,DATA╞ADDR + 1  FRMW = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMH = PEEK(DATA╞ADDR)  DATA╞ADDR = DATA╞ADDR + 1  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  #DECLARE YY, SCRADDR,CLRADDR  SCRADDR = $800 + FRMX + FRMY * 80  CLRADDR = $1F800 + FRMX, + FRMY * 80  CDATA╞ADDR = DATA╞ADDR + FRMW * FRMH  FOR YY=FRMY TO FRMY1    EDMA 0, FRMW, DATA╞ADDR, SCRADDR    EDMA 0, FRMW, CDATA╞ADDR, CLRADDR    DATA╞ADDR = DATA╞ADDR + FRMW    CDATA╞ADDR = CDATA╞ADDR + FRMW    SCRADDR = SCRADDR + 80    CLRAD,DR = CLRADDR + 80    NEXT YY  RETURN.INIT╞REACTION'-------------  PRINT "⌠";  FRAMEIDX = фрм╞станд:GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞лифт╞папер1:GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞лифт╞папер2:GOSUB DRAW╞PETSCII╞FRAME  RETURN.DRA,W╞REACTION'-------------  ACTTIMER = ACTTIMER + 1  SLEEP .1  IF MOD(ACTTIMER,2) = 0 THEN FRAMEIDX=фрм╞схоцк╞фаце:ELSE FRAMEIDX=фрм╞хоррор╞фаце  GOSUB DRAW╞PETSCII╞FRAME  IF ACTTIMER > 10 THEN ACTION = тьтталк:ACTTIMER = 0  RETURN.DRAW╞PAINTING,'-------------  PRINT "⌠";  FRAMEIDX = фрм╞папер  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞паинтинг1 + ACTPAINTING - 1  GOSUB DRAW╞PETSCII╞FRAME  RETURN#DECLARE RVAL, AIDX, VIDX#DECLARE TEST$.INIT╞ANIMS'----------  AIDX = 0  VIDX = 0  DO,    READ RVAL    ' PRINT RVAL;", ";    IF RVAL = алл╞анимс╞финисхед THEN EXIT    ANIMS(AIDX,VIDX) = RVAL    VIDX = VIDX + 1    IF RVAL = енд╞аним THEN AIDX=AIDX+1:VIDX=0  LOOP  RETURN.ANIMS'-----  ' анм╞пондер  DATA фрм╞станд,   .3, _      , фрм╞арм╞уп1, .3, _       фрм╞арм╞уп2, .3, _       фрм╞арм╞уп3, .3    ' RAISE ARM TO CHIN  DATA марк1  DATA фрм╞арм╞уп4, .5, _       фрм╞арм╞уп3, .5, _       фрм╞арм╞уп4, .5, _       фрм╞арм╞уп3, .5    ' SCRATCH CHIN  DATA фрм╞цлосе╞еыес, 0 , _ ,      фрм╞арм╞уп4,     .5, _       фрм╞арм╞уп3,     .5, _       фрм╞арм╞уп4,     .5, _       фрм╞арм╞уп3,     .5    ' CLOSE EYES & SCRATCH CHIN  DATA фрм╞цлосе╞моутх, .2    ' NORMAL FACE  DATA репеат, марк1, инфинителы  DATA енд╞аним  ' анм╞паинт,  DATA фрм╞опен╞моутх, 0 , _       фрм╞арм╞лефт1, 1     ' GAPING MOUTH AND FINGER POINT UP  DATA фрм╞цлосе╞моутх,.2, _       фрм╞арм╞лефт2,  .2, _       фрм╞арм╞лефт3,  .2, _       фрм╞арм╞лефт4,  .2, _       фрм╞арм╞ригхт1, .2, _       фрм╞арм╞р,игхт2, .2 ' GET BRUSH  DATA марк1  DATA фрм╞цлосе╞моутх, .1  DATA марк2  DATA фрм╞арм╞ригхт3, .1, _       фрм╞арм╞ригхт4, .1  DATA репеат, марк2,   5  DATA фрм╞цлосе╞еыес,  .5  DATA марк3  DATA фрм╞арм╞ригхт3, .1, _       фрм╞арм╞ригхт4, .1  D,ATA репеат, марк3,   5  DATA репеат, марк1, инфинителы  DATA енд╞аним  ' анм╞лифт  DATA фрм╞арм╞ригхт2, .25, _       фрм╞арм╞ригхт1, .25, _       фрм╞ретурн╞паинтбрусх, .5, _       фрм╞арм╞ригхт5, .25, _       фрм╞арм╞ригхт6, .25, _       фрм╞л,ифт╞папер1, .25, _       фрм╞лифт╞папер2, .25  DATA марк1  DATA фрм╞цринге╞фаце, .1, _       фрм╞цросс╞фаце, .1, _       репеат, марк1, 5  DATA енд╞аним  ' анм╞рип  DATA фрм╞норм╞фаце, .2, _       фрм╞рип1, .1, _       фрм╞рип2, .1, _       ф,рм╞рип3, .1, _       фрм╞рип4, .1, _       фрм╞рип5, .1, _       фрм╞рип6, .1, _       фрм╞рип7, .1, _       фрм╞рип8, .1, _       фрм╞рип9, .1, _       фрм╞рип10, .1, _       фрм╞рип11, .1  DATA енд╞аним  DATA алл╞анимс╞финисхед.STORY╞DA,TA'----------                  '      TIMEDELTA  ACTION       TEXT                            X   Y  DUR(SEC)  ' сONNY: ATTEMPT #1  DATA 0,        аним,        анм╞пондер  DATA 2,        тьтгреы,     "HERE'S SONNY...",              4,  0  DATA 1.5,,      тьтгреы,     "A STRUGGLING ARTIST...",       22, 0  DATA 1.7,      тьтгреы,     "SEARCHING FOR INSPIRATION...", 47, 0  DATA 2,        тьтцлеар  DATA .5,       тьтталк,     "HMM... WHAT TO DRAW TODAY...",        3  DATA 2,        аним,        ан,м╞паинт  DATA 1.5,      тьтталк,     "I KNOW!",                             2  DATA 1,        тьтцлеар  DATA 3,        аним,        анм╞лифт  DATA 4,        паинтинг,    1  DATA 2,        реацтион,    "BLECH!",                       1,     2  DATA ,2,        аним,        анм╞рип  DATA 1.5,      цлс  DATA .,        тьтгреы,     "TRY AGAIN SONNY...",           34, 12  DATA 2,      цлс  ' сONNY: ATTEMPT #2  DATA .,        аним,        анм╞пондер  DATA 2,        аним,        анм╞паинт  DATA 1.5,,      тьтталк,     "AHA!",                             2  DATA 1,        тьтцлеар  DATA 3,        аним,        анм╞лифт  DATA 4,        паинтинг,    2  DATA 2,        реацтион,    "YUCK!",                       1,     2  DATA 2,        аним,       ,  анм╞рип  DATA 1.5,      цлс  DATA .,        тьтгреы,     "DON'T GIVE UP SONNY!",           32, 12  DATA 2,        цлс  ' сONNY: ATTEMPT #3  DATA .,        аним,        анм╞пондер  DATA 2,        аним,        анм╞паинт  DATA 1.5,      тьтталк,   ,!  "I GOT IT!",                             2  DATA 1,        тьтцлеар  DATA 3,        аним,        анм╞лифт  DATA 4,        паинтинг,    3  DATA 2,        реацтион,    "EWW!",                       1,     2  DATA 2,        аним,        анм╞рип  DAT,"A 1.5,      дравфрм,     фрм╞сад╞фаце  DATA .,        тьтгреы,     "AWW... POOR SONNY...",           32, 0  DATA 2,        тьтцлеар  DATA .1,       тьтталк,     "GUYS LIKE ME SHOULDN'T DREAM ANYWAY...", 3.5  DATA 3.5,      дравфрм,     фрм╞сад╞фаце ,# DATA 1,        цлс  DATA .5,       тьтгреы,     "...AND WITH THAT, SONNY'S DREAMS BLEW AWAY WITH THE WIND...", 10, 12  DATA 3.5,      цлс  DATA 1,       ендер'=====.ENDER'=====  GOSUB SWITCH╞TO╞80X25╞MODE  GOSUB RESTORE╞SCREEN╞POINTER  PALET,$TE RESTORE  RETURN'============.XANADU╞TITLE'============  PRINT CHR$(147);  BACKGROUND 0  BORDER 0  ' FILL SCREEN WITH BLACK INVERTED SPACES  EDMA 3,4000,0,$FF80000  EDMA 3,4000,160,$48000      GOSUB LOAD╞PALETTE  GOSUB SWITCH╞TO╞80X50╞MO,%DE  GOSUB SET╞SCREEN╞POINTER  GOSUB PAN╞TITLE  RETURN.SWITCH╞TO╞80X50╞MODE'--------------------  BANK 128  SETBIT хотрег╞7, 7  POKE $D031, $E8 ' х640, фаст, аттр, ж400  RETURN.SWITCH╞TO╞80X25╞MODE'--------------------  BANK 128  POKE $D031,&, $E0 ' х640, фаст, аттр  RETURN.RESTORE╞SCREEN╞POINTER'----------------------  ' TO BANK 0 - $0800  BANK 128  WPOKE сцрнптрлсб, $0800  POKE сцрнптрбнк, 0  RETURN.SET╞SCREEN╞POINTER'------------------  ' MOVE TO BANK4 - $8000  BANK 128  SE,'TBIT хотрег╞7, 7  WPOKE сцрнптрлсб, $8000  POKE сцрнптрбнк, $04  RETURN.PAN╞TITLE'---------  FOR PAN╞IDX = 0 TO 196    IF PAN╞IDX > 79 THEN BEGIN      PAN╞SRC╞IDX = PAN╞IDX - 79      PAN╞DEST╞IDX = 0      IF PAN╞IDX > 117 THEN BEGIN        PA- N╞LEN = 80 - (PAN╞IDX - 117)        IF PAN╞LEN < 1 THEN PAN╞LEN = 0      BEND:ELSE BEGIN        PAN╞LEN = 80      BEND    BEND:ELSE BEGIN      PAN╞SRC╞IDX = 0      PAN╞DEST╞IDX = 79 - PAN╞IDX      PAN╞LEN=PAN╞IDX + 1    BEND    FOR PAN╞Y = 0 T-O 49      EDMA 0,PAN╞LEN,$41000+PAN╞Y*118+PAN╞SRC╞IDX,$FF80000+PAN╞Y*80+PAN╞DEST╞IDX    NEXT PAN╞Y    SLEEP .02    GOSUB POLL╞PLAY  NEXT PAN╞IDX  RETURN.LOAD╞PALETTE'------------  #DECLARE LOC=$40FA0  FOR K = 0 TO 31    POKE $D100+K,PEEK(LOC-):LOC=LOC+1    POKE $D200+K,PEEK(LOC):LOC=LOC+1    POKE $D300+K,PEEK(LOC):LOC=LOC+1  NEXT K  RETURN'========.BAS╞LOGO'========  GOSUB POLL╞PLAY  GOSUB FADE╞TO╞WHITE  GOSUB DRAW╞LOGO  GOSUB FADE╞TO╞DEFAULTS  GOSUB CYCLE╞ALT╞PALETTE╞LOOP  GOS-UB FADE╞TO╞BLACK  RETURN.CYCLE╞ALT╞PALETTE╞LOOP'----------------------  FOR M = 0 TO 32*4    GOSUB CYCLE╞ALT╞PALETTE    GOSUB POLL╞PLAY    GOSUB ANIM╞DRAW╞SUBTEXT    SLEEP .04  NEXT M  RETURN.ANIM╞DRAW╞SUBTEXT'-----------------  IF M = 40- THEN BEGIN    SUBTEXT╞IDX = 1    PLEN = 0    EDMA 3,80,32,$800+80*24  BEND  IF PLEN < LEN(SUBTEXT$(SUBTEXT╞IDX)) THEN BEGIN    PLEN = PLEN + 1    RAINBOWSTR$=LEFT$(SUBTEXT$(SUBTEXT╞IDX),PLEN)    IF SUBTEXT╞IDX = 0 THEN RAINBOW╞X = 36:ELSE RAINB-OW╞X = 21    RAINBOW╞Y = 24    GOSUB PRINT╞RAINBOW╞STR  BEND  RETURN.PRINT╞RAINBOW╞STR  #DECLARE RAIN╞IDX  CURSOR RAINBOW╞X, RAINBOW╞Y  FOR RAIN╞IDX=1 TO LEN(RAINBOWSTR$)    FOREGROUND MOD(RAIN╞IDX-1,16)+16    PRINT MID$(RAINBOWSTR$,RAIN╞IDX,-1);  NEXT RAIN╞IDX  RETURN.CYCLE╞ALT╞PALETTE'-----------------  #DECLARE TEMPR, TEMPG, TEMPB  TEMPR = PEEK($D100+16)  TEMPG = PEEK($D200+16)  TEMPB = PEEK($D300+16)  FOR K = 16 TO 30    POKE $D100+K, PEEK($D100+K+1)    POKE $D200+K, PEEK($D20-0+K+1)    POKE $D300+K, PEEK($D300+K+1)  NEXT K  POKE $D100+31, TEMPR  POKE $D200+31, TEMPG  POKE $D300+31, TEMPB  RETURN.DRAW╞LOGO'---------  BACKGROUND 1  BORDER 1  EDMA 0, 2000, $40000, $800  EDMA 0, 2000, $407D0, $FF80000  RETURN.FAD-E╞TO╞WHITE'-------------  FOR FADEVAL=0 TO 16    GOSUB FADE╞COLOURS╞TO╞WHITE    SLEEP .05  NEXT FADEVAL  RETURN.FADE╞TO╞BLACK'-------------  GOSUB STORE╞CURR╞COLOURS  FOR FADEVAL=0 TO 16    GOSUB FADE╞COLOURS╞TO╞BLACK    SLEEP .05  NEXT FAD-	EVAL  RETURN.FADE╞TO╞DEFAULTS'----------------  GOSUB STORE╞CURR╞COLOURS  FOR FADEVAL=0 TO 16    GOSUB FADE╞COLOURS╞TO╞DEFAULTS    SLEEP .05  NEXT FADEVAL  RETURN'====.INIT'====  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $F-
D  ^^BLOAD "INTRO.DAT",P($40000),R  ' $4,0000 +------------------+ интро.дат  '         ! бас LOGO CHARS   !  ' $4,07д0 +..................+  '         ! бас LOGO COLORS  !  ' $4,0фа0 +..................+  '         ! 32 X ргб палетте !  ' $4,1-000 +..................+  '         ! титле COLORS     !  ' $4,270ц +..................+  '         ! петсции FRAMES   !  ' $4,54фц +------------------+  GOSUB INIT╞MUSIC  GOSUB STORE╞DEFAULT╞COLOURS  RETURN.STORE╞DEFAULT╞COLOURS'----------------------  FOR K = 0 TO 31    DEFAULT╞RED(K)=PEEK($D100+K)    DEFAULT╞GREEN(K)=PEEK($D200+K)    DEFAULT╞BLUE(K)=PEEK($D300+K)  NEXT K  RETURN.STORE╞CURR╞COLOURS'------------------  FOR K = 0 TO 31    CURR╞RED(K)=PEEK($D100+K)    CURR╞GREEN(K)-=PEEK($D200+K)    CURR╞BLUE(K)=PEEK($D300+K)  NEXT K  RETURN.FADE╞COLOURS╞TO╞WHITE'---------------------  'инпут: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = 0 TO 31    POKE $D100+K, DEFAULT╞RED(K) + (15 - DEFAULT╞RED(K)) * TEMPVAL    POK-E $D200+K, DEFAULT╞GREEN(K) + (15 - DEFAULT╞GREEN(K)) * TEMPVAL    POKE $D300+K, DEFAULT╞BLUE(K) + (15 - DEFAULT╞BLUE(K)) * TEMPVAL  NEXT K  RETURN.FADE╞COLOURS╞TO╞DEFAULTS'------------------------  'инпут: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16-  FOR K = 0 TO 31    POKE $D100+K, CURR╞RED(K) + (DEFAULT╞RED(K)-CURR╞RED(K)) * TEMPVAL    POKE $D200+K, CURR╞GREEN(K) + (DEFAULT╞GREEN(K)-CURR╞GREEN(K)) * TEMPVAL    POKE $D300+K, CURR╞BLUE(K) + (DEFAULT╞BLUE(K)-CURR╞BLUE(K)) * TEMPVAL  NEXT K  RE-TURN.FADE╞COLOURS╞TO╞BLACK'---------------------  TEMPVAL = (16-FADEVAL) / 16  FOR K = 0 TO 31    POKE $D100+K, CURR╞RED(K) * TEMPVAL    POKE $D200+K, CURR╞GREEN(K) * TEMPVAL    POKE $D300+K, CURR╞BLUE(K) * TEMPVAL  NEXT K  RETURN'==========-.INIT╞MUSIC'==========  PLAY  BAR╞INDEX=0  MAP╞BAR╞TO╞CHUNK(0)=0  MAP╞BAR╞TO╞CHUNK(1)=1  MAP╞BAR╞TO╞CHUNK(2)=1  MAP╞BAR╞TO╞CHUNK(3)=2  MAP╞BAR╞TO╞CHUNK(4)=3  FILTER 1,100,1  FILTER 2,100,1  ENVELOPE 2,3,3,3,10,0  ENVELOPE 4,9,4,9,8  ENVELOPE- 7,0,9,9,0,2,1100  ENVELOPE 8,0,12,3,5,2,1100  ENVELOPE 9,0,10,3,5,2,1100  ' *** VOICE1 - GUITAR1 ***  ' ------------------------  V1$(0)="T2O6M2 QDIR QC.R QDIR QC.R QDIR QC.R QDIR QC.R"  V1$(1)="T2O6M2 QDIR QC.R QDIR QC.R P9A IR QAIR P0IDP9O5A O54IAO6DA Q.G IDO5A IBO6DG Q.A IGD O5BO6EG Q.A IGE O5IBO6DG Q.A IGD  O5BO6EGQA IG#FE "  V1$(2)="T2O6M2 QDIR QC.R QDIR QC.R  IDDFQ.DIFD O5Q.#AHO6CIR O5#AQ#AO6HCIR IDDFHDIR  DDFQ.DIFD O5Q.#AHO6CIR O5#AQ#AO6HCIR O5Q.A O6HE IR  V1$(3)="T2O6M2 IGG#GHGIR O5Q.G -  
 ▐ POST-COMPILE 4  ≥"⌠COMPILING SUCCESSFUL." J  Ч 4:AD╡я("FF30") t  К Щ б(AD)Ё╠0:F$╡F$╙г(б(AD)):AD╡AD╙1:Л ╣ ( ▀ F$╡"" ╟ ц(F$)╠16 ╖ ≥ "??FATAL ERROR DETERMINING OUTFILE":░ к - Р("11TEMP"):Р(F$) Х 2 У ("11TOKENIZED") ╓ (F$) 	!< ≥"RUN"╙г(34) =╙F$:≥""; !A Ы ▒ !B Ч 128 1!D ≈ 208,1:≈ 688,13 7!F ╒                                                                                                                                                                                                     -  d DF$╡"11.DEFAULTS" S n SB$╡"ележен DEVELOPMENT ENVIRONMENT VERSION 0.1 ALPHA" ~ x █ 820: ▐ GET SETTINGS FROM MAILBOX RAM ┤ ┌ Ы Ч$ ⌠ ▄ ≥"⌠" ╢ √ DL$╡г(27)╙"Q": ▐ DELETE LINE э ═ BU$(0)╡"DISABLED":BU$(1)╡"ENABLED " Ч ╙ SM$(0)╡"80X25":SM$(1)╡"80X50"- +!╢ █ 1220: ▐ READ DEFAULTS, SET SCREEN MODE 1!╬ К I!х Ч9 FG: Ч; BG: Ч< BO j!р ≥"  ележен PREFERENCES  ▓" ÷!э ЧA 0,3:≥ "  ф1 ▓ WORKING FILE NAME : ";DL$;CF$; а!Ф ▀ CF$╡"" ╖ ≥ "<NOT DEFINED>"; П!П ≥:≥ "  ф2 ▓ AUTOMATIC BACKUP  : ";BU$(BU) Ш!З ЧA 0,5 -""≥ "  ф3 ▓ BORDER COLOUR     : "; D"Ч9 BO: ≥ "          ▓":Ч9 FG j"≥ "  ф4 ▓ BACKGROUND COLOUR : "; ▄""Ч9 BG: ≥ "          ▓":Ч9 FG ╡",≥ "  ф5 ▓ FOREGROUND COLOUR : "; т"6Ч9 FG: ≥ "          ▓":Ч9 FG З"@≥ "  ф6 ▓ HIGHLIGHT COLOUR  : ";- #JЧ9 HL: ≥ "          ▓":Ч9 FG B#T≥ "  ф7 ▓ STATUS BAR COLOUR : "; d#^Ч9 SB: ≥ "          ▓":Ч9 FG j#h≥ ≈#r≥ "  ф9 ▓ SCREEN MODE       : ";SM$(SM) ╘#|ЧA 0,16:Ч9 HL и#├≥"  с ▓  сAVE AS DEFAULTS" П#░≥"  л ▓  лOAD DEFAULTS FROM DISC" $ ≥" - р ▓  рESET DEFAULTS" A$╓≥" таб▓  еXIT PREFERENCES & LAUNCH EDITOR"; S$╝ЧA 0,24:Ч9 SB ■$╦▀ SB$╡"" ╖ SB$╡"ележен DEVELOPMENT ENVIRONMENT VERSION 0.5" ÷$б█ 1130 ╡$л║Ы T$ : SB$╡"" ь$ж▀ T$╡"├" ╖ BO╡BO╙1:▀ BO╠15 ╖ BO╡0 Ч$Ю▀ T$╡"┼" ╖ BG╡BG╙1:▀ BG╠1-5 ╖ BG╡0 $%Й▀ T$╡"┤" ╖ FG╡FG╙1:▀ FG╠15 ╖ FG╡0 J%Т▀ T$╡"▀" ╖ HL╡HL╙1:▀ HL╠15 ╖ HL╡0 p%Ч▀ T$╡"┬" ╖ SB╡SB╙1:▀ SB╠15 ╖ SB╡0 ┼%▀ T$╡"┴" ╖ BU╡╤(BU╚1) °%▀ T$╡"" ╖ Ч ╞%  SM ╡ ╤(SM╚1) н%&  █ 1220: ▐ SET SCREENMODE у%0Ч Н%:▀ T$╡"R" ╖ RS╡1:█820  &D▀- T$╡"S" ╖ Ч &&N  SB$╡"SAVING DEFAULTS...":█ 1130 4&X  Р (DF$) d&b  Ч (DF$),B(4),P(я("FF00")) ╓ P(я("FF80")) ≥&l  Ч 3,80,160,0,3968,0 : ▐  --- CLEAR STATUS BAR ы&v  ▀ DS╡0 ╖ SB$╡"DEFAULTS SAVED.": у SB$╡"DISC ERROR "╙DS$ Ф&─  █ 1130 М&┼Ч Ъ&■-▀ T$╡"L" ╖ Ч &'·  SB$╡"LOADING DEFAULTS...":█ 1130 G'╗  Ч (DF$),B(4),P(я("FF00")) S'╡  █ 820 ■'╪  ▀ DS╡0 ╖ SB$╡"DEFAULTS LOADED.": у SB$╡"DISC ERROR "╙DS$ ╗'ф  █ 1130:█ 1220 ╞'пЧ ╧'з█ 990 х'ДЛ Э T$╡"	" н'Н° 0(Ь ≥"⌠EDMA 0,$D400,$8000000-,$2001:NEW RESTORE":≥"RUN";:▐ LOAD '11.EDIT' FROM ATTIC CACHE <( Ч 128 p( ≈ 208,2     : ▐ NO OF CHARS IN KEYBOARD BUFFER ▄( ≈ 688,13,13 : ▐ RETURN ⌠(  ─ ≥(*░ ю(4▐ --- LOAD SETTINGS TO MAILBOX RAM А(>T$╡г(б($4FF00))╙г(б($4FF01)) Й(HRT╡0 )R-▀ T$Ё╠"SK"╟ RS╡1 ╖ Ч 9)\  BG╡0:FG╡5:BO╡6:HL╡2:SB╡14 : ▐ STANDARD COLOURS b)f  CF$╡"" : BU╡1 : RT╡1 : RS╡0 : SM╡0 i)pЧ ≈)z▀ RT╡1 ╖ ▌ : ▐ RETURN IF JUST INITIALIZED ╥)└TF$╡"":I╡$4FF10:К Щ б(I)Ё╠0 с)▌TF$╡TF$╙г(б(I)):I╡I╙1:Л Ч)≤BO╡б($4FF02):BG╡б($4- FF03):FG╡б($4FF04) *╒HL╡б($4FF05):SB╡б($4FF06) 9*╛BU ╡ ╤((б($4FF07)╞4)Ё╠0) V*╤SM ╡ ╤((б($4FF07)╞8)Ё╠0) i*юCF$╡TF$:Ч 128 o*й▌ u*т: ·*ч▐ --- SAVE SETTINGS FROM MAILBOX RAM ╖*ХЧ 4 ╫*Р▀ CF$╡"" ╖ ┴ 1040 Р*Э│ I╡1 ╓ ц(CF$):≈ я("FF10")╙I╚1,ф(й(CF$,I-!,1)):┌ I +≈ я("FF10")╙I╚1,0 2+≈ я("FF07"),0 : FL╡0 : ▐ DELETE FLAGS a+FL ╡ FL ╟ 1              : ▐ AUTOLOAD FLAG ▌+$▀ BU╡1 ╖ FL╡FL ╟ 4   : ▐ AUTOBACKUP FLAG ╤+.▀ SM╡1 ╖ FL╡FL ╟ 8   : ▐ 80X50 FLAG ф+8≈ $4FF07,FL Й+B≈ $4FF00,ф("S"):≈ $4FF01,ф("K-"") ,L≈ $4FF02,BO : ≈ $4FF03,BG : ≈ $4FF04,FG 4,V≈ $4FF05,HL : ≈ $4FF06,SB @,`Ч128:▌ U,j▐ --- STATUS BAR ░,t▀ н	(1)╡25 ╖ CB╡2048╙(24╛80)   : FB╡$FF80800 ╙ (24╛80) к,~▀ н	(1)╡50 ╖ CB╡$40800╙(49╛80) : FB╡$FF80800 ╙ (49╛80) З,┬Ч! 3,80,160,CB   : ▐   д--- CLEAR STATUS BAR )-▓Ч! 3,80,SB,FB    : ▐  SET STATUS BAR COLOR :-°ЧA 0,н	(1)╚1 M-╕Ч9 SB : ≥ SB$; S-╟▌ \-╨┘ T$ u-д▐ --- SET SCREENMODE  -н▀ SM ╖ ≥ г(27)╙"5":у ≥ г(27)╙"8" ═-ьХ ╕-Б▌                                                              -$' вAY OF THE иMPLODING фOOT' -------------------------' а COLLABORATIVE TEAM-EFFORT GAME MADE BY THE мега65 COMMUNITY'' гURCE:' -----' - иNITIAL BACKGROUND ART' - еLEVEN CODE INFRASTRUCTURE' - иNITIAL гAME MECHANICS' дEFT:' ----' - аRTISTIC PL-%AYER HEAD PERMUTATIONS#OUTPUT "FOOT"' банк4 мEMORY USAGE' ------------------' 4.0000 дма-лист' 4.0100 сунсет палеттес (EACH PALETTE IS 16*3 IN SIZE, HAVE 12 PALETTES)' 4.0800 сцреен меморы' 4.2000 петсции грапхицс' банк5 мEMORY USAGE' --------&-----------' 5.0000 SCREEN BUFFER' 5.1000 COLOR RAM BUFFER' 5.2000 DOUBLED-UP LAYER BUFFER' UNCOMMENT THIS LINE TO ADD DEBUG OUTPUT#DECLARE дебуг = 0.PETSCII VARS'------------#DEFINE форм╞лаыер   = 0#DEFINE форм╞хуман   = 1#DEFINE форм╞дуцк  -'  = 2#DEFINE форм╞маь     = 3#DEFINE дат╞лаыер   = 0#DEFINE дат╞плаыер1 = 1#DEFINE дат╞плаыер2 = 2#DEFINE дат╞плаыер3 = 3#DEFINE дат╞плаыер4 = 4#DEFINE дат╞дуцк    = 5#DEFINE дат╞маь     = 6#DECLARE DATA╞ADDR = $42000#DECLARE MAX╞FRAMES(форм╞. маь)#DECLARE FRAME╞ADDR(дат╞маь, 25)#DECLARE FRAME╞DBLUP╞ADDR(64)#DECLARE JDIR╞RAW, JFIRE, JDIR#DECLARE FRM╞IDX = 0#DECLARE FRMW, FRMH,FRMX,FRMY,FRMX1,FRMY1,FRAMEIDX,CDATA╞ADDR#DECLARE YY, SCRADDR,CLRADDR#DECLARE A$, LIDX, K, X, Y#DECLARE SRC╞A.DDR, DEST╞ADDR, LENGTH, TRANSP#DECLARE DEST╞MB╞SEL, DEST╞BANK#DECLARE FORM, SZ#DEFINE плаыер = 0#DEFINE баддие = 1#DECLARE CHARACTER#DECLARE OPPONENT╞DATA╞ADDR#DECLARE DBLUP╞ADDR = $52000#DECLARE KNEEL╞FLAG#DECLARE BADDIE╞KNEEL╞FLAG#DECLAR.E MIRROR, PLAYER╞MIRROR, BADDIE╞MIRROR, OPPONENT╞MIRROR, TMP╞MIRROR#DECLARE PX, PY ' PLAYER X,Y#DECLARE BX, BY ' BADDIE X,Y#DECLARE PLAYER╞ENERGY = 18#DECLARE LAG╞PENERGY = 0#DECLARE BADDIE╞ENERGY = 18#DECLARE LAG╞BENERGY = 0#DECLARE X1,Y1,X2,Y.2, DRAW╞COLOR, IDX, TMPX1#DECLARE P╞X1, P╞Y1, P╞X2, P╞Y2#DECLARE O╞X1, O╞Y1, O╞X2, O╞Y2#DECLARE RET%#DECLARE DAT╞IDX, PLAYER╞DAT╞IDX, BADDIE╞DAT╞IDX#DECLARE PLAYER╞DAT╞FIXED, BADDIE╞DAT╞FIXED#DECLARE TMP#DEFINE цхар╞боь╞тл = 112#DEFINE цхар╞боь╞.тр = 110#DEFINE цхар╞боь╞бл = 109#DEFINE цхар╞боь╞бр = 125#DEFINE цхар╞хорз   = 64#DEFINE цхар╞жерт   = 93#DEFINE цхар╞спаце  = 32.JOYSTICK╞DEFS'-------------#DEFINE й╞уп = 1#DEFINE й╞уп╞ригхт = 2#DEFINE й╞ригхт = 3#DEFINE й╞довн╞ригхт = 4#.DEFINE й╞довн = 5#DEFINE й╞довн╞лефт = 6#DEFINE й╞лефт = 7#DEFINE й╞уп╞лефт = 8#DEFINE й╞фире = 128#DEFINE йд╞уп = 1#DEFINE йд╞уп╞форвард = 2#DEFINE йд╞форвард = 3#DEFINE йд╞довн╞форвард = 4#DEFINE йд╞довн = 5#DEFINE йд╞довн╞бацквард = 6#DEFI.NE йд╞бацквард = 7#DEFINE йд╞уп╞бацквард = 8#DECLARE JD(1,8) ' DIRECTIONAL JOYSTICK (PLAYER DIRECTION NEUTRAL)JD(0, й╞уп) = йд╞упJD(0, й╞уп╞ригхт) = йд╞уп╞форвардJD(0, й╞ригхт) = йд╞форвардJD(0, й╞довн╞ригхт) = йд╞довн╞форвардJD(0, й╞довн) = йд╞д.овнJD(0, й╞довн╞лефт) = йд╞довн╞бацквардJD(0, й╞лефт) = йд╞бацквардJD(0, й╞уп╞лефт) = йд╞уп╞бацквардJD(1, й╞уп) = йд╞упJD(1, й╞уп╞ригхт) = йд╞уп╞бацквардJD(1, й╞ригхт) = йд╞форвардJD(1, й╞довн╞ригхт) = йд╞довн╞бацквардJD(1, й╞довн) = йд╞довнJD(.1, й╞довн╞лефт) = йд╞довн╞форвардJD(1, й╞лефт) = йд╞форвардJD(1, й╞уп╞лефт) = йд╞уп╞форвард.IMGS'----#DEFINE имг╞цлоудс = 0#DEFINE имг╞скы = 1#DEFINE имг╞лт╞моунт = 2#DEFINE имг╞дк╞моунт = 3#DEFINE имг╞ватер = 4#DEFINE имг╞хи╞гроунд = 5#DEFI.	NE имг╞ло╞гроунд = 6#DEFINE имг╞сун = 7#DEFINE имг╞пвалк1 = 0#DEFINE имг╞пвалк2 = 1#DEFINE имг╞пвалк3 = 2#DEFINE имг╞ппунцх1 = 3#DEFINE имг╞ппунцх2 = 4#DEFINE имг╞ппунцх3 = 5#DEFINE имг╞пкицк1 = 6#DEFINE имг╞пкицк2 = 7#DEFINE имг╞пкицк3 = 8#D.
EFINE имг╞пкнеел1 = 9#DEFINE имг╞пкнеел2 = 10#DEFINE имг╞пкнеел3 = 11#DEFINE имг╞пкпунцх1 = 12#DEFINE имг╞пкпунцх2 = 13#DEFINE имг╞пкпунцх3 = 14#DEFINE имг╞пккицк1 = 15#DEFINE имг╞пккицк2 = 16#DEFINE имг╞пккицк3 = 17#DEFINE имг╞пдие1 = 18#DEFIN.E имг╞пдие2 = 19#DEFINE имг╞пдие3 = 20#DEFINE имг╞пдие4 = 21#DEFINE имг╞пдие5 = 22#DEFINE имг╞двалк1 = 0#DEFINE имг╞двалк2 = 1#DEFINE имг╞двалк3 = 2#DEFINE имг╞дяуацк1 = 3#DEFINE имг╞дяуацк2 = 4#DEFINE имг╞дяуацк3 = 5#DEFINE имг╞ддие1 = 6#DEF.INE имг╞ддие2 = 7#DEFINE имг╞ддие3 = 8#DEFINE имг╞ддие4 = 9#DEFINE имг╞ддие5 = 10#DEFINE хигхест╞лаыер = 7#DECLARE FX, FY#DECLARE XOFFS(хигхест╞лаыер) ' OFFSET INTO CYCLING OF GRAPHIC#DECLARE DRAW╞ORDER(хигхест╞лаыер)DRAW╞ORDER(0) = имг╞скы.DRAW╞ORDER(1) = имг╞сунDRAW╞ORDER(2) = имг╞цлоудсDRAW╞ORDER(3) = имг╞лт╞моунтDRAW╞ORDER(4) = имг╞дк╞моунтDRAW╞ORDER(5) = имг╞ватерDRAW╞ORDER(6) = имг╞хи╞гроундDRAW╞ORDER(7) = имг╞ло╞гроунд#DECLARE OFFS╞AMOUNT(хигхест╞лаыер)OFFS╞AMOUNT(0) = .7OF.FS╞AMOUNT(1) = 0OFFS╞AMOUNT(2) = .1OFFS╞AMOUNT(3) = .5OFFS╞AMOUNT(4) = 1OFFS╞AMOUNT(5) = 1.5OFFS╞AMOUNT(6) = 2#DECLARE PALIDX, PTR.ANIMS'-----#DEFINE аним╞пвалк = 0#DEFINE аним╞ппунцх = 1#DEFINE аним╞пкицк = 2#DEFINE аним╞пкнеел╞дн = 3#DEF0INE аним╞пкнеел╞уп = 4#DEFINE аним╞пкпунцх = 5#DEFINE аним╞пккицк = 6#DEFINE аним╞пдие = 7#DEFINE аним╞пйумп = 8#DEFINE аним╞двалк = 0#DEFINE аним╞дяуацк = 1#DEFINE аним╞ддие = 2#DEFINE аним╞маь = 10#DECLARE ANIM╞ORDER(форм╞маь, аним╞маь, 10).' жарт' ====' аN OPEN-SOURCE TOOL FOR DRAWING 640X400 VECTOR ART ON THE MEGA65#OUTPUT "VART"' #DEFINE дебуг╞сорт=1' MENU SYSTEM' +------+--------+-----+------+----------+---------+------+------+------+-----+' ! LINE ! CIRCLE ! BOX ! POLY ! (X) .FILL ! PALETTE ! LOAD ! SAVE ! UNDO ! REDO!' +------+--------+-----+------+----------+---------+------+------+------+-----+' X = EXIT' ? = SHOW/HIDE MENU' CTRL+1-8 = SELECT FROM 1ST 8 COLOURS' MEGA+1-8 = SELECT FROM 2ND 8 COLOURS' CTRL+D = CHOOSE F.ROM DEFAULT PALETTE' CTRL+A = CHOOSE FROM ALTERNATE PALETTE.DECLARES'--------#DECLARE KEY$#DECLARE K,M0%, M1%, A$#DECLARE X%, Y%, W%, H%, X2%, Y2%#DECLARE MX%, MY%, MB%, MB╞OLD%#DECLARE MENU╞SELECTION = -1#DECLARE RET%#DECLARE LAST╞COLOUR% = -.1#DECLARE SELECTED╞COLOUR% = 1#DECLARE OLD╞MENU╞SELECTION% = -1#DECLARE YMIN%, YMAX%, IDX%, PIDX%, PX%(20)#DECLARE REV%, Y0%, Y1%, X0%, X1%, TMP%, M, C, I%, J%, SWAPPED%#DECLARE LOAD╞STATE% = -4#DECLARE FILL╞STATE% = 0#DECLARE LINE╞STATE%, LX0%,. LY0%#DECLARE CIRCLE╞STATE%, CX0%, CY0%, RADIUS%#DECLARE ELLIPSE╞STATE%, EX0%, EY0%, XRADIUS%, YRADIUS%#DECLARE BOX╞STATE%, BX0%, BY0%#DECLARE POLY╞STATE%, POLY╞IDX%=0, POLY╞X%(250), POLY╞Y%(250)#DECLARE VEC╞DATA%(12000)VEC╞DATA%(0) = ASC("V")  ' .хеадер фор "жецтор" датаVEC╞DATA%(1) = ASC("E")VEC╞DATA%(2) = ASC("C")#DECLARE VEC╞SIZE% = 3#DECLARE STOR%(1000), STOR╞CNT%#STRUCT буттон X%, Y%, W%, H%, TYPE%, STATE%, TEXT$#DEFINE тыпе╞нормал = 0#DEFINE тыпе╞тоггле = 1#DEFINE лине    = 0#D.EFINE цирцле  = 1#DEFINE еллипсе = 2#DEFINE боь     = 3#DEFINE полы    = 4#DEFINE филл    = 5#DEFINE саже    = 6#DEFINE лоад    = 7#DEFINE еьит    = 8#DEFINE маь╞бтн = 9буттон BTNS(маь╞бтн) = [     _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "LINE", ],  .  _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "CIRCLE", ],  _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "ELLIPSE", ], _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "BOX", ],     _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "POLY", ],    _  [ 0, 0, 0, 0, тыпе╞тоггле, 0, "FILL", ],    _  [ 0, 0, .0, 0, тыпе╞нормал, 0, "SAVE", ],    _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "LOAD", ],    _  [ 0, 0, 0, 0, тыпе╞нормал, 0, "EXIT", ]     _] #DEFINE цолоур = 63.INIT╞BTNS'---------BTNS╞W%(0) = LEN(BTNS╞TEXT$(0))+2BTNS╞H%(0) = 3FOR K = 1 TO маь╞бтн-1 . BTNS╞X%(K) = BTNS╞X%(K-1) + BTNS╞W%(K-1)  BTNS╞W%(K) = LEN(BTNS╞TEXT$(K)) + 2  BTNS╞H%(K) = 3NEXT K.MAIN'----  GOSUB INIT     GOSUB DRAW╞MENU╞SYSTEM  GOSUB CHECK╞INPUT  GOSUB ENDER  END.INIT'----  SCREEN 0,640,400,4  FOR K = 0 TO 62    .READ X%    POKE $0600+K, X%  NEXT K  MOUSE ON, 1, 0  SPRITE 0,1,1  RETURN#DEFINE цхр╞хеигхт = 2#DEFINE цхр╞видтх = 1#DEFINE цхр╞дир╞уп = 1#DEFINE цхр╞дир╞ригхт = 2#DEFINE цхр╞дир╞довн = 4#DEFINE цхр╞дир╞лефт = 8.CLEAR╞MENU'----------  FO.R K=0 TO 7    EDMA 3, 640*2, 0, $40000+K*$4000  NEXT K  RETURN.DRAW╞MENU╞SYSTEM'----------------  GOSUB CLEAR╞MENU  PEN 0,1  ' DRAW ITEMS  FOR K = 0 TO маь╞бтн-1    X%=BTNS╞X%(K)    Y%=BTNS╞Y%(K)    W%=(X% + BTNS╞W%(K))    H%=(Y% + BTNS╞H%.(K))    PEN 0, 1    IF MENU╞SELECTION=K AND BTNS╞TYPE%(K) <> тыпе╞тоггле THEN BEGIN      BOX X%*8, Y%*8, W%*8, H%*8, 1      PEN 0, 0    BEND:ELSE BEGIN      BOX X%*8, Y%*8, W%*8, H%*8      IF BTNS╞TYPE%(K) = тыпе╞тоггле AND BTNS╞STATE%(K)<>0 THEN/ BEGIN        PEN 0,3        BOX X%*8, Y%*8, W%*8, H%*8, 1        PEN 0,0      BEND    BEND    CHAR X%+1, Y%*8+4, цхр╞хеигхт, цхр╞видтх, цхр╞дир╞ригхт, BTNS╞TEXT$(K)    PEN 0, 1  NEXT K  PEN 0,SELECTED╞COLOUR% : SPRITE 0,1,SELECTED╞COLOUR%  RE. 19 W .R                  .R           .R           O3T4.G H.RWM1T5 O1.A            .A           .A           .AP0HM3T9 O2A O4C O3B     O2A O4C O3B  O2A O4C O3B  HR WO4T4.GP0QM3T9 RH O3A O3A O4C   O3A O3A O4C  O3G O3G R   WO4T4.BWM1T5 O1.A          .  .A           .A           .AW.R                   .R           .R           IR WO2T4.AW .R                .R             .R           O3T4.G H.RWM1T5 O1.A          .A             .A           .AHM3T9 O2A O3B O3A   O2A O3B O3A    O2A O4C O3B  HR WO4. T4.GQM3T9 RH O3F O2A O3F  O3F O2A O3F   O3G O2A R   WO4T4.BWM1T5 O1.A          .A             .A           .AW.R                 .R             .R           IR WO2T4.AW .R                 .R           .R             .WRWM1T5 O1.A           .A       .!    .A             RHM3T9 O2A O3B O3A    O2A O3B O3A  O2A O4C O3B O4C QR HO4C O3AQM3T9 RH O3F O2A O3F  O3F O2A O3F  O3G O2A O3G O4D QR SO3BO4CIO3BWM1T5 O1.A           .A           .A             RW       .R          .R                .R           .R."WM1T5 O1.A          .R                .A           .RHM3T9 O4E O3A O2A O4C O3A IO4CO3B QR  HO4E O3A O2A O4C O3A IO4CO3B QRQM3T9 RH O2A O4D O3A O2A O3B O3A       O2A O4D O3A O2A O3B O3AWM1T5 O1.A          .R                .A           .RW     .R   .#           .R                  .R             .RWM1T5 O1.G            .R                  .GHM3T9  O4C O3G O3D    O4C O3D  O3B        O4C O3G O3D    O4G E CQM3T9 RH O3D O3B O3G   O4D SO4CDICQR O3A RH O3D O3B O3G  O4F SDEIDQR HO3BWM1T5 O1.G           .$ .R                  .GT2M8O6P0 H.E .D .C O5QB O6ICO5B QA P5 O6H.E P0 .D .C O5QB O6ICO5B QAT1M1O2 W.F  .F   .F   .FHM2P3T7 O4E O3A O2A O4C O3A IO4CO3B QR HO4E O3A O2A O4C O3A IO4CO3B QRQM2P3T7 RH O2A O4D O3A O2A O3B O3A      O2A O4D O3A O2A O3B O3A.%T1M1O2 W.D  .D   .D   .DT2M6O6P0 H.E .D .C O5QB O6ICO5B QA P5 O6H.E P0 .D .C O5QB O6ICO5B P0 QAT2M8O6 P5H.CP0 O5.B O6QC HD SCDICQ O5BA  P5O6H.CP0 O5.B P8O6QGP0FE SDEIDQCO5BT1M1O2 W.G .G .G .GHM3T7 O4C O3G O3D     O4C O3D O3B          O4C O3G O3D  O4G.& E CQM3T7 RH O3D O3B O3G   O4D SO4CDICQR O3A RH O3D O3B O3G O4F SDEIDQR HO3BT1M1O2 W.D .D .D .DT2M6O6 P5H.CP0 O5.B O6QC HD SCDICQ O5BA P5O6H.CP0 O5.B P8O6QGP0FE SDEIDQCO5BT2M8O5 H.B QA W.A QBO6C        WO5.B B QAGT1M1O1 H.A QA W.A QAA          T0QO2.'GIGGQGGGG GIGGQGGGGM3T7 O3H.B QA W.A QBO4C        WO3.B B QAGM1T7 O3H.F QE W.E O4P5QBO5C    WO4.B B QAGT1M1O2 H.F QE W.E QEE          T0QO2DIDDQDDDD DIDDQDDDDT2M6O5 H.B QA W.A QBO6C        WO5.B B QAGT2M8O5 W.AA QBO6CT0QO2FIFFQFFFF FIFFQFFFFM3T7 O/ 3W.AA QBO4CM1T7 O4W.AA QBO5CT0QO2CICCQCCCC CICCQCCCCT2M6O5 W.AA QBO6CT2M8O5 WA QBO6C O5WB QAG WA QBO6CT0QO2AIAAQAAAA GIGGQGGGG FIFFQFFFFM3T7 O3WA QBO4C O3WB QAG WA QBO4CM1T7 O4WA QBO5C O4WB QAG WA QBO5CT0QO2EIEEQEEEE DIDDQDDDD CICCQCCCCT2M6O5 WA/ QBO6C O5WB QAG WA QBO6CT2M8O5 WAQR G WB QR A W#G QRIFGSFGFGFG QE SDW.E QR W.RT0M1QO2DIDDQDDDD T1W.E .E .E .EM3T7 O3 WAQR  G WB QR A W#G QRIFGSFGFGFG QE SDW.EM1T7 O4 WAQR  G WB QR A W#G QRIFGSFGFGFG QE SDW.ET0QO1AIAAQAAAA T1W.E .E .E .ET2M6O5 WAQR /G WB QR A W#G QRIFGSFGFGFG QE SDW.EWRRRRRRP0M3T8 HO2A O4C O2F O4C R O3A  QR HO3A B A B O4C QRP0M3T8 QR HO3A B   A B O4C QR  HO2A O4C O2F O4C R O3AP0T3O4IGGGG QGG HC R WR          IGGGG QGG HC R WRO1M1T6 QA IAA QAA O1M0WFR       O1M1T6 QA IAA QAA /O1M0HFRP0M3T8 HO2A O4C O2F O4C R O3A  QR HO3A B A B O4C QRP0M3T8 QR HO3A B  A B O4C QR  HO2A O4C O2F O4C R O3AO1M1T6 QA IAA QAA O1M0WFR       O1M1T6 QA IAA QAA O1M0HFRP0T3O4IGGGG QGG HC R WR         IGGGG QGG HC R WRO1M0T1 QM0WE.F HR   WE.F HRO2M1T/8 QM0WE.F HR   WE.F HRP0M3T8 HO2A O4C O2F O4C R O3A QR HO3A B A B O4C QRP0M3T8 QR HO3A B  A B O4C QR  HO2A O4C O2F O4C R O3AO1M2T8 QM0WE.F HR    WE.F HRO2M0T1 QM0WE.F HR   WE.F HRO1M0T1 QM0WA.F HR  WA.F HRO2M1T8 QM0WA.F HR  WA.F HRP0M3T8 HO2A O4C /O2F O4C R O3A QR HO3A B A B O4C QRP0M3T8 QR HO3A B  A B O4C QR  HO2A O4C O2F O4C R O3AO1M2T8 QM0WA.F HR WA.F HRO2M0T1 QM0WA.F HR WA.F HRO2M0T1 HR M0W.E .E .E .E W.RO1M1T1 M0W.E .E .E .EP0M3T8 O3 T1W.#G .#G .#G .#GP0M3T8 O3 T1H.R W.E .E .E .EO1M1T/1 M0W.E .E .E .EO2M0T1 HR M0W.E .E .E .EM1T9 O5 W.A .R .FM1T1 O5 W.A .R .FM3T2 O3WA QBO4C O3W3WB QAG WA QBO4CM1T2 O4WA QBO5C O4W3WB QAG WA QBO5CM1T1 O5 W.R .GM1T9 O5 W.R .GM1T1O5W.A .G .FT1M1O2W.A .G .FM3T2 O3WA QBO4C O3W3WB QAG WA QBO4CM1T2 O/4WA QBO5C O4W3WB QAG WA QBO5CT1M1O1W.A .G .FM1T1 O5W.A .G .FM1T1O5 W.D .E .E .E .ET1M1O2 W.D .E .E .E .EM3T2 O3 WAQR  G WB QR A W#G QRIFGSFGFGFG QE SDW.EM1T2 O4 WAQR  G WB QR A W#G QRIFGSFGFGFG QE SDW.ET1M1O1 W.D .E .E .E .EM1T1O5 W.D .E .E .E .E/ 18 пIANO 0  9  0  0  2  1536 аCCORDION 12  0  12  0  1  0 цALLIOPE 0  0  15  0  0  0 дRUM 0  5  5  0  3  0 фLUTE 9  4  4  0  0  0 гUITAR 0  9  2  1  1  0 хARPSICRD 0  9  0  0  2  512 оRGAN 0  9  9  /	0  2  2048 тRUMPET 8  9  4  1  2  512 ьYLOPHONE 0  9  0  0  0  0 LOWP╞UP 1000  1  0  0  15  1  100  10 LOWP╞DOWN 1000  1  0  0  15  2  100  10 LOWP╞OSC 1000  1  0  0  15  3  100  10 BANDP╞UP 1000  0  1  0 /
 15  1  100  10 BANDP╞DOWN 1000  0  1  0  15  2  100  10 BANDP╞OSC 1000  0  1  0  15  3  100  10 HIGHP╞UP 1000  0  0  1  15  1  100  10 HIGHP╞DOWN 1000  0  0  1  15  2  100  10 HIGHP╞OSC 1000  0  0  1  15  3 / 100  10 SPARE╞1 0  0  0  0  0  0  0  0 SPARE╞2 0  0  0  0  0  0  0  0  38 -1  18 -9  5  0  2  1  0  2  0  3  0  4  0 -9  15  5  0  6  0  5  0  7  0  8  0  9  4  10  0 -1  24 -9  5  11  2 -9  8  ╘ 12  2 -9  15  13  2  14  2  13  2  15  0 -1  18 -9  5  16  0 -9  15  17  0 -9  13  17  0 -9  11  17  0 -9  9  17  0 -9  7  18  0                                                                                       /TURN.STORE╞COLOUR'------------  IF LAST╞COLOUR% <> SELECTED╞COLOUR% THEN BEGIN    VEC╞DATA%(VEC╞SIZE%) = цолоур : VEC╞SIZE% = VEC╞SIZE% + 1    VEC╞DATA%(VEC╞SIZE%) = SELECTED╞COLOUR% : VEC╞SIZE% = VEC╞SIZE% + 1    LAST╞COLOUR% = SELECTED╞COLOUR% / BEND  RETURN.STORE'-----  FOR K = 0 TO STOR╞CNT%    VEC╞DATA%(VEC╞SIZE%) = STOR%(K)    VEC╞SIZE% = VEC╞SIZE% + 1  NEXT K  RETURN.STORE╞LINE'----------  STOR%(0) = лине + 64 * BTNS╞STATE%(филл)  STOR%(1) = LX0% AND 255 : STOR%(2) = LX0% >> /8  STOR%(3) = LY0% AND 255 : STOR%(4) = LY0% >> 8  STOR%(5) = MX% AND 255 : STOR%(6) = MX% >> 8  STOR%(7) = MY% AND 255 : STOR%(8) = MY% >> 8  STOR╞CNT% = 8 : GOSUB STORE  RETURN.ON╞CLICK╞LINE'-------------  IF LINE╞STATE% = 0 THEN BEGIN    GOS/UB STORE╞COLOUR    LX0%=MX%    LY0%=MY%    DOT MX%,MY%    LINE╞STATE%=1  BEND:ELSE IF LINE╞STATE% = 1 THEN BEGIN    LINE LX0%, LY0%, MX%, MY%    GOSUB STORE╞LINE    LINE╞STATE% = 0  BEND  RETURN.STORE╞CIRCLE'------------  STOR%(0) = цир/цле + 64 * BTNS╞STATE%(филл)  STOR%(1) = CX0% AND 255 : STOR%(2) = CX0% >> 8  STOR%(3) = CY0% AND 255 : STOR%(4) = CY0% >> 8  STOR%(5) = RADIUS% AND 255 : STOR%(6) = RADIUS% >> 8  STOR╞CNT% = 6 : GOSUB STORE  RETURN.ON╞CLICK╞CIRCLE'--------------/-  IF CIRCLE╞STATE% = 0 THEN BEGIN    GOSUB STORE╞COLOUR    CX0%=MX%    CY0%=MY%    CIRCLE╞STATE%=1  BEND:ELSE IF CIRCLE╞STATE% = 1 THEN BEGIN    RADIUS% = SQR( (MX%-CX0%)^2 + (MY%-CY0%)^2 )    CIRCLE CX0%, CY0%, RADIUS%, BTNS╞STATE%(филл)   / GOSUB STORE╞CIRCLE    CIRCLE╞STATE% = 0  BEND  RETURN.STORE╞ELLIPSE'-------------  STOR%(0) = еллипсе + 64 * BTNS╞STATE%(филл)  STOR%(1) = EX0% AND 255 : STOR%(2) = EX0% >> 8  STOR%(3) = EY0% AND 255 : STOR%(4) = EY0% >> 8  STOR%(5) = XRADIUS/% AND 255 : STOR%(6) = XRADIUS% >> 8  STOR%(7) = YRADIUS% AND 255 : STOR%(8) = YRADIUS% >> 8  STOR╞CNT% = 8 : GOSUB STORE  RETURN.ON╞CLICK╞ELLIPSE'----------------  IF ELLIPSE╞STATE% = 0 THEN BEGIN    GOSUB STORE╞COLOUR    EX0%=MX%    EY0%=MY%/    ELLIPSE╞STATE%=1    BEND:ELSE IF ELLIPSE╞STATE% = 1 THEN BEGIN    XRADIUS% = ABS(MX%-EX0%)    YRADIUS% = ABS(MY%-EY0%)    ELLIPSE EX0%, EY0%, XRADIUS%, YRADIUS%, BTNS╞STATE%(филл)    GOSUB STORE╞ELLIPSE    ELLIPSE╞STATE% = 0  BEND  RETUR/N.STORE╞BOX'---------    STOR%(0) = боь + 64 * BTNS╞STATE%(филл)    STOR%(1) = BX0% AND 255 : STOR%(2) = BX0% >> 8    STOR%(3) = BY0% AND 255 : STOR%(4) = BY0% >> 8    STOR%(5) = MX% AND 255 : STOR%(6) = MX% >> 8    STOR%(7) = MY% AND 255 : STOR%/(8) = MY% >> 8    STOR╞CNT% = 8 : GOSUB STORE    RETURN.ON╞CLICK╞BOX'------------  IF BOX╞STATE% = 0 THEN BEGIN    GOSUB STORE╞COLOUR    BX0%=MX%    BY0%=MY%        BOX╞STATE%=1  BEND: ELSE IF BOX╞STATE% = 1 THEN BEGIN    BOX BX0%, BY0%, M/X%, MY%, BTNS╞STATE%(филл)    GOSUB STORE╞BOX    BOX╞STATE% = 0  BEND  RETURN.FIND╞YMIN╞YMAX'--------------  YMIN% = POLY╞Y%(0)  YMAX% = POLY╞Y%(0)  FOR IDX% = 0 TO POLY╞IDX%-1    IF POLY╞Y%(IDX%) < YMIN% THEN YMIN% = POLY╞Y%(IDX%)    IF PO/LY╞Y%(IDX%) > YMAX% THEN YMAX% = POLY╞Y%(IDX%)  NEXT IDX%  RETURN .IS╞Y╞IN╞LINE╞YRANGE'-------------------  RET% = 0: REV% = 0  Y0% = POLY╞Y%(IDX%-1)  Y1% = POLY╞Y%(IDX%)  IF Y0% > Y1% THEN TMP%=Y0%:Y0% = Y1%:Y1% = TMP%:REV%=1  IF Y0% <= Y% AND/ Y% < Y1% THEN RET% = 1  RETURN.CHECK╞LINE╞INTERSECT'--------------------  GOSUB IS╞Y╞IN╞LINE╞YRANGE  IF RET% = 0 THEN RETURN  X0% = POLY╞X%(IDX%-1)  X1% = POLY╞X%(IDX%)  IF REV%=1 THEN TMP%=X0%:X0% = X1%:X1% = TMP%  IF X0% = X1% THEN X% =X0%/:RET% = 1:RETURN  M = (Y1%-Y0%) / (X1% - X0%)  C = Y0% - M * X0%    X% = (Y% - C) / M  RET% = 1  RETURN  .FIND╞INTERSECTS'---------------  PIDX% = 0  ' CHECK LAST-POINT TO FIRST  POLY╞X%(POLY╞IDX%) = POLY╞X%(0)  POLY╞Y%(POLY╞IDX%) = POLY╞Y/%(0)  FOR IDX% = 1 TO POLY╞IDX%    GOSUB CHECK╞LINE╞INTERSECT    IF RET% = 1 THEN PX%(PIDX%)=X% : PIDX% = PIDX% + 1  NEXT IDX%  RETURN.SORT╞INTERSECTS'---------------  ' BUBBLE SORT ALGORITHM FROM: GEEKSFORGEEKS.ORG/BUBBLE-SORT  #IFDEF дебуг/╞сорт  GOSUB CLEAR╞MENU  CHAR 0,0,1,1,2,STR$(PIDX%-1)  FOR I%=0 TO PIDX%-1    CHAR 4+I%*4,0,1,1,2,STR$(PX%(I%))  NEXT I%#ENDIF  FOR I% = 0 TO PIDX%-2    SWAPPED% = 0    FOR J% = 0 TO PIDX%-I%-2      IF PX%(J%) > PX%(J%+1) THEN BEGIN        T/MP%=PX%(J%)        PX%(J%) = PX%(J%+1)        PX%(J%+1) = TMP%        SWAPPED% = 1      BEND    NEXT J%    IF SWAPPED% = 0 THEN I% = PIDX%  ' EXIT EARLY  NEXT I%#IFDEF дебуг╞сорт  FOR I%=0 TO PIDX%-1    CHAR 4+I%*4,10,1,1,2,STR$(PX%(I%))  NE/XT I%  GETKEY A$#ENDIF  RETURN.DRAW╞HORIZONTAL╞INTERSECTS'--------------------------  GOSUB FIND╞INTERSECTS  GOSUB SORT╞INTERSECTS  FOR IDX%=0 TO PIDX%-1 STEP 2    LINE PX%(IDX%),Y%,PX%(IDX%+1),Y%  NEXT IDX%  RETURN.FILL╞POLY'--------- /  GOSUB FIND╞YMIN╞YMAX  FOR Y%=YMIN% TO YMAX%    GOSUB DRAW╞HORIZONTAL╞INTERSECTS  NEXT Y%  RETURN.STORE╞POLY'----------  STOR%(0) = полы + 64 * BTNS╞STATE%(филл)  STOR%(1) = POLY╞IDX%  STOR╞CNT% = 1  FOR K = 0 TO POLY╞IDX%-1    MX% = POLY╞X%(/!K)    MY% = POLY╞Y%(K)    STOR╞CNT%=STOR╞CNT%+1 : STOR%(STOR╞CNT%) = MX% AND 255    STOR╞CNT%=STOR╞CNT%+1 : STOR%(STOR╞CNT%) = MX% >> 8    STOR╞CNT%=STOR╞CNT%+1 : STOR%(STOR╞CNT%) = MY% AND 255    STOR╞CNT%=STOR╞CNT%+1 : STOR%(STOR╞CNT%) = MY% >> 8/"  NEXT K  GOSUB STORE  RETURN.ON╞CLICK╞POLY'-------------  IF POLY╞STATE% = 0 THEN BEGIN    GOSUB STORE╞COLOUR    POLY╞STATE% = 1    POLY╞IDX% = 0  BEND    IF POLY╞IDX% > 0 THEN BEGIN    IF POLY╞X%(POLY╞IDX%-1)=MX% AND POLY╞Y%(POLY╞IDX%-/#1)=MY% THEN BEGIN      LINE MX%,MY%,POLY╞X%(0),POLY╞Y%(0)      GOSUB STORE╞POLY      POLY╞STATE% = 0      IF BTNS╞STATE%(филл) = 1 THEN GOSUB FILL╞POLY      RETURN    BEND  BEND  POLY╞X%(POLY╞IDX%) = MX%  POLY╞Y%(POLY╞IDX%) = MY%  IF POLY╞I/$DX% = 0 THEN BEGIN    DOT MX%, MY%  BEND:ELSE BEGIN    LINE POLY╞X%(POLY╞IDX%-1), POLY╞Y%(POLY╞IDX%-1), MX%, MY%  BEND  POLY╞IDX% = POLY╞IDX% + 1  RETURN.ON╞CLICK╞FILL'-------------  IF BTNS╞STATE%(филл) = 0 THEN BTNS╞STATE%(филл)=1:ELSE BTNS╞/%STATE%(филл)=0  RETURN.ON╞CLICK╞SAVE'-------------  BORDER 3  ' FOR NOW, JUST SAVE TO A SINGLE HARD-CODED FILE  ^^DOPEN #2,"@TEST.V",W,U8  FOR K = 0 TO VEC╞SIZE%-1    PRINT #2, CHR$(VEC╞DATA%(K));  NEXT K  DCLOSE #2  RETURN.LOAD╞ERROR'----/&------  BORDER 2  LOAD╞STATE% = -4  RETURN.CHECK╞VEC╞HEADER'----------------  RET% = 0  IF K<>ASC("V") THEN RETURN  GET#2, K:PRINT K;  IF K<>ASC("E") THEN RETURN  GET#2, K:PRINT K;  IF K<>ASC("C") THEN RETURN  RET% = 1  VEC╞SIZE% = 3  LOAD/'╞STATE%=-1  RETURN.ON╞CLICK╞LOAD'-------------  ' FOR NOW, JUST LOAD FROM A SINGLE HARD-CODED FILE  LOAD╞STATE% = -4  ^^DOPEN #2,"TEST.V",R,U8  DO    GET#2, K:PRINT "RD=";K;    IF ST THEN EXIT    IF LOAD╞STATE% = -4 THEN BEGIN      PRINT "C0 HECK╞VEC ";      GOSUB CHECK╞VEC╞HEADER      IF RET% = 0 THEN GOSUB LOAD╞ERROR:EXIT:ELSE GOTO NXT╞LP    BEND    IF LOAD╞STATE% = -1 THEN BEGIN      PRINT "NEW╞CMD ";      FILL╞STATE% = (K AND 64)/64      BTNS╞STATE%(филл) = FILL╞STATE%      K = 0K AND 63      LOAD╞STATE% = K    BEND    IF LOAD╞STATE% = цолоур THEN BEGIN      PRINT "COLOUR ";      GET#2,K:PRINT K;      PEN 0, K      VEC╞DATA%(VEC╞SIZE%) = цолоур      VEC╞SIZE% = VEC╞SIZE% +1      VEC╞DATA%(VEC╞SIZE%) = K      VEC╞SIZE0% = VEC╞SIZE% +1      LAST╞COLOUR% = K      SELECTED╞COLOUR% = K      LOAD╞STATE% = -1      GOTO NXT╞LP    BEND    IF LOAD╞STATE% = лине THEN BEGIN      PRINT "LINE ";      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% 0AND 255 : PRINT M1%;      LX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      LY0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M10% AND 255 : PRINT M1%;      MX% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      MY% = M0% + (M1% << 8)      LINE LX0%, LY0%, MX%, MY%      GOSUB STORE╞LINE      LOAD╞STATE% 0= -1      GOTO NXT╞LP    BEND    IF LOAD╞STATE% = цирцле THEN BEGIN      PRINT "CIRCLE ";      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      CX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND0 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      CY0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      RADIUS% = M0% + (M1% << 8)      CIRCLE CX0%, CY0%, 0RADIUS%, BTNS╞STATE%(филл)      GOSUB STORE╞CIRCLE      LOAD╞STATE% = -1      GOTO NXT╞LP    BEND    IF LOAD╞STATE% = еллипсе THEN BEGIN      PRINT "ELLIPSE ";      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 :0 PRINT M1%;      EX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      EY0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 2550	 : PRINT M1%;      XRADIUS% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      YRADIUS% = M0% + (M1% << 8)      ELLIPSE EX0%, EY0%, XRADIUS%, YRADIUS%, BTNS╞STATE%(филл)      GO0
SUB STORE╞ELLIPSE      LOAD╞STATE% = -1      GOTO NXT╞LP    BEND    IF LOAD╞STATE% = боь THEN BEGIN      PRINT "BOX ";      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      BX0% = M0% + (M1% << 8)0      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      BY0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      MX% = M0% + (M1% << 8)0      GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;      GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;      MY% = M0% + (M1% << 8)      BOX BX0%, BY0%, MX%, MY%, BTNS╞STATE%(филл)      GOSUB STORE╞BOX      LOAD╞STATE% = -1      GOTO NXT╞LP    BEND0    IF LOAD╞STATE% = полы THEN BEGIN      PRINT "POLY ";      GET#2,K:K = K AND 255      POLY╞IDX% = K      FOR K = 0 TO POLY╞IDX%-1        GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;        GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;        POLY╞X0%(K) = M0% + (M1% << 8)        GET#2,M0% : M0% = M0% AND 255 : PRINT M0%;        GET#2,M1% : M1% = M1% AND 255 : PRINT M1%;        POLY╞Y%(K) = M0% + (M1% << 8)        IF (K>0) THEN LINE POLY╞X%(K-1), POLY╞Y%(K-1), POLY╞X%(K), POLY╞Y%(K)      NEXT 0K      LINE POLY╞X%(POLY╞IDX%-1),POLY╞Y%(POLY╞IDX%-1),POLY╞X%(0),POLY╞Y%(0)      IF BTNS╞STATE%(филл) = 1 THEN GOSUB FILL╞POLY      GOSUB STORE╞POLY      LOAD╞STATE% = -1      GOTO NXT╞LP    BEND.NXT╞LP  LOOP  DCLOSE #2  RETURN.RESET╞ALL╞0ART╞STATES'--------------------  LOAD╞STATE% = -4  FILL╞STATE% = 0  LINE╞STATE% = 0  CIRCLE╞STATE% = 0  ELLIPSE╞STATE% = 0  BOX╞STATE% = 0  POLY╞STATE% = 0  RETURN.CHECK╞ACTION╞CLICK'------------------  IF MENU╞SELECTION = лине THEN GOSUB ON0╞CLICK╞LINE  IF MENU╞SELECTION = цирцле THEN GOSUB ON╞CLICK╞CIRCLE  IF MENU╞SELECTION = еллипсе THEN GOSUB ON╞CLICK╞ELLIPSE  IF MENU╞SELECTION = боь THEN GOSUB ON╞CLICK╞BOX  IF MENU╞SELECTION = полы THEN GOSUB ON╞CLICK╞POLY  RETURN.REPOSITION╞MOUS0E'----------------  MOVSPR 0, MX%, MY%  RETURN.CHECK╞KEYPRESS'---------------------  IF A$=CHR$(144) THEN SELECTED╞COLOUR% = 0  IF A$=CHR$(5)   THEN SELECTED╞COLOUR% = 1  IF A$=CHR$(28)  THEN SELECTED╞COLOUR% = 2  IF A$=CHR$(159) THEN SELECTED╞0COLOUR% = 3  IF A$=CHR$(156) THEN SELECTED╞COLOUR% = 4  IF A$=CHR$(30)  THEN SELECTED╞COLOUR% = 5  IF A$=CHR$(31)  THEN SELECTED╞COLOUR% = 6  IF A$=CHR$(158) THEN SELECTED╞COLOUR% = 7  IF A$=CHR$(129) THEN SELECTED╞COLOUR% = 8  IF A$=CHR$(149) THEN0 SELECTED╞COLOUR% = 9  IF A$=CHR$(150) THEN SELECTED╞COLOUR% = 10  IF A$=CHR$(151) THEN SELECTED╞COLOUR% = 11  IF A$=CHR$(152) THEN SELECTED╞COLOUR% = 12  IF A$=CHR$(153) THEN SELECTED╞COLOUR% = 13  IF A$=CHR$(154) THEN SELECTED╞COLOUR% = 14  IF A$0=CHR$(155) THEN SELECTED╞COLOUR% = 15  PEN 0,SELECTED╞COLOUR% : SPRITE 0,1,SELECTED╞COLOUR%  MX%=RSPPOS(0,0)  MY%=RSPPOS(0,1)  ' LEFT  IF A$=CHR$(157) THEN MX%=MX%-1:GOSUB REPOSITION╞MOUSE  ' RIGHT  IF A$=CHR$(29) THEN MX%=MX%+1:GOSUB REPOSITIO0N╞MOUSE  ' UP  IF A$=CHR$(145) THEN MY%=MY%-1:GOSUB REPOSITION╞MOUSE  ' DOWN  IF A$=CHR$(17) THEN MY%=MY%+1:GOSUB REPOSITION╞MOUSE  ' RETURN/ENTER  IF A$=CHR$(13) THEN GOSUB READ╞SCALED╞MOUSE : GOSUB CHECK╞ACTION╞CLICK  RETURN.READ╞SCALED╞MOUSE0'-----------------  RMOUSE MX%, MY%, MB%  MX%=(MX%-24)*2  MY%=(MY%-50)*2  RETURN.CHECK╞INPUT'-----------  GET A$  IF A$="X" THEN RETURN  GOSUB CHECK╞KEYPRESS  GOSUB READ╞SCALED╞MOUSE  IF MB%=128 AND MB╞OLD%=0 THEN BEGIN    MB╞OLD%=128  0  GOSUB CHECK╞BUTTON╞HIT        IF RET%=1 THEN BEGIN      GOSUB RESET╞ALL╞ART╞STATES      IF MENU╞SELECTION = еьит THEN SCREEN CLOSE:END    BEND:ELSE BEGIN      GOSUB CHECK╞ACTION╞CLICK    BEND  BEND  IF MB╞OLD%=128 AND MB%=0 THEN MB╞OLD% = 00  'DEBUG STUFF  'A$ = STR$(MX%) + ", " + STR$(MY%) + ", " + STR$(MB%)  'PEN 0, 0  'BOX 0, 64, 150, 80, 1  'PEN 0, 1  'CHAR 0, 64, цхр╞хеигхт, цхр╞видтх, цхр╞дир╞ригхт, A$  GOTO CHECK╞INPUT.CHECK╞BUTTON╞HIT'----------------  RET%=0  FOR K = 0 0TO маь╞бтн-1    X%=BTNS╞X%(K)*8    Y%=BTNS╞Y%(K)*8    W%=BTNS╞W%(K)*8    H%=BTNS╞H%(K)*8    X2%=X%+W%    Y2%=Y%+H%    IF X%<=MX% AND MX%<=X2% AND Y%<=MY% AND MY%<=Y2% THEN BEGIN      OLD╞MENU╞SELECTION% = MENU╞SELECTION      MENU╞SELECTION = K 0     IF MENU╞SELECTION = филл THEN BEGIN        GOSUB ON╞CLICK╞FILL        MENU╞SELECTION = OLD╞MENU╞SELECTION%      BEND: ELSE IF MENU╞SELECTION = саже THEN BEGIN        GOSUB ON╞CLICK╞SAVE      BEND: ELSE IF MENU╞SELECTION = лоад THEN BEGIN    0    GOSUB ON╞CLICK╞LOAD      BEND      RET%=1      GOSUB DRAW╞MENU╞SYSTEM      K=маь╞бтн-1    BEND  NEXT K  RETURN  .ENDER'-----  SCREEN CLOSE  MOUSE OFF  RETURN.DATA'MOUSE POINTERDATA %11111111, %00000000, %00000000DATA %11111110, %000000000, %00000000DATA %11111100, %00000000, %00000000DATA %11111000, %00000000, %00000000DATA %11111100, %00000000, %00000000DATA %11101110, %00000000, %00000000DATA %11000111, %00000000, %00000000DATA %10000011, %10000000, %00000000DATA %000000001, %11000000, %00000000DATA %00000000, %11100000, %00000000DATA %00000000, %01110000, %00000000DATA %00000000, %00111000, %00000000DATA %00000000, %00011100, %00000000DATA %00000000, %00001110, %00000000DATA %00000000, %00000111, %00000000DATA %00 ь000000, %00000011, %10000000DATA %00000000, %00000001, %00000000DATA %00000000, %00000000, %00000000DATA %00000000, %00000000, %00000000DATA %00000000, %00000000, %00000000DATA %00000000, %00000000, %00000000                                       0 ANIM╞ORDER(форм╞хуман, аним╞пвалк, 0) = имг╞пвалк1ANIM╞ORDER(форм╞хуман, аним╞пвалк, 1) = имг╞пвалк2ANIM╞ORDER(форм╞хуман, аним╞пвалк, 2) = имг╞пвалк3ANIM╞ORDER(форм╞хуман, аним╞пвалк, 3) = имг╞пвалк2ANIM╞ORDER(форм╞хуман, аним╞ппунцх, 0) = имг╞ппу0!нцх1ANIM╞ORDER(форм╞хуман, аним╞ппунцх, 1) = имг╞ппунцх2ANIM╞ORDER(форм╞хуман, аним╞ппунцх, 2) = имг╞ппунцх3ANIM╞ORDER(форм╞хуман, аним╞ппунцх, 3) = имг╞ппунцх2ANIM╞ORDER(форм╞хуман, аним╞ппунцх, 4) = имг╞ппунцх1ANIM╞ORDER(форм╞хуман, аним╞пкицк, 00") = имг╞пкицк1ANIM╞ORDER(форм╞хуман, аним╞пкицк, 1) = имг╞пкицк2ANIM╞ORDER(форм╞хуман, аним╞пкицк, 2) = имг╞пкицк3ANIM╞ORDER(форм╞хуман, аним╞пкицк, 3) = имг╞пкицк2ANIM╞ORDER(форм╞хуман, аним╞пкицк, 4) = имг╞пкицк1ANIM╞ORDER(форм╞хуман, аним╞пкнеел0#╞дн, 0) = имг╞пкнеел1ANIM╞ORDER(форм╞хуман, аним╞пкнеел╞дн, 1) = имг╞пкнеел2ANIM╞ORDER(форм╞хуман, аним╞пкнеел╞дн, 2) = имг╞пкнеел3ANIM╞ORDER(форм╞хуман, аним╞пкнеел╞уп, 0) = имг╞пкнеел2ANIM╞ORDER(форм╞хуман, аним╞пкнеел╞уп, 1) = имг╞пкнеел1ANIM╞O0$RDER(форм╞хуман, аним╞пкпунцх, 0) = имг╞пкпунцх1ANIM╞ORDER(форм╞хуман, аним╞пкпунцх, 1) = имг╞пкпунцх2ANIM╞ORDER(форм╞хуман, аним╞пкпунцх, 2) = имг╞пкпунцх3ANIM╞ORDER(форм╞хуман, аним╞пкпунцх, 3) = имг╞пкпунцх2ANIM╞ORDER(форм╞хуман, аним╞пкпунцх, 4) 0%= имг╞пкпунцх1ANIM╞ORDER(форм╞хуман, аним╞пккицк, 0) = имг╞пккицк1ANIM╞ORDER(форм╞хуман, аним╞пккицк, 1) = имг╞пккицк2ANIM╞ORDER(форм╞хуман, аним╞пккицк, 2) = имг╞пккицк3ANIM╞ORDER(форм╞хуман, аним╞пккицк, 3) = имг╞пккицк2ANIM╞ORDER(форм╞хуман, ани0&м╞пккицк, 4) = имг╞пккицк1ANIM╞ORDER(форм╞хуман, аним╞пдие, 0) = имг╞пдие1ANIM╞ORDER(форм╞хуман, аним╞пдие, 1) = имг╞пдие2ANIM╞ORDER(форм╞хуман, аним╞пдие, 2) = имг╞пдие3ANIM╞ORDER(форм╞хуман, аним╞пдие, 3) = имг╞пдие4ANIM╞ORDER(форм╞хуман, аним╞пд0'ие, 4) = имг╞пдие5ANIM╞ORDER(форм╞хуман, аним╞пдие, 5) = имг╞пдие5ANIM╞ORDER(форм╞хуман, аним╞пдие, 6) = имг╞пдие5ANIM╞ORDER(форм╞хуман, аним╞пдие, 7) = имг╞пдие5ANIM╞ORDER(форм╞хуман, аним╞пдие, 8) = имг╞пдие5ANIM╞ORDER(форм╞хуман, аним╞пйумп, 0) 1 = имг╞пкнеел1ANIM╞ORDER(форм╞хуман, аним╞пйумп, 1) = имг╞пкнеел2ANIM╞ORDER(форм╞дуцк, аним╞двалк, 0) = имг╞двалк1ANIM╞ORDER(форм╞дуцк, аним╞двалк, 1) = имг╞двалк2ANIM╞ORDER(форм╞дуцк, аним╞двалк, 2) = имг╞двалк3ANIM╞ORDER(форм╞дуцк, аним╞двалк, 3) 1= имг╞двалк2ANIM╞ORDER(форм╞дуцк, аним╞дяуацк, 0) = имг╞дяуацк1ANIM╞ORDER(форм╞дуцк, аним╞дяуацк, 1) = имг╞дяуацк2ANIM╞ORDER(форм╞дуцк, аним╞дяуацк, 2) = имг╞дяуацк3ANIM╞ORDER(форм╞дуцк, аним╞дяуацк, 3) = имг╞дяуацк2ANIM╞ORDER(форм╞дуцк, аним╞дяуац1к, 4) = имг╞дяуацк1ANIM╞ORDER(форм╞дуцк, аним╞ддие, 0) = имг╞ддие1ANIM╞ORDER(форм╞дуцк, аним╞ддие, 1) = имг╞ддие2ANIM╞ORDER(форм╞дуцк, аним╞ддие, 2) = имг╞ддие3ANIM╞ORDER(форм╞дуцк, аним╞ддие, 3) = имг╞ддие4ANIM╞ORDER(форм╞дуцк, аним╞ддие, 4) = имг1╞ддие5ANIM╞ORDER(форм╞дуцк, аним╞ддие, 5) = имг╞ддие5ANIM╞ORDER(форм╞дуцк, аним╞ддие, 6) = имг╞ддие5ANIM╞ORDER(форм╞дуцк, аним╞ддие, 7) = имг╞ддие5ANIM╞ORDER(форм╞дуцк, аним╞ддие, 8) = имг╞ддие5#DECLARE MAX╞FRAME(форм╞маь, аним╞маь)MAX╞FRAME(форм1╞хуман, аним╞пвалк) = 4MAX╞FRAME(форм╞хуман, аним╞ппунцх) = 5MAX╞FRAME(форм╞хуман, аним╞пкицк) = 5MAX╞FRAME(форм╞хуман, аним╞пкнеел╞дн) = 3MAX╞FRAME(форм╞хуман, аним╞пкнеел╞уп) = 2MAX╞FRAME(форм╞хуман, аним╞пкпунцх) = 5MAX╞FRAME(форм╞хуман, аним╞пк1кицк) = 5MAX╞FRAME(форм╞хуман, аним╞пдие) = 9MAX╞FRAME(форм╞хуман, аним╞пйумп) = 2MAX╞FRAME(форм╞дуцк, аним╞двалк) = 4MAX╞FRAME(форм╞дуцк, аним╞дяуацк) = 5MAX╞FRAME(форм╞дуцк, аним╞ддие) = 9.FANIM#DECLARE PLAYER╞FORM = 1 ' хуман#DECLARE BADDIE╞1FORM = 1#DEFINE фаним╞валк = 0#DEFINE фаним╞пунцх = 1#DEFINE фаним╞кицк = 2#DEFINE фаним╞кнеел╞дн = 3#DEFINE фаним╞кнеел╞уп = 4#DEFINE фаним╞кпунцх = 5#DEFINE фаним╞ккицк = 6#DEFINE фаним╞дие = 7#DEFINE фаним╞йумп = 8#DEFINE фаним╞маь = 9#D1ECLARE FORM╞ANIM(форм╞маь, фаним╞маь)FORM╞ANIM(форм╞хуман, фаним╞валк) = аним╞пвалкFORM╞ANIM(форм╞хуман, фаним╞пунцх) = аним╞ппунцхFORM╞ANIM(форм╞хуман, фаним╞кицк) = аним╞пкицкFORM╞ANIM(форм╞хуман, фаним╞кнеел╞дн) = аним╞пкнеел╞днFORM╞ANIM(форм╞хум1ан, фаним╞кнеел╞уп) = аним╞пкнеел╞упFORM╞ANIM(форм╞хуман, фаним╞кпунцх) = аним╞пкпунцхFORM╞ANIM(форм╞хуман, фаним╞ккицк) = аним╞пккицкFORM╞ANIM(форм╞хуман, фаним╞дие) = аним╞пдиеFORM╞ANIM(форм╞хуман, фаним╞йумп) = аним╞пйумпFORM╞ANIM(форм╞дуцк, фан1	им╞валк) = аним╞двалкFORM╞ANIM(форм╞дуцк, фаним╞пунцх) = аним╞дяуацкFORM╞ANIM(форм╞дуцк, фаним╞кицк) = аним╞дяуацкFORM╞ANIM(форм╞дуцк, фаним╞дие) = аним╞ддие#DECLARE PLAYER╞FRAME = 0#DECLARE PLAYER╞ANIM = 0 ' аним╞пвалк#DECLARE BADDIE╞FRAME = 0#1
DECLARE BADDIE╞ANIM = 0 ' аним╞пвалк.OFFSETS#DEFINE оффсет╞дата╞сизе  = 0#DEFINE оффсет╞нум╞фрамес = 2#DEFINE оффсет╞фраме0     = 3#DEFINE фрм╞оффсет╞ь          = 0#DEFINE фрм╞оффсет╞ы          = 1#DEFINE фрм╞оффсет╞в          = 2#DEFINE фрм╞оф1фсет╞х          = 3#DEFINE фрм╞оффсет╞хитбоьес   = 4#DEFINE фрм╞оффсет╞хб╞хеад    = 4#DEFINE фрм╞оффсет╞хб╞торсо   = 8#DEFINE фрм╞оффсет╞хб╞феет    = 12#DEFINE фрм╞оффсет╞хб╞аттацк  = 16#DEFINE фрм╞оффсет╞дата       = 20#DECLARE BX╞OFFS(3)BX╞OFF1S(0) = фрм╞оффсет╞хб╞хеадBX╞OFFS(1) = фрм╞оффсет╞хб╞торсоBX╞OFFS(2) = фрм╞оффсет╞хб╞феетBX╞OFFS(3) = фрм╞оффсет╞хб╞аттацк.MUSIC╞VARS'----------#DEFINE CHUNK╞MAX = 50#DECLARE CHUNK╞CNT, CHUNK╞IDX, VIDX, TMPO%, ROW#DECLARE ECHO╞M, ECHO╞B, ECHO╞SZ 1= .05, CHUNK╞RPT, ECHO╞DELAY#DECLARE V$(5,CHUNK╞MAX), V#DECLARE SONG$#DECLARE V1$, V2$, V3$, V4$, V5$, V6$#DECLARE CURR╞FREQ, CURR╞DIR#STRUCT енжтыпе NAME$, ATTACK, DECAY, SUSTAIN, RELEASE, WAVEFORM, PWенжтыпе ENVS(9) = [ _  [ "пIANO",       0, 1 9,  0,  0,  2, 1536 ], _  [ "аCCORDION",  12,  0, 12,  0,  1,    0 ], _  [ "цALLIOPE",    0,  0, 15,  0,  0,    0 ], _  [ "дRUM",        0,  5,  5,  0,  3,    0 ], _  [ "фLUTE",       9,  4,  4,  0,  0,    0 ], _  [ "гUITAR",      0,  9,  2,  1,  11,    0 ], _  [ "хARPSICRD",   0,  9,  0,  0,  2,  512 ], _  [ "оRGAN",       0,  9,  9,  0,  2, 2048 ], _  [ "тRUMPET",     8,  9,  4,  1,  2,  512 ], _  [ "ьYLOPHONE",   0,  9,  0,  0,  0,    0 ]  _]#DEFINE дир╞ноне = 0#DEFINE дир╞уп   = 1#DEFI1NE дир╞довн = 2#DEFINE дир╞осц  = 3#DEFINE ф╞офф = 0#DEFINE ф╞он  = 1#DECLARE FSROW = 0, FSEL = -1#STRUCT филттыпе NAME$, FREQ, LP, BP, HP, RES, DIR, MIN, SWEEPфилттыпе FILT(10) = [ _  [ "LOWP╞UP",    1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞уп,   1100, 10 ], _  [ "LOWP╞DOWN",  1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞довн, 100, 10 ], _  [ "LOWP╞OSC",   1000, ф╞он,  ф╞офф, ф╞офф, 15, дир╞осц,  100, 10 ], __  [ "BANDP╞UP",   1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞уп,   100, 10 ], _  [ "BANDP╞DOWN", 1000, 1ф╞офф, ф╞он,  ф╞офф, 15, дир╞довн, 100, 10 ], _  [ "BANDP╞OSC",  1000, ф╞офф, ф╞он,  ф╞офф, 15, дир╞осц,  100, 10 ], __  [ "HIGHP╞UP",   1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞уп,   100, 10 ], _  [ "HIGHP╞DOWN", 1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞довн, 1100, 10 ], _  [ "HIGHP╞OSC",  1000, ф╞офф, ф╞офф, ф╞он,  15, дир╞осц,  100, 10 ], __  [ "SPARE╞1",    0,    ф╞офф, ф╞офф, ф╞офф, 0,  дир╞ноне, 0,   0  ], _  [ "SPARE╞2",    0,    ф╞офф, ф╞офф, ф╞офф, 0,  дир╞ноне, 0,   0  ], __]#DECLARE SEQCNT#DE1CLARE SEQ╞CHUNK(200), SEQ╞EXTRA(200)#DECLARE PLYPTR, PLYFLAG#DEFINE цмд╞темпо = -1#DEFINE цмд╞филтер = -2#DEFINE цмд╞лооп = -3#DEFINE цмд╞ецхо╞м1 = -4   ' ECHO MELODY: VOICE 1 ON VOICE 4#DEFINE цмд╞ецхо╞м2 = -5   ' ECHO MELODY: VOICE 1 ON VOICE 21 + 4 + 5#DEFINE цмд╞ецхо╞б  = -6   ' ECHO BASS:   VOICE 3 ON VOICE 6#DEFINE цмд╞ецхо╞офф = -7#DEFINE цмд╞ецхо╞сз = -8#DEFINE цмд╞жол = -9#DEFINE цмд╞делаы = -10#DEFINE цмд╞маь = 11#DECLARE PJUMP, PJDIR, BJUMP, BJDIR#DEFINE бс╞офф = 0#DEFINE бс1╞спавн = 1#DEFINE бс╞алиже = 2#DEFINE бс╞деад = 3#DECLARE NEXT╞BADDIE╞TIME = 50, BADDIE╞DEAD╞TIME = 50, BADDIE╞STATE#DECLARE BADDIE╞VISIBLE'----.MAIN'----PRINT CHR$(27)+"5"PRINT CHR$(147);BORDER 0BACKGROUND 0GOSUB LOAD╞DATAPALIDX = 0GOSUB1 SET╞PALETTESONG$ = "CHABI.P"GOSUB LOAD╞SONG.LOOP0  GOSUB INIT╞VARS  GOSUB SHOW╞TITLE  GOSUB GAMEPLAY  ' GOSUB GAMEOVER  GOTO LOOP0'---------------.TRANSPARENT╞DMA'---------------  WPOKE $40009, SRC╞ADDR  WPOKE $4000C, DEST╞ADDR  WPOKE $140007, LENGTH  POKE  $40004, TRANSP  POKE $D702, 4 ' DMA LIST IN BANK 4  POKE $D701, $00 ' DMA LIST MSB  POKE $D705, $00 ' DMA LIST LSB  RETURN'----------.SHOW╞TITLE'----------  PRINT CHR$(147);  PRINT CHR$(14);  ' LOWER-CASE  PRINT "вAY OF1 THE иMPLODING фOOT"  PRINT "========================="  PRINT "а GAME MADE BY THE мега65 COMMUNITY!"  GET KEY A$  A$=""  ' ALL REVERSE-CHAR SPACES FOR MOST OF SCREEN  EDMA 3, $F00, 160, $40800  PRINT CHR$(142);  ' UPPERCASE  RETURN'--------1-.LOAD╞DATA'---------  PTR = $42000    FORM = форм╞лаыер  DAT╞IDX = дат╞лаыер  BLOAD "LEVEL1-BG.DAT",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB PREPARE╞DOUBLE╞COPY╞LAYER  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  FORM = форм╞хуман  DAT╞IDX = дат╞плаы1ер1  BLOAD "PLAYER.DAT",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  FORM = форм╞хуман  DAT╞IDX = дат╞плаыер2  BLOAD "PLAYER2.DAT",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  FORM = форм╞хуман1  DAT╞IDX = дат╞плаыер3  BLOAD "PLAYER3.DAT",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  FORM = форм╞хуман  DAT╞IDX = дат╞плаыер4  BLOAD "PLAYER4.DAT",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FRE1E  FORM = форм╞дуцк  DAT╞IDX = дат╞дуцк  BLOAD "DUCK.DAT",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  BLOAD "PAL.BIN",P($40100),R  RETURN'---------------------------.╞INCREMENT╞PTR╞TO╞NEXT╞FREE'--------------------1-------  PTR = TMP  SZ = WPEEK(PTR + оффсет╞дата╞сизе)  'PRINT  'PRINT "INC SZ = ";SZ  'PRINT "PTR = ";HEX$(PTR + оффсет╞дата╞сизе)  PTR = PTR + SZ  'GET KEY A$  RETURN'-----------.SET╞PALETTE'----------- (PALIDX)  PTR = $40100 + PALIDX * 116 * 3  FOR K = 0 TO 15    ' RED    POKE $D100 + K + 16, PEEK(PTR)    PTR = PTR + 1    ' GREEN    POKE $D200 + K + 16, PEEK(PTR)    PTR = PTR + 1    ' BLUE    POKE $D300 + K + 16, PEEK(PTR)    PTR = PTR + 1  NEXT K  RETURN'---------.INIT1 ╞VARS'---------  ' CLEAR DMA LIST AREA  FOR K = 0 TO 20    POKE $40000+K, 0  NEXT K  POKE $40000, $81 ' OPT = DEST ADDR мб SELECTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' 1!OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $00 ' цмд LSB = цопы  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C,1" $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' цмд MSB (IGNORE)  WPOKE $40010, $0000 ' MODULO (IGNORE)  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $F00, 160, $50000  EDMA 3, $A0, $20, $50F00  EDMA 3, $FA0, $4F, $51000  KN1#EEL╞FLAG = 0  PLAYER╞FORM = форм╞хуман  PLAYER╞DAT╞FIXED = дат╞плаыер4  PLAYER╞DAT╞IDX = PLAYER╞DAT╞FIXED  BADDIE╞KNEEL╞FLAG = 0  BADDIE╞FORM = форм╞хуман  BADDIE╞DAT╞FIXED = дат╞плаыер2  BADDIE╞DAT╞IDX = BADDIE╞DAT╞FIXED  PLAYER╞FRAME = 0  PL1$AYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞валк)  PX = 0 : PY = 23  BX = 60 : BY = 23  PLAYER╞ENERGY = 18  LAG╞PENERGY = 0  BADDIE╞ENERGY = 0  LAG╞BENERGY = 0  PJUMP = 0  PJDIR = 0  BJDIR = 0  PLAYER╞MIRROR = 0  BADDIE╞MIRROR = 1  BJUMP = 01%  NEXT╞BADDIE╞TIME = 50  BADDIE╞DEAD╞TIME = 50  BADDIE╞STATE = бс╞офф  RETURN'-------------------.INIT╞PETSCII╞FRAMES'-------------------  TMP = PTR  MAX╞FRAMES(FORM) = PEEK(PTR + оффсет╞нум╞фрамес)  'PRINT  'PRINT "PTR=";HEX$(PTR + оффсет╞ну1&м╞фрамес)  PTR = PTR + оффсет╞фраме0  'PRINT  'PRINT "FORM=";FORM;" - MX╞FRM=";MAX╞FRAMES(FORM);": ";  FRM╞IDX = 0  DO WHILE FRM╞IDX < MAX╞FRAMES(FORM)    'PRINT FRM╞IDX;    FRAME╞ADDR(DAT╞IDX, FRM╞IDX) = PTR    FRMW = PEEK(PTR + фрм╞оффсет╞в)1'    FRMH = PEEK(PTR + фрм╞оффсет╞х)        'PRINT "PTR=";HEX$(PTR);", IDX=";FRM╞IDX;", W=";FRMW;", H=";FRMH    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH    ':PRINT CHR$(147);"FRM╞IDX=";FRM╞IDX    FRM╞IDX = FRM╞IDX + 1  LOOP  PTR = TMP  RETURN2 '-------------------------.PREPARE╞DOUBLE╞COPY╞LAYER'-------------------------  DBLUP╞ADDR = $52000  FOR FRAMEIDX = 0 TO MAX╞FRAMES(форм╞лаыер)-1    PTR = FRAME╞ADDR(дат╞лаыер, FRAMEIDX)    FRMX = PEEK(PTR + фрм╞оффсет╞ь)    FRMY = PEEK(PTR + ф2рм╞оффсет╞ы)    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    FRMX1=FRMX+FRMW-1    FRMY1=FRMY+FRMH-1    FRAME╞DBLUP╞ADDR(FRAMEIDX) = DBLUP╞ADDR    ' цопы цолор FOR EACH ROW TWICE INTO SOME LOCATION IN DBLUP╞ADDR    FOR Y2 = FRMY TO FRMY1      FOR K = 0 TO 1          ' COPY IT TO SOME PLACE IN $5.2000          EDMA 0, FRMW, (PTR + фрм╞оффсет╞дата), DBLUP╞ADDR          DBLUP╞ADDR = DBLUP╞ADDR + FRMW      NEXT K      PTR = PTR + FRMW    NEXT Y  NEXT FRAMEIDX  RET2URN'---------------.DRAW╞BACKGROUND'---------------   '   FRAMEIDX = имг╞сун   '   GOSUB DRAW╞PETSCII╞LAYER    '   RETURN  POKE $4000B, $05  ' ASSURE SOURCE BANK 5 (FOR DOUBLED-UP LAYERS)  FOR LIDX = 0 TO MAX╞FRAMES(форм╞лаыер)-1     ' IF LA2YER╞VISIBLE[LIDX] = 1 THEN BEGIN       FRAMEIDX = DRAW╞ORDER(LIDX)       GOSUB DRAW╞PETSCII╞LAYER      'BEND  NEXT LIDX  RETURN'----------.MOVE╞RIGHT'----------  BADDIE╞VISIBLE = BADDIE╞STATE = бс╞алиже OR BADDIE╞STATE = бс╞деад  IF PX < 252 OR (BADDIE╞STATE = бс╞алиже AND PX < 59) THEN BEGIN    PX = PX + 1  BEND:ELSE BEGIN    IF BX > 0 AND BADDIE╞VISIBLE THEN BEGIN      GOSUB INCR╞OFFS      BX = BX - 1    BEND    IF BADDIE╞STATE = бс╞офф THEN BEGIN      GOSUB INCR╞OFFS    BEND  2BEND  IF BADDIE╞STATE <> бс╞алиже AND PX > 26 THEN BEGIN    IF MOD(PLAYER╞FRAME,2) = 0 THEN PX = PX - 1  BEND  KNEEL╞FLAG = 0  RETURN'---------.MOVE╞LEFT'---------  IF PX > 0 THEN BEGIN    PX = PX - 1  BEND:ELSE BEGIN    IF BX < 60 THEN 2BEGIN      GOSUB DECR╞OFFS      BX = BX + 1    BEND  BEND  KNEEL╞FLAG = 0  RETURN'--------------.GET╞USER╞INPUT'--------------  GOSUB KEYBOARD╞INPUT  GOSUB JOYSTICK╞INPUT  IF A$="X" THEN BEGIN    KNEEL╞FLAG = 0    PLAYER╞ANIM = FORM╞AN2IM(PLAYER╞FORM, фаним╞дие)    PLAYER╞FRAME = 0  BEND  RETURN'--------------.KEYBOARD╞INPUT'--------------  GET A$  IF A$="," AND PALIDX>0 THEN PALIDX=PALIDX-1:GOSUB SET╞PALETTE  IF A$="." AND PALIDX<11 THEN PALIDX=PALIDX+1:GOSUB SET╞PALETTE2	  IF A$="1" THEN BEGIN    дебуг=MOD(дебуг+1,2)    EDMA 3, $F00, 160, $50000    EDMA 3, $F00, 160, $40800  BEND  ' D = TOGGLE BETWEEN HUMAN AND DUCK  IF A$="D" THEN BEGIN    IF PLAYER╞FORM = форм╞хуман THEN BEGIN      PLAYER╞FORM = форм╞дуцк  2
    PLAYER╞DAT╞IDX = дат╞дуцк    BEND:ELSE BEGIN      PLAYER╞FORM = форм╞хуман      PLAYER╞DAT╞IDX = PLAYER╞DAT╞FIXED    BEND    PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞валк)    PLAYER╞FRAME = 0    KNEEL╞FLAG = 0  BEND  IF A$="<" AND PLAYER╞2DAT╞FIXED > дат╞плаыер1 THEN BEGIN    PLAYER╞DAT╞FIXED = PLAYER╞DAT╞FIXED - 1    PLAYER╞DAT╞IDX = PLAYER╞DAT╞FIXED  BEND  IF A$=">" AND PLAYER╞DAT╞FIXED < дат╞плаыер4 THEN BEGIN    PLAYER╞DAT╞FIXED = PLAYER╞DAT╞FIXED + 1    PLAYER╞DAT╞IDX = PLAYER╞2DAT╞FIXED  BEND  RETURN'--------------.JOYSTICK╞INPUT'--------------  JDIR╞RAW = JOY(2)  JFIRE = JDIR╞RAW AND 128  JDIR = JDIR╞RAW AND $7F  IF JDIR > 8 THEN JDIR = 0  ' HIDE ANY NONSENSICALS  ' HANDLE NO JOYSTICK INPUT CASES  ' -------------2-----------------  IF JDIR╞RAW=0 AND PLAYER╞ANIM = аним╞пкнеел╞дн THEN BEGIN    IF PLAYER╞FRAME >= MAX╞FRAME(форм╞хуман, аним╞пкнеел╞дн)-1 THEN BEGIN    KNEEL╞FLAG = 0    PLAYER╞ANIM = аним╞пкнеел╞уп    PLAYER╞FRAME = 0    BEND  BEND  IF JDIR╞RAW2 = 0 THEN RETURN  ' HANDLE CASES WITH SOME JOYSTICK INPUT  ' -------------------------------------  ' NO FIRE BUTTON MOVES  ' --------------------  IF JFIRE=0 THEN BEGIN    IF JDIR=й╞ригхт AND PJUMP=0 THEN GOSUB MOVE╞RIGHT    IF JDIR=й╞лефт AND 2PJUMP=0 THEN GOSUB MOVE╞LEFT    IF JDIR=й╞довн AND PLAYER╞ANIM = аним╞пвалк THEN BEGIN      PLAYER╞ANIM = аним╞пкнеел╞дн      PLAYER╞FRAME = 0    BEND    IF (JDIR=й╞уп OR JDIR=й╞уп╞лефт OR JDIR=й╞уп╞ригхт) AND PJUMP=0 THEN BEGIN      PLAYER╞ANIM = 2аним╞пйумп      PJUMP = 1      IF JDIR=й╞уп THEN PJDIR = 0      IF JDIR=й╞уп╞лефт THEN PJDIR = -1      IF JDIR=й╞уп╞ригхт THEN PJDIR = 1      PLAYER╞FRAME = 0    BEND  BEND  ' FIRE BUTTON MOVES  ' -----------------  IF JFIRE = 128 AND PJUMP=0 2THEN BEGIN    IF JD(PLAYER╞MIRROR, JDIR)=йд╞уп╞форвард AND PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞валк) THEN BEGIN      PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞пунцх)      SOUND 1 + PLAYER╞MIRROR * 3, 4000, 5, 1, 100, 1000, 3      IF KNEEL╞FLA2G = 1 THEN PLAYER╞ANIM = аним╞пкпунцх      PLAYER╞FRAME = 0    BEND    IF JD(PLAYER╞MIRROR, JDIR)=йд╞довн╞форвард AND PLAYER╞ANIM = аним╞пвалк THEN BEGIN      PLAYER╞ANIM = аним╞пкицк      SOUND 1 + PLAYER╞MIRROR * 3, 2000, 5, 1, 100, 1000, 3      2IF KNEEL╞FLAG = 1 THEN PLAYER╞ANIM = аним╞пккицк      PLAYER╞FRAME = 0    BEND  BEND  RETURN'-----------.DRAW╞PLAYER'-----------  CHARACTER = плаыер  FRAMEIDX = ANIM╞ORDER(PLAYER╞FORM, PLAYER╞ANIM, PLAYER╞FRAME)  FX=PX : FY=PY  MIRROR = PLAY2ER╞MIRROR  FORM = PLAYER╞FORM  DAT╞IDX = PLAYER╞DAT╞IDX  GOSUB DRAW╞PETSCII╞FRAME  RETURN'-----------.DRAW╞BADDIE'-----------  CHARACTER = баддие  FRAMEIDX = ANIM╞ORDER(BADDIE╞FORM, BADDIE╞ANIM, BADDIE╞FRAME)  FX=BX : FY=BY  MIRROR = BADDIE2╞MIRROR  FORM = BADDIE╞FORM  DAT╞IDX = BADDIE╞DAT╞IDX  GOSUB DRAW╞PETSCII╞FRAME  RETURN'--------------------------.CONSIDER╞NEXT╞PLAYER╞FRAME'--------------------------  IF PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞валк) AND (JDIR=й╞лефт OR JD2IR=й╞ригхт) THEN BEGIN    PLAYER╞FRAME = PLAYER╞FRAME + 1  BEND  IF PLAYER╞ANIM <> FORM╞ANIM(PLAYER╞FORM, фаним╞валк) THEN BEGIN    PLAYER╞FRAME = PLAYER╞FRAME + 1  BEND  IF PLAYER╞ANIM = аним╞пкнеел╞дн AND JDIR=й╞довн THEN BEGIN    IF PLAYER╞FRA2ME >= MAX╞FRAME(форм╞хуман, фаним╞кнеел╞дн) THEN BEGIN      PLAYER╞FRAME = MAX╞FRAME(форм╞хуман, фаним╞кнеел╞дн) - 1      KNEEL╞FLAG = 1    BEND    RETURN  BEND  IF PLAYER╞ANIM = аним╞пйумп THEN BEGIN    IF PLAYER╞FRAME >= MAX╞FRAME(форм╞хуман, ф2аним╞йумп) THEN BEGIN      PLAYER╞FRAME = MAX╞FRAME(форм╞хуман, фаним╞йумп) - 1    BEND  BEND  IF PJUMP > 0 THEN BEGIN    IF PJDIR>0 THEN GOSUB MOVE╞RIGHT:GOSUB MOVE╞RIGHT    IF PJDIR<0 THEN GOSUB MOVE╞LEFT:GOSUB MOVE╞LEFT    IF PJUMP = 1 THEN BE2GIN      PY = PY - 2      IF PY <= 0 THEN PJUMP = 2    BEND    IF PJUMP = 2 THEN BEGIN      PY = PY + 2      IF PY >= 23 THEN BEGIN        PY = 23        PJUMP = 0        PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞валк)        PLAYER╞FRAME = 02      BEND    BEND  BEND  IF PLAYER╞FRAME >= MAX╞FRAME(PLAYER╞FORM, PLAYER╞ANIM) THEN BEGIN    IF PLAYER╞ANIM = аним╞пдие THEN BEGIN      IF PLAYER╞ENERGY > 0 THEN BEGIN        PLAYER╞ANIM = аним╞пкнеел╞уп        PLAYER╞FRAME = 0      BEND:ELSE 2BEGIN        PLAYER╞FRAME = MAX╞FRAME(PLAYER╞FORM, PLAYER╞ANIM) - 1      BEND      RETURN    BEND    IF KNEEL╞FLAG = 1 AND PLAYER╞ANIM <> аним╞пкнеел╞дн THEN BEGIN      PLAYER╞ANIM = аним╞пкнеел╞дн      PLAYER╞FRAME = MAX╞FRAME(форм╞хуман, аним╞пк2неел╞дн) - 1    BEND:ELSE BEGIN      PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞валк)      PLAYER╞FRAME = 0    BEND  BEND  IF BADDIE╞STATE = бс╞алиже OR BADDIE╞STATE = бс╞деад THEN BEGIN    IF PX > (BX + 5) THEN PLAYER╞MIRROR = 1    IF BX > (PX 2+ 5) THEN PLAYER╞MIRROR = 0  BEND:ELSE BEGIN    PLAYER╞MIRROR = 0  BEND  RETURN'--------------------------.CONSIDER╞NEXT╞BADDIE╞FRAME'--------------------------  IF BADDIE╞STATE = бс╞алиже THEN BEGIN    IF BX > (PX + 5) THEN BADDIE╞MIRROR = 12    IF PX > (BX + 5) THEN BADDIE╞MIRROR = 0  BEND  IF BADDIE╞ANIM <> аним╞пвалк THEN BEGIN    BADDIE╞FRAME = BADDIE╞FRAME + 1  BEND  IF BADDIE╞FRAME >= MAX╞FRAME(BADDIE╞FORM, BADDIE╞ANIM) THEN BEGIN    IF BADDIE╞ANIM = аним╞пдие THEN BEGIN      2IF BADDIE╞ENERGY > 0 THEN BEGIN        BADDIE╞ANIM = аним╞пкнеел╞уп        BADDIE╞FRAME = 0      BEND:ELSE BEGIN        BADDIE╞FRAME = MAX╞FRAME(BADDIE╞FORM, BADDIE╞ANIM) - 1      BEND      RETURN    BEND    IF BADDIE╞KNEEL╞FLAG = 1 AND BADDIE╞AN2 IM <> аним╞пкнеел╞дн THEN BEGIN      BADDIE╞ANIM = аним╞пкнеел╞дн      BADDIE╞FRAME = MAX╞FRAME(форм╞хуман, аним╞пкнеел╞дн) - 1    BEND:ELSE BEGIN      BADDIE╞ANIM = FORM╞ANIM(BADDIE╞FORM, фаним╞валк)      BADDIE╞FRAME = 0    BEND    RETURN  BEND2!  IF BADDIE╞STATE <> бс╞алиже THEN RETURN  IF BADDIE╞ANIM = аним╞пдие THEN RETURN  GOSUB IF╞PLAYER╞FAR╞WALK╞CLOSER  IF RET% = 1 THEN RETURN  GOSUB IF╞PLAYER╞NEARER╞WALK╞CAUTIOUS  IF RET% = 1 THEN RETURN  GOSUB IF╞PLAYER╞HITTABLE╞TRY╞HITTING  2"IF RET% = 1 THEN RETURN  ' IF PLAYER IS TRYING TO HIT ME, CONSIDER FLEEING  RETURN'------------------------------.IF╞PLAYER╞HITTABLE╞TRY╞HITTING'------------------------------  RET% = 0  ' IF PLAYER IS WITHIN HITTING DISTANCE, CONSIDER HITTING2#  IF ABS(PX-BX) >= 8 AND BADDIE╞ANIM = аним╞пвалк THEN BEGIN    RET% = 1    K = INT(RND(1)*8)    IF K = 1 THEN BEGIN      BADDIE╞ANIM = аним╞ппунцх      BADDIE╞FRAME=0      SOUND 1 + BADDIE╞MIRROR * 3, 4000, 5, 1, 100, 1000, 3    BEND    IF K = 22$ THEN BEGIN      BADDIE╞ANIM = аним╞пкицк      BADDIE╞FRAME=0      SOUND 1 + BADDIE╞MIRROR * 3, 2000, 5, 1, 100, 1000, 3    BEND  BEND  RETURN'------------------------------.IF╞PLAYER╞NEARER╞WALK╞CAUTIOUS'------------------------------  RET% 2%= 0  ' IF PLAYER IS NEARER, WALK AHEAD MORE CAUTIOUSLY  IF ABS(PX-BX) > 8 THEN BEGIN    IF INT(RND(1)*4) >= 3 THEN GOSUB MOVE╞BADDIE╞CLOSER    RET% = 1  BEND  RETURN'-------------------------.IF╞PLAYER╞FAR╞WALK╞CLOSER'-------------------------2&  RET% = 0  ' IF PLAYER IS A LONG DISTANCE AWAY, COMMIT TO WALKING CLOSER  IF ABS(PX-BX) > 20 THEN BEGIN    GOSUB MOVE╞BADDIE╞CLOSER    RET% = 1  BEND  RETURN'------------------.MOVE╞BADDIE╞CLOSER'------------------  BADDIE╞ANIM = аним╞пвалк2'  BADDIE╞FRAME = BADDIE╞FRAME + 1  IF BADDIE╞FRAME >= MAX╞FRAME(BADDIE╞FORM, BADDIE╞ANIM) THEN BADDIE╞FRAME = 0  IF BX > PX THEN BEGIN    BX = BX - 1  BEND:ELSE BEGIN    BX = BX + 1  BEND  RETURN'------------------.DRAW╞PETSCII╞FRAME'--------3 ----------  POKE $4000B, $04  ' ASSURE SOURCE BANK 4 (FOR ORIGINAL FRAME DATA)  IF MIRROR = 1 THEN SETBIT $40006, 5:ELSE CLRBIT $40006, 5  DATA╞ADDR = FRAME╞ADDR(DAT╞IDX, FRAMEIDX)  FRMX = PEEK(DATA╞ADDR + фрм╞оффсет╞ь)  FRMY = PEEK(DATA╞ADDR + фрм╞3оффсет╞ы)  FRMW = PEEK(DATA╞ADDR + фрм╞оффсет╞в)  FRMH = PEEK(DATA╞ADDR + фрм╞оффсет╞х)  FRMX = FX ' OVERRIDE POSITION  FRMY = FY  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  CLRADDR = $51000 + FRMX + FRMY * 80  IF MIRROR = 1 THEN CLRADDR = CLRADDR 3+ FRMW - 1  CDATA╞ADDR = DATA╞ADDR + фрм╞оффсет╞дата  FOR YY=FRMY TO FRMY1    ' DRAW CHARS    ' ----------    SRC╞ADDR = CDATA╞ADDR    DEST╞ADDR = CLRADDR    LENGTH = FRMW    TRANSP = $FF    GOSUB TRANSPARENT╞DMA    CDATA╞ADDR = CDATA╞ADDR 3+ FRMW    CLRADDR = CLRADDR + 80    NEXT YY  IF дебуг THEN GOSUB DRAW╞BOXES  GOSUB CHECK╞IF╞HIT╞OPPONENT  RETURN'------------------.DRAW╞PETSCII╞LAYER'------------------  CLRBIT $40006, 5  DATA╞ADDR = FRAME╞ADDR(дат╞лаыер, FRAMEIDX)  FRMX3 = PEEK(DATA╞ADDR + фрм╞оффсет╞ь)  FRMY = PEEK(DATA╞ADDR + фрм╞оффсет╞ы)  FRMW = PEEK(DATA╞ADDR + фрм╞оффсет╞в)  FRMH = PEEK(DATA╞ADDR + фрм╞оффсет╞х)  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  CLRADDR = $51000 + FRMX + FRMY * 80  CDATA╞ADDR = DATA╞3ADDR + фрм╞оффсет╞дата + FRMW * FRMH  XOFFS(FRAMEIDX) = MOD(XOFFS(FRAMEIDX) + 80, 80)  XOFFS = INT(XOFFS(FRAMEIDX))  CDATA╞ADDR = FRAME╞DBLUP╞ADDR(FRAMEIDX)  FOR YY=FRMY TO FRMY1    ' DRAW CHARS FROM OFFSET TO END    ' -------------------------3----    SRC╞ADDR = CDATA╞ADDR + XOFFS    DEST╞ADDR = CLRADDR    LENGTH = FRMW    TRANSP = $FF    GOSUB TRANSPARENT╞DMA    CDATA╞ADDR = CDATA╞ADDR + FRMW * 2    CLRADDR = CLRADDR + 80    NEXT YY  RETURN'--------.GAMEPLAY'--------  GOSUB GE3T╞USER╞INPUT  GOSUB DRAW╞BACKGROUND  GOSUB DRAW╞SPRITES  GOSUB PAGE╞FLIP  GOSUB GAME╞LOGIC  GOSUB DRAW╞ENERGY╞BARS  RET% = 0  DO WHILE RET% = 0    GOSUB PARSE╞CURRENT╞SEQPTR  LOOP  GOTO GAMEPLAY  RETURN'----------------.DRAW╞ENERGY╞BARS'3----------------  IF PLAYER╞ENERGY <> LAG╞PENERGY THEN BEGIN    IF LAG╞PENERGY < PLAYER╞ENERGY THEN BEGIN      LAG╞PENERGY = LAG╞PENERGY + 1      K = LAG╞PENERGY      GOSUB DRAW╞BLUE╞TRIANGLE      RETURN    BEND    IF LAG╞PENERGY > PLAYER╞ENERGY 3	THEN BEGIN      K = LAG╞PENERGY      GOSUB CLEAR╞BLUE╞TRIANGLE      LAG╞PENERGY = LAG╞PENERGY - 1      RETURN    BEND  BEND  IF BADDIE╞ENERGY <> LAG╞BENERGY THEN BEGIN    IF LAG╞BENERGY < BADDIE╞ENERGY THEN BEGIN      LAG╞BENERGY = LAG╞BENERGY 3
+ 1      K = LAG╞BENERGY      GOSUB DRAW╞RED╞TRIANGLE      RETURN    BEND    IF LAG╞BENERGY > BADDIE╞ENERGY THEN BEGIN      K = LAG╞BENERGY      GOSUB CLEAR╞RED╞TRIANGLE      LAG╞BENERGY = LAG╞BENERGY - 1      RETURN    BEND  BEND  RETURN'3------------------.DRAW╞BLUE╞TRIANGLE'------------------  CURSOR 1 + K * 2, 48:PRINT " ъ";  CURSOR 1 + K * 2, 49:PRINT "▓╘";  RETURN'-------------------.CLEAR╞BLUE╞TRIANGLE'-------------------  CURSOR 1 + K * 2, 48:PRINT "▓ ";  CURSOR 1 + K 3* 2, 49:PRINT "▓ ";  RETURN'-----------------.DRAW╞RED╞TRIANGLE'-----------------  CURSOR 78 - K * 2, 48:PRINT "√╘";  CURSOR 78 - K * 2, 49:PRINT "▓ъ";  RETURN'------------------.CLEAR╞RED╞TRIANGLE'------------------  CURSOR 78 - K * 2, 483:PRINT "▓ ";  CURSOR 78 - K * 2, 49:PRINT "▓ ";  RETURN'------------.DRAW╞SPRITES'------------  IF BADDIE╞STATE = бс╞алиже OR BADDIE╞STATE = бс╞деад THEN BEGIN    GOSUB DRAW╞BADDIE  BEND  GOSUB DRAW╞PLAYER  RETURN'----------.GAME╞LOGIC'---3-------  GOSUB CONSIDER╞NEXT╞PLAYER╞FRAME  GOSUB ASSESS╞BADDIE╞STATE  RETURN'-------------------.ASSESS╞BADDIE╞STATE'-------------------  IF BADDIE╞STATE = бс╞офф THEN BEGIN    ' CONSIDER WHEN TO SPAWN NEXT BADDIE    NEXT╞BADDIE╞TIME = NEXT╞BA3DDIE╞TIME - 1    IF NEXT╞BADDIE╞TIME = 0 THEN BADDIE╞STATE = бс╞спавн    RETURN  BEND  IF BADDIE╞STATE = бс╞спавн THEN BEGIN    BADDIE╞FORM = форм╞хуман    IF BADDIE╞DAT╞FIXED = дат╞плаыер2 THEN BEGIN      BADDIE╞DAT╞FIXED = дат╞плаыер3    BEND:3 ELSE BEGIN      BADDIE╞DAT╞FIXED = дат╞плаыер2    BEND    BADDIE╞DAT╞IDX = BADDIE╞DAT╞FIXED    BADDIE╞STATE = бс╞алиже    BX = 60 : BY = 23    BADDIE╞ANIM = FORM╞ANIM(BADDIE╞FORM, фаним╞валк)    BADDIE╞FRAME = 0    BADDIE╞ENERGY = 18    LAG╞B3ENERGY = 0    BADDIE╞MIRROR = 1    BJUMP = 0    RETURN  BEND  IF BADDIE╞STATE = бс╞алиже THEN BEGIN    GOSUB CONSIDER╞NEXT╞BADDIE╞FRAME    IF BADDIE╞ENERGY = 0 THEN BADDIE╞STATE = бс╞деад: BADDIE╞DEAD╞TIME=50    RETURN  BEND  IF BADDIE╞STATE3 = бс╞деад THEN BEGIN    GOSUB CONSIDER╞NEXT╞BADDIE╞FRAME    PLAYER╞MIRROR = 0    BADDIE╞DEAD╞TIME = BADDIE╞DEAD╞TIME - 1    IF BADDIE╞DEAD╞TIME = 0 THEN BADDIE╞STATE = бс╞офф:NEXT╞BADDIE╞TIME=50    RETURN  BEND  RETURN'---------.PAGE╞FLIP'--3-------  IF дебуг THEN BEGIN    EDMA 0, $F00, $50000, $40800    EDMA 3, $F00, 160, $50000  BEND  EDMA 0, $F00, $51000, $FF80000  ' FILL THE TOP PART  EDMA 3, $F00, $4F, $51000  RETURN'---------.INCR╞OFFS'---------  FOR K = 0 TO хигхест╞лаые3р    XOFFS(K) = XOFFS(K) + OFFS╞AMOUNT(K)  NEXT K  RETURN'---------.DECR╞OFFS'---------  FOR K = 0 TO хигхест╞лаыер    XOFFS(K) = XOFFS(K) - OFFS╞AMOUNT(K)  NEXT K  RETURN'----------.DRAW╞BOXES'----------  PTR = DATA╞ADDR + фрм╞оффсет╞хи3тбоьес  FOR IDX = 0 TO 3    X1 = PEEK(PTR + 0)    Y1 = PEEK(PTR + 1)    X2 = PEEK(PTR + 2)    Y2 = PEEK(PTR + 3)    IF NOT (X1=0 AND Y1=0 AND X2=0 AND Y2=0) THEN BEGIN      GOSUB ADJUST╞COORDS      DRAW╞COLOR = 7      IF IDX = 3 THEN BEGIN 3       DRAW╞COLOR = 2        GOSUB DRAW╞BOX        ' GOSUB CHECK╞IF╞HIT╞OPPONENT      BEND:ELSE BEGIN        GOSUB DRAW╞BOX      BEND    BEND    PTR = PTR + 4  NEXT IDX  RETURN'--------.DRAW╞BOX'--------  ' DRAW CORNERS  ' ------------3  X = X1 : Y = Y1 : K = цхар╞боь╞тл : GOSUB DRAW╞CHAR  X = X2 : Y = Y1 : K = цхар╞боь╞тр : GOSUB DRAW╞CHAR  X = X1 : Y = Y2 : K = цхар╞боь╞бл : GOSUB DRAW╞CHAR  X = X2 : Y = Y2 : K = цхар╞боь╞бр : GOSUB DRAW╞CHAR  ' DRAW HORIZONTALS  ' ------------3----  FOR X = X1+1 TO X2-1    Y = Y1 : K = цхар╞хорз : GOSUB DRAW╞CHAR    Y = Y2 : K = цхар╞хорз : GOSUB DRAW╞CHAR  NEXT X  ' DRAW VERTICALS  ' --------------  FOR Y = Y1+1 TO Y2-1    X = X1 : K = цхар╞жерт : GOSUB DRAW╞CHAR    X = X2 : K = цха3р╞жерт : GOSUB DRAW╞CHAR  NEXT Y  RETURN'---------.DRAW╞CHAR'---------  IF PEEK($50000 + X + Y * 80) <> цхар╞спаце THEN BEGIN    K = K + 128  BEND:ELSE BEGIN    POKE $51000 + X + Y * 80, 1  BEND  IF DRAW╞COLOR = 2 THEN POKE $51000 + X + Y *3 80, DRAW╞COLOR  POKE $50000 + X + Y * 80, K  RETURN'---------------------.CHECK╞IF╞HIT╞OPPONENT'---------------------  DATA╞ADDR = FRAME╞ADDR(DAT╞IDX, FRAMEIDX)  TMP╞MIRROR = MIRROR  IF CHARACTER = плаыер THEN BEGIN    FRAMEIDX = ANIM╞ORDER(3BADDIE╞FORM, BADDIE╞ANIM, BADDIE╞FRAME)    OPPONENT╞DATA╞ADDR = FRAME╞ADDR(BADDIE╞DAT╞IDX, FRAMEIDX)    OPPONENT╞MIRROR = BADDIE╞MIRROR    FX=BX : FY=BY  BEND  IF CHARACTER = баддие THEN BEGIN    FRAMEIDX = ANIM╞ORDER(PLAYER╞FORM, PLAYER╞ANIM, PLAY3ER╞FRAME)    OPPONENT╞DATA╞ADDR = FRAME╞ADDR(PLAYER╞DAT╞IDX, FRAMEIDX)    OPPONENT╞MIRROR = PLAYER╞MIRROR    FX=PX : FY=PY  BEND  X1 = PEEK(DATA╞ADDR + фрм╞оффсет╞хб╞аттацк + 0)  Y1 = PEEK(DATA╞ADDR + фрм╞оффсет╞хб╞аттацк + 1)  X2 = PEEK(DATA╞ADD3R + фрм╞оффсет╞хб╞аттацк + 2)  Y2 = PEEK(DATA╞ADDR + фрм╞оффсет╞хб╞аттацк + 3)  IF X1=0 AND Y1=0 AND X2=0 AND Y2=0 THEN RETURN  GOSUB ADJUST╞COORDS  P╞X1 = X1  P╞Y1 = Y1  P╞X2 = X2  P╞Y2 = Y2  FRMX = PEEK(OPPONENT╞DATA╞ADDR + фрм╞оффсет╞ь)  F3RMY = PEEK(OPPONENT╞DATA╞ADDR + фрм╞оффсет╞ы)  FRMX = FRMX + FX  FRMY = FRMY + FY  FRMW = PEEK(OPPONENT╞DATA╞ADDR + фрм╞оффсет╞в)  FRMH = PEEK(OPPONENT╞DATA╞ADDR + фрм╞оффсет╞х)  ' ITERATE THROUGH HEAD/TORSO/FEET HITBOXES OF OPPONENT  PTR = OPPO3NENT╞DATA╞ADDR + фрм╞оффсет╞хитбоьес  FOR IDX = 0 TO 2    X1 = PEEK(PTR + 0)    Y1 = PEEK(PTR + 1)    X2 = PEEK(PTR + 2)    Y2 = PEEK(PTR + 3)    GOSUB ADJUST╞COORDS    O╞X1 = X1    O╞Y1 = Y1    O╞X2 = X2    O╞Y2 = Y2    GOSUB CHECK╞BOX╞COL3 LISION    IF RET% = 1 THEN BEGIN      IF CHARACTER = баддие THEN BEGIN        PLAYER╞ANIM = FORM╞ANIM(PLAYER╞FORM, фаним╞дие)        PLAYER╞FRAME = 0        IF PLAYER╞ENERGY > 0 THEN PLAYER╞ENERGY = PLAYER╞ENERGY - 1        IF PLAYER╞ENERGY = 0 TH3!EN BEGIN          SOUND 1 + PLAYER╞MIRROR * 3, 8000, 50, 1, 435, 100, 0, 4000        BEND:ELSE BEGIN          SOUND 1 + PLAYER╞MIRROR * 3, 8000, 10, 1, 435, 200, 0, 4000        BEND      BEND      IF CHARACTER = плаыер THEN BEGIN        BADDIE╞ANI3"M = FORM╞ANIM(BADDIE╞FORM, фаним╞дие)        BADDIE╞FRAME = 0        IF BADDIE╞ENERGY > 0 THEN BADDIE╞ENERGY = BADDIE╞ENERGY - 1        IF BADDIE╞ENERGY = 0 THEN BEGIN          SOUND 1 + BADDIE╞MIRROR * 3, 8000, 50, 1, 435, 100, 0, 4000        BEND:3#ELSE BEGIN          SOUND 1 + BADDIE╞MIRROR * 3, 8000, 10, 1, 435, 200, 0, 4000        BEND      BEND      IDX = 2  ' FORCE BAIL OUT OF FOR-LOOP UPON ANY HIT    BEND    PTR = PTR + 4  NEXT IDX  MIRROR = TMP╞MIRROR  PTR = FRAME╞ADDR(DAT╞IDX, FRA3$MEIDX)  RETURN'-------------.ADJUST╞COORDS'-------------  IF MIRROR = 0 THEN BEGIN    X1 = FRMX + X1    Y1 = FRMY + Y1    X2 = FRMX + X2    Y2 = FRMY + Y2  BEND:ELSE BEGIN    TMPX1 = X1    X1 = FRMX + FRMW - X2 - 1    Y1 = FRMY + Y1    X23% = FRMX + FRMW - TMPX1 - 1    Y2 = FRMY + Y2  BEND  RETURN'-------------------.CHECK╞BOX╞COLLISION'-------------------  'PRINT "";CHR$(27);"Q";P╞X1;P╞Y1;P╞X2;P╞Y2  'PRINT CHR$(27);"Q";O╞X1;O╞Y1;O╞X2;O╞Y2;  'GET KEY A$  IF NOT ((O╞X1 > P╞X2)3& OR _          (O╞X2 < P╞X1) OR _          (O╞Y1 > P╞Y2) OR _          (O╞Y2 < P╞Y1)) THEN _  BEGIN    RET% = 1  BEND:ELSE BEGIN    RET% = 0  BEND  RETURN'---------.LOAD╞SONG'---------  DOPEN #2,(SONG$),R,U8  ' LOAD MELODY CHUNKS  ' ----3'--------------  INPUT #2, CHUNK╞CNT  FOR CHUNK╞IDX = 0 TO CHUNK╞CNT - 1    FOR VIDX=0 TO 5      INPUT #2,V$(VIDX, CHUNK╞IDX)    NEXT VIDX  NEXT CHUNK╞IDX  INPUT #2,TMPO%    ' LOAD ENVELOPES  ' --------------  FOR ROW = 0 TO 9    INPUT #2, EN4 VS╞NAME$(ROW)    INPUT #2, ENVS╞ATTACK(ROW)    INPUT #2, ENVS╞DECAY(ROW)    INPUT #2, ENVS╞SUSTAIN(ROW)    INPUT #2, ENVS╞RELEASE(ROW)    INPUT #2, ENVS╞WAVEFORM(ROW)    INPUT #2, ENVS╞PW(ROW)    GOSUB SET╞ENV  NEXT ROW  PRINT  ' LOAD FILTER P4RESETS  ' -------------------  FOR ROW = 0 TO 10    INPUT #2, FILT╞NAME$(ROW)    INPUT #2, FILT╞FREQ(ROW)    INPUT #2, FILT╞LP(ROW)    INPUT #2, FILT╞BP(ROW)    INPUT #2, FILT╞HP(ROW)    INPUT #2, FILT╞RES(ROW)    INPUT #2, FILT╞DIR(ROW)    INP4UT #2, FILT╞MIN(ROW)    INPUT #2, FILT╞SWEEP(ROW)  NEXT ROW  ' LOAD SEQUENCE  ' -------------  SEQCNT = 0  INPUT #2, SEQCNT  ROW = 0  DO WHILE ROW < SEQCNT    INPUT #2, SEQ╞CHUNK(ROW)    INPUT #2, SEQ╞EXTRA(ROW)    ROW = ROW + 1  LOOP  DC4LOSE #2  CHUNK╞IDX = 0  RETURN'-------.SET╞ENV'-------  ENVELOPE ROW, ENVS╞ATTACK(ROW), ENVS╞DECAY(ROW), ENVS╞SUSTAIN(ROW), ENVS╞RELEASE(ROW), ENVS╞WAVEFORM(ROW), ENVS╞PW(ROW)  RETURN'--------------------.PARSE╞CURRENT╞SEQPTR'-------------4-------  RET% = 0  IF RPLAY(1)<>0 THEN RET%=1:RETURN  K = SEQ╞CHUNK(PLYPTR)    IF K >= 0 THEN BEGIN    CHUNK╞IDX = K    IF CHUNK╞RPT <= 0 THEN CHUNK╞RPT = SEQ╞EXTRA(PLYPTR)    GOSUB PLAY╞CHUNK╞IDX    'SLEEP .1    RET% = 1  BEND  IF K = цмд╞т4емпо THEN BEGIN    K = SEQ╞EXTRA(PLYPTR)    TEMPO (K)    TMPO% = K  BEND  IF K = цмд╞филтер THEN BEGIN    K = SEQ╞EXTRA(PLYPTR)    FSROW = K    FSEL = K    GOSUB APPLY╞SELECTED╞FILTER  BEND  IF K = цмд╞ецхо╞м1 THEN ECHO╞M = 1 : ECHO╞DELAY = 04  IF K = цмд╞ецхо╞м2 THEN ECHO╞M = 2 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞б  THEN ECHO╞B = 1 : ECHO╞DELAY = 0  IF K = цмд╞ецхо╞офф THEN ECHO╞M = 0 : ECHO╞B = 0  IF K = цмд╞ецхо╞сз THEN ECHO╞SZ = SEQ╞EXTRA(PLYPTR)  IF K = цмд╞делаы THEN ECHO╞DELAY = 1 : 4ECHO╞M = 0 : ECHO╞B = 0  IF K = цмд╞жол THEN V = SEQ╞EXTRA(PLYPTR) : VOL V, V  IF CHUNK╞RPT > 0 THEN CHUNK╞RPT = CHUNK╞RPT - 1  IF CHUNK╞RPT <= 0 THEN PLYPTR = PLYPTR + 1  IF K = цмд╞лооп THEN PLYPTR = 0  IF PLYPTR >= SEQCNT THEN PLYFLAG = 0 : 4PLYPTR = -1  RETURN'--------------.PLAY╞CHUNK╞IDX'--------------  V1$ = V$(0,CHUNK╞IDX)  V2$ = V$(1,CHUNK╞IDX)  V3$ = V$(2,CHUNK╞IDX)  V4$ = V$(3,CHUNK╞IDX)  V5$ = V$(4,CHUNK╞IDX)  V6$ = V$(5,CHUNK╞IDX)  IF ECHO╞DELAY = 1 THEN BEGIN    PLA4	Y V1$    SLEEP (ECHO╞SZ)    PLAY ,V2$    SLEEP (ECHO╞SZ)    PLAY ,,V3$    SLEEP (ECHO╞SZ)    PLAY ,,,V4$    SLEEP (ECHO╞SZ)    PLAY ,,,,V5$    SLEEP (ECHO╞SZ)    PLAY ,,,,,V6$    SLEEP (ECHO╞SZ)    RETURN  BEND  IF ECHO╞M = 0 AND ECHO╞B = 4
0 THEN BEGIN    PLAY V1$, V2$, V3$, V4$, V5$, V6$    RETURN  BEND  IF ECHO╞M = 1 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$, V2$, V3$,    , V5$, V6$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$  BEND  IF ECHO╞M = 1 AND ECHO╞B = 1 THEN BEGIN    PL4AY V1$, V2$, V3$,    , V5$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$,    , V3$  BEND  IF ECHO╞M = 2 AND ECHO╞B = 0 THEN BEGIN    PLAY V1$,    , V3$,    ,    , V6$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$    SLEEP (ECHO╞SZ)    PLAY    ,4 V1$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    ,    , V1$  BEND  IF ECHO╞M = 2 AND ECHO╞B = 1 THEN BEGIN    PLAY V1$,    , V3$    SLEEP (ECHO╞SZ)    PLAY    ,    ,    , V1$    SLEEP (ECHO╞SZ)    PLAY    , V1$,    ,    ,    , V3$    SLEEP (ECHO╞S4Z)    PLAY    ,    ,    ,    , V1$  BEND  RETURN'---------------------.APPLY╞SELECTED╞FILTER'---------------------  IF FSEL = -1 THEN RETURN  CURR╞FREQ = FILT╞FREQ(FSEL)  CURR╞DIR = дир╞ноне  IF   FILT╞DIR(FSEL) = дир╞уп _    OR FILT╞DIR(F4SEL) = дир╞осц THEN BEGIN    CURR╞FREQ = FILT╞MIN(FSEL)    CURR╞DIR = дир╞уп  BEND  IF FILT╞DIR(FSEL) = дир╞довн THEN BEGIN    CURR╞DIR = дир╞довн  BEND  FILTER 1, FILT╞FREQ(FSEL), FILT╞LP(FSEL), _          FILT╞BP(FSEL), FILT╞HP(FSEL), FILT╞RES w(FSEL)  FILTER 2, FILT╞FREQ(FSEL), FILT╞LP(FSEL), _          FILT╞BP(FSEL), FILT╞HP(FSEL), FILT╞RES(FSEL)  RETURN                                                                                                                                        4IDX)<3 THEN BEGIN      INC(FRAMEIDX) = INC(FRAMEIDX) + .2 * INC╞DIR(FRAMEIDX)      IF INC(FRAMEIDX) < .6 THEN BEGIN        INC╞DIR(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF INC(FRAMEIDX) > 2.9 THEN BEGIN        INC╞DIR4(FRAMEIDX) = -1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF BCNT(FRAMEIDX) = 2 AND INC(FRAMEIDX) > 1 THEN BEGIN        INC(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND    BEND    BEND  NEXT FRAMEIDX    RETURN4'----.INIT'----  BANK 0:BLOAD "ASMHELPER":BANK 128  LOGO╞STATE = 0  GOSUB STORE╞DEFAULT╞COLOURS  INC╞DIR(3) = -1  INC(3) = 1  ' CLEAR DMA LIST AREA  FOR K = 0 TO 20    POKE $40000+K, 0  NEXT K  POKE $40000, $81 ' OPT = DEST ADDR мб SELE5CTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $00 ' цмд LSB = цопы4O6HD IR AA#AHA IR A O6D #F QE I#F QD  Q.#F.EDO6.G.#FE O5G I#A O6 QE O5I#A O6QE QDIR QC.R QDIR QC.R  V1$(3)=V1$(3)+"O6Q.G.#FE O5G I#A O6QE O5I#A O6QE QDIR QC.R QDIR QC.R QDIR QC.R QDIR QC.R"  ' *** VOICE2 - GUITAR2 ***  ' ------------------------  V24$(0)="T2O5M4 QAIR Q#G.R QAIR Q#G.R QAIR Q#G.R QAIR Q#G.R"  V2$(1)="T2O5M4 QAIR Q#G.R QAIR Q#G.R  O5 Q.#C .D O6I#FD O5D#FAO6Q.D IO5A#F  EGBO6Q.E O5IBG EAO6#CQ.E I#CO5A EGBO6Q.E O5IBG EAO6#CQE ID#CD"  V2$(2)="T2O5M4 QAIR Q#G.R QAIR Q#G.R  IAAO6CO5Q.AIGA 4Q.FHG IR IFQF HG IR IAAO6CO5HA IR  AAO6CO5Q.AIGA Q.FHG IRFQF HG IR Q.E .A O6E "  V2$(3)="T2O5M4 IGG#G HG IR Q.D HG IR DDGHD IR DDAQGIAQD Q.A.G#F .#A .A G  O5QEIGQ#AIG#AO6C QAIR Q#G.R QAIR Q#G.R Q.#A .A G O5QEIGQ#AIG#AO6C"  V2$(3)=V2$(3)+"QAIR Q#G.R QAI4R Q#G.R QAIR Q#G.R QAIR Q#G.R"  ' *** VOICE3 - BASS ***  ' ---------------------  V3$(0)="X1T7O2M1 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A   O2ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  V3$(1)="X1T7O2M1 ID QR P1 ICD QR ICD SF#F QD QR IR O1A T8 O2Q.4#CQD IDE#F Q.#F O1A IA O2Q#C O1Q.E E IEBG Q.A A IA O2QC Q.E E IE O1 QB Q.A A O2IE QA"  V3$(2)="X1T7O2M1 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  V3$(2)=V3$(2)+"T9O2IDDDDDDDD O1#A#A#A#A#A#A#A#A #A#A#A#A#A#A#A#A O2DDFQDIDDDDDDDDDDD O1#A#A#A#A#A#A#A#A #4A#A#A T8O2QCICCC O1Q.AAIAAA"  V3$(3)="O2Q.DDIDDD O1Q.GGI#AA#A Q.#A#AI#AQ#A Q.AAIAQA O2Q.DDIO1GO2QD Q.EEIEQE O1Q.AAIAQA T7O2 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  V3$(3)=V3$(3)+"O2Q.EEIEQE O1Q.AAIAQA T7O2 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A  T47O2 ID QR P1 ICD QR ICD SF#F QD IR O1AO2CO1A"  ' *** VOICE4 - MELODY ***  ' -----------------------  V4$(0)=""  V4$(1)="T4O5P0 QR M2ID M4QD P5 M1O4#G H.A IAQA   O5Q.E H#F IR #F#FA QG IG#F W M5 .G P9M2O4IA O5I.B.A SG#F AGABAB QG O4IAB O5H#F SG#F Q.E.4D"  V4$(2)="O5T4P7WDHRQ.RICP5O5IDDFQ.GIFDQ.FSEDHCIFFAQGIFDSCP2H.DP5I.RICDDFQ.GIFD Q.F SED HC IFFAQGIFD IGP1H.A P7IRA"  V4$(3)="T4 IO6DD#DQDICO5#AH.#AQ.R IAA#AQAIAGP1WAP7IR"  V4$(3)=V4$(3)+"HRI#FGAQ.GI#FG#FHERIR DHDRR IR#FGAQ.GI#FG#FHERIR DHD"  RETURN4'---------.POLL╞PLAY'---------  IF RPLAY(1) THEN RETURN  MUSIC╞CHUNK╞INDEX=MAP╞BAR╞TO╞CHUNK(BAR╞INDEX)    PLAY V1$(MUSIC╞CHUNK╞INDEX),V3$(MUSIC╞CHUNK╞INDEX),V4$(MUSIC╞CHUNK╞INDEX)  SLEEP .05  PLAY ,,,V2$(MUSIC╞CHUNK╞INDEX),V3$(MUSIC╞CHUNK╞INDE _X),V4$(MUSIC╞CHUNK╞INDEX)  BAR╞INDEX=BAR╞INDEX+1  IF BAR╞INDEX=5 THEN BAR╞INDEX=1  RETURN                                                                                                                                                                 P╞IDX-1,16)+16    PRINT MID$(RAINBOWSTR$,RAIN╞IDX,1);  NEXT RAIN╞IDX  RETURN                                                                                                                                                                               4 ~L~LБ~LКLя│L╩┐L└Lш└L≈┘x█/┬╘ █.┬╘ ┘┘┘╘┘╜.┬█0┬╜/┬█1┬╒Ю П╜1┬j█1┬╜0┬j█0┬йпНё шё Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬█4┬╘П█5┬ ~┤шЗ² яшё"Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬█4┬╘П█5┬ ~┤шЗ² ршё$Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬█4┬╘П█5┬ ~┤шЗ² сб сtЪX`x█/┬╘ █.┬╘ ┘┘┘╘┘╜.┬█04 ┬╜/┬█1┬╒Ю П╜1┬j█1┬╜0┬j█0┬йпНё шё&Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬шё Й╡┘)Й╡┘*ШЙ╡) h┤█5┬╘ █4┬ ~┤шЗ² яшё(Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬шё"Й╡┘)Й╡┘*ШЙ╡) h┤█5┬╘ █4┬ ~┤шЗ² ршё*Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬шё$Й╡┘)Й╡┘*ШЙ╡) h┤█5┬╘ █4┬ ~┤шЗ² сб с5ЪX`╘ ┘┘┘╘┘╜я4!█9┬╜р█:┬╜с█;┬╒╫я² я╫р² р╫с² сХЮпИ╜9┬█я╜:┬█р╜;┬█сёшё&Й╡┘)Й╡┘*ШЙ╡)█9┬шё(Й╡┘)Й╡┘*ШЙ╡)█:┬шё*Й╡┘)Й╡┘*ШЙ╡)█;┬ёшё&Й╡┘)Й╡┘*ШЙ╡);Й▓)шё(Й╡┘)Й╡┘*ШЙ╡);Й▓)шё*Й╡┘)Й╡┘*ШЙ╡);Й▓)бп╤ёшё&Й╡┘)Й╡┘*Ш╜9┬Й▓)шё(Й╡┘)Й╡┘*Ш╜:┬Й▓)шё*Й╡┘)Й╡4"┘*Ш╜;┬Й▓)ёшё Й╡┘)Й╡┘*ШЙ╡)█9┬шё"Й╡┘)Й╡┘*ШЙ╡)█:┬шё$Й╡┘)Й╡┘*ШЙ╡)█;┬ёшё Й╡┘)Й╡┘*ШЙ╡);Й▓)шё"Й╡┘)Й╡┘*ШЙ╡);Й▓)шё$Й╡┘)Й╡┘*ШЙ╡);Й▓)бп╤ёшё Й╡┘)Й╡┘*Ш╜9┬Й▓)шё"Й╡┘)Й╡┘*Ш╜:┬Й▓)шё$Й╡┘)Й╡┘*Ш╜;┬Й▓)`█G┬╘ █F┬▌I┬█H┬▄J┬╘ ┘┘┘┘┘┘┘╘┘4#┘ ┘!╘Ь┘"╘┘#шё,Й╡┘Й╡┘Шё Й╡█=┬Й╡█<┬шё.Й╡┘Й╡┘Шё Й╡█?┬Й╡█>┬шё0Й╡┘Й╡┘Шё Й╡█A┬Й╡█@┬шё2Й╡┘Й╡┘Шё Й╡█C┬Й╡█B┬шё4Й╡┘Й╡┘Шё Й╡█E┬Й╡█D┬╜H┬█K┬╜I┬█L┬╜A┬`╜L┬мG┬0
п╜K┬мF┬╜F┬█K┬╜G┬█L┬╘ █8┬8╜L┬МG┬█7┬шё ═ ╒ ╜7┬BB█pв╜J┬BB█tвBB╜xв▌4%8┬█7┬Ш╜<┬m7┬█M┬╜=┬m8┬█N┬╜@┬█O┬╜A┬█P┬╜J┬█Q┬╘ █R┬╘f█S┬ Ф├╜>┬m7┬█M┬╜?┬m8┬█N┬╜B┬█O┬╜C┬█P┬╜J┬█Q┬╘ █R┬╘Ъ█S┬ Ф├╘P█7┬╘ █8┬8╜@┬М7┬█@┬╜A┬М8┬█A┬8╜B┬М7┬█B┬╜C┬М8┬█C┬╜K┬мF┬п	╜L┬мG┬п`8╜K┬МD┬█K┬╜L┬МE┬█L┬L╓┌`x█/┬╘ █.┬╘ ┘┘┘╘┘╜.┬█0┬╜/┬█1┬╒Ю П╜1┬j█1┬╜0┬j█0┬й V"б" ╖ °:П "STARFIELD" %|┴ 180 H%├≥ "⌠AUTOLOAD ";г(34);Z$;г(34):°:П "11BOOT.C65"                                                                                                                                                                            4&пНё шё Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬█4┬█5┬ ~┤шЗ² яшё"Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬█4┬█5┬ ~┤шЗ² ршё$Й╡┘)Й╡┘*ШЙ╡) h┤█3┬╘ █2┬█4┬█5┬ ~┤шЗ² сб сzЪX`╘ ┘┘┘╘┘шё6Й╡┘)Й╡┘*Шё шё8Й╡┘Й╡┘Ш╘┘╘ ┘═ 8Й╡)ЙРЙ▓);Й╡)ЙРЙ▓)iPЙ▓)хюпш`█=┬╘ █<┬╘O█J┬╘O█Q┬╘ █4'R┬╘ █7┬█8┬╘ ┘┘┘╘┘╘ ┘┘┘╘┘═ ╜<┬m7┬█O┬╜=┬m8┬█P┬╜O┬█M┬╜P┬█N┬╜M┬i█M┬╜N┬i █N┬ +┤╜O┬┘╜P┬┘ёO╘ Й▓╜N┬i█N┬╜P┬i█P┬ +┤╜O┬┘╜P┬┘ёO╘ Й▓╜7┬iP█7┬╜8┬i █8┬хю2сЪ`╘ ┘┘┘╘┘ё╘Й▓ё╘Й▓╘ █M┬╘@█N┬╘ █O┬╘ █P┬╘═█Q┬╘█R┬╘ █S┬ Ф├╘ █M┬╘P█N┬╘ █O┬╘█P┬╘ █5S┬ Ф├╘ █M┬╘ █N┬╘ █O┬╘ █P┬╘ █S┬ Ф├╘ █M┬╘0█N┬╘ █O┬╘█P┬╘ █S┬ Ф├ё╘Й▓ё╘Й▓╘═█Q┬╘█R┬╘ █M┬╘ █N┬╘ █O┬╘█P┬ +┤ё╘ЪЙ▓ё╘Й▓ё╘Й▓ё╘Й▓╘ █M┬╘█N┬╘ █O┬╘ █P┬ Ф├ё╘ Й▓ё╘Й▓ё╘Й▓ё╘Й▓╘ █M┬╘ █N┬╘ █O┬╘ █P┬ +┤╘█M┬╘ █N┬╘ █O┬╘█P┬ +┤ё╘ Й▓ё╘Й▓`ё	╜M┬Й5 ~L~Lэ~LЕLк│L÷┐Lc└x█к┘╘ █й┘╘ ┘┘┘╘┘╜й┘█л┘╜к┘█м┘╒Ю П╜м┘j█м┘╜л┘j█л┘йпНё шё Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘█п┘╘П█я┘ ┘шЗ² яшё"Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘█п┘╘П█я┘ ┘шЗ² ршё$Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘█п┘╘П█я┘ ┘шЗ² сб сtЪX`x█к┘╘ █й┘╘ ┘┘┘╘┘╜й┘█л┘╜к┘█м5THEN CHR = 27:RETURN ' EXCLAMATION  IF CHR = 44 THEN CHR = 28:RETURN ' COMMA (SMILEY)  IF CHR = 47 THEN CHR = 29:RETURN ' FORWARD SLASH (LOVE HEART)  IF CHR = 35 THEN CHR = 30:RETURN ' # HASH (DHUFISH)  IF CHR >= 1 AND CHR <= 26 THEN CHR = CHR + 30 5
┘╒Ю П╜м┘j█м┘╜л┘j█л┘йпНё шё&Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘шё Й╡┘)Й╡┘*ШЙ╡) ┘█я┘╘ █п┘ ┘шЗ² яшё(Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘шё"Й╡┘)Й╡┘*ШЙ╡) ┘█я┘╘ █п┘ ┘шЗ² ршё*Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘шё$Й╡┘)Й╡┘*ШЙ╡) ┘█я┘╘ █п┘ ┘шЗ² сб с5ЪX`╘ ┘┘┘╘┘╜я█у┘╜р5 RETURN'---------------.TRANSPARENT╞DMA'---------------  WPOKE $40009, SRC╞ADDR  WPOKE $4000C, DEST╞ADDR  WPOKE $40007, LENGTH  POKE  $40004, TRANSP  POKE $D702, 4 ' DMA LIST IN BANK 4  POKE $D701, $00 ' DMA LIST MSB  POKE $D705, $00 ' DMA LI5ST LSB  RETURN'------------------.SCROLL╞CANVAS╞LEFT'------------------  FOR YY = 0 TO 49    EDMA оп╞цопы+дст╞дец+срц╞дец, _           79, $52000 + YY*80 + 78, $52000 + YY*80 + 79    POKE $52000 + YY*80, 32   NEXT YY  RETURN'------------- р------.SCROLL╞CANVAS╞RIGHT'-------------------  OFFS(FIDX%) = OFFS(FIDX%) + 1  IF FIDX% = 0 THEN ADDR = $20  ' $52000  IF FIDX% = 1 THEN ADDR = $40  ' $54000  BANK 0:SYS $7E12, ADDR: BANK 128  RETURN                                             5▓╜N┬Й▓ё╜O┬Й▓╜P┬Й▓ё╜Q┬Й▓╜R┬Й▓ё╜S┬Й▓╘█в╘ █в╘ █в`ё	╜M┬Й▓╜N┬Й▓ё╜O┬Й▓╜P┬Й▓ё╜Q┬Й▓╜R┬Й▓╘█в╘ █в╘█в`╙)



█6┬┼)ПJJJJ6┬`╜5┬м3┬░R8╜4┬М2┬█7┬╜5┬М3┬█8┬шё ═ ╝8┬╜7┬BB█pв╝1┬╜0┬BB█tвBB╜xв▌7┬▄8┬Ш╜2┬m7┬█7┬╜3┬m8┬█8┬L'┬8╜2┬М4┬█7┬╜3┬М5┬█8 o┬шё ═ ╝8┬╜7┬BB█pв╝1┬╜0┬BB█tвBB╜xв▌7┬▄8┬Ш8╜2┬М7┬█7┬╜3┬М8┬█8┬╜8┬ h┤`                                          █в╘ █в╘█в`╙)



█6┬┼)ПJJJJ6┬`╜5┬м3┬░R8╜4┬М2┬█7┬╜5┬М3┬█8┬шё ═ ╝8┬╜7┬BB█pв╝1┬╜0┬BB█tвBB╜xв▌7┬▄8┬Ш╜2┬m7┬█7┬╜3┬m8┬█8┬L'┬8╜2┬М4┬█7┬╜3┬М5┬█85	6 REM CUR╞CHAR = :AB: 107 REM PIX = :AC: 108 REM DIFFX = :AD: 109 REM DIFFY = :AE: 110 REM DELTAX = :AF: 111 REM DELTAY = :AG: 112 REM TANVAL = :AH: 113 REM ANGLE = :AI: 114 REM ANG = :AJ: 115 REM LINE╞LENGTH = :AK: 116 REM K = :AL: 117 REM DE5BUG = :AM: 118 REM CENTREX = :AN: 119 REM CENTREY = :AO: 120 REM CENTREZ = :AP: 121 REM PX = :AQ: 122 REM PY = :AR: 123 REM PLEN = :AS: 124 REM PANG = :AT: 125 REM PIDX = :AU: 126 REM PDIST = :AV: 127 REM SQANG = :AW: 128 REM CB╞ANGA = :AX: 15█ж┘╜с█в┘╒╫я² я╫р² р╫с² сХЮпИ╜у┘█я╜ж┘█р╜в┘█сёшё&Й╡┘)Й╡┘*ШЙ╡)█у┘шё(Й╡┘)Й╡┘*ШЙ╡)█ж┘шё*Й╡┘)Й╡┘*ШЙ╡)█в┘ёшё&Й╡┘)Й╡┘*ШЙ╡);Й▓)шё(Й╡┘)Й╡┘*ШЙ╡);Й▓)шё*Й╡┘)Й╡┘*ШЙ╡);Й▓)бп╤ёшё&Й╡┘)Й╡┘*Ш╜у┘Й▓)шё(Й╡┘)Й╡┘*Ш╜ж┘Й▓)шё*Й╡┘)Й╡┘*Ш╜в5┘Й▓)ёшё Й╡┘)Й╡┘*ШЙ╡)█у┘шё"Й╡┘)Й╡┘*ШЙ╡)█ж┘шё$Й╡┘)Й╡┘*ШЙ╡)█в┘ёшё Й╡┘)Й╡┘*ШЙ╡);Й▓)шё"Й╡┘)Й╡┘*ШЙ╡);Й▓)шё$Й╡┘)Й╡┘*ШЙ╡);Й▓)бп╤ёшё Й╡┘)Й╡┘*Ш╜у┘Й▓)шё"Й╡┘)Й╡┘*Ш╜ж┘Й▓)шё$Й╡┘)Й╡┘*Ш╜в┘Й▓)`█Ц┘╘ █Б┘▌Е┘█Д┘▄Ф┘╘ ┘┘┘┘┘┘┘╘┘┘ ┘!╘Ь5┘"╘┘#шё,Й╡┘Й╡┘Шё Й╡█ы┘Й╡█ь┘шё.Й╡┘Й╡┘Шё Й╡█ш┘Й╡█з┘шё0Й╡┘Й╡┘Шё Й╡█щ┘Й╡█э┘шё2Й╡┘Й╡┘Шё Й╡█ъ┘Й╡█ч┘шё4Й╡┘Й╡┘Шё Й╡█А┘Й╡█Ю┘╜Д┘█Г┘╜Е┘█Х┘╜щ┘`╜Х┘мЦ┘0
п╜Г┘мБ┘╜Б┘█Г┘╜Ц┘█Х┘╘ █т┘8╜Х┘МЦ┘█с┘шё ═ ╒ ╜с┘BB█pв╜Ф┘BB█tвBB╜xв▌т┘█с┘Ш5╜ь┘mс┘█И┘╜ы┘mт┘█Й┘╜э┘█К┘╜щ┘█Л┘╘f█М┘ ©└╜з┘mс┘█И┘╜ш┘mт┘█Й┘╜ч┘█К┘╜ъ┘█Л┘╘Ъ█М┘ ©└╘P█с┘╘ █т┘8╜э┘Мс┘█э┘╜щ┘Мт┘█щ┘8╜ч┘Мс┘█ч┘╜ъ┘Мт┘█ъ┘╜Г┘мБ┘п	╜Х┘мЦ┘п`8╜Г┘МЮ┘█Г┘╜Х┘МА┘█Х┘L·┌`x█к┘╘ █й┘╘ ┘┘┘╘┘╜й┘█л┘╜к┘█м┘╒Ю П╜м┘j█м┘╜л┘j█л┘йпНё шё Й╡┘)Й╡┘*ШЙ╡) ┘█о┘5╘ █н┘█п┘█я┘ ┘шЗ² яшё"Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘█п┘█я┘ ┘шЗ² ршё$Й╡┘)Й╡┘*ШЙ╡) ┘█о┘╘ █н┘█п┘█я┘ ┘шЗ² сб сzЪX`╘ ┘┘┘╘┘шё6Й╡┘)Й╡┘*Шё шё8Й╡┘Й╡┘Ш╘┘╘ ┘═ 8Й╡)ЙРЙ▓);Й╡)ЙРЙ▓)iPЙ▓)хюпш`ё	╜И┘Й▓╜Й┘Й▓ё╜К┘Й▓╜Л┘Й▓ё╜Ф┘Й▓ё╘ Й▓ё╜М5$┘Й▓╘█в╘ █в╘ █в`╙)



█р┘┼)ПJJJJр┘`╜я┘мо┘░R8╜п┘Мн┘█с┘╜я┘Мо┘█т┘шё ═ ╝т┘╜с┘BB█pв╝м┘╜л┘BB█tвBB╜xв▌с┘▄т┘Ш╜н┘mс┘█с┘╜о┘mт┘█т┘Lц┘8╜н┘Мп┘█с┘╜о┘Мя┘█т┘шё ═ ╝т┘╜с┘BB█pв╝м┘╜л┘BB█tвBB╜xв▌с┘▄т┘Ш8╜н┘Мс┘█с┘╜о┘Мт┘█т┘╜т┘ ┘`                                    529 REM CB╞ANGB = :AY: 130 REM CBIDX = :AZ: 131 REM CBTMP = :BA: 132 REM PZ = :BB: 133 REM CB╞INCA = :BC: 134 REM CB╞INCB = :BD: 135 REM RET╞ANG = :BE: 136 REM ZFACT = :BF: 137 REM DDX = :BG: 138 REM DDY = :BH: 139 REM SX = :BI: 140 REM SY = :B5J: 141 REM E = :BK: 142 REM E2 = :BL: 143 REM QLIDX = :BM: 144 REM QLCNT = :BN: 145 REM QLX1 = :BO: 146 REM QLY1 = :BP: 147 REM QLX2 = :BQ: 148 REM QLY2 = :BR: 149 REM QLVX1 = :BS: 150 REM QLVY1 = :BT: 151 REM QLVX2 = :BU: 152 REM QLVY2 = :BV5: 153 REM QLCLR = :BW: 154 REM  = :BX: 155 REM  = :A%: 156 REM A$ = :A$: 157 REM Z$ = :B$: 158 REM  = :C$: 159 REM  = :A&: 32000 32001 32002 32003 32004 32005 32006 32007 32008 32009 32010Dц:Dс"11TOKENIZED":IFDS<>0THEN?"DISC ERROR: ";D5  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C, $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' цмд MSB (IGNORE)  WPOKE $40010, $0000 ' MODULO (IGNORE)5  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  ' INIT VAR INTERFACE TO ASSEMBLY  LOC = $40020  PTR = POINTER(DEFAULT╞RED&(0))  GOSUB STORE╞PTR  PTR = POINTER(DEFAULT╞GREEN&(0))  GOSUB STORE╞PTR  PTR = POIN5TER(DEFAULT╞BLUE&(0))  GOSUB STORE╞PTR  PTR = POINTER(CURR╞RED&(0))  GOSUB STORE╞PTR  PTR = POINTER(CURR╞GREEN&(0))  GOSUB STORE╞PTR  PTR = POINTER(CURR╞BLUE&(0))  GOSUB STORE╞PTR  PTR = POINTER(DATA╞ADDR%)  GOSUB STORE╞PTR  PTR = POINTER(5CDATA╞ADDR%)  GOSUB STORE╞PTR  PTR = POINTER(SCRADDR%)  GOSUB STORE╞PTR  PTR = POINTER(CLRADDR%)  GOSUB STORE╞PTR  PTR = POINTER(INC%)  GOSUB STORE╞PTR  RETURN'---------.STORE╞PTR'---------  WPOKE LOC, PTR  LOC = LOC + 2  RETURN'---5------.LOAD╞DATA'---------  PTR = $42000    BLOAD "BAS.BIN",P(PTR)  GOSUB INIT╞PETSCII╞FRAMES  GOSUB ╞INCREMENT╞PTR╞TO╞NEXT╞FREE  RETURN'-------------------.INIT╞PETSCII╞FRAMES'-------------------  TMP = PTR  MAX╞FRAMES = PEEK(PTR + оффсет╞5нум╞фрамес)  'PRINT  'PRINT "PTR=";HEX$(PTR + оффсет╞нум╞фрамес)  PTR = PTR + оффсет╞фраме0  'PRINT  'PRINT "- MX╞FRM=";MAX╞FRAMES;": "  FRM╞IDX = 0  DO WHILE FRM╞IDX < MAX╞FRAMES    'PRINT FRM╞IDX;    FRAME╞ADDR%(FRM╞IDX) = MOD(PTR,65536)   5 FRMX = PEEK(PTR + фрм╞оффсет╞ь)    FRMY = PEEK(PTR + фрм╞оффсет╞ы)    FRMW = PEEK(PTR + фрм╞оффсет╞в)    FRMH = PEEK(PTR + фрм╞оффсет╞х)    FRMX1=FRMX+FRMW-1    FRMY1=FRMY+FRMH-1    DATA╞ADDR% = MOD(PTR, 65536)    DATA╞ADDR% = DATA╞ADDR% + фрм╞5оффсет╞дата    CDATA╞ADDR% = DATA╞ADDR% + FRMW * FRMH    BANK 4    FOR Y = 0 TO FRMY1-FRMY      FOR X = 0 TO FRMX1-FRMX        IF PEEK(DATA╞ADDR% + X + Y * FRMW) = 102 THEN BEGIN          POKE (CDATA╞ADDR% + X + Y * FRMW), $FF        BEND      N5!EXT X    NEXT Y    BANK 128        'PRINT "PTR=";HEX$(PTR);", IDX=";FRM╞IDX;", W=";FRMW;", H=";FRMH    PTR = PTR + фрм╞оффсет╞дата + FRMW * FRMH * 2    'PRINT "FRM╞IDX=";FRM╞IDX    FRM╞IDX = FRM╞IDX + 1  LOOP  PTR = TMP  RETURN'----------- 1S$:ELSE?"":Dл"11.POST                                                                                                                                                                                                              5 t  A╡126:B╡124:C╡123:D╡108:E╡254:F╡252:G╡251:H╡236:I╡127:J╡255:K╡98:L╡226:M╡97:N╡225:O╡32:P╡160:Q╡3.141592654269: Ё  ├ AQ(10):├ AR(10):├ BO(10):├ BP(10):├ BQ(10):├ BR(10):█ 78 *! ≥"⌠";:≥"PETLINE EXAMPLE MENU:":≥"--------------------":≥"1) LINES":≥"25) SQUARE":≥"3) MANY SQUARES":≥"4) DRAW CUBE" f! ≥"5) DRAW MANY CUBES":≥"6) QIX LINES":║ЫB$:▀B$╡"1"╖█ 27 w! ▀B$╡"2"╖█ 24 ┬! ▀B$╡"3"╖█ 23 ≥! ▀B$╡"4"╖█ 17 ╙! ▀B$╡"5"╖█ 16 ╩!	 ▀B$╡"6"╖█ 12 у!
 ▀B$╠╡"1"╞B$Ё╡"5"╖║ЫB$ ъ! ┴ 3:─ М! BM╡.:BN╡. q" BO(BM)╡╣(╩6(1)╛160):BP(BM)╡╣(╩(1)╛100):BQ(BM)╡╣(╩(1)╛160):BR(BM)╡╣(╩(1)╛100):BW╡╣(╩(1)╛16)╙64:·32268,1:BN╡BN╙1:R╡BO(BM):S╡BP(BM) ⌡" T╡BQ(BM):U╡BR(BM):█ 28:BM╡н(BM╙1,10) ╕" ┴ 13:▌ Н" BD╡.:│BC╡.╓1.9╛Q╜4╘Q╜16:█ 17:┌BC:BC╡.:│BD╡.╓1.9╛Q╜2╘Q╜16:█ 17:┌BD:▌ Y# AV╡45:A5% (  ├ A&(12000):├ C%(60):├ D%(60):G╡0: h  █ 3:H╡.:I╡.:A$╡",/#":█ 12:H╡.:I╡15:A$╡"дRUM бOOGIE!":█ 12:─ ╨  ≥"⌠";:H╡.:I╡.:A╡270336:█ 10:B╡.:C%(.)╡.:D%(.)╡.:C╡.:D╡.:КЩDЁB%:B&╡A&(D):D╡D╙1 и  ▀B&╡255╖Ч Й  D%(B)╡C:C╡.:B╡B╙1:C%(B)╡D:Ч З  ▀B&╡255╖┴ 9 !5"----------------.╞INCREMENT╞PTR╞TO╞NEXT╞FREE'---------------------------  PTR = TMP  SZ = WPEEK(PTR + оффсет╞дата╞сизе)  'PRINT  'PRINT "INC SZ = ";SZ  'PRINT "PTR = ";HEX$(PTR + оффсет╞дата╞сизе)  PTR = PTR + SZ  'GET KEY A$  RETURN'-------5#-.DRAW╞BAS'--------  FRAMEIDX = фрм╞бацкдроп  FX=-999 : FY = -999  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞б  FX=-999 : FY=FRMY(0)  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞а  FX=-999 : FY=FRMY(1)  MIRROR = 0  GOS5$UB DRAW╞PETSCII╞FRAME  FRAMEIDX = фрм╞с  FX=-999 : FY=FRMY(2)  MIRROR = 0  GOSUB DRAW╞PETSCII╞FRAME  RETURN'------------------.DRAW╞PETSCII╞FRAME'------------------  POKE $4000B, $04  ' ASSURE SOURCE BANK 4 (FOR ORIGINAL FRAME DATA)  IF MIR     ╘█в╘ █в╘ █в`╙)



█р┘┼)ПJJJJр┘`╜я┘мо┘░R8╜п┘Мн┘█с┘╜я┘Мо┘█т┘шё ═ ╝т┘╜с┘BB█pв╝м┘╜л┘BB█tвBB╜xв▌с┘▄т┘Ш╜н┘mс┘█с┘╜о┘mт┘█т┘Lц┘8╜н┘Мп┘█с┘╜о┘Мя┘█т┘шё ═ ╝т┘╜с┘BB█pв╝м┘╜л┘BB█tвBB╜xв▌с┘▄т┘Ш8╜н┘Мс┘█с┘╜о┘Мт┘█т┘╜т┘ ┘`                                    5& B&╡B&╞127:▀B&╠C╖C╡B& #! D╡D╙1:D╡D╙1 +!	 Л:▌ S!
 Ч#2,("ABC.LN"),R,U8:К:║#2,B&:▀ST╖М r! A&(B%)╡B&:B%╡B%╙1:Л:Ч#2:▌  ! │D╡1╓ц(A$):J╡ф(й(A$,D,1)):█ 17:█ 25 ╖! ▀J╡32╖Ч ╠! H╡H╙7 я! Ч:у:Ч:█ 33:H╡H╙D%(J)╙1:Ч з! ┌D:▌ Т! ▀J╠╡0╞JЁ╡31╖J╡J╟128:▌ " ▀J╠5'╡32╞JЁ╡63╖▌ "" ▀J╠╡64╞JЁ╡95╖J╡J╞191:▌ >" ▀J╠╡96╞JЁ╡127╖J╡J╞223:▌ Z" ▀J╠╡128╞JЁ╡159╖J╡J╟64:▌ w" ▀J╠╡160╞JЁ╡191╖J╡J╞191:▌ ■" ▀J╠╡192╞JЁ╡254╖J╡J╞127:▌  " ▌ ╢" ▀J╠╡65╞JЁ╡90╖J╡J╚65:▌ е" ▀J╡46╖J╡26:▌ ж" ▀J╡33╖J╡27:▌ Г" ▀J╡44╖J╡28:▌ Ь" ▀J╡47╖J╡29:▌ 	6 # ▀J╡35╖J╡30:▌  # ▀J╠╡1╞JЁ╡26╖J╡J╙30 &#  ▌ w#! A%╡C%(J):КЩA%ЁB%╞A&(A%)Ё╠255:B&╡A&(A%):A%╡A%╙1:E╡B&╞127:▀B&╞128╖≥"";:у≥"▓"; ╤#" F╡A&(A%):A%╡A%╙1:B$╡г(A&(A%)):A%╡A%╙1:ЧAH╙E,I╙F:█ 36:Ч.02 ╬## Л:▌ и#$ ≥B$;:▌ ы#% ▐ PTR = :A: Н#& ▐ CHAR╞CNT = :B: $' ▐ MAX6╞WIDTH = :C: $( ▐ TXT╞K = :D: $$) ▐ X = :E: 2$* ▐ Y = :F: D$+ ▐ DEBUG = :G: S$, ▐ XX = :H: b$- ▐ YY = :I: r$. ▐ CHR = :J: $/ ▐  = :K: ▓$0 ▐ PIDX% = :A%: ╔$1 ▐ DIDX% = :B%: ╪$2 ▐ CHAR╞IDX% = :C%: у$3 ▐ CHAR╞WIDTH% = :D%: Ц$4 ▐  = :E%: С$5 ▐ S$ = :A$: %6 ▄  ├ A%(25):├ V(3):├ W(3):AK╡0:├ AL(3):├ AM(3):├ C$(2):AU╡0:C$(.)╡"PRESENTS...":C$(1)╡"A SONG BY...":AV╡53341:├ A&(32):├ B&(32):├ C&(32): ╛  ├ D&(32):├ E&(32):├ F&(32): е  █ 52:█ 59:█ 4:█ 31:─ о  AJ╡TI э  ▀AD╡0╖Ч М  █ 76:AD╡1:Ч З  ▀AD╡1╖Ч 2!6 Ч128:≈53280,1,1:█ 29:█ 30:█ 75:█ 78:█ 80:AW╡.:AC╡. >!	 AD╡2:Ч K!
 ▀AD╡2╖Ч [! ▀AWЁ╡128╖Ч ┐! Ч.:ЧT10:·32259,AW:Ч128:AW╡AW╙1:Ч ╜! Ч.:·32262:Ч128:AC╡AC╙1:▀AC╡130╖AD╡3 ╢! Ч а! ▀AD╡3╖Ч У! █ 31:Ч.:·32262:Ч128:AC╡AC╙1:▀AC╠250╖AD╡4:AW╡. Э! Ч6 	" ▀AD╡4╖Ч +" █ 83:Ч.:·32262:Ч128:AC╡AC╙1 :" ▀AC╠360╖Ч ]" Ч.:·32268,AW:Ч128:AW╡AW╙1:Ч l" ▀AW╡128╖Ч ╫" ≈53280,.,.:≥"⌠";:█ 78:│AW╡.╓128:Ч.:ЧT10:·32259,AW:Ч128:AW╡AW╙1:┌AW:AD╡5:Ч д" Ч я" ▀AD╡5╖Ч Г" ≥"ANATHEMA!";:Ч Ш" К:ЛЩ(TI╚AJ)Ё.063 # ┴ 4:▌ +# ≈53272,б(53272)╞253:≥г(27);"5";:▌ L# M╡3:N╡╚999:O╡╚999:P╡.:█ 69:▌ Y# ▀AK╡.╖Ч р#  AM(.)╡6:AM(1)╡23:AM(2)╡6:R(.)╡╚44:R(1)╡╚69:R(2)╡╚107:AK╡1:W(.)╡1:V(.)╡1:W(1)╡1:V(1)╡1:W(2)╡1:V(2)╡1:W(3)╡1:V(3)╡1:Ч ъ#! ▀AK╡1╖Ч О#" AN╡.:│A╡.╓2 $# ▀R(A6─
║ 
║─ ─╛─
  
║─	  ╩ 	╪─ ─ ─  	╬ ╒─	 ─	╬ 
╬─
   
╛ ─║─   ╪─ ─╩ ╩─ ─╒ ╩─ ─  ╪─╒ ╒ ╒─╒─╒─╬─ ─ 	─╛ ╛	─ 	 ╛
 ╬
─ 
 
╛ ╬─
╬─
  	╛─
╒─	╬─	 ─	  ╛─	╛ ╒─╬─	╒─  ╛─╒ ╒─6╬─╒─ ─╒─╪─╒─╒ ╒─╒ ╒ ╒─╒ ╒─╩─  	╪─╪─	╒ ╒─	╩─	 ─
  
║─  
╛─ ─╒─ ─╪─╩─ ─╒ 
╩─
  
╪ 	║─	 ─ ─ ─  ╩─  ╪ ║─  ╪ ╩─ ─ ─  ╒ ╒─ ─  ╬─╬─ ─╬─  ╬─ ─║─ ─║6─
  
║─╩─╪ ╪─  ╩─  ║─╩─ ─ ─╪─╩─ ─  ║─║─ ─  ╩─  ║─║─  ╪─  ╩─  ║─  ║─  ║─  ║─  ╬─ ─  ╛─╬─  ╬─ ─╬  ╬─  ─ ╬─!╛─!  !╒─"╛─"  "╛─#╬─#╛─$  $║─%╩─% ─%╛─$╬─6	$╛─#  #╛─" ─! ─ ╪─! ─    ╪ ╒%─║&─╪&─	╛%─	╬%─
╒$─	 $ 
╪# 	╪#─║$ ║# ╛$─ $ ╛%─ %─╒&─╪&─╩'─╪'─╩( ║'─	║( 	║'─
║( 
║'─║(─ '─║(─╛'─╬( ║'─ & ╛&─ ' ║&─ %─║&─╛%─║%─ & ║%─ & ║%─ & ║%─╩&─╪&─ ' ╩&─╩'─╪& ╪'─ '─╩( ║6
'─║(─ (─ ) ║(─║)─╪)─ )─ * ╩)─║* ║)  ╪*─  *─! + !╩*─"╩+ "║*─#║+─# +─$ +─% * %╛+ &╬*─& )─& )─%╛( &╪(─%║(─$║)─$ ( #╛)─# *─#╩)─"╬*─" ) !╛+ !║+─  *─╪+─ , ╬+─ , ║+─ , ║+─ , ╩+─ * ╪+─ *─║+─ *─║* ╛+─ , ╬+─╬,─╛, ╒-─ - ╛.─╒. ╒/─6╒/─╬0─ 0─╒1 ╒1─╒2 ╒2─╒3 ╩3─ 4─ 4 ╪5 ╒5─ 6 ╩6 ╩5─╩6 ║5─║6 ║5─╬6 ║5─ 4 ╛5 ╬4─ 3 ╛4 ╬3─ 2 ╛3─╛2─ 3 ╬2─ 1─ ║2─  1─!║2─! 1─"║2─" 1 #╪2─# 2─$╩3─$╪3─% 4─%╪3 &╪4─&╒5─&╒5─% 6 %║5─$║6─$ 6─#╪5─#╩5 "╒4 "╒4─#╛3─#╬3─$ < ╒< ╪= ╒=─╒6>─╬> ╬?─ @─ @ ╒A ╩A─ B─ B ╪C─╪C─╒D─ D─╬E ╬E─ F─╛E ╛F─ F─ G ║F─ F─╪E ╪E─╪D─╩D ╒C─ C─╒B─ B─╒A ╒A─ @─ @─╛? ╛?─ >─╬?─╛>─ = ╛>─╛=─ < ╛<─ =─╛<─ =─╪; ╛<─╛;─╬;─ < ╬;─ : ╛:─ ║;─  :─!║;─! : "╪;─" ;─#╩<─#╪<─$ ; 6$╪=─$╪< %╪=─%╩>─% ?─% ?─&╒@─&╒@─% A─% B─% B $╛C─%╒C─$╬D─$ E $╬D #╛E─# F #╬E─" F "║F !╩E─! E  ╩D─! D  ╒C─! C─" B─"║B #╪C─# D #╒E─$ F─#╪F─$ G─$ G─#╬H─# H─$╒I─# I "╛J─#╒J─"╬K─"╛K !╒L "╬L─! h ╒h─ h ║g─║g─ f ╛f─╒f ╒e─╒e─╪d─╩d─╬e─╛e ╒f─ f─╬g─╛6f─╩f─╛e─╬e ╬d ╒d─╒c─╒c ╒b ╪b─ a─╩a─╪`─ _─╒_ ╒^─ ]─ \─ \ ╒[─ Z ╒Z─╒Y─ X ╒X─ Y ╬W─╬W─ X ╬V ╛W ║V─ V─	 W 	║V─
 W 
║V─║W─╪W─ W ╪X ╩X─ Y─╪Y─╩Z─ Z─╩[ ╩[─ [ ╪\ ╩\─ ]─╪]─╩^─ ^ ╪_ ╩_─╩`─╪`─╩a─ a─╩b─╪b─ c─6╪b ╪c─ d ╩c─║d─ d─ d─║e ╩e ║d─║e─ d─║e─ d─║e─ d─║e ║d─ c ╛d─╛c─ b ╛c─ ╛b─  a  ╒b !╬a─! `─! ` "╬_ !╒_─"╛^─" ]─" ]─#╒\─#╒\─" [─" [─!╪Z "╪Z─!║Z─  [  ║Z─ [ ║Z─ Z─ Y ╪Y─ Z ╩X─╒X─╪W─╩W ╩V ╒V─ U ╛U ╪V─ V─╩W ╩W─ X─ X─╒6Y─ Y─ Z ║Y─ X─╩Y─╪X─ W─╒X ╩W─ V ╪W ╩V─ U ╪U ╛V ╩l─ l─║m ║l─ k─╬k─╒j─╒j─ i ╪j─ k─╒j ╛k─ k ╒l─ l─╬m ╬m─╛m─ n ║m 
╛n─
 o 
╬n─	╬o 	║l─╬m ╩l ╬k ╪k─ j ╪j ╛k─ k ╛l─╒l─ m─╪m─ n ╩m─ n ║m─║n ║m─ n ╬m─ m─ l 6╛m ║l─║l─║m ║l─ l─ l─ l─ ╛k─ ╬k─! k─"╒l─" m─" n─"╒n─! n─ ╪m─  l─  l !║k─" k─# k─$║l $║t─ s ╪t─╬u─╪u─ v ║u─ v ╬u─╛t─╬t ╬s─╒s ╒r ╪r─╪q─ q─╪p ╪p─╩p─ q ║p─║q─ q─╬r ╬r─ r ╛s ╬s─ s ╛t─╒t─ u─ u─╒v ╩v─╩w─╪v ╪w─ x ╩6w─ x ║w─║x ║w─║x ║w─║x ║w─║x─ w─	║x─	 w─
║x─
 w─║x ║w─╬x ║w─ x ╬w─ v ╛w─ v─║w─╤v─║v─ w ║v─ w ╬v─ u ╛u─║v─ u─║v─ u─╬v─ u─ v ║u─ v ║u─ v ╬u─ t ╛u─ t─║u─ t─║u─ t─║u─ t─║u─ t─║u─  t─ ║u─! t─!║u─" t "╪v "╩u─6#╩v─# w─# w─$╒x─# x "╒y #╬y─" z─"╛y !╛z─! z─  z─ y ╪z─╪y─ x─ x─╛w ╛w─ w─  x─ ╪w !╪x !╬~ ╪─  ╪──╪──╒│─╒│ ╒┌ ╒┌─╒┐─╬┐─╒└─ ┘─╛┘ ╛├─ ├ ╛┤─╛┤─ ┬─╛┬─ ┤ ╛┬─ ┤─╩┬ ╒┤─ ├─ ├ ╒┘─ └ ╒└─╛┐─ ┐ ╬┌─╬┌─ │─╬┌ ╬│─ ──╬── │ ╬6 ╛─ ──╛─ ─ ~─║~─║ ║~─║ ║~─║─ ─  ─  ╒──!╒│  ╒│─! ┌─! ┌  ╒┐─  ┐─!╒└─  └ ╒┘  ╬┘─ ├─╛├ ╒┤─ ┬─╛┤ ╛┬─ ┴ ║┴ ║┬─ ┬ ╩┤─ ┤ ╛├─ ├─╛┘ ╛┘─ ┘─╩├─ ├─ ┤─ ┬─╪┤─ ╒┬─ ╒█─╬▌─╪▌─╩▐ ║▌─ ▐ ╬█─╬█─╒▄─╒▄─╪▀ ╪▀─╩▀ ╛▄─ ▄─╬█─6 █ ╒▌─ ▐ ╒▐─╛░ ╩░─╩▒─╪▒─ ▓ ║▒─ ▓ ║▒─ ░ ╛▒─╛░─╬░─ ░─╛▐─║▐─ ░ ╬▐─ ▌ ╛▌─║▐ ║▌─ ▐ ╬▌─ ▌─ █ ╛▌─╛█─║▌  ║█─ ║█─! █ "╬▄ "╪▄─!╪▀ !╪▄  ║▀─ ║▀ ╛▄─ █─╩▄ ╛█─╬▐ ║▐─ ░ ╬▐─ ░─╛░─ ▒ ╬░─╪▒─ ▒ ╛▓─╒▓─ ⌠─╛⌠─╬■─╛■ ╒∙─ ∙ ╬6∙ ╛√─╬√─╛≈─ ≈ ╬≤─ ≤ ╒≥─ ≥ ╒  ╒ ─ ⌡ ║ ─║⌡─  ─║⌡─  ─ ⌡ ║≥─╬ ─ ≥─   ╬≤ ╛≤─ ≥─╛≈ ╛≤─╛≈─╬≈─ √ ╛√─ ≈─╛√─ ∙─║∙─ ║√  ║∙ !╪√─! ≈─! ≈  ╛≤ !╬≤─  ≥  ╬≤─ ≥ ║≤ ╒≈─ ∙ ╒∙─ ■─╬■─ ╛⌠─ ║⌠─! ⌠─"╒²─╪° ╛²─╛°─ ⌡─╒°─ ⌡─ ⌡─ °─╛⌡─ c6 ▐ A$ = :B$: %7 ▐ Z$ = :C$: !%8 ▐  = :D$: 5%9 ▐ LDATA& = :A&: G%: ▐ VAL& = :B&: U%; ▐  = :C&:                                                                                                                                                               6Z╡.:AY╡а(1╜╨(2)):│AX╡Q╜4╓1.9╛Q╘Q╜2:BA╡AV╛╬(AY):BB╡BA╛©(AX):AR(AZ)╡AV╛©(AY):AQ(AZ)╡BA╛╬(AX):█ 21 м# █ 22:AQ(AZ)╡AN╙AQ(AZ)╚BB╛BF╜4:AR(AZ)╡AO╙AR(AZ)╙BB╛BF:AZ╡AZ╙1:┌AX:AS╡4:█ 26:AZ╡.:AY╡╚а(1╜╨(2)):│AX╡Q╜4╓1.9╛Q╘Q╜2 >$ R╡AQ(AZ):S╡AR(AZ):BA╡AV╛╬(AY):BB╡BA╛©(6AX):AR(AZ)╡AV╛©(AY):AQ(AZ)╡BA╛╬(AX):█ 21:█ 22:AQ(AZ)╡AN╙AQ(AZ)╚BB╛BF╜4 ┬$ AR(AZ)╡AO╙AR(AZ)╙BB╛BF:T╡AQ(AZ):U╡AR(AZ):█ 28:AZ╡AZ╙1:┌AX:AS╡4:█ 26:▌ з$ AD╡AQ(AZ):AE╡BB:BA╡╨(AD╛AD╙AE╛AE):█ 29:AI╡AI╙BC:AQ(AZ)╡BA╛╬(AI):BB╡BA╛©(AI):▌ 4% AD╡AQ(AZ):AE╡AR(AZ):BA╡6╨(AD╛AD╙AE╛AE):█ 29:AI╡AI╙BD:AQ(AZ)╡BA╛╬(AI):AR(AZ)╡BA╛©(AI):▌ Q% │AW╡.╓Q╜2╘Q╜8:█ 24:┌AW:▌ у% AV╡45:AT╡AW╚3╛Q╜4:AQ(.)╡AN╙AV╛╬(AT):AR(.)╡AO╙AV╛©(AT):AT╡AW╚Q╜4:AQ(1)╡AN╙AV╛╬(AT):AR(1)╡AO╙AV╛©(AT):AT╡AW╙Q╜4:AQ(2)╡AN╙AV╛╬(AT) '& AR(2)╡AO╙AV╛©(AT):AT╡AW╙3╛6Q╜4:AQ(3)╡AN╙AV╛╬(AT):AR(3)╡AO╙AV╛©(AT):AS╡4:█ 26:▌ ■& │AU╡.╓AS╚2:R╡AQ(AU):S╡AR(AU):T╡AQ(AU╙1):U╡AR(AU╙1):█ 28:┌AU:R╡AQ(AS╚1):S╡AR(AS╚1):T╡AQ(.):U╡AR(.):█ 28:▌ щ& │AJ╡.╓2╛Q╘Q╜8:R╡80:S╡50:T╡╣(80╙30╛╬(AJ)):U╡╣(50╙30╛©(AJ)):█ 28:┌AJ:▌ E' ·32259:R╡н(╣(R)6╙256,256):S╡н(╣(S)╙256,256):T╡н(╣(T)╙256,256):U╡н(╣(U)╙256,256):·32265,R,S,T,U:▌ R' ▀AD╡.╖Ч d' ▀AEЁ.╖AI╡╚Q╜2 u' ▀AE╠.╖AI╡Q╜2 ▓'  Ч:уЧ:AH╡AE╜AD:AI╡а(AH) ÷'! ▀ADЁ.╖Ч ╨'" ▀AEЁ.╖AI╡AI╚Q:уAI╡AI╙Q а'# Ч х'$ Ч н'% ▌ Ч'& Ч.:·32262,н(Z╙256,256),н(A7A╙256,256),5:▌ (' ▀ZЁ.╟Z╠159╟AAЁ.╟AA╠99╖▌ v(( V╡╣(Z╜2):W╡╣(AA╜2):X╡н(╣(Z),2):Y╡н(╣(AA),2):AB╡б(264192╙V╙W╛80):█ 45:▀X╡.╞Y╡.╖AC╡AC╟1 ▀() ▀X╡1╞Y╡.╖AC╡AC╟2 ═(* ▀X╡.╞Y╡1╖AC╡AC╟4 ╣(+ ▀X╡1╞Y╡1╖AC╡AC╟8 р(, █ 61:≈264192╙V╙W╛80,AB:▌ Х(- AC╡.:▀AB╡A╖AC╡1:▌ Ы(. ▀6)ЁAM(A)╖Ч )$$ R(A)╡R(A)╙2:▀R(A)╠AM(A)╖R(A)╡AM(A) 0$% Ч J$& ▀R(A)╡AM(A)╖AN╡AN╟2╝A T$' ┌A:Ч i$( █ 67:█ 75:│M╡.╓2 ─$) ▀AN╞2╝M╞AO(M)Ё3╖Ч √$* V(M)╡V(M)╙.2╛W(M) ╕$+ ▀V(M)Ё.6╖Ч б$, W(M)╡1:AO(M)╡AO(M)╙1:Ч с$- ▀V(M)╠2.9╖Ч П$. W(M)╡╚1:AO(M)╡AO(M)╙1:Ч %/ ▀6$AO(M)╡2╞V(M)╠1╖Ч #%0 V(M)╡1:AO(M)╡AO(M)╙1:Ч *%1 Ч 1%2 Ч :%3 ┌M:▌ ╕%4 Ч.:Ч"ASMHELPER":Ч128:AD╡.:█ 77:W(3)╡╚1:V(3)╡1:│A╡.╓20:≈262144╙A,.:┌A:≈262144,129:≈262145,0:≈262146,7 %&5 ≈262147,134:≈262148,32:≈262149,0:≈262150,0:Ч262151,0:Ч262153,4096:≈26216 ╬°─ ²─ ² ╒· ╒·─ ÷ ╒÷─ ═ ╩═─ ═─ ║ ║═ ╪║─ ║─╩╒─╪╒─╩ё─ ё ╪╓─ ╓─╒╔ ╒╔─ ╕─ ╕ ╒╖─ ╖ ╬╗─ ╗ ╛╘ ╬╘─╛╘─ ╘ ╩╗ ╒╗─╛╖─╬╖─ ╕─║╕─ ╔─╬╕ ╬╔─╛╓─ ё ╪╓ ╩ё─ ё─ ╓─╛ё ╛╓─ ╔─╛╓ ╛╔─╬╕─ ╕─ ╖ ║╕─║╖─ ╖─ ╕─╩╖─ ╕─╬╖ ║╕─ 6!╖ ║╕─ ╔─	║╕─	 ╔─
 ╕ 
║╔─ ╓─║╓─║╔─╛╓─ ╔ ╬ё ╛╓─╛ё─║╓ ║ё─ ё─ ╓ ╬ё─ ╒─ ╒─ ╒─ ё─╛╒─ ё ║╒─ ё ╬╒─ ║ ╛╒─ ║─║╒─╛║─║║─║╒ ║║─║╒ ║║─║╒ ║║─║╒ ║║─║╒ ║║─║╒ ║║─║╒ ║║  ╪╒─  ╒─!╩ё  ╩ё─! ё─"╒╓─"╒╓─! ╔─! ╓  ╛╔─  ╕  ║╔─ ╕ ╩╔ ╒╓─6" ╓─╒ё ╒ё─╛╒─ ║─ ║║─! ╒─! ║─" ═ "╛║─#╛═─#║║ $╬═ $╪л ╒л─╛к─ й─ й─ и ╪и ╛й─╬к ╬к─ л─╒л ╒к ╛м─ н ╩м ╪н─ н─ о ║м─╬н─ н ╬м─╛л─ к─ к─╒й─╬й─╛и─ и ╒х─╒х ╒г─╒г─╪ф─ ф ╩е ╪е─ д─╩д─╪ц─ ц ╒б─╒б ╒а─ ю─ ю ╒©─ ©─╒╬─╬6#╬─ ╫─╬╬ ╬╫─ ╪─╬╫ ╬╪─ ╩ ╛╪─╛╩─╬╪ ╬╩─ ╨ ╛╩─	 ╨─	╬╩ 
║╨─
 ╨─ ╩ ╬╨─ ╧─║╨─ ╧─║╨─╛╧─║╨ ║╧─║╨ ║╧─║╧─ ╨ ╬╧─ ╧─ ╧─ ╦─║╧─ ╦─║╧─ ╦─║╧ ║╦─║╧ ║╦─║╧ ║╦─║╧ ║╦─║╧ ║╦─║╧ ║╦─║╧─╪╦─║╦ ╪╧─ ╧─ ╨ ╩╧─ ╩╨─ ╪╨─! ╩ !╩╨ "╪╩─"╩╪─6%" ╫─#╒╫─"╪╬ "╒╬─#╒©─#╒© "╒ю─#╒ю "╒а─" а #╬а !╛б─" б !╒ц─"╒ц─!╬д─! д  ╒е─  е !╬ф ╒ф─ ╛г─ г─ ╒х─ и─ ╒и─╪й ╒й─ ╩к─ ╪й─!║к─! й─"╬к─" к─#╛й─# и─# и─$╒х─# г─#╩г─" х "╩г─!╬х─! и !╩и "╬╨─ ╨ ╛╩ ╒╩─ ╪ ╩╪─ ╫─ ╬─╪╬─╒© ╒©─╒ю ╒ю─╒а ╒а─ б─ ц─ ц ╛6&55,5:Ч262156,4096:≈262158,5:≈262159,0:Ч262160,0 ├&6 Ч!3,4000,32,327680:Ч!3,4000,.,331776:AP╡262176:B╡н
(A&(.)):█ 58:B╡н
(B&(.)):█ 58:B╡н
(C&(.)) к&7 █ 58:B╡н
(D&(.)):█ 58:B╡н
(E&(.)):█ 58:B╡н
(F&(.)):█ 58:B╡н
(B%) '8 █ 58:B╡н
(E%):█ 58:B╡н
(C%):█ 58:B7&д─╛д─╬е─ е─╩ф ╬ф─╪е─╬ф─ ф─ г ╩ф─ ф─ ф ╩г ╬е─╩ф ╬е─╪е─╒д─╬е ╒д─╒о─ о ╛п─╪п─ о─ о─╒н─ н ╩м ╪м─ м─ н─╒м ╛н─ о─ п─ п ╒я─ р ╩я ╪р─ р─║с ║с ║р─║с ║р─║с ║р─ р─ р─ р─ р─ р─ р ║я─║р ║я─║р  ║я─ ╬я─! р !╬п 6'╡н
(D%):█ 58:B╡н
(F%):█ 58 '9 ▌ '': ЧAP,B:AP╡AP╙2:▌ Q'; B╡270336:Ч"BAS.BIN",P(B):█ 60:█ 66:▌ ╦'< C╡B:D╡б(B╙2):B╡B╙3:E╡.:КЩEЁD:A%(E)╡н(B,65536):Q╡б(B╙0):R╡б(B╙1):F╡б(B╙2):G╡б(B╙3):S╡Q╙F╚1:T╡R╙G╚1 к'= B%╡н(B,65536) Ь'> B%╡B%╙20:E%╡B%╙F╛G:Ч4:│Y╡.╓T╚R:7│X╡.╓S╚Q (? ▀б(B%╙X╙Y╛F)╡102╖Ч '(@ ≈(E%╙X╙Y╛F),255:Ч R(A ┌X:┌Y:Ч128:B╡B╙20╙F╛G╛2:E╡E╙1:Л:B╡C:▌ l(B B╡C:H╡н(B╙0):B╡B╙H:▌ е(C M╡3:N╡╚999:O╡╚999:P╡.:█ 69:M╡0:N╡╚999:O╡R(.):P╡.:█ 69:M╡1:N╡╚999:O╡R(1):P╡.:█ 69:M╡2 Б(D N╡╚999:O╡R(2):P╡.:█ 69:▌ )E ≈2621557 Ц─╒Д ╩Д─ Д─ Е ║Д─ Е ║Д─ Д─ Ц ╛Ц─ Д ║Ц─ Д ╬Ц─ Б ╛Б─║Ц ║Б─╬Ц ║Б─ Ц ╬Б─ Б─  А  ╛Б !║А─!║А─"╬Б "╬А─# А─$ Б─$╪А %╪Б─%╒Ц─%╒Ц─$╬Д─$ Д─#╬Е $╬Е─#╛Е─" Е─! Е  ║Д─  Д─!╛Ц  ╛Ц─!╬Ц─"╒У ║Т─╩Т─ У ╩Т─ С ╪Т ╩С─ С ╩Р─ Р─╒Я─ Я─╒П─ П─╛7О ╒О─ Н─ Н ╬М ╒М─ Л─╬Л─ М ╬К─╬Л ╬К─ Й ╛К─╛Й─╬Й─ Й─ И─║Й ║И─║Й ║И─ И─ И─ Х─║И  ║Х─ ║И─!╪Х !╪И─" Й "╩И─#╩Й─# Й $╪К─#╪К─$ Л─#╬Л─$╛М─# М "╒Н─" Н─#╒О─" О─!╬П "╬П─!╛П─  Я─ ╛П ╛Я─ Р─╛Я ╛Р─ С─╛Р ╛С─ Т─╛С ╛Т─ У ╬Т ╛У─ У─╬Ж 7AB╡B╖AC╡2:▌ 
)/ ▀AB╡C╖AC╡4:▌ )0 ▀AB╡D╖AC╡8:▌ -)1 ▀AB╡E╖AC╡14:▌ ?)2 ▀AB╡F╖AC╡13:▌ Q)3 ▀AB╡G╖AC╡11:▌ b)4 ▀AB╡H╖AC╡7:▌ s)5 ▀AB╡I╖AC╡9:▌ └)6 ▀AB╡J╖AC╡6:▌ √)7 ▀AB╡K╖AC╡12:▌ ╖)8 ▀AB╡L╖AC╡3:▌ ╦)9 ▀AB╡M╖AC╡5:▌ й): ▀AB╡N╖AC╡10:▌ э); ▀AB╡P╖AC╡15:▌ Б)< ▌ С)= ▀AC╡.7╖AB╡O:▌ *> ▀AC╡1╖AB╡A:▌ *? ▀AC╡2╖AB╡B:▌ &*@ ▀AC╡3╖AB╡L:▌ 7*A ▀AC╡4╖AB╡C:▌ H*B ▀AC╡5╖AB╡M:▌ Y*C ▀AC╡6╖AB╡J:▌ j*D ▀AC╡7╖AB╡H:▌ {*E ▀AC╡8╖AB╡D:▌ ▄*F ▀AC╡9╖AB╡I:▌ ·*G ▀AC╡10╖AB╡N:▌ ╟*H ▀AC╡11╖AB╡G:▌ б*I ▀AC╡12╖AB╡K:▌ т*J ▀AC╡13╖AB╡F:▌ Ф*K ▀AC╡14╖AB╡E:▌ Ь*L7 ▀AC╡15╖AB╡P:▌ Ч*M ▌ E+N Ч.:Ч"MEGAPLOT":·32259:AN╡80:AO╡50:≥г(27);"5";г(147);:BF╡╬(Q╜4):▌ X+O ▐ пиь╞тл = :A: k+P ▐ пиь╞тр = :B: ~+Q ▐ пиь╞бл = :C: ▒+R ▐ пиь╞бр = :D: ╗+S ▐ пиь╞инж╞тл = :E: ©+T ▐ пиь╞инж╞тр = :F: ж+U ▐ пиь╞инж╞бл = :G: М+V ▐ пиь╞инж╞бр 7= :H: ,W ▐ пиь╞диаг╞тл╞бр = :I: #,X ▐ пиь╞диаг╞бл╞тр = :J: =,Y ▐ пиь╞хлине╞бот = :K: W,Z ▐ пиь╞хлине╞топ = :L: r,[ ▐ пиь╞жлине╞лефт = :M: ▌,\ ▐ пиь╞жлине╞ригхт = :N: ё,] ▐ пиь╞ноне = :O: ╥,^ ▐ пиь╞алл = :P: ф,_ ▐ пи = :Q: у,` ▐ X1 = :R: Д,a ▐ Y1 = :S: С7,b ▐ X2 = :T: -c ▐ Y2 = :U: -d ▐ DX = :V:  -e ▐ DY = :W: /-f ▐ MX = :X: >-g ▐ MY = :Y: M-h ▐ CX = :Z: ]-i ▐ CY = :AA: s-j ▐ CUR╞CHAR = :AB: └-k ▐ PIX = :AC: ≈-l ▐ DIFFX = :AD: ╙-m ▐ DIFFY = :AE: ╬-n ▐ DELTAX = :AF: р-o ▐ DELTAY = :AG: Ф-p ▐ TANVAL = :A7H: Ы-q ▐ ANGLE = :AI: 
.r ▐ ANG = :AJ: #.s ▐ LINE╞LENGTH = :AK: 2.t ▐ K = :AL: E.u ▐ DEBUG = :AM: Z.v ▐ CENTREX = :AN: o.w ▐ CENTREY = :AO: └.x ▐ CENTREZ = :AP: ■.y ▐ PX = :AQ: ╓.z ▐ PY = :AR: ╤.{ ▐ PLEN = :AS: х.| ▐ PANG = :AT: з.} ▐ PIDX = :AU: М.~ ▐ P8	DIST = :AV:  / ▐ SQANG = :AW: /─ ▐ CB╞ANGA = :AX: */│ ▐ CB╞ANGB = :AY: =/┌ ▐ CBIDX = :AZ: P/┐ ▐ CBTMP = :BA: `/└ ▐ PZ = :BB: u/┘ ▐ CB╞INCA = :BC: ┼/├ ▐ CB╞INCB = :BD: ÷/┤ ▐ RET╞ANG = :BE: ╡/┬ ▐ ZFACT = :BF: ц/┴ ▐ DDX = :BG: т/┼ ▐ DDY = :BH: Д/▀ ▐ SX = 7
 ├  ├ A%(20):├ A(20):├ B%(20):├ B&(2,12288):├ C%(2):C%╡0:├ D%(2):D%╡0:E%╡0:├ E&(2):E&╡0:├ C(2):├ D(2):├ I(2):├ F%(60):├ G%(60):AH╡0: ▐  █ 16 ╕  AB╡TI:AA╡AA╙1:█ 51 ╪  ▀AA╠╡70╞AAЁ800╖Ч м  E%╡.:█ 56:Ч П  █ 53:▀AA╠850╞AAЁ950╖E%╡.:█ 100 Ъ  ▀AA╠300╖Ч7 ! E%╡1:█ 56:▀AA╠2630╖█ 100 #!	 Ч 0!
 ▀AH╡.╖Ч V! D$╡"иN DREAMLAND...":AF╡1:AH╡1:Ч c! ▀AH╡1╖Ч t! E%╡2:█ 28:Ч █! █ 52:КЩ(TI╚ABЁ.03):Л ≈! ┴ 3:─ " AA╡.:Ч.:Ч"ASMHELPER":Ч128:≈53272,б(53272)╞253:≥г(27);"5";:≥"⌠";:≈53280,.,.:│B╡.╓20:A%(B)╡╣(╩(71)╛80)╛256 ░" A(B)╡╣(╩(1)╛50):B%(B)╡(╩(1)╛4╙.5)╛256:┌B:Ч!3,4000,32,327680:Ч!3,4000,.,331776:Ч!3,4000,32,335872:Ч!3,4000,.,339968:Ч!3,4000,32,344064 З" Ч!3,4000,.,348160:A$╡"ANA.LN":E%╡.:D(E%)╡1:█ 47:A$╡"SILENT.L":E%╡1:D(E%)╡2:█ 47:≈262144,129:≈262145,07 x# ≈262146,7:≈262147,134:≈262148,32:≈262149,0:≈262150,0:Ч262151,0:Ч262153,4096:≈262155,5:Ч262156,4096:≈262158,5:≈262159,0 ╧# Ч262160,0:█ 21:Y╡262198:Z╡н
(A%(.)):█ 46:Z╡н
(B%(.)):█ 46:▌ #$ AF╡.:Q╡.:R╡.:A$╡"ABC.LN":E%╡2:D(E%)╡3:█ 47:AD╡.:F%(.)╡.:G%7(.)╡.:AE╡.:B╡.:КЩBЁC%(E%):A&╡B&(E%,B):B╡B╙1 2$ ▀A&╡255╖Ч Y$ G%(AD)╡AE:AE╡.:AD╡AD╙1:F%(AD)╡B:Ч j$ ▀A&╡255╖┴ 27 ┘$ A&╡A&╞127:▀A&╠AE╖AE╡A& ∙$ B╡B╙1:B╡B╙1 ²$ Л:▌ ╧$ ▀AI╡.╞AF╠.╞AFЁ╡ц(D$)╖Ч в$ S╡ф(й(D$,AF,1)):█ 82:█ 90 Д$ ▀S╡32╖Ч Ж$ Q╡Q╙7:AF╡AF╙17 %  Ч:у:Ч:AI╡1:AJ╡S:D%(E%)╡F%(S):Ч #%! Ч 0%" ▀AI╡1╖Ч >%# S╡AJ:█ 40 K%$ ▀AG╡1╖Ч l%% Q╡Q╙G%(AJ)╙1:AF╡AF╙1:AI╡.:Ч s%& Ч y%' ▌ ┌%( AG╡1 ╚%) ▀D%(E%)ЁC%(E%)╞B&(E%,D%(E%))Ё╠255╖Ч Т%* A&╡B&(E%,D%(E%)):D%(E%)╡D%(E%)╙1:J╡A&╞127:▀A&╞128╖E&(E%)╡1:уE&(E%)╡.7 R&+ K╡B&(E%,D%(E%)):D%(E%)╡D%(E%)╙1:B$╡г(B&(E%,D%(E%))):D%(E%)╡D%(E%)╙1:N╡Q╙J:O╡R╙K:█ 76:AG╡. Y&, Ч _&- ▌ q&. ЧY,Z:Y╡Y╙2:▌ ~&/ ▀A$╡""╖▌ ╔&0 █ 50:Ч#2,(A$),R,U8:К:║#2,A&:▀ST╖М ь&1 B&(E%,C%(E%))╡A&:C%(E%)╡C%(E%)╙1:Л:Ч#2:█ 54:▌ '2 G╡╚1:H╡╚1:I(E%)╡.:C%(7E%)╡.:C&╡.:E&(E%)╡.:C(E%)╡.:▌ ='3 │B╡.╓20:≈327680╙A%(B)╜256╙A(B)╛80,46:┌B:▌ T'4 Ч.:·32271:Ч128:▌ p'5 ЧT10:Ч.:·32277:Ч128:▌ ²'6 ≥"⌠";:C(E%)╡.:D%(E%)╡.:▀E╡1╖D%(E%)╡F:E╡. ё'7 ▌ ╧'8 ▀D%(E%)ЁC%(E%)╖Ч ч'9 A&╡B&(E%,D%(E%)):D%(E%)╡D%(E%)╙1 У': ▀D(E%)╡3╞A&╡2755╖Ч (; ▀D%(E%)╠F╖F╡D%(E%) (< ┴ 44:Ч %(= J╡A&╞127 5(> ▀D(E%)╡2╖Ч s(? J╡A&:A&╡B&(E%,D%(E%)):D%(E%)╡D%(E%)╙1:J╡J╙(A&╞127)╛256:Ч ▓(@ ▀A&╞128╖E&(E%)╡1:уE&(E%)╡. з(A K╡B&(E%,D%(E%)):D%(E%)╡D%(E%)╙1:B$╡г(B&(E%,D%(E%))):D%(E%)╡D%(E%)╙1 Й(B ▀D(E%)╡2╖Ч Щ(C7 ▀J╚C(E%)╠78╖Ч )D █ 100:D%(E%)╡D%(E%)╚4:▌  )E Ч ')F Ч B)G N╡J╚C(E%):O╡K:█ 76:P╡. N)H ▀P╡1╖Ч ⌠)I ≥"";г(27);"Q X,Y,PIDX,A$,OFFS=";J;K;D%(E%),ф(B$),C(E%):║ЫB$:Ч  )J Ч ╙)K J╡J╚C(E%):▌ м)L S╡ф(B$):█ 82:▀E&(E%)╡1╖S╡S╙128 щ)M ▀D(E%)╡1╖Ч *N ≈335872╙N╙7O╛80,S:≈339968╙N╙O╛80,1:Ч *O ▀D(E%)╡2╟D(E%)╡3╖Ч G*P ≈344064╙N╙O╛80,S:≈348160╙N╙O╛80,2:Ч M*Q ▌ g*R ▀S╠╡0╞SЁ╡31╖S╡S╟128:▌ z*S ▀S╠╡32╞SЁ╡63╖▌ ∙*T ▀S╠╡64╞SЁ╡95╖S╡S╞191:▌ ╠*U ▀S╠╡96╞SЁ╡127╖S╡S╞223:▌ м*V ▀S╠╡128╞SЁ╡159╖S╡S╟64:▌ О*W ▀S╠╡160╞SЁ╡191╖S╡(S╞127)8╟64:▌ +X ▀S╠╡192╞SЁ╡254╖S╡S╞127:▌ +Y ▌ ,+Z ▀S╠╡65╞SЁ╡90╖S╡S╚65:▌ =+[ ▀S╡46╖S╡26:▌ N+\ ▀S╡33╖S╡27:▌ _+] ▀S╡44╖S╡28:▌ p+^ ▀S╡47╖S╡29:▌ │+_ ▀S╡35╖S╡30:▌ ≤+` ▀S╠╡1╞SЁ╡26╖S╡S╙30 ·+a ▌ Й+b Ч262153,U:Ч262156,V:Ч262151,W:≈262148,X:≈55042,4:≈55041,0:≈55045,07╬Ж─╛Ж─ В ╬Ж─║В─╛Ж─║В─ Ж─╩В─ В─╪Ж─ У─╬У─ У ║Т─ Т─ Т─ С─║Т─╪С─║С─║Т─ Т─╛С─ С─║Т ║С─ ║Т  ║Т !║С─!║С─" Т "║С─# Т #║С─$ Т $╬С─% С─& С─' Р '╛Р─(║С─( Р─)║С─)╛Р─*║С *║Р─+╬С +║Р─, Я─-╬Р─-╛Я─. П .╛Я─/╛П─/ П─0╒О /╛О─0 Н─0 Н─1╒М─1╒М 0╒Л─1╒7Л─0 К─0 К /╩Й─0╒Й─/ И─/╩И─. Й .╩И─- Х─-║И─, Й ,╬И─+║Й─+ Й *╒К─+ К *╒Л─+╪Л─, М ,╬К ,╛Л -╬К─- Й─- Й .║Х─- Х .╪Г─- Ф─-╩Ф ,╒Е─-╒Е─, Д─,║Э ╬Э─ Щ─╪Щ─ Щ─╛Э─╬Э─╒Ш─╒Ш─╪З─║З─ З─ Ш ╬З─╬Ш─╛Ш ╒Э ╬Э─ Щ─╛Э ╛Щ ╒Ч ╩Ч─╩Ъ ╩Ъ─ Ъ─ Ъ─ Ъ─ Ъ─ Ч ╛Ч─7║Ъ─ Ч─║Ъ ║Ъ ║Ч─║Ч─║Ъ ║Ч─ Ч─ Ч─ Ч─  Щ─ ║Ч─! Щ─!║Ч "║Щ─"║Ч #║Щ─#║Щ─$ Щ %╬Э─$╪Э─%╒Ш─$╩Ш─# Ш─" Ш─! Э !║Ш─ ║Э─ ╛Ш ╛Э─ Э─ Щ ╬Э─║Щ─╛Э ╛Щ─ Ч─╩Щ─ Ч─ Щ─║Ч─ Ч─╬ │╛ │ │╛ ╛│ │ │╬│ ╬╛│ │╒│ │╒│╪│ │ ║│ ║7,4:▀P╡1╖Ч-ЧN262150,5:у°ЧN262150,5 [)F B%╡A%(M):Ч4:Q╡б(B%╙0):R╡б(B%╙1):F╡б(B%╙2):G╡б(B%╙3):Ч128:▀NЁ╠╚999╖Q╡N l)G ▀OЁ╠╚999╖R╡O ╤)H S╡Q╙F╚1:T╡R╙G╚1:C%╡0╙Q╙(R╙G╚1)╛80:D%╡4096╙Q╙(R╙G╚1)╛80:▀P╡1╖D%╡D%╙F╚1 *I B%╡B%╙20:E%╡B%╙F╛G:F%╡V(M)╛256:Ч.:·32265,н(R╙257│╩║│║║│║║│║║│ ║│ ║│ ║│ │  │! │!║│" │"║│# │#║│$╛│$ │%╒│%╒│$╪│$ │# │" "║│!╬!║│ ║│ ╛│ ╬│║│╛│╬│ │ │╪╬│╛│ │╬	│ 	╬	│ 
│╛	╛
│ │ ╒│ │╒│╒│ ╩│ ╩│╩│7 │║│ │║│ │ │ │ │║│╛│║║│║║│║ ║│  │! │" │# #╛│$╛│$╬│% %╬│&╛│& │%╪&╪│% │$╬$║│#║│# │"╬│" !╛│"╒│!  ╒│! │! "╪!╩│" "╩#╪│ │╩╩│ ╩│╒│╪│ │╒│ │╛│╬│ │╬╬│ │╬7│╛│ ╛│╛│╬│ ╬│ ╛│╛│║│ ╬│  │! │" │# #║$╪│$ %╪│$ │%╒│%╒│$ %╬│$ │#╬$╬│#╛│" "╬│!╬│!╛│ ╬│ ╛│╬│╛│ ╬╛│ │╬ ╬ │╛ │ !╬ │║!║ │║!│ !╩ │╩ │╪│║│  │ │╛│╬│ │╛│║│╪│ ┬║│║│ │  │! │! │" │# │$ │% │%╪&╪│&╩│&╛│%  %║│$╬ │$  │# │#╩ "║│" "╛│# $╬$╛│%╬│& &╛│' '╪(╪│(╛'╩ ╛│ ╬│ ╛│╬│╛│ ╬╛│ │╬ ╬ │╛ │ !╬ │║!║ │║!│ !╩ │╩ │╪│║│  │ │╛│╬│ │╛│║│╪│76,256),н(T╙256,256),F:▌ P*J Ч262153,I:Ч262156,J:Ч262151,K:≈262148,L:≈55042,4:≈55041,0:≈55045,0:▌ ╛*K Ч!.,4000,327680,264192:Ч!.,4000,331776,267911168:Ч!3,4000,32,327680:Ч!3,4000,.,331776:▌ ы*L │AW╡.╓128:Ч.:ЧT10:·32256,AW:Ч128:┌AW:▌ +M │A╡.╓31:A&(A7)╡б(53504╙A):B&(A)╡б(53760╙A):C&(A)╡б(54016╙A):┌A:▌ a+N │A╡.╓31:D&(A)╡б(53504╙A):E&(A)╡б(53760╙A):F&(A)╡б(54016╙A):┌A:▌ v+O │AC╡.╓32╛4:┌AC:▌ И+P │A╡12╓21:AE╡218╙(27╚218)╛(A╚12)╜9:█ 82:A&(A)╡AE:A&(43╚A)╡AE:AE╡137╙(66╚137)╛(A╚12)╜9:█ 82:B&(A)╡AE:B&(43╚A)╡A7 E !,Q AE╡0╙(11╚0)╛(A╚12)╜9:█ 82:C&(A)╡AE:C&(43╚A)╡AE:┌A:▌ L,R AG╡AE╞15:AF╡(AEЧS4)╞15:AE╡(AGЧR4)╙AF:▌ [,S ▀AC╡330╖Ч ┐,T AU╡1:AR╡.:Ч!3,80,32,264192╙80╛46:Ч ≤,U ▀ARЁц(C$(AU))╖Ч и,V AR╡AR╙.25:B$╡х(C$(AU),AR):▀AU╡.╖AS╡35:уAS╡33 ш,W AT╡46:█ 89:Ч А,X ▌ -Y 7!ЧAAS,AT:│AQ╡1╓ц(B$):Ч9н(AQ╚1,16)╙16:≥й(B$,AQ,1);:┌AQ:▌ +-Z ▐ K = :A: ;-[ ▐ PTR = :B: K-\ ▐ TMP = :C: b-] ▐ MAX╞FRAMES = :D: v-^ ▐ FRM╞IDX = :E: ┤-_ ▐ FRMW = :F: ≤-` ▐ FRMH = :G: ╖-a ▐ SZ = :H: ╪-b ▐ SRC╞ADDR = :I: р-c ▐ DEST╞ADDR = :J: Е-d ▐ LENGTH = :K7": Ь-e ▐ TRANSP = :L: .f ▐ FRAMEIDX = :M: .g ▐ FX = :N: +.h ▐ FY = :O: >.i ▐ MIRROR = :P: O.j ▐ FRMX = :Q: `.k ▐ FRMY = :R: r.l ▐ FRMX1 = :S: └.m ▐ FRMY1 = :T: ⌠.n ▐ YY = :U: ё.o ▐ INC = :V: ╥.p ▐ INC╞DIR = :W: е.q ▐ X = :X: с.r ▐ Y = :Y: Е.s ▐ TEMPR = 7#:Z: Ь.t ▐ TEMPG = :AA: /u ▐ TEMPB = :AB: /v ▐ M = :AC: 2/w ▐ LOGO╞STATE = :AD: H/x ▐ FLIP╞VAR = :AE: b/y ▐ UPPER╞NIBBLE = :AF: |/z ▐ LOWER╞NIBBLE = :AG: ▌/{ ▐ CLR1 = :AH: ═/| ▐ CLR2 = :AI: ╢/} ▐ TSTART = :AJ: к/~ ▐ BAS╞STATE = :AK: щ/ ▐ FRMY = :AL: Т/7$─ ▐ ORIG╞FRMY = :AM: 0│ ▐ FINISH╞CNT = :AN: 0┌ ▐ BCNT = :AO: /0┐ ▐ LOC = :AP: E0└ ▐ RAIN╞IDX = :AQ: W0┘ ▐ PLEN = :AR: n0├ ▐ RAINBOW╞X = :AS: ┘0┤ ▐ RAINBOW╞Y = :AT: ·0┬ ▐ SUBTEXT╞IDX = :AU: ╢0┴ ▐ хотрег╞7 = :AV: и0┼ ▐ FADEVAL = :AW: ч0▀ ▐ TEMPVAL = :AX:7% Л0▄ ▐  = :AY: 1█ ▐ FRAME╞ADDR% = :A%: 1▌ ▐ DATA╞ADDR% = :B%: 31▐ ▐ SCRADDR% = :C%: I1░ ▐ CLRADDR% = :D%: b1▒ ▐ CDATA╞ADDR% = :E%: t1▓ ▐ INC% = :F%: ┌1⌠ ▐  = :G%: ▓1■ ▐ A$ = :A$: ╚1∙ ▐ RAINBOWSTR$ = :B$: а1√ ▐ SUBTEXT$ = :C$: о1≈ ▐  = :D$: И1≤ ▐ DEFAUL ·T╞RED& = :A&: 2≥ ▐ DEFAULT╞GREEN& = :B&:  2  ▐ DEFAULT╞BLUE& = :C&: 72⌡ ▐ CURR╞RED& = :D&: P2° ▐ CURR╞GREEN& = :E&: h2² ▐ CURR╞BLUE& = :F&: v2· ▐  = :G&:                                                                                                    7'!╛я─"╛п─"╬п─#╛о─# о $╬н─#╩н─" о "╬н─! о !║н─ ╬о─ ╛о─ п ║о─║п─ п─╬я─╛я─╬с─╛с─ с ╛т ╬т─ т─╬у ╬у─ у─╬ж─╛ж─ ж ╛в ╬в─ ь─╛ь─╬ы─ ы ╬з─ з ╒ш─ э ╩ш─╩э ║ш─╬э ║ш─ э ╬ш─ ш─ з ╛ш─╛з─║ш ║з─╬з─ ш ╬з─ з─ з─ ╛ы  ╛ы─!║з !║ы─"╬7 з "║ы─# ь─#╬ы $╬ь─$ в─$╒в─# в─" ь "╬в !╛ь─!╛ь─ ╬ы─  ы ╛ш─ э ╬э ╩Ц─╛Б─║Б ╛Ц─ Д ╩Д─ Д─ Ц─╬Д ╬Ц─╒Б─ Б ╒А─╒А─ Ю─║Ю─║А ║Ю ╛А─ А─ Б─╛А ╛Б─╬Ц─ Ц ╛Д ╬Д─ А ╪А ╛Б─╪Б─ Ц ║Б─ Б ╬А─╒А ╒Ю ╪Ю─ Ю─ Ю─ А─╩Ю─║А─ А ╛Б─╒Б─╬Ц─8 t  A╡126:B╡124:C╡123:D╡108:E╡254:F╡252:G╡251:H╡236:I╡127:J╡255:K╡98:L╡226:M╡97:N╡225:O╡32:P╡160:Q╡3.141592654269: Ё  ├ AQ(10):├ AR(10):├ BO(10):├ BP(10):├ BQ(10):├ BR(10):█ 78 *! ≥"⌠";:≥"PETLINE EXAMPLE MENU:":≥"--------------------":≥"1) LINES":≥"28) SQUARE":≥"3) MANY SQUARES":≥"4) DRAW CUBE" f! ≥"5) DRAW MANY CUBES":≥"6) QIX LINES":║ЫB$:▀B$╡"1"╖█ 27 w! ▀B$╡"2"╖█ 24 ┬! ▀B$╡"3"╖█ 23 ≥! ▀B$╡"4"╖█ 17 ╙! ▀B$╡"5"╖█ 16 ╩!	 ▀B$╡"6"╖█ 12 у!
 ▀B$╠╡"1"╞B$Ё╡"5"╖║ЫB$ ъ! ┴ 3:─ М! BM╡.:BN╡. r" BO(BM)╡╣(╩8(1)╛160):BP(BM)╡╣(╩(1)╛100):BQ(BM)╡╣(╩(1)╛160):BR(BM)╡╣(╩(1)╛100):BW╡╣(╩(1)╛16)╙64:·32268,BW:BN╡BN╙1:R╡BO(BM):S╡BP(BM) °" T╡BQ(BM):U╡BR(BM):█ 28:BM╡н(BM╙1,10) ╖" ┴ 13:▌ О" BD╡.:│BC╡.╓1.9╛Q╜4╘Q╜16:█ 17:┌BC:BC╡.:│BD╡.╓1.9╛Q╜2╘Q╜16:█ 17:┌BD:▌ Z# AV╡45:8AZ╡.:AY╡а(1╜╨(2)):│AX╡Q╜4╓1.9╛Q╘Q╜2:BA╡AV╛╬(AY):BB╡BA╛©(AX):AR(AZ)╡AV╛©(AY):AQ(AZ)╡BA╛╬(AX):█ 21 н# █ 22:AQ(AZ)╡AN╙AQ(AZ)╚BB╛BF╜4:AR(AZ)╡AO╙AR(AZ)╙BB╛BF:AZ╡AZ╙1:┌AX:AS╡4:█ 26:AZ╡.:AY╡╚а(1╜╨(2)):│AX╡Q╜4╓1.9╛Q╘Q╜2 ?$ R╡AQ(AZ):S╡AR(AZ):BA╡AV╛╬(AY):BB╡BA╛©8(AX):AR(AZ)╡AV╛©(AY):AQ(AZ)╡BA╛╬(AX):█ 21:█ 22:AQ(AZ)╡AN╙AQ(AZ)╚BB╛BF╜4 ┴$ AR(AZ)╡AO╙AR(AZ)╙BB╛BF:T╡AQ(AZ):U╡AR(AZ):█ 28:AZ╡AZ╙1:┌AX:AS╡4:█ 26:▌ ш$ AD╡AQ(AZ):AE╡BB:BA╡╨(AD╛AD╙AE╛AE):█ 29:AI╡AI╙BC:AQ(AZ)╡BA╛╬(AI):BB╡BA╛©(AI):▌ 5% AD╡AQ(AZ):AE╡AR(AZ):BA8╡╨(AD╛AD╙AE╛AE):█ 29:AI╡AI╙BD:AQ(AZ)╡BA╛╬(AI):AR(AZ)╡BA╛©(AI):▌ R% │AW╡.╓Q╜2╘Q╜8:█ 24:┌AW:▌ ж% AV╡45:AT╡AW╚3╛Q╜4:AQ(.)╡AN╙AV╛╬(AT):AR(.)╡AO╙AV╛©(AT):AT╡AW╚Q╜4:AQ(1)╡AN╙AV╛╬(AT):AR(1)╡AO╙AV╛©(AT):AT╡AW╙Q╜4:AQ(2)╡AN╙AV╛╬(AT) (& AR(2)╡AO╙AV╛©(AT):AT╡AW╙38╛Q╜4:AQ(3)╡AN╙AV╛╬(AT):AR(3)╡AO╙AV╛©(AT):AS╡4:█ 26:▌ ∙& │AU╡.╓AS╚2:R╡AQ(AU):S╡AR(AU):T╡AQ(AU╙1):U╡AR(AU╙1):█ 28:┌AU:R╡AQ(AS╚1):S╡AR(AS╚1):T╡AQ(.):U╡AR(.):█ 28:▌ ч& │AJ╡.╓2╛Q╘Q╜8:R╡80:S╡50:T╡╣(80╙30╛╬(AJ)):U╡╣(50╙30╛©(AJ)):█ 28:┌AJ:▌ F' ·32259:R╡н(╣(R8)╙256,256):S╡н(╣(S)╙256,256):T╡н(╣(T)╙256,256):U╡н(╣(U)╙256,256):·32265,R,S,T,U:▌ S' ▀AD╡.╖Ч e' ▀AEЁ.╖AI╡╚Q╜2 v' ▀AE╠.╖AI╡Q╜2 ⌠'  Ч:уЧ:AH╡AE╜AD:AI╡а(AH) ═'! ▀ADЁ.╖Ч ╩'" ▀AEЁ.╖AI╡AI╚Q:уAI╡AI╙Q б'# Ч и'$ Ч о'% ▌ Ъ'& Ч.:·32262,н(Z╙256,256),н(8AA╙256,256),5:▌ (' ▀ZЁ.╟Z╠159╟AAЁ.╟AA╠99╖▌ w(( V╡╣(Z╜2):W╡╣(AA╜2):X╡н(╣(Z),2):Y╡н(╣(AA),2):AB╡б(264192╙V╙W╛80):█ 45:▀X╡.╞Y╡.╖AC╡AC╟1 ▄() ▀X╡1╞Y╡.╖AC╡AC╟2 ║(* ▀X╡.╞Y╡1╖AC╡AC╟4 ╤(+ ▀X╡1╞Y╡1╖AC╡AC╟8 с(, █ 61:≈264192╙V╙W╛80,AB:▌ И(- AC╡.:▀AB╡A╖AC╡1:▌ З(. 8
:BI: Т/▄ ▐ SY = :BJ: 0█ ▐ E = :BK: 0▌ ▐ E2 = :BL: &0▐ ▐ QLIDX = :BM: 90░ ▐ QLCNT = :BN: K0▒ ▐ QLX1 = :BO: ]0▓ ▐ QLY1 = :BP: o0⌠ ▐ QLX2 = :BQ: │0■ ▐ QLY2 = :BR: ■0∙ ▐ QLVX1 = :BS: ╖0√ ▐ QLVY1 = :BT: ╨0≈ ▐ QLVX2 = :BU: м0≤ ▐ QLVY2 = :BV: Ю0≥ ▐ QLCLR = :B ^W: Н0  ▐  = :BX: Э0⌡ ▐  = :A%: 1° ▐ A$ = :A$: 1² ▐ Z$ = :B$: *1· ▐  = :C$: 81÷ ▐  = :A&:                                                                                                                                                                    8▀AB╡B╖AC╡2:▌ )/ ▀AB╡C╖AC╡4:▌ )0 ▀AB╡D╖AC╡8:▌ .)1 ▀AB╡E╖AC╡14:▌ @)2 ▀AB╡F╖AC╡13:▌ R)3 ▀AB╡G╖AC╡11:▌ c)4 ▀AB╡H╖AC╡7:▌ t)5 ▀AB╡I╖AC╡9:▌ ┘)6 ▀AB╡J╖AC╡6:▌ ≈)7 ▀AB╡K╖AC╡12:▌ ╗)8 ▀AB╡L╖AC╡3:▌ ╧)9 ▀AB╡M╖AC╡5:▌ к): ▀AB╡N╖AC╡10:▌ щ); ▀AB╡P╖AC╡15:▌ Ц)< ▌ Т)= ▀AC╡8.╖AB╡O:▌ *> ▀AC╡1╖AB╡A:▌ *? ▀AC╡2╖AB╡B:▌ '*@ ▀AC╡3╖AB╡L:▌ 8*A ▀AC╡4╖AB╡C:▌ I*B ▀AC╡5╖AB╡M:▌ Z*C ▀AC╡6╖AB╡J:▌ k*D ▀AC╡7╖AB╡H:▌ |*E ▀AC╡8╖AB╡D:▌ █*F ▀AC╡9╖AB╡I:▌ ÷*G ▀AC╡10╖AB╡N:▌ ╠*H ▀AC╡11╖AB╡G:▌ ц*I ▀AC╡12╖AB╡K:▌ у*J ▀AC╡13╖AB╡F:▌ Г*K ▀AC╡14╖AB╡E:▌ Ы*8L ▀AC╡15╖AB╡P:▌ Ъ*M ▌ F+N Ч.:Ч"MEGAPLOT":·32259:AN╡80:AO╡50:≥г(27);"5";г(147);:BF╡╬(Q╜4):▌ Y+O ▐ пиь╞тл = :A: l+P ▐ пиь╞тр = :B: +Q ▐ пиь╞бл = :C: ▓+R ▐ пиь╞бр = :D: ╘+S ▐ пиь╞инж╞тл = :E: ю+T ▐ пиь╞инж╞тр = :F: в+U ▐ пиь╞инж╞бл = :G: Н+V ▐ пиь╞инж╞бр8 = :H: 	,W ▐ пиь╞диаг╞тл╞бр = :I: $,X ▐ пиь╞диаг╞бл╞тр = :J: >,Y ▐ пиь╞хлине╞бот = :K: X,Z ▐ пиь╞хлине╞топ = :L: s,[ ▐ пиь╞жлине╞лефт = :M: ▐,\ ▐ пиь╞жлине╞ригхт = :N: ╓,] ▐ пиь╞ноне = :O: ╦,^ ▐ пиь╞алл = :P: г,_ ▐ пи = :Q: ж,` ▐ X1 = :R: Е,a ▐ Y1 = :S: 8Т,b ▐ X2 = :T: -c ▐ Y2 = :U: -d ▐ DX = :V: !-e ▐ DY = :W: 0-f ▐ MX = :X: ?-g ▐ MY = :Y: N-h ▐ CX = :Z: ^-i ▐ CY = :AA: t-j ▐ CUR╞CHAR = :AB: ┘-k ▐ PIX = :AC: ≤-l ▐ DIFFX = :AD: ╚-m ▐ DIFFY = :AE: ©-n ▐ DELTAX = :AF: с-o ▐ DELTAY = :AG: Г-p ▐ TANVAL = :8AH: З-q ▐ ANGLE = :AI: .r ▐ ANG = :AJ: $.s ▐ LINE╞LENGTH = :AK: 3.t ▐ K = :AL: F.u ▐ DEBUG = :AM: [.v ▐ CENTREX = :AN: p.w ▐ CENTREY = :AO: ┘.x ▐ CENTREZ = :AP: ∙.y ▐ PX = :AQ: ╔.z ▐ PY = :AR: ╥.{ ▐ PLEN = :AS: и.| ▐ PANG = :AT: ш.} ▐ PIDX = :AU: Н.~ ▐ 8PDIST = :AV: / ▐ SQANG = :AW: /─ ▐ CB╞ANGA = :AX: +/│ ▐ CB╞ANGB = :AY: >/┌ ▐ CBIDX = :AZ: Q/┐ ▐ CBTMP = :BA: a/└ ▐ PZ = :BB: v/┘ ▐ CB╞INCA = :BC: ▀/├ ▐ CB╞INCB = :BD: ═/┤ ▐ RET╞ANG = :BE: Ё/┬ ▐ ZFACT = :BF: д/┴ ▐ DDX = :BG: у/┼ ▐ DDY = :BH: Е/▀ ▐ SX =8 :BI: У/▄ ▐ SY = :BJ: 0█ ▐ E = :BK: 0▌ ▐ E2 = :BL: '0▐ ▐ QLIDX = :BM: :0░ ▐ QLCNT = :BN: L0▒ ▐ QLX1 = :BO: ^0▓ ▐ QLY1 = :BP: p0⌠ ▐ QLX2 = :BQ: ┌0■ ▐ QLY2 = :BR: ∙0∙ ▐ QLVX1 = :BS: ╗0√ ▐ QLVY1 = :BT: ╩0≈ ▐ QLVX2 = :BU: н0≤ ▐ QLVY2 = :BV: А0≥ ▐ QLCLR = : _BW: О0  ▐  = :BX: Щ0⌡ ▐  = :A%: 1° ▐ A$ = :A$: 1² ▐ Z$ = :B$: +1· ▐  = :C$: 91÷ ▐  = :A&:                                                                                                                                                                   8000,327680,264192:Ч!.,4000,331776,267911168:Ч!3,4000,32,327680 F(7 Ч!3,4000,1,331776:▌ s(8 ≥"⌠";:C(E%)╡.:D%(E%)╡.:▀E╡1╖D%(E%)╡F:E╡. y(9 ▌ ▐(: ▀D%(E%)ЁC%(E%)╖Ч ╢(; A&╡B&(E%,D%(E%)):D%(E%)╡D%(E%)╙1 к(< ▀D(E%)╡3╞A&╡255╖Ч Б(= ▀D%(E%)╠F╖F╡D%(E%) Н(> ┴ 44:Ч8:▌ 6,c │M╡.╓49:Ч!0╙32╙16,79,335872╙M╛80╙78,335872╙M╛80╙79:≈335872╙M╛80,32:┌M:▌ T,d C(E%)╡C(E%)╙1:▀E%╡.╖AC╡32 d,e ▀E%╡1╖AC╡64 ~,f Ч.:·32274,AC:Ч128:▌ ░,g ▐ STARY = :A: ·,h ▐ K = :B: ╞,i ▐ OFFS = :C: ©,j ▐ VER = :D: т,k ▐ LASTFLAG = :E: О,l ▐ LAST╞GROUP╞8IDX = :F:  -m ▐ OLDX = :G: -n ▐ OLDY = :H: %-o ▐ OLDOFFS = :I: 3-p ▐ X = :J: A-q ▐ Y = :K: P-r ▐ XX = :L: _-s ▐ YY = :M: o-t ▐ DXX = :N: -u ▐ DYY = :O: ▒-v ▐ DEBUG = :P: ║-w ▐ WXX = :Q: ╠-x ▐ WYY = :R: а-y ▐ CHR = :S: я-z ▐ TMP = :T: Ф-{ ▐ SRC╞ADDR = :8U: Э-| ▐ DEST╞ADDR = :V: .} ▐ LENGTH = :W: ".~ ▐ TRANSP = :X: 2. ▐ LOC = :Y: B.─ ▐ PTR = :Z: Q.│ ▐ M = :AA: e.┌ ▐ TSTART = :AB: w.┐ ▐ ADDR = :AC: █.└ ▐ CHAR╞CNT = :AD: ╓.┘ ▐ MAX╞WIDTH = :AE: ╥.├ ▐ TXT╞K = :AF: х.┤ ▐ RET = :AG: ч.┬ ▐ MN╞STATE = :AH: С.┴8 ▐ WC╞FLAG = :AI: /┼ ▐ WC╞CHR = :AJ: /▀ ▐  = :AK: )/▄ ▐ STARX% = :A%: >/█ ▐ STARVX% = :B%: Q/▌ ▐ DIDX% = :C%: d/▐ ▐ PIDX% = :D%: w/░ ▐ FIDX% = :E%: ▌/▒ ▐ CHAR╞IDX% = :F%: ╖/▓ ▐ CHAR╞WIDTH% = :G%: ╣/⌠ ▐  = :H%: и/■ ▐ FNAME$ = :A$: ы/∙ ▐ A$ = :B$: И/√ ▐  ║Z$ = :C$: Ы/≈ ▐ S$ = :D$: 0≤ ▐  = :E$: 0≥ ▐ VAL& = :A&: -0  ▐ LDATA& = :B&: F0⌡ ▐ GROUP╞FLAG& = :C&: X0° ▐ VAL& = :D&: o0² ▐ REV╞FLAG& = :E&: }0· ▐  = :F&:                                                                                                 84:▌ Ж)G Ч Щ)H Ч *I N╡J╚C(E%):O╡K:█ 78:P╡. $*J ▀P╡1╖Ч i*K ≥"";г(27);"Q X,Y,PIDX,A$,OFFS=";J;K;D%(E%),ф(B$),C(E%):║ЫB$:Ч p*L Ч ─*M J╡J╚C(E%):▌ ё*N S╡ф(B$):█ 84:▀E&(E%)╡1╖S╡S╙128 Ё*O ▀D(E%)╡1╖Ч э*P ≈335872╙N╙O╛80,S:≈339968╙N╙O╛80,1:Ч Т*Q ▀D(E%)╡2╟8╞FLAG = :AI: /┼ ▐ WC╞CHR = :AJ: /▀ ▐  = :AK: $/▄ ▐ STARX% = :A%: 9/█ ▐ STARVX% = :B%: L/▌ ▐ DIDX% = :C%: _/▐ ▐ PIDX% = :D%: r/░ ▐ FIDX% = :E%: ┴/▒ ▐ CHAR╞IDX% = :F%: ╒/▓ ▐ CHAR╞WIDTH% = :G%: ╟/⌠ ▐  = :H%: д/■ ▐ FNAME$ = :A$: т/∙ ▐ A$ = :B$: Д/√ ▐ Z$ =  °:C$: Т/≈ ▐ S$ = :D$: 0≤ ▐  = :E$: 0≥ ▐ VAL& = :A&: (0  ▐ LDATA& = :B&: A0⌡ ▐ GROUP╞FLAG& = :C&: S0° ▐ VAL& = :D&: j0² ▐ REV╞FLAG& = :E&: x0· ▐  = :F&:                                                                                                      8) SQUARE":≥"3) MANY SQUARES":≥"4) DRAW CUBE" f! ≥"5) DRAW MANY CUBES":≥"6) QIX LINES":║ЫB$:▀B$╡"1"╖█ 27 w! ▀B$╡"2"╖█ 24 ┬! ▀B$╡"3"╖█ 23 ≥! ▀B$╡"4"╖█ 17 ╙! ▀B$╡"5"╖█ 16 ╩!	 ▀B$╡"6"╖█ 12 у!
 ▀B$╠╡"1"╞B$Ё╡"5"╖║ЫB$ ъ! ┴ 3:─ М! BM╡.:BN╡. o" BO(BM)╡╣(╩8) SQUARE":≥"3) MANY SQUARES":≥"4) DRAW CUBE" f! ≥"5) DRAW MANY CUBES":≥"6) QIX LINES":║ЫB$:▀B$╡"1"╖█ 27 w! ▀B$╡"2"╖█ 24 ┬! ▀B$╡"3"╖█ 23 ≥! ▀B$╡"4"╖█ 17 ╙! ▀B$╡"5"╖█ 16 ╩!	 ▀B$╡"6"╖█ 12 у!
 ▀B$╠╡"1"╞B$Ё╡"5"╖║ЫB$ ъ! ┴ 3:─ М! BM╡.:BN╡. i" BO(BM)╡╣(╩8 (1)╛160):BP(BM)╡╣(╩(1)╛100):BQ(BM)╡╣(╩(1)╛160):BR(BM)╡╣(╩(1)╛100):BN╡BN╙1:R╡BO(BM):S╡BP(BM):T╡BQ(BM):U╡BR(BM) ╚" ЧA.,.:≥г(27);"QX1,Y1,X2,Y2=",R,S,T,U:█ 28:║ЫA$:BM╡н(BM╙1,10) ╤" ┴ 13:▌ Ч" BD╡.:│BC╡.╓1.9╛Q╜4╘Q╜16:█ 17:┌BC:BC╡.:│BD╡.╓1.9╛Q╜2╘Q╜16:█ 17:┌8!BD:▌ i# AV╡45:AZ╡.:AY╡а(1╜╨(2)):│AX╡Q╜4╓1.9╛Q╘Q╜2:BA╡AV╛╬(AY):BB╡BA╛©(AX):AR(AZ)╡AV╛©(AY):AQ(AZ)╡BA╛╬(AX):█ 21 щ# █ 22:AQ(AZ)╡AN╙AQ(AZ)╚BB╛BF╜4:AR(AZ)╡AO╙AR(AZ)╙BB╛BF:AZ╡AZ╙1:┌AX:AS╡4:█ 26:AZ╡.:AY╡╚а(1╜╨(2)):│AX╡Q╜4╓1.9╛Q╘Q╜2 N$ R╡AQ(AZ):S╡AR(AZ):BA╡A8"V╛╬(AY):BB╡BA╛©(AX):AR(AZ)╡AV╛©(AY):AQ(AZ)╡BA╛╬(AX):█ 21:█ 22:AQ(AZ)╡AN╙AQ(AZ)╚BB╛BF╜4 ≤$ AR(AZ)╡AO╙AR(AZ)╙BB╛BF:T╡AQ(AZ):U╡AR(AZ):█ 28:AZ╡AZ╙1:┌AX:AS╡4:█ 26:▌ Й$ AD╡AQ(AZ):AE╡BB:BA╡╨(AD╛AD╙AE╛AE):█ 29:AI╡AI╙BC:AQ(AZ)╡BA╛╬(AI):BB╡BA╛©(AI):▌ D% AD╡AQ(A8#Z):AE╡AR(AZ):BA╡╨(AD╛AD╙AE╛AE):█ 29:AI╡AI╙BD:AQ(AZ)╡BA╛╬(AI):AR(AZ)╡BA╛©(AI):▌ a% │AW╡.╓Q╜2╘Q╜8:█ 24:┌AW:▌ Е% AV╡45:AT╡AW╚3╛Q╜4:AQ(.)╡AN╙AV╛╬(AT):AR(.)╡AO╙AV╛©(AT):AT╡AW╚Q╜4:AQ(1)╡AN╙AV╛╬(AT):AR(1)╡AO╙AV╛©(AT):AT╡AW╙Q╜4:AQ(2)╡AN╙AV╛╬(AT) 7& AR(2)╡AO╙A8$V╛©(AT):AT╡AW╙3╛Q╜4:AQ(3)╡AN╙AV╛╬(AT):AR(3)╡AO╙AV╛©(AT):AS╡4:█ 26:▌ ╓& │AU╡.╓AS╚2:R╡AQ(AU):S╡AR(AU):T╡AQ(AU╙1):U╡AR(AU╙1):█ 28:┌AU:R╡AQ(AS╚1):S╡AR(AS╚1):T╡AQ(.):U╡AR(.):█ 28:▌ М& │AJ╡.╓2╛Q╘Q╜8:R╡80:S╡50:T╡╣(80╙30╛╬(AJ)):U╡╣(50╙30╛©(AJ)):█ 28:┌AJ:▌ U' 8%·32259:R╡н(╣(R)╙256,256):S╡н(╣(S)╙256,256):T╡н(╣(T)╙256,256):U╡н(╣(U)╙256,256):·32265,R,S,T,U:▌ b' ▀AD╡.╖Ч t' ▀AEЁ.╖AI╡╚Q╜2 ┘' ▀AE╠.╖AI╡Q╜2 ╒'  Ч:уЧ:AH╡AE╜AD:AI╡а(AH) ╞'! ▀ADЁ.╖Ч й'" ▀AEЁ.╖AI╡AI╚Q:уAI╡AI╙Q я'# Ч ь'$ Ч ч'% ▌ (& Ч.:·32262,н8&(Z╙256,256),н(AA╙256,256),5:▌ *(' ▀ZЁ.╟Z╠159╟AAЁ.╟AA╠99╖▌ ├(( V╡╣(Z╜2):W╡╣(AA╜2):X╡н(╣(Z),2):Y╡н(╣(AA),2):AB╡б(264192╙V╙W╛80):█ 45:▀X╡.╞Y╡.╖AC╡AC╟1 ⌡() ▀X╡1╞Y╡.╖AC╡AC╟2 ╟(* ▀X╡.╞Y╡1╖AC╡AC╟4 е(+ ▀X╡1╞Y╡1╖AC╡AC╟8 Б(, █ 61:≈264192╙V╙W╛80,AB:▌ Ь(- AC╡.:▀A8'B╡A╖AC╡1:▌ 	). ▀AB╡B╖AC╡2:▌ )/ ▀AB╡C╖AC╡4:▌ +)0 ▀AB╡D╖AC╡8:▌ =)1 ▀AB╡E╖AC╡14:▌ O)2 ▀AB╡F╖AC╡13:▌ a)3 ▀AB╡G╖AC╡11:▌ r)4 ▀AB╡H╖AC╡7:▌ ┐)5 ▀AB╡I╖AC╡9:▌ ■)6 ▀AB╡J╖AC╡6:▌ ╕)7 ▀AB╡K╖AC╡12:▌ ╥)8 ▀AB╡L╖AC╡3:▌ х)9 ▀AB╡M╖AC╡5:▌ з): ▀AB╡N╖AC╡10:▌ Л); ▀AB╡P╖AC╡15:▌8  Р)< ▌ *= ▀AC╡.╖AB╡O:▌ *> ▀AC╡1╖AB╡A:▌ %*? ▀AC╡2╖AB╡B:▌ 6*@ ▀AC╡3╖AB╡L:▌ G*A ▀AC╡4╖AB╡C:▌ X*B ▀AC╡5╖AB╡M:▌ i*C ▀AC╡6╖AB╡J:▌ z*D ▀AC╡7╖AB╡H:▌ ▀*E ▀AC╡8╖AB╡D:▌ °*F ▀AC╡9╖AB╡I:▌ ╝*G ▀AC╡10╖AB╡N:▌ ю*H ▀AC╡11╖AB╡G:▌ р*I ▀AC╡12╖AB╡K:▌ Д*J ▀AC╡13╖AB╡F:▌ Ж*K ▀                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                