#OUTPUT "BASLOGO"' ¬¡ŒÀ4 ÕEMORY USAGE' ------------------' 4.0000 ƒÕ¡-Ã…”‘' 4.0020 VAR INTERFACE TO ASSEMBLY'        0020: PTR TO DEFAULTØRED&'        0022: PTR TO DEFAULTØGREEN&'        0024: PTR TO DEFAULTØBLUE&'        0026: PTR TO CURRØRED&'        0028: PTR TO CURRØGREEN&'        002A: PTR TO CURRØBLUE&'        002C: PTR TO DATAØADDR%'        002E: PTR TO CDATAØADDR%'        0030: PTR TO SCRADDR%'        0032: PTR TO CLRADDR%'        0034: PTR TO INC%' 4.0800 ”√“≈≈Œ Õ≈Õœ“Ÿ' 4.2000 –≈‘”√…… «“¡–»…√”' ¬¡ŒÀ5 ÕEMORY USAGE' ------------------' 5.0000 SCREEN BUFFER' 5.1000 COLOR RAM BUFFER.DEFINES#DECLARE K, PTR, TMP, MAXØFRAMES, FRMØIDX, FRMW, FRMH, SZ#DECLARE FRAMEØADDR%(25), SRCØADDR, DESTØADDR, LENGTH, TRANSP#DECLARE FRAMEIDX, FX, FY, MIRROR, DATAØADDR%, FRMX, FRMY#DECLARE FRMX1, FRMY1, SCRADDR%, CLRADDR%, CDATAØADDR%, YY#DECLARE INC(3), INCØDIR(3), A$, X, Y#DECLARE TEMPR, TEMPG, TEMPB, M#DECLARE LOGOØSTATE#DECLARE FLIPØVAR, UPPERØNIBBLE, LOWERØNIBBLE#DECLARE CLR1, CLR2, TSTART#DECLARE BASØSTATE = 0#DECLARE FRMY(3), ORIGØFRMY(3), FINISHØCNT, BCNT#DECLARE LOC, INC%  #DECLARE RAINØIDX, PLEN, RAINBOWSTR$, RAINBOWØX, RAINBOWØY  #DECLARE SUBTEXT$(2)  #DECLARE SUBTEXTØIDX = 0  SUBTEXT$(0) = "PRESENTS..."  SUBTEXT$(1) = "A SONG BY..."#DEFINE ∆“ÕØ¬ = 0#DEFINE ∆“ÕØ¡ = 1#DEFINE ∆“ÕØ” = 2#DEFINE ∆“ÕØ¬¡√Àƒ“œ– = 3#DECLARE »œ‘“≈«Ø7 = $D05D#DEFINE ”√“Œ–‘“Ã”¬ = $D060#DEFINE ”√“Œ–‘“¬ŒÀ = $D062  ' PALETTE  ' -------  #DECLARE DEFAULTØRED&(32)  #DECLARE DEFAULTØGREEN&(32)  #DECLARE DEFAULTØBLUE&(32)  #DECLARE CURRØRED&(32)  #DECLARE CURRØGREEN&(32)  #DECLARE CURRØBLUE&(32)  #DECLARE FADEVAL, TEMPVAL.OFFSETS#DEFINE œ∆∆”≈‘Øƒ¡‘¡Ø”…⁄≈  = 0#DEFINE œ∆∆”≈‘ØŒ’ÕØ∆“¡Õ≈” = 2#DEFINE œ∆∆”≈‘Ø∆“¡Õ≈0     = 3#DEFINE ∆“ÕØœ∆∆”≈‘Øÿ          = 0#DEFINE ∆“ÕØœ∆∆”≈‘ØŸ          = 1#DEFINE ∆“ÕØœ∆∆”≈‘Ø◊          = 2#DEFINE ∆“ÕØœ∆∆”≈‘Ø»          = 3#DEFINE ∆“ÕØœ∆∆”≈‘Ø»…‘¬œÿ≈”   = 4#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø»≈¡ƒ    = 4#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø‘œ“”œ   = 8#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø∆≈≈‘    = 12#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø¡‘‘¡√À  = 16#DEFINE ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡       = 20'----.MAIN'----  GOSUB INIT  GOSUB LOADØDATA  GOSUB STATEØLOOP  GOSUB ANIMATEØLOGO  END#DEFINE ”‘Ø∆¡ƒ≈Ø‘œØ◊»…‘≈ = 0#DEFINE ”‘Øƒ“¡◊Ø¬¡√Àƒ“œ–ØœŒÃŸ = 1#DEFINE ”‘Ø∆¡ƒ≈Ø‘œØƒ≈∆¡’Ã‘ = 2#DEFINE ”‘Øƒ“œ–Ø…ŒØ¬ = 3#DEFINE ”‘Ø–“≈”≈Œ‘” = 4#DEFINE ”‘Ø¡Œ¡‘»≈Õ¡ = 5'----------.STATEØLOOP'----------  TSTART = TI  IF LOGOØSTATE = ”‘Ø∆¡ƒ≈Ø‘œØ◊»…‘≈ THEN BEGIN    GOSUB FADEØTOØWHITE    LOGOØSTATE = ”‘Øƒ“¡◊Ø¬¡√Àƒ“œ–ØœŒÃŸ  BEND    IF LOGOØSTATE = ”‘Øƒ“¡◊Ø¬¡√Àƒ“œ–ØœŒÃŸ THEN BEGIN    BANK 128    POKE $D020, 1, 1    GOSUB INITØ80X50    GOSUB DRAWØBACKDROP    GOSUB PAGEØFLIP    GOSUB STOREØCURRØCOLOURS    GOSUB SETØPALETTEØFORØBACKDROP    FADEVAL=0    M=0    LOGOØSTATE = ”‘Ø∆¡ƒ≈Ø‘œØƒ≈∆¡’Ã‘  BEND    IF LOGOØSTATE = ”‘Ø∆¡ƒ≈Ø‘œØƒ≈∆¡’Ã‘ THEN BEGIN    IF FADEVAL <= 128 THEN BEGIN      ' FADEØCOLOURSØTOØDEFAULTS      BANK 0:VSYNC 10:SYS $7E03, FADEVAL:BANK 128      FADEVAL = FADEVAL + 1    BEND    ' CYCLEØALTØPALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M = 130 THEN LOGOØSTATE = ”‘Øƒ“œ–Ø…ŒØ¬  BEND  IF LOGOØSTATE = ”‘Øƒ“œ–Ø…ŒØ¬ THEN BEGIN    GOSUB ANIMATEØLOGO    ' CYCLEØALTØPALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M > 250 THEN LOGOØSTATE = ”‘Ø–“≈”≈Œ‘”:FADEVAL = 0  BEND  IF LOGOØSTATE = ”‘Ø–“≈”≈Œ‘” THEN BEGIN    GOSUB ANIMØDRAWØSUBTEXT    ' CYCLEØALTØPALETTE    BANK 0:SYS $7E06:BANK 128    M = M + 1    IF M > 360 THEN BEGIN      ' FADE TO BLACK      BANK 0:SYS $7E0C, FADEVAL:BANK 128      FADEVAL = FADEVAL + 1    BEND    IF FADEVAL = 128 THEN BEGIN      POKE $D020, 0, 0      LOGOØSTATE = ”‘Ø¡Œ¡‘»≈Õ¡    BEND  BEND  DO  LOOP WHILE (TI-TSTART) < .03  GOTO STATEØLOOP  RETURN'----------.INITØ80X50'----------  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  ' SWITCH TO 80X50  ' SETBIT »œ‘“≈«Ø7, 7  ' POKE $D031, $E8 ' 1110 1000 = »640,∆¡”‘,¡‘‘“,÷400  PRINT CHR$(27);"5";  ' WPOKE ”√“Œ–‘“Ã”¬, $0800  ' POKE ”√“Œ–‘“¬ŒÀ, $04  RETURN'-------------.DRAWØBACKDROP'-------------    FRAMEIDX = ∆“ÕØ¬¡√Àƒ“œ–    FX=-999 : FY = -999    MIRROR = 0    GOSUB DRAWØPETSCIIØFRAME    RETURN'------------.ANIMATEØLOGO'------------  IF BASØSTATE = 0 THEN BEGIN    ORIGØFRMY(0) = 6    ORIGØFRMY(1) = 23    ORIGØFRMY(2) = 6    FRMY(0) = -44    FRMY(1) = -69    FRMY(2) = -107    BASØSTATE = 1    INCØDIR(0) = 1    INC(0) = 1    INCØDIR(1) = 1    INC(1) = 1    INCØDIR(2) = 1    INC(2) = 1    INCØDIR(3) = 1    INC(3) = 1  BEND  IF BASØSTATE = 1 THEN BEGIN    FINISHØCNT = 0    FOR K = 0 TO 2      IF FRMY(K) < ORIGØFRMY(K) THEN BEGIN        FRMY(K) = FRMY(K) + 2        IF FRMY(K) > ORIGØFRMY(K) THEN FRMY(K) = ORIGØFRMY(K)      BEND      IF FRMY(K) = ORIGØFRMY(K) THEN FINISHØCNT = FINISHØCNT OR 2^K    NEXT K  BEND  GOSUB DRAWØBAS  GOSUB PAGEØFLIP  FOR FRAMEIDX = 0 TO 2    IF FINISHØCNT AND 2^FRAMEIDX AND BCNT(FRAMEIDX)<3 THEN BEGIN      INC(FRAMEIDX) = INC(FRAMEIDX) + .2 * INCØDIR(FRAMEIDX)      IF INC(FRAMEIDX) < .6 THEN BEGIN        INCØDIR(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF INC(FRAMEIDX) > 2.9 THEN BEGIN        INCØDIR(FRAMEIDX) = -1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF BCNT(FRAMEIDX) = 2 AND INC(FRAMEIDX) > 1 THEN BEGIN        INC(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND    BEND    BEND  NEXT FRAMEIDX    RETURN'----.INIT'----  BANK 0:BLOAD "ASMHELPER":BANK 128  LOGOØSTATE = 0  GOSUB STOREØDEFAULTØCOLOURS  INCØDIR(3) = -1  INC(3) = 1  ' CLEAR DMA LIST AREA  FOR K = 0 TO 20    POKE $40000+K, 0  NEXT K  POKE $40000, $81 ' OPT = DEST ADDR Õ¬ SELECTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $00 ' √Õƒ LSB = √œ–Ÿ  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C, $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' √Õƒ MSB (IGNORE)  WPOKE $40010, $0000 ' MODULO (IGNORE)  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  ' INIT VAR INTERFACE TO ASSEMBLY  LOC = $40020  PTR = POINTER(DEFAULTØRED&(0))  GOSUB STOREØPTR  PTR = POINTER(DEFAULTØGREEN&(0))  GOSUB STOREØPTR  PTR = POINTER(DEFAULTØBLUE&(0))  GOSUB STOREØPTR  PTR = POINTER(CURRØRED&(0))  GOSUB STOREØPTR  PTR = POINTER(CURRØGREEN&(0))  GOSUB STOREØPTR  PTR = POINTER(CURRØBLUE&(0))  GOSUB STOREØPTR  PTR = POINTER(DATAØADDR%)  GOSUB STOREØPTR  PTR = POINTER(CDATAØADDR%)  GOSUB STOREØPTR  PTR = POINTER(SCRADDR%)  GOSUB STOREØPTR  PTR = POINTER(CLRADDR%)  GOSUB STOREØPTR  PTR = POINTER(INC%)  GOSUB STOREØPTR  RETURN'---------.STOREØPTR'---------  WPOKE LOC, PTR  LOC = LOC + 2  RETURN'---------.LOADØDATA'---------  PTR = $42000    BLOAD "BAS.BIN",P(PTR)  GOSUB INITØPETSCIIØFRAMES  GOSUB ØINCREMENTØPTRØTOØNEXTØFREE  RETURN'-------------------.INITØPETSCIIØFRAMES'-------------------  TMP = PTR  MAXØFRAMES = PEEK(PTR + œ∆∆”≈‘ØŒ’ÕØ∆“¡Õ≈”)  'PRINT  'PRINT "PTR=";HEX$(PTR + œ∆∆”≈‘ØŒ’ÕØ∆“¡Õ≈”)  PTR = PTR + œ∆∆”≈‘Ø∆“¡Õ≈0  'PRINT  'PRINT "- MXØFRM=";MAXØFRAMES;": "  FRMØIDX = 0  DO WHILE FRMØIDX < MAXØFRAMES    'PRINT FRMØIDX;    FRAMEØADDR%(FRMØIDX) = MOD(PTR,65536)    FRMX = PEEK(PTR + ∆“ÕØœ∆∆”≈‘Øÿ)    FRMY = PEEK(PTR + ∆“ÕØœ∆∆”≈‘ØŸ)    FRMW = PEEK(PTR + ∆“ÕØœ∆∆”≈‘Ø◊)    FRMH = PEEK(PTR + ∆“ÕØœ∆∆”≈‘Ø»)    FRMX1=FRMX+FRMW-1    FRMY1=FRMY+FRMH-1    DATAØADDR% = MOD(PTR, 65536)    DATAØADDR% = DATAØADDR% + ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡    CDATAØADDR% = DATAØADDR% + FRMW * FRMH    BANK 4    FOR Y = 0 TO FRMY1-FRMY      FOR X = 0 TO FRMX1-FRMX        IF PEEK(DATAØADDR% + X + Y * FRMW) = 102 THEN BEGIN          POKE (CDATAØADDR% + X + Y * FRMW), $FF        BEND      NEXT X    NEXT Y    BANK 128        'PRINT "PTR=";HEX$(PTR);", IDX=";FRMØIDX;", W=";FRMW;", H=";FRMH    PTR = PTR + ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡ + FRMW * FRMH * 2    'PRINT "FRMØIDX=";FRMØIDX    FRMØIDX = FRMØIDX + 1  LOOP  PTR = TMP  RETURN'---------------------------.ØINCREMENTØPTRØTOØNEXTØFREE'---------------------------  PTR = TMP  SZ = WPEEK(PTR + œ∆∆”≈‘Øƒ¡‘¡Ø”…⁄≈)  'PRINT  'PRINT "INC SZ = ";SZ  'PRINT "PTR = ";HEX$(PTR + œ∆∆”≈‘Øƒ¡‘¡Ø”…⁄≈)  PTR = PTR + SZ  'GET KEY A$  RETURN'--------.DRAWØBAS'--------  FRAMEIDX = ∆“ÕØ¬¡√Àƒ“œ–  FX=-999 : FY = -999  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  FRAMEIDX = ∆“ÕØ¬  FX=-999 : FY=FRMY(0)  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  FRAMEIDX = ∆“ÕØ¡  FX=-999 : FY=FRMY(1)  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  FRAMEIDX = ∆“ÕØ”  FX=-999 : FY=FRMY(2)  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  RETURN'------------------.DRAWØPETSCIIØFRAME'------------------  POKE $4000B, $04  ' ASSURE SOURCE BANK 4 (FOR ORIGINAL FRAME DATA)  IF MIRROR = 1 THEN SETBIT $40006, 5:ELSE CLRBIT $40006, 5  DATAØADDR% = FRAMEØADDR%(FRAMEIDX)  BANK 4  FRMX = PEEK(DATAØADDR% + ∆“ÕØœ∆∆”≈‘Øÿ)  FRMY = PEEK(DATAØADDR% + ∆“ÕØœ∆∆”≈‘ØŸ)  FRMW = PEEK(DATAØADDR% + ∆“ÕØœ∆∆”≈‘Ø◊)  FRMH = PEEK(DATAØADDR% + ∆“ÕØœ∆∆”≈‘Ø»)  BANK 128  IF FX<>-999 THEN FRMX = FX ' OVERRIDE POSITION  IF FY<>-999 THEN FRMY = FY  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  SCRADDR% = $0000 + FRMX + (FRMY+FRMH-1) * 80  CLRADDR% = $1000 + FRMX + (FRMY+FRMH-1) * 80  IF MIRROR = 1 THEN CLRADDR% = CLRADDR% + FRMW - 1  DATAØADDR% = DATAØADDR% + ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡  CDATAØADDR% = DATAØADDR% + FRMW * FRMH  INC% = INC(FRAMEIDX) * 256  ' ASM: DRAWØPETSCIIØFRAME  BANK 0:SYS $7E09, MOD(FRMY+256,256), MOD(FRMY1+256,256), FRMW  RETURN'---------------.TRANSPARENTØDMA'---------------  WPOKE $40009, SRCØADDR  WPOKE $4000C, DESTØADDR  WPOKE $40007, LENGTH  POKE  $40004, TRANSP  POKE $D702, 4 ' DMA LIST IN BANK 4  POKE $D701, $00 ' DMA LIST MSB  POKE $D705, $00 ' DMA LIST LSB  RETURN'---------.PAGEØFLIP'---------  EDMA 0, $FA0, $50000, $40800  EDMA 0, $FA0, $51000, $FF80000  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  RETURN.FADEØTOØWHITE'-------------  FOR FADEVAL=0 TO 128    ' FADEØCOLOURSØTOØWHITE    BANK 0:VSYNC 10:SYS $7E00, FADEVAL:BANK 128  NEXT FADEVAL  RETURN.STOREØDEFAULTØCOLOURS'---------------------  FOR K = 0 TO 31    DEFAULTØRED&(K)=PEEK($D100+K)    DEFAULTØGREEN&(K)=PEEK($D200+K)    DEFAULTØBLUE&(K)=PEEK($D300+K)  NEXT K  RETURN.STOREØCURRØCOLOURS'------------------  FOR K = 0 TO 31    CURRØRED&(K)=PEEK($D100+K)    CURRØGREEN&(K)=PEEK($D200+K)    CURRØBLUE&(K)=PEEK($D300+K)  NEXT K  RETURN.CYCLEØALTØPALETTEØLOOP'----------------------  FOR M = 0 TO 32*4    ' GOSUB CYCLEØALTØPALETTE    ' GOSUB POLLØPLAY    ' GOSUB ANIMØDRAWØSUBTEXT  NEXT M  RETURN'------------------------.SETØPALETTEØFORØBACKDROP'------------------------#DEFINE √œÃ1Ø“ = $DA ' 218#DEFINE √œÃ1Ø« = $89 ' 137#DEFINE √œÃ1Ø¬ = $00 ' 0#DEFINE √œÃ2Ø“ = $1B ' 27#DEFINE √œÃ2Ø« = $42 ' 66#DEFINE √œÃ2Ø¬ = $0B ' 11  FOR K = 12 TO 21    FLIPØVAR = √œÃ1Ø“ + (√œÃ2Ø“-√œÃ1Ø“) * (K-12)/9    GOSUB FLIPØNIBBLE    DEFAULTØRED&(K) = FLIPØVAR    DEFAULTØRED&(43-K) = FLIPØVAR    FLIPØVAR = √œÃ1Ø« + (√œÃ2Ø«-√œÃ1Ø«) * (K-12)/9    GOSUB FLIPØNIBBLE    DEFAULTØGREEN&(K) = FLIPØVAR    DEFAULTØGREEN&(43-K) = FLIPØVAR    FLIPØVAR = √œÃ1Ø¬ + (√œÃ2Ø¬-√œÃ1Ø¬) * (K-12)/9    GOSUB FLIPØNIBBLE    DEFAULTØBLUE&(K) = FLIPØVAR    DEFAULTØBLUE&(43-K) = FLIPØVAR  NEXT K  RETURN'-----------.FLIPØNIBBLE'-----------  LOWERØNIBBLE = FLIPØVAR AND $0F  UPPERØNIBBLE = (FLIPØVAR >> 4) AND $0F  FLIPØVAR = (LOWERØNIBBLE << 4) + UPPERØNIBBLE  RETURN.ANIMØDRAWØSUBTEXT'-----------------  IF M = 330 THEN BEGIN    SUBTEXTØIDX = 1    PLEN = 0    EDMA 3,80,32,$40800+80*46  BEND  IF PLEN < LEN(SUBTEXT$(SUBTEXTØIDX)) THEN BEGIN    PLEN = PLEN + .25    RAINBOWSTR$=LEFT$(SUBTEXT$(SUBTEXTØIDX),PLEN)    IF SUBTEXTØIDX = 0 THEN RAINBOWØX = 35:ELSE RAINBOWØX = 33    RAINBOWØY = 46    GOSUB PRINTØRAINBOWØSTR  BEND  RETURN.PRINTØRAINBOWØSTR'-----------------  CURSOR RAINBOWØX, RAINBOWØY  FOR RAINØIDX=1 TO LEN(RAINBOWSTR$)    FOREGROUND MOD(RAINØIDX-1,16)+16    PRINT MID$(RAINBOWSTR$,RAINØIDX,1);  NEXT RAINØIDX  RETURN