#OUTPUT "BASLOGO"' ¬¡ŒÀ4 ÕEMORY USAGE' ------------------' 4.0000 ƒÕ¡-Ã…”‘' 4.0020 VAR INTERFACE TO ASSEMBLY'        0020: PTR TO DEFAULTØRED&'        0022: PTR TO DEFAULTØGREEN&'        0024: PTR TO DEFAULTØBLUE&' 4.0800 ”√“≈≈Œ Õ≈Õœ“Ÿ' 4.2000 –≈‘”√…… «“¡–»…√”' ¬¡ŒÀ5 ÕEMORY USAGE' ------------------' 5.0000 SCREEN BUFFER' 5.1000 COLOR RAM BUFFER.DEFINES#DECLARE K, PTR, TMP, MAXØFRAMES, FRMØIDX, FRMW, FRMH, SZ#DECLARE FRAMEØADDR(25), SRCØADDR, DESTØADDR, LENGTH, TRANSP#DECLARE FRAMEIDX, FX, FY, MIRROR, DATAØADDR, FRMX, FRMY#DECLARE FRMX1, FRMY1, SCRADDR, CLRADDR, CDATAØADDR, YY#DECLARE INC(3), INCØDIR(3), A$, X, Y#DECLARE TEMPR, TEMPG, TEMPB, M#DECLARE LOGOØSTATE#DECLARE FLIPØVAR, UPPERØNIBBLE, LOWERØNIBBLE#DECLARE CLR1, CLR2, TSTART#DECLARE BASØSTATE = 0#DECLARE FRMY(3), ORIGØFRMY(3), FINISHØCNT, BCNT#DECLARE LOC#DEFINE ∆“ÕØ¬ = 0#DEFINE ∆“ÕØ¡ = 1#DEFINE ∆“ÕØ” = 2#DEFINE ∆“ÕØ¬¡√Àƒ“œ– = 3#DECLARE »œ‘“≈«Ø7 = $D05D#DEFINE ”√“Œ–‘“Ã”¬ = $D060#DEFINE ”√“Œ–‘“¬ŒÀ = $D062  ' PALETTE  ' -------  #DECLARE DEFAULTØRED&(32)  #DECLARE DEFAULTØGREEN&(32)  #DECLARE DEFAULTØBLUE&(32)  #DECLARE CURRØRED&(32)  #DECLARE CURRØGREEN&(32)  #DECLARE CURRØBLUE&(32)  #DECLARE FADEVAL, TEMPVAL.OFFSETS#DEFINE œ∆∆”≈‘Øƒ¡‘¡Ø”…⁄≈  = 0#DEFINE œ∆∆”≈‘ØŒ’ÕØ∆“¡Õ≈” = 2#DEFINE œ∆∆”≈‘Ø∆“¡Õ≈0     = 3#DEFINE ∆“ÕØœ∆∆”≈‘Øÿ          = 0#DEFINE ∆“ÕØœ∆∆”≈‘ØŸ          = 1#DEFINE ∆“ÕØœ∆∆”≈‘Ø◊          = 2#DEFINE ∆“ÕØœ∆∆”≈‘Ø»          = 3#DEFINE ∆“ÕØœ∆∆”≈‘Ø»…‘¬œÿ≈”   = 4#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø»≈¡ƒ    = 4#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø‘œ“”œ   = 8#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø∆≈≈‘    = 12#DEFINE ∆“ÕØœ∆∆”≈‘Ø»¬Ø¡‘‘¡√À  = 16#DEFINE ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡       = 20'----.MAIN'----  GOSUB INIT  GOSUB LOADØDATA  GOSUB STATEØLOOP  GOSUB ANIMATEØLOGO  END#DEFINE ”‘Ø∆¡ƒ≈Ø‘œØ◊»…‘≈ = 0#DEFINE ”‘Øƒ“¡◊Ø¬¡√Àƒ“œ–ØœŒÃŸ = 1#DEFINE ”‘Ø∆¡ƒ≈Ø‘œØƒ≈∆¡’Ã‘ = 2#DEFINE ”‘Øƒ“œ–Ø…ŒØ¬ = 3'----------.STATEØLOOP'----------  IF LOGOØSTATE = ”‘Ø∆¡ƒ≈Ø‘œØ◊»…‘≈ THEN BEGIN    GOSUB FADEØTOØWHITE    LOGOØSTATE = ”‘Øƒ“¡◊Ø¬¡√Àƒ“œ–ØœŒÃŸ  BEND    IF LOGOØSTATE = ”‘Øƒ“¡◊Ø¬¡√Àƒ“œ–ØœŒÃŸ THEN BEGIN    BANK 128    POKE $D020, 1, 1    GOSUB INITØ80X50    GOSUB DRAWØBACKDROP    GOSUB PAGEØFLIP    GOSUB STOREØCURRØCOLOURS    GOSUB SETØPALETTEØFORØBACKDROP    FADEVAL=0    M=0    LOGOØSTATE = ”‘Ø∆¡ƒ≈Ø‘œØƒ≈∆¡’Ã‘  BEND    IF LOGOØSTATE = ”‘Ø∆¡ƒ≈Ø‘œØƒ≈∆¡’Ã‘ THEN BEGIN    TSTART = TI    IF FADEVAL <= 16 THEN BEGIN      IF MOD(M,3) = 0 THEN BEGIN        GOSUB FADEØCOLOURSØTOØDEFAULTS        FADEVAL = FADEVAL + 1      BEND    BEND    GOSUB CYCLEØALTØPALETTE    M = M + 1    IF M = 50 THEN LOGOØSTATE = ”‘Øƒ“œ–Ø…ŒØ¬    DO    LOOP WHILE (TI-TSTART) < .1  BEND  IF LOGOØSTATE = ”‘Øƒ“œ–Ø…ŒØ¬ THEN BEGIN    GOSUB ANIMATEØLOGO    GOSUB CYCLEØALTØPALETTE    M = M + 1  BEND  GOTO STATEØLOOP  RETURN'----------.INITØ80X50'----------  ' SWITCH BACK TO UPPER-CASE  POKE $D018, PEEK($D018) AND $FD  ' SWITCH TO 80X50  SETBIT »œ‘“≈«Ø7, 7  POKE $D031, $E8 ' 1110 1000 = »640,∆¡”‘,¡‘‘“,÷400  WPOKE ”√“Œ–‘“Ã”¬, $0800  POKE ”√“Œ–‘“¬ŒÀ, $04  RETURN'-------------.DRAWØBACKDROP'-------------    FRAMEIDX = ∆“ÕØ¬¡√Àƒ“œ–    FX=-999 : FY = -999    MIRROR = 0    GOSUB DRAWØPETSCIIØFRAME    RETURN'------------.ANIMATEØLOGO'------------  IF BASØSTATE = 0 THEN BEGIN    ORIGØFRMY(0) = 6    ORIGØFRMY(1) = 23    ORIGØFRMY(2) = 6    FRMY(0) = -44    FRMY(1) = -69    FRMY(2) = -107    BASØSTATE = 1    INCØDIR(0) = 1    INC(0) = 1    INCØDIR(1) = 1    INC(1) = 1    INCØDIR(2) = 1    INC(2) = 1    INCØDIR(3) = 1    INC(3) = 1  BEND  IF BASØSTATE = 1 THEN BEGIN    FINISHØCNT = 0    FOR K = 0 TO 2      IF FRMY(K) < ORIGØFRMY(K) THEN BEGIN        FRMY(K) = FRMY(K) + 2        IF FRMY(K) > ORIGØFRMY(K) THEN FRMY(K) = ORIGØFRMY(K)      BEND      IF FRMY(K) = ORIGØFRMY(K) THEN FINISHØCNT = FINISHØCNT OR 2^K    NEXT K  BEND  GOSUB DRAWØBAS  GOSUB PAGEØFLIP  FOR FRAMEIDX = 0 TO 2    IF FINISHØCNT AND 2^FRAMEIDX AND BCNT(FRAMEIDX)<3 THEN BEGIN      INC(FRAMEIDX) = INC(FRAMEIDX) + .2 * INCØDIR(FRAMEIDX)      IF INC(FRAMEIDX) < .6 THEN BEGIN        INCØDIR(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF INC(FRAMEIDX) > 2.9 THEN BEGIN        INCØDIR(FRAMEIDX) = -1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND      IF BCNT(FRAMEIDX) = 2 AND INC(FRAMEIDX) > 1 THEN BEGIN        INC(FRAMEIDX) = 1        BCNT(FRAMEIDX)=BCNT(FRAMEIDX)+1      BEND    BEND    BEND  NEXT FRAMEIDX    RETURN'----.INIT'----  BANK 0:BLOAD "ASMHELPER":BANK 128  LOGOØSTATE = 0  GOSUB STOREØDEFAULTØCOLOURS  INCØDIR(3) = -1  INC(3) = 1  ' CLEAR DMA LIST AREA  FOR K = 0 TO 20    POKE $40000+K, 0  NEXT K  POKE $40000, $81 ' OPT = DEST ADDR Õ¬ SELECTOR  POKE $40001, $00 ' DEFAULT TO 1ST MEGABYTE  POKE $40002, $07 ' OPT = ENABLE TRANSPARENCY  POKE $40003, $86 ' OPT = SET TRANSPARENCY  POKE $40004, $20 ' TRANSPARENCY VALUE  POKE $40005, $00 ' END OF OPTIONS  POKE $40006, $00 ' √Õƒ LSB = √œ–Ÿ  WPOKE $40007, $0000 ' LENGTH  WPOKE $40009, $1000 ' SOURCE ADDR  POKE $4000B, $05    ' SOURCE BANK  WPOKE $4000C, $1000 ' DEST ADDR  POKE $4000E, $05    ' DEST BANK  POKE $4000F, $00    ' √Õƒ MSB (IGNORE)  WPOKE $40010, $0000 ' MODULO (IGNORE)  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  ' INIT VAR INTERFACE TO ASSEMBLY  LOC = $40020  PTR = POINTER(DEFAULTØRED&(0))  GOSUB STOREØPTR  PTR = POINTER(DEFAULTØGREEN&(0))  GOSUB STOREØPTR  PTR = POINTER(DEFAULTØBLUE&(0))  GOSUB STOREØPTR  RETURN'---------.STOREØPTR'---------  WPOKE LOC, PTR  LOC = LOC + 2  RETURN'---------.LOADØDATA'---------  PTR = $42000    BLOAD "BAS.BIN",P(PTR)  GOSUB INITØPETSCIIØFRAMES  GOSUB ØINCREMENTØPTRØTOØNEXTØFREE  RETURN'-------------------.INITØPETSCIIØFRAMES'-------------------  TMP = PTR  MAXØFRAMES = PEEK(PTR + œ∆∆”≈‘ØŒ’ÕØ∆“¡Õ≈”)  'PRINT  'PRINT "PTR=";HEX$(PTR + œ∆∆”≈‘ØŒ’ÕØ∆“¡Õ≈”)  PTR = PTR + œ∆∆”≈‘Ø∆“¡Õ≈0  'PRINT  'PRINT "- MXØFRM=";MAXØFRAMES;": "  FRMØIDX = 0  DO WHILE FRMØIDX < MAXØFRAMES    'PRINT FRMØIDX;    FRAMEØADDR(FRMØIDX) = PTR    FRMX = PEEK(PTR + ∆“ÕØœ∆∆”≈‘Øÿ)    FRMY = PEEK(PTR + ∆“ÕØœ∆∆”≈‘ØŸ)    FRMW = PEEK(PTR + ∆“ÕØœ∆∆”≈‘Ø◊)    FRMH = PEEK(PTR + ∆“ÕØœ∆∆”≈‘Ø»)    FRMX1=FRMX+FRMW-1    FRMY1=FRMY+FRMH-1    DATAØADDR = PTR    DATAØADDR = DATAØADDR + ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡    CDATAØADDR = DATAØADDR + FRMW * FRMH    FOR Y = 0 TO FRMY1-FRMY      FOR X = 0 TO FRMX1-FRMX        IF PEEK(DATAØADDR + X + Y * FRMW) = 102 THEN BEGIN          POKE (CDATAØADDR + X + Y * FRMW), $FF        BEND      NEXT X    NEXT Y        'PRINT "PTR=";HEX$(PTR);", IDX=";FRMØIDX;", W=";FRMW;", H=";FRMH    PTR = PTR + ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡ + FRMW * FRMH * 2    'PRINT "FRMØIDX=";FRMØIDX    FRMØIDX = FRMØIDX + 1  LOOP  PTR = TMP  RETURN'---------------------------.ØINCREMENTØPTRØTOØNEXTØFREE'---------------------------  PTR = TMP  SZ = WPEEK(PTR + œ∆∆”≈‘Øƒ¡‘¡Ø”…⁄≈)  'PRINT  'PRINT "INC SZ = ";SZ  'PRINT "PTR = ";HEX$(PTR + œ∆∆”≈‘Øƒ¡‘¡Ø”…⁄≈)  PTR = PTR + SZ  'GET KEY A$  RETURN'--------.DRAWØBAS'--------  FRAMEIDX = ∆“ÕØ¬¡√Àƒ“œ–  FX=-999 : FY = -999  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  FRAMEIDX = ∆“ÕØ¬  FX=-999 : FY=FRMY(0)  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  FRAMEIDX = ∆“ÕØ¡  FX=-999 : FY=FRMY(1)  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  FRAMEIDX = ∆“ÕØ”  FX=-999 : FY=FRMY(2)  MIRROR = 0  GOSUB DRAWØPETSCIIØFRAME  RETURN'------------------.DRAWØPETSCIIØFRAME'------------------  POKE $4000B, $04  ' ASSURE SOURCE BANK 4 (FOR ORIGINAL FRAME DATA)  IF MIRROR = 1 THEN SETBIT $40006, 5:ELSE CLRBIT $40006, 5  DATAØADDR = FRAMEØADDR(FRAMEIDX)  FRMX = PEEK(DATAØADDR + ∆“ÕØœ∆∆”≈‘Øÿ)  FRMY = PEEK(DATAØADDR + ∆“ÕØœ∆∆”≈‘ØŸ)  FRMW = PEEK(DATAØADDR + ∆“ÕØœ∆∆”≈‘Ø◊)  FRMH = PEEK(DATAØADDR + ∆“ÕØœ∆∆”≈‘Ø»)  IF FX<>-999 THEN FRMX = FX ' OVERRIDE POSITION  IF FY<>-999 THEN FRMY = FY  FRMX1=FRMX+FRMW-1  FRMY1=FRMY+FRMH-1  SCRADDR = $50000 + FRMX + (FRMY+FRMH-1) * 80  CLRADDR = $51000 + FRMX + (FRMY+FRMH-1) * 80  IF MIRROR = 1 THEN CLRADDR = CLRADDR + FRMW - 1  DATAØADDR = DATAØADDR + ∆“ÕØœ∆∆”≈‘Øƒ¡‘¡  CDATAØADDR = DATAØADDR + FRMW * FRMH  FOR YY=FRMY1 TO FRMY STEP -INC(FRAMEIDX)    IF YY < FRMY THEN YY = FRMY    IF SCRADDR < $50000 THEN GOTO FORØSKIP    ' DRAW CHARS    ' ----------    SRCØADDR = DATAØADDR + INT(YY-FRMY) * FRMW    DESTØADDR = SCRADDR    LENGTH = FRMW    TRANSP = 102    GOSUB TRANSPARENTØDMA    SRCØADDR = CDATAØADDR + INT(YY-FRMY) * FRMW    DESTØADDR = CLRADDR    LENGTH = FRMW    TRANSP = $FF    GOSUB TRANSPARENTØDMA    'DATAØADDR = D + FRMW * INT(FRMY1 + YY    'CDATAØADDR = CDATAØADDR + FRMW    SCRADDR = SCRADDR - 80    CLRADDR = CLRADDR - 80.FORØSKIP  NEXT YY  RETURN'---------------.TRANSPARENTØDMA'---------------  WPOKE $40009, SRCØADDR  WPOKE $4000C, DESTØADDR  WPOKE $40007, LENGTH  POKE  $40004, TRANSP  POKE $D702, 4 ' DMA LIST IN BANK 4  POKE $D701, $00 ' DMA LIST MSB  POKE $D705, $00 ' DMA LIST LSB  RETURN'---------.PAGEØFLIP'---------  EDMA 0, $FA0, $50000, $40800  EDMA 0, $FA0, $51000, $FF80000  ' CLEAR THE OFFSCREEN BUFFER  EDMA 3, $FA0, 32, $50000  EDMA 3, $FA0, 0, $51000  RETURN.FADEØTOØWHITE'-------------  FOR FADEVAL=0 TO 16    BANK 0:SYS $7E00, FADEVAL:BANK 128    ' GOSUB FADEØCOLOURSØTOØWHITE  NEXT FADEVAL  RETURN.FADEØCOLOURSØTOØWHITE'---------------------  '…Œ–’‘: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = 0 TO 31    FLIPØVAR = DEFAULTØRED&(K)    GOSUB FLIPØNIBBLE    CLR1 = FLIPØVAR    CLR2 = $F0    FLIPØVAR = CLR1 + (CLR2 - CLR1) * TEMPVAL    GOSUB FLIPØNIBBLE    POKE $D100+K, FLIPØVAR    FLIPØVAR = DEFAULTØGREEN&(K)    GOSUB FLIPØNIBBLE    CLR1 = FLIPØVAR    FLIPØVAR = CLR1 + (CLR2 - CLR1) * TEMPVAL    GOSUB FLIPØNIBBLE    POKE $D200+K, FLIPØVAR    FLIPØVAR = DEFAULTØBLUE&(K)    GOSUB FLIPØNIBBLE    CLR1 = FLIPØVAR    FLIPØVAR = CLR1 + (CLR2 - CLR1) * TEMPVAL    GOSUB FLIPØNIBBLE    POKE $D300+K, FLIPØVAR  NEXT K  RETURN.STOREØDEFAULTØCOLOURS'---------------------  FOR K = 0 TO 31    DEFAULTØRED&(K)=PEEK($D100+K)    DEFAULTØGREEN&(K)=PEEK($D200+K)    DEFAULTØBLUE&(K)=PEEK($D300+K)  NEXT K  RETURN.FADEØCOLOURSØTOØDEFAULTS'------------------------  '…Œ–’‘: FADEVAL=0 TO 16  TEMPVAL = FADEVAL / 16  FOR K = 0 TO 31    FLIPØVAR = CURRØRED&(K)    GOSUB FLIPØNIBBLE    CLR1 = FLIPØVAR    FLIPØVAR = DEFAULTØRED&(K)    GOSUB FLIPØNIBBLE    CLR2 = FLIPØVAR    FLIPØVAR = CLR1 + (CLR2 - CLR1) * TEMPVAL    GOSUB FLIPØNIBBLE    POKE $D100+K, FLIPØVAR    ' ------    FLIPØVAR = CURRØGREEN&(K)    GOSUB FLIPØNIBBLE    CLR1 = FLIPØVAR    FLIPØVAR = DEFAULTØGREEN&(K)    GOSUB FLIPØNIBBLE    CLR2 = FLIPØVAR    FLIPØVAR = CLR1 + (CLR2 - CLR1) * TEMPVAL    GOSUB FLIPØNIBBLE    POKE $D200+K, FLIPØVAR    ' ------    FLIPØVAR = CURRØBLUE&(K)    GOSUB FLIPØNIBBLE    CLR1 = FLIPØVAR    FLIPØVAR = DEFAULTØBLUE&(K)    GOSUB FLIPØNIBBLE    CLR2 = FLIPØVAR    FLIPØVAR = CLR1 + (CLR2 - CLR1) * TEMPVAL    GOSUB FLIPØNIBBLE    POKE $D300+K, FLIPØVAR  NEXT K  RETURN.STOREØCURRØCOLOURS'------------------  FOR K = 0 TO 31    CURRØRED&(K)=PEEK($D100+K)    CURRØGREEN&(K)=PEEK($D200+K)    CURRØBLUE&(K)=PEEK($D300+K)  NEXT K  RETURN.CYCLEØALTØPALETTEØLOOP'----------------------  FOR M = 0 TO 32*4    GOSUB CYCLEØALTØPALETTE    ' GOSUB POLLØPLAY    ' GOSUB ANIMØDRAWØSUBTEXT  NEXT M  RETURN.CYCLEØALTØPALETTE'-----------------  TEMPR = PEEK($D100+12)  TEMPG = PEEK($D200+12)  TEMPB = PEEK($D300+12)  FOR K = 12 TO 30    POKE $D100+K, PEEK($D100+K+1)    POKE $D200+K, PEEK($D200+K+1)    POKE $D300+K, PEEK($D300+K+1)  NEXT K  POKE $D100+31, TEMPR  POKE $D200+31, TEMPG  POKE $D300+31, TEMPB  TEMPR = CURRØRED&(12)  TEMPG = CURRØGREEN&(12)  TEMPB = CURRØBLUE&(12)  FOR K = 12 TO 30    CURRØRED&(K) = CURRØRED&(K+1)    CURRØGREEN&(K) = CURRØGREEN&(K+1)    CURRØBLUE&(K) = CURRØBLUE&(K+1)  NEXT K  CURRØRED&(31) = TEMPR  CURRØGREEN&(31) = TEMPG  CURRØBLUE&(31) = TEMPB  TEMPR = DEFAULTØRED&(12)  TEMPG = DEFAULTØGREEN&(12)  TEMPB = DEFAULTØBLUE&(12)  FOR K = 12 TO 30    DEFAULTØRED&(K) = DEFAULTØRED&(K+1)    DEFAULTØGREEN&(K) = DEFAULTØGREEN&(K+1)    DEFAULTØBLUE&(K) = DEFAULTØBLUE&(K+1)  NEXT K  DEFAULTØRED&(31) = TEMPR  DEFAULTØGREEN&(31) = TEMPG  DEFAULTØBLUE&(31) = TEMPB  RETURN'------------------------.SETØPALETTEØFORØBACKDROP'------------------------#DEFINE √œÃ1Ø“ = $DA ' 218#DEFINE √œÃ1Ø« = $89 ' 137#DEFINE √œÃ1Ø¬ = $00 ' 0#DEFINE √œÃ2Ø“ = $1B ' 27#DEFINE √œÃ2Ø« = $42 ' 66#DEFINE √œÃ2Ø¬ = $0B ' 11  FOR K = 12 TO 21    FLIPØVAR = √œÃ1Ø“ + (√œÃ2Ø“-√œÃ1Ø“) * (K-12)/9    GOSUB FLIPØNIBBLE    DEFAULTØRED&(K) = FLIPØVAR    DEFAULTØRED&(43-K) = FLIPØVAR    FLIPØVAR = √œÃ1Ø« + (√œÃ2Ø«-√œÃ1Ø«) * (K-12)/9    GOSUB FLIPØNIBBLE    DEFAULTØGREEN&(K) = FLIPØVAR    DEFAULTØGREEN&(43-K) = FLIPØVAR    FLIPØVAR = √œÃ1Ø¬ + (√œÃ2Ø¬-√œÃ1Ø¬) * (K-12)/9    GOSUB FLIPØNIBBLE    DEFAULTØBLUE&(K) = FLIPØVAR    DEFAULTØBLUE&(43-K) = FLIPØVAR  NEXT K  RETURN'-----------.FLIPØNIBBLE'-----------  LOWERØNIBBLE = FLIPØVAR AND $0F  UPPERØNIBBLE = (FLIPØVAR >> 4) AND $0F  FLIPØVAR = (LOWERØNIBBLE << 4) + UPPERØNIBBLE  RETURN